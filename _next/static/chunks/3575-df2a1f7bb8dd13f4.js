(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3575],{62729:function(){},45965:function(c,u,f){"use strict";/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function _iterableToArrayLimit(c,u){var f=null==c?null:"undefined"!=typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(null!=f){var g,b,v,x,w=[],_=!0,k=!1;try{if(v=(f=f.call(c)).next,0===u){if(Object(f)!==f)return;_=!1}else for(;!(_=(g=v.call(f)).done)&&(w.push(g.value),w.length!==u);_=!0);}catch(c){k=!0,b=c}finally{try{if(!_&&null!=f.return&&(x=f.return(),Object(x)!==x))return}finally{if(k)throw b}}return w}}function ownKeys(c,u){var f=Object.keys(c);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(c);u&&(g=g.filter(function(u){return Object.getOwnPropertyDescriptor(c,u).enumerable})),f.push.apply(f,g)}return f}function _objectSpread2(c){for(var u=1;u<arguments.length;u++){var f=null!=arguments[u]?arguments[u]:{};u%2?ownKeys(Object(f),!0).forEach(function(u){_defineProperty(c,u,f[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(f)):ownKeys(Object(f)).forEach(function(u){Object.defineProperty(c,u,Object.getOwnPropertyDescriptor(f,u))})}return c}function _defineProperty(c,u,f){return(u=_toPropertyKey(u))in c?Object.defineProperty(c,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[u]=f,c}function _objectWithoutPropertiesLoose(c,u){if(null==c)return{};var f,g,b={},v=Object.keys(c);for(g=0;g<v.length;g++)f=v[g],u.indexOf(f)>=0||(b[f]=c[f]);return b}function _objectWithoutProperties(c,u){if(null==c)return{};var f,g,b=_objectWithoutPropertiesLoose(c,u);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(c);for(g=0;g<v.length;g++)f=v[g],!(u.indexOf(f)>=0)&&Object.prototype.propertyIsEnumerable.call(c,f)&&(b[f]=c[f])}return b}function _slicedToArray(c,u){return _arrayWithHoles(c)||_iterableToArrayLimit(c,u)||_unsupportedIterableToArray(c,u)||_nonIterableRest()}function _toConsumableArray(c){return _arrayWithoutHoles(c)||_iterableToArray(c)||_unsupportedIterableToArray(c)||_nonIterableSpread()}function _arrayWithoutHoles(c){if(Array.isArray(c))return _arrayLikeToArray(c)}function _arrayWithHoles(c){if(Array.isArray(c))return c}function _iterableToArray(c){if("undefined"!=typeof Symbol&&null!=c[Symbol.iterator]||null!=c["@@iterator"])return Array.from(c)}function _unsupportedIterableToArray(c,u){if(c){if("string"==typeof c)return _arrayLikeToArray(c,u);var f=Object.prototype.toString.call(c).slice(8,-1);if("Object"===f&&c.constructor&&(f=c.constructor.name),"Map"===f||"Set"===f)return Array.from(c);if("Arguments"===f||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return _arrayLikeToArray(c,u)}}function _arrayLikeToArray(c,u){(null==u||u>c.length)&&(u=c.length);for(var f=0,g=Array(u);f<u;f++)g[f]=c[f];return g}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toPrimitive(c,u){if("object"!=typeof c||null===c)return c;var f=c[Symbol.toPrimitive];if(void 0!==f){var g=f.call(c,u||"default");if("object"!=typeof g)return g;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(c)}function _toPropertyKey(c){var u=_toPrimitive(c,"string");return"symbol"==typeof u?u:String(u)}function canvasTest(c){var u,f,g=c.sizes.shift(),b=Math.max(Math.ceil(g[0]),1),v=Math.max(Math.ceil(g[1]),1),x=[b-1,v-1,1,1],w=Date.now(),_="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;_?(u=new OffscreenCanvas(1,1),f=new OffscreenCanvas(b,v)):((u=document.createElement("canvas")).width=1,u.height=1,(f=document.createElement("canvas")).width=b,f.height=v);var k=u.getContext("2d"),E=f.getContext("2d");E&&(E.fillRect.apply(E,x),k.drawImage(f,b-1,v-1,1,1,0,0,1,1));var T=k&&0!==k.getImageData(0,0,1,1).data[3],$=Date.now()-w;return[u,f].forEach(function(c){c.height=0,c.width=0}),_?(postMessage({width:b,height:v,benchmark:$,isTestPass:T}),!T&&c.sizes.length&&canvasTest(c)):T?c.onSuccess(b,v,$):(c.onError(b,v,$),c.sizes.length&&canvasTest(c)),T}f.r(u),f.d(u,{default:function(){return w}});var g={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},b=["onError","onSuccess"],v={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},x={};function createSizesArray(c){var u=c.width===c.height,f=1===c.height,g=1===c.width,b=[];if(c.width&&c.height)for(var x=c.min||v.min,w=c.step||v.step,_=Math.max(c.width,c.height);_>=x;){var k=u||f?_:1,E=u||g?_:1;b.push([k,E]),_-=w}else c.sizes.forEach(function(c){var v=u||f?c:1,x=u||g?c:1;b.push([v,x])});return b}function handleMethod(c){var u=window&&"HTMLCanvasElement"in window,f=window&&"OffscreenCanvas"in window,g=Date.now(),v=c.onError,w=c.onSuccess,_=_objectWithoutProperties(c,b),k=null;if(!u)return!1;if(c.useWorker&&f){var E="\n            var canvasTest = ".concat(canvasTest.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),T=new Blob([E],{type:"application/javascript"}),$=URL.createObjectURL(T);k=new Worker($),URL.revokeObjectURL($),k.onmessage=function(c){var u=c.data,f=u.width,b=u.height,v=u.benchmark;u.isTestPass?(x[g].onSuccess(f,b,v),delete x[g]):x[g].onError(f,b,v)}}return c.usePromise?new Promise(function(u,f){var b=_objectSpread2(_objectSpread2({},c),{},{onError:function(u,g,b){var x;if(0===c.sizes.length)x=!0;else{var w=_slicedToArray(c.sizes.slice(-1),1),_=_slicedToArray(w[0],2),k=_[0],E=_[1];x=u===k&&g===E}v(u,g,b),x&&f({width:u,height:g,benchmark:b})},onSuccess:function(c,f,g){w(c,f,g),u({width:c,height:f,benchmark:g})}});if(k){var E=b.onError,T=b.onSuccess;x[g]={onError:E,onSuccess:T},k.postMessage(_)}else canvasTest(b)}):k?void(x[g]={onError:v,onSuccess:w},k.postMessage(_)):canvasTest(c)}var w={maxArea:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=createSizesArray({width:c.max,height:c.max,min:c.min,step:c.step,sizes:_toConsumableArray(g.area)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},v),c),{},{sizes:u}))},maxHeight:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=createSizesArray({width:1,height:c.max,min:c.min,step:c.step,sizes:_toConsumableArray(g.height)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},v),c),{},{sizes:u}))},maxWidth:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=createSizesArray({width:c.max,height:1,min:c.min,step:c.step,sizes:_toConsumableArray(g.width)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},v),c),{},{sizes:u}))},test:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=_objectSpread2(_objectSpread2({},v),c);return u.sizes=_toConsumableArray(u.sizes),u.width&&u.height&&(u.sizes=[[u.width,u.height]]),handleMethod(u)}}},28729:function(c){"use strict";var u=Object.prototype.hasOwnProperty,f="~";function Events(){}function EE(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function addListener(c,u,g,b,v){if("function"!=typeof g)throw TypeError("The listener must be a function");var x=new EE(g,b||c,v),w=f?f+u:u;return c._events[w]?c._events[w].fn?c._events[w]=[c._events[w],x]:c._events[w].push(x):(c._events[w]=x,c._eventsCount++),c}function clearEvent(c,u){0==--c._eventsCount?c._events=new Events:delete c._events[u]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),new Events().__proto__||(f=!1)),EventEmitter.prototype.eventNames=function(){var c,g,b=[];if(0===this._eventsCount)return b;for(g in c=this._events)u.call(c,g)&&b.push(f?g.slice(1):g);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(c)):b},EventEmitter.prototype.listeners=function(c){var u=f?f+c:c,g=this._events[u];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,x=Array(v);b<v;b++)x[b]=g[b].fn;return x},EventEmitter.prototype.listenerCount=function(c){var u=f?f+c:c,g=this._events[u];return g?g.fn?1:g.length:0},EventEmitter.prototype.emit=function(c,u,g,b,v,x){var w=f?f+c:c;if(!this._events[w])return!1;var _,k,E=this._events[w],T=arguments.length;if(E.fn){switch(E.once&&this.removeListener(c,E.fn,void 0,!0),T){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,u),!0;case 3:return E.fn.call(E.context,u,g),!0;case 4:return E.fn.call(E.context,u,g,b),!0;case 5:return E.fn.call(E.context,u,g,b,v),!0;case 6:return E.fn.call(E.context,u,g,b,v,x),!0}for(k=1,_=Array(T-1);k<T;k++)_[k-1]=arguments[k];E.fn.apply(E.context,_)}else{var $,I=E.length;for(k=0;k<I;k++)switch(E[k].once&&this.removeListener(c,E[k].fn,void 0,!0),T){case 1:E[k].fn.call(E[k].context);break;case 2:E[k].fn.call(E[k].context,u);break;case 3:E[k].fn.call(E[k].context,u,g);break;case 4:E[k].fn.call(E[k].context,u,g,b);break;default:if(!_)for($=1,_=Array(T-1);$<T;$++)_[$-1]=arguments[$];E[k].fn.apply(E[k].context,_)}}return!0},EventEmitter.prototype.on=function(c,u,f){return addListener(this,c,u,f,!1)},EventEmitter.prototype.once=function(c,u,f){return addListener(this,c,u,f,!0)},EventEmitter.prototype.removeListener=function(c,u,g,b){var v=f?f+c:c;if(!this._events[v])return this;if(!u)return clearEvent(this,v),this;var x=this._events[v];if(x.fn)x.fn!==u||b&&!x.once||g&&x.context!==g||clearEvent(this,v);else{for(var w=0,_=[],k=x.length;w<k;w++)(x[w].fn!==u||b&&!x[w].once||g&&x[w].context!==g)&&_.push(x[w]);_.length?this._events[v]=1===_.length?_[0]:_:clearEvent(this,v)}return this},EventEmitter.prototype.removeAllListeners=function(c){var u;return c?(u=f?f+c:c,this._events[u]&&clearEvent(this,u)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=f,EventEmitter.EventEmitter=EventEmitter,c.exports=EventEmitter},99780:function(c,u,f){c=f.nmd(c);var g,b="__lodash_hash_undefined__",v="[object Arguments]",x="[object Array]",w="[object Boolean]",_="[object Date]",k="[object Error]",E="[object Function]",T="[object Map]",$="[object Number]",I="[object Object]",M="[object Promise]",j="[object RegExp]",D="[object Set]",L="[object String]",F="[object WeakMap]",B="[object ArrayBuffer]",G="[object DataView]",U=/^\[object .+?Constructor\]$/,V=/^(?:0|[1-9]\d*)$/,K={};K["[object Float32Array]"]=K["[object Float64Array]"]=K["[object Int8Array]"]=K["[object Int16Array]"]=K["[object Int32Array]"]=K["[object Uint8Array]"]=K["[object Uint8ClampedArray]"]=K["[object Uint16Array]"]=K["[object Uint32Array]"]=!0,K[v]=K[x]=K[B]=K[w]=K[G]=K[_]=K[k]=K[E]=K[T]=K[$]=K[I]=K[j]=K[D]=K[L]=K[F]=!1;var Z="object"==typeof f.g&&f.g&&f.g.Object===Object&&f.g,Y="object"==typeof self&&self&&self.Object===Object&&self,X=Z||Y||Function("return this")(),J=u&&!u.nodeType&&u,Q=J&&c&&!c.nodeType&&c,ee=Q&&Q.exports===J,et=ee&&Z.process,en=function(){try{return et&&et.binding&&et.binding("util")}catch(c){}}(),er=en&&en.isTypedArray;function arrayFilter(c,u){for(var f=-1,g=null==c?0:c.length,b=0,v=[];++f<g;){var x=c[f];u(x,f,c)&&(v[b++]=x)}return v}function arrayPush(c,u){for(var f=-1,g=u.length,b=c.length;++f<g;)c[b+f]=u[f];return c}function arraySome(c,u){for(var f=-1,g=null==c?0:c.length;++f<g;)if(u(c[f],f,c))return!0;return!1}function baseTimes(c,u){for(var f=-1,g=Array(c);++f<c;)g[f]=u(f);return g}function baseUnary(c){return function(u){return c(u)}}function cacheHas(c,u){return c.has(u)}function getValue(c,u){return null==c?void 0:c[u]}function mapToArray(c){var u=-1,f=Array(c.size);return c.forEach(function(c,g){f[++u]=[g,c]}),f}function overArg(c,u){return function(f){return c(u(f))}}function setToArray(c){var u=-1,f=Array(c.size);return c.forEach(function(c){f[++u]=c}),f}var ei=Array.prototype,eo=Function.prototype,ea=Object.prototype,es=X["__core-js_shared__"],el=eo.toString,ec=ea.hasOwnProperty,eu=(g=/[^.]+$/.exec(es&&es.keys&&es.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",ed=ea.toString,eh=RegExp("^"+el.call(ec).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ep=ee?X.Buffer:void 0,ef=X.Symbol,eg=X.Uint8Array,em=ea.propertyIsEnumerable,ey=ei.splice,eb=ef?ef.toStringTag:void 0,ev=Object.getOwnPropertySymbols,eS=ep?ep.isBuffer:void 0,ex=overArg(Object.keys,Object),ew=getNative(X,"DataView"),e_=getNative(X,"Map"),ek=getNative(X,"Promise"),eC=getNative(X,"Set"),eE=getNative(X,"WeakMap"),eP=getNative(Object,"create"),eT=toSource(ew),e$=toSource(e_),eI=toSource(ek),eA=toSource(eC),eM=toSource(eE),ej=ef?ef.prototype:void 0,eO=ej?ej.valueOf:void 0;function Hash(c){var u=-1,f=null==c?0:c.length;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function hashClear(){this.__data__=eP?eP(null):{},this.size=0}function hashDelete(c){var u=this.has(c)&&delete this.__data__[c];return this.size-=u?1:0,u}function hashGet(c){var u=this.__data__;if(eP){var f=u[c];return f===b?void 0:f}return ec.call(u,c)?u[c]:void 0}function hashHas(c){var u=this.__data__;return eP?void 0!==u[c]:ec.call(u,c)}function hashSet(c,u){var f=this.__data__;return this.size+=this.has(c)?0:1,f[c]=eP&&void 0===u?b:u,this}function ListCache(c){var u=-1,f=null==c?0:c.length;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function listCacheClear(){this.__data__=[],this.size=0}function listCacheDelete(c){var u=this.__data__,f=assocIndexOf(u,c);return!(f<0)&&(f==u.length-1?u.pop():ey.call(u,f,1),--this.size,!0)}function listCacheGet(c){var u=this.__data__,f=assocIndexOf(u,c);return f<0?void 0:u[f][1]}function listCacheHas(c){return assocIndexOf(this.__data__,c)>-1}function listCacheSet(c,u){var f=this.__data__,g=assocIndexOf(f,c);return g<0?(++this.size,f.push([c,u])):f[g][1]=u,this}function MapCache(c){var u=-1,f=null==c?0:c.length;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(e_||ListCache),string:new Hash}}function mapCacheDelete(c){var u=getMapData(this,c).delete(c);return this.size-=u?1:0,u}function mapCacheGet(c){return getMapData(this,c).get(c)}function mapCacheHas(c){return getMapData(this,c).has(c)}function mapCacheSet(c,u){var f=getMapData(this,c),g=f.size;return f.set(c,u),this.size+=f.size==g?0:1,this}function SetCache(c){var u=-1,f=null==c?0:c.length;for(this.__data__=new MapCache;++u<f;)this.add(c[u])}function setCacheAdd(c){return this.__data__.set(c,b),this}function setCacheHas(c){return this.__data__.has(c)}function Stack(c){var u=this.__data__=new ListCache(c);this.size=u.size}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(c){var u=this.__data__,f=u.delete(c);return this.size=u.size,f}function stackGet(c){return this.__data__.get(c)}function stackHas(c){return this.__data__.has(c)}function stackSet(c,u){var f=this.__data__;if(f instanceof ListCache){var g=f.__data__;if(!e_||g.length<199)return g.push([c,u]),this.size=++f.size,this;f=this.__data__=new MapCache(g)}return f.set(c,u),this.size=f.size,this}function arrayLikeKeys(c,u){var f=eN(c),g=!f&&eL(c),b=!f&&!g&&eF(c),v=!f&&!g&&!b&&eB(c),x=f||g||b||v,w=x?baseTimes(c.length,String):[],_=w.length;for(var k in c)(u||ec.call(c,k))&&!(x&&("length"==k||b&&("offset"==k||"parent"==k)||v&&("buffer"==k||"byteLength"==k||"byteOffset"==k)||isIndex(k,_)))&&w.push(k);return w}function assocIndexOf(c,u){for(var f=c.length;f--;)if(eq(c[f][0],u))return f;return -1}function baseGetAllKeys(c,u,f){var g=u(c);return eN(c)?g:arrayPush(g,f(c))}function baseGetTag(c){return null==c?void 0===c?"[object Undefined]":"[object Null]":eb&&eb in Object(c)?getRawTag(c):objectToString(c)}function baseIsArguments(c){return isObjectLike(c)&&baseGetTag(c)==v}function baseIsEqual(c,u,f,g,b){return c===u||(null!=c&&null!=u&&(isObjectLike(c)||isObjectLike(u))?baseIsEqualDeep(c,u,f,g,baseIsEqual,b):c!=c&&u!=u)}function baseIsEqualDeep(c,u,f,g,b,w){var _=eN(c),k=eN(u),E=_?x:eD(c),T=k?x:eD(u);E=E==v?I:E,T=T==v?I:T;var $=E==I,M=T==I,j=E==T;if(j&&eF(c)){if(!eF(u))return!1;_=!0,$=!1}if(j&&!$)return w||(w=new Stack),_||eB(c)?equalArrays(c,u,f,g,b,w):equalByTag(c,u,E,f,g,b,w);if(!(1&f)){var D=$&&ec.call(c,"__wrapped__"),L=M&&ec.call(u,"__wrapped__");if(D||L){var F=D?c.value():c,B=L?u.value():u;return w||(w=new Stack),b(F,B,f,g,w)}}return!!j&&(w||(w=new Stack),equalObjects(c,u,f,g,b,w))}function baseIsNative(c){return!(!isObject(c)||isMasked(c))&&(isFunction(c)?eh:U).test(toSource(c))}function baseIsTypedArray(c){return isObjectLike(c)&&isLength(c.length)&&!!K[baseGetTag(c)]}function baseKeys(c){if(!isPrototype(c))return ex(c);var u=[];for(var f in Object(c))ec.call(c,f)&&"constructor"!=f&&u.push(f);return u}function equalArrays(c,u,f,g,b,v){var x=1&f,w=c.length,_=u.length;if(w!=_&&!(x&&_>w))return!1;var k=v.get(c);if(k&&v.get(u))return k==u;var E=-1,T=!0,$=2&f?new SetCache:void 0;for(v.set(c,u),v.set(u,c);++E<w;){var I=c[E],M=u[E];if(g)var j=x?g(M,I,E,u,c,v):g(I,M,E,c,u,v);if(void 0!==j){if(j)continue;T=!1;break}if($){if(!arraySome(u,function(c,u){if(!cacheHas($,u)&&(I===c||b(I,c,f,g,v)))return $.push(u)})){T=!1;break}}else if(!(I===M||b(I,M,f,g,v))){T=!1;break}}return v.delete(c),v.delete(u),T}function equalByTag(c,u,f,g,b,v,x){switch(f){case G:if(c.byteLength!=u.byteLength||c.byteOffset!=u.byteOffset)break;c=c.buffer,u=u.buffer;case B:if(c.byteLength!=u.byteLength||!v(new eg(c),new eg(u)))break;return!0;case w:case _:case $:return eq(+c,+u);case k:return c.name==u.name&&c.message==u.message;case j:case L:return c==u+"";case T:var E=mapToArray;case D:var I=1&g;if(E||(E=setToArray),c.size!=u.size&&!I)break;var M=x.get(c);if(M)return M==u;g|=2,x.set(c,u);var F=equalArrays(E(c),E(u),g,b,v,x);return x.delete(c),F;case"[object Symbol]":if(eO)return eO.call(c)==eO.call(u)}return!1}function equalObjects(c,u,f,g,b,v){var x=1&f,w=baseGetAllKeys(c,keys,eR),_=w.length;if(_!=baseGetAllKeys(u,keys,eR).length&&!x)return!1;for(var k=_;k--;){var E=w[k];if(!(x?E in u:ec.call(u,E)))return!1}var T=v.get(c);if(T&&v.get(u))return T==u;var $=!0;v.set(c,u),v.set(u,c);for(var I=x;++k<_;){var M=c[E=w[k]],j=u[E];if(g)var D=x?g(j,M,E,u,c,v):g(M,j,E,c,u,v);if(!(void 0===D?M===j||b(M,j,f,g,v):D)){$=!1;break}I||(I="constructor"==E)}if($&&!I){var L=c.constructor,F=u.constructor;L!=F&&"constructor"in c&&"constructor"in u&&!("function"==typeof L&&L instanceof L&&"function"==typeof F&&F instanceof F)&&($=!1)}return v.delete(c),v.delete(u),$}function getMapData(c,u){var f=c.__data__;return isKeyable(u)?f["string"==typeof u?"string":"hash"]:f.map}function getNative(c,u){var f=getValue(c,u);return baseIsNative(f)?f:void 0}function getRawTag(c){var u=ec.call(c,eb),f=c[eb];try{c[eb]=void 0;var g=!0}catch(c){}var b=ed.call(c);return g&&(u?c[eb]=f:delete c[eb]),b}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var eR=ev?function(c){return null==c?[]:arrayFilter(ev(c=Object(c)),function(u){return em.call(c,u)})}:stubArray,eD=baseGetTag;function isIndex(c,u){return!!(u=null==u?9007199254740991:u)&&("number"==typeof c||V.test(c))&&c>-1&&c%1==0&&c<u}function isKeyable(c){var u=typeof c;return"string"==u||"number"==u||"symbol"==u||"boolean"==u?"__proto__"!==c:null===c}function isMasked(c){return!!eu&&eu in c}function isPrototype(c){var u=c&&c.constructor;return c===("function"==typeof u&&u.prototype||ea)}function objectToString(c){return ed.call(c)}function toSource(c){if(null!=c){try{return el.call(c)}catch(c){}try{return c+""}catch(c){}}return""}function eq(c,u){return c===u||c!=c&&u!=u}(ew&&eD(new ew(new ArrayBuffer(1)))!=G||e_&&eD(new e_)!=T||ek&&eD(ek.resolve())!=M||eC&&eD(new eC)!=D||eE&&eD(new eE)!=F)&&(eD=function(c){var u=baseGetTag(c),f=u==I?c.constructor:void 0,g=f?toSource(f):"";if(g)switch(g){case eT:return G;case e$:return T;case eI:return M;case eA:return D;case eM:return F}return u});var eL=baseIsArguments(function(){return arguments}())?baseIsArguments:function(c){return isObjectLike(c)&&ec.call(c,"callee")&&!em.call(c,"callee")},eN=Array.isArray;function isArrayLike(c){return null!=c&&isLength(c.length)&&!isFunction(c)}var eF=eS||stubFalse;function isEqual(c,u){return baseIsEqual(c,u)}function isFunction(c){if(!isObject(c))return!1;var u=baseGetTag(c);return u==E||"[object GeneratorFunction]"==u||"[object AsyncFunction]"==u||"[object Proxy]"==u}function isLength(c){return"number"==typeof c&&c>-1&&c%1==0&&c<=9007199254740991}function isObject(c){var u=typeof c;return null!=c&&("object"==u||"function"==u)}function isObjectLike(c){return null!=c&&"object"==typeof c}var eB=er?baseUnary(er):baseIsTypedArray;function keys(c){return isArrayLike(c)?arrayLikeKeys(c):baseKeys(c)}function stubArray(){return[]}function stubFalse(){return!1}c.exports=isEqual},26978:function(c,u,f){var g="Expected a function",b=0/0,v=/^\s+|\s+$/g,x=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,_=/^0o[0-7]+$/i,k=parseInt,E="object"==typeof f.g&&f.g&&f.g.Object===Object&&f.g,T="object"==typeof self&&self&&self.Object===Object&&self,$=E||T||Function("return this")(),I=Object.prototype.toString,M=Math.max,j=Math.min,now=function(){return $.Date.now()};function debounce(c,u,f){var b,v,x,w,_,k,E=0,T=!1,$=!1,I=!0;if("function"!=typeof c)throw TypeError(g);function invokeFunc(u){var f=b,g=v;return b=v=void 0,E=u,w=c.apply(g,f)}function leadingEdge(c){return E=c,_=setTimeout(timerExpired,u),T?invokeFunc(c):w}function remainingWait(c){var f=c-k,g=c-E,b=u-f;return $?j(b,x-g):b}function shouldInvoke(c){var f=c-k,g=c-E;return void 0===k||f>=u||f<0||$&&g>=x}function timerExpired(){var c=now();if(shouldInvoke(c))return trailingEdge(c);_=setTimeout(timerExpired,remainingWait(c))}function trailingEdge(c){return(_=void 0,I&&b)?invokeFunc(c):(b=v=void 0,w)}function cancel(){void 0!==_&&clearTimeout(_),E=0,b=k=v=_=void 0}function flush(){return void 0===_?w:trailingEdge(now())}function debounced(){var c=now(),f=shouldInvoke(c);if(b=arguments,v=this,k=c,f){if(void 0===_)return leadingEdge(k);if($)return _=setTimeout(timerExpired,u),invokeFunc(k)}return void 0===_&&(_=setTimeout(timerExpired,u)),w}return u=toNumber(u)||0,isObject(f)&&(T=!!f.leading,x=($="maxWait"in f)?M(toNumber(f.maxWait)||0,u):x,I="trailing"in f?!!f.trailing:I),debounced.cancel=cancel,debounced.flush=flush,debounced}function throttle(c,u,f){var b=!0,v=!0;if("function"!=typeof c)throw TypeError(g);return isObject(f)&&(b="leading"in f?!!f.leading:b,v="trailing"in f?!!f.trailing:v),debounce(c,u,{leading:b,maxWait:u,trailing:v})}function isObject(c){var u=typeof c;return!!c&&("object"==u||"function"==u)}function isObjectLike(c){return!!c&&"object"==typeof c}function isSymbol(c){return"symbol"==typeof c||isObjectLike(c)&&"[object Symbol]"==I.call(c)}function toNumber(c){if("number"==typeof c)return c;if(isSymbol(c))return b;if(isObject(c)){var u="function"==typeof c.valueOf?c.valueOf():c;c=isObject(u)?u+"":u}if("string"!=typeof c)return 0===c?c:+c;c=c.replace(v,"");var f=w.test(c);return f||_.test(c)?k(c.slice(2),f?2:8):x.test(c)?b:+c}c.exports=throttle},50528:function(c,u,f){var g,b="__lodash_hash_undefined__",v=/^\[object .+?Constructor\]$/,x="object"==typeof f.g&&f.g&&f.g.Object===Object&&f.g,w="object"==typeof self&&self&&self.Object===Object&&self,_=x||w||Function("return this")();function arrayIncludes(c,u){return!!(c?c.length:0)&&baseIndexOf(c,u,0)>-1}function arrayIncludesWith(c,u,f){for(var g=-1,b=c?c.length:0;++g<b;)if(f(u,c[g]))return!0;return!1}function baseFindIndex(c,u,f,g){for(var b=c.length,v=f+(g?1:-1);g?v--:++v<b;)if(u(c[v],v,c))return v;return -1}function baseIndexOf(c,u,f){if(u!=u)return baseFindIndex(c,baseIsNaN,f);for(var g=f-1,b=c.length;++g<b;)if(c[g]===u)return g;return -1}function baseIsNaN(c){return c!=c}function cacheHas(c,u){return c.has(u)}function getValue(c,u){return null==c?void 0:c[u]}function isHostObject(c){var u=!1;if(null!=c&&"function"!=typeof c.toString)try{u=!!(c+"")}catch(c){}return u}function setToArray(c){var u=-1,f=Array(c.size);return c.forEach(function(c){f[++u]=c}),f}var k=Array.prototype,E=Function.prototype,T=Object.prototype,$=_["__core-js_shared__"],I=(g=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",M=E.toString,j=T.hasOwnProperty,D=T.toString,L=RegExp("^"+M.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=k.splice,B=getNative(_,"Map"),G=getNative(_,"Set"),U=getNative(Object,"create");function Hash(c){var u=-1,f=c?c.length:0;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function hashClear(){this.__data__=U?U(null):{}}function hashDelete(c){return this.has(c)&&delete this.__data__[c]}function hashGet(c){var u=this.__data__;if(U){var f=u[c];return f===b?void 0:f}return j.call(u,c)?u[c]:void 0}function hashHas(c){var u=this.__data__;return U?void 0!==u[c]:j.call(u,c)}function hashSet(c,u){return this.__data__[c]=U&&void 0===u?b:u,this}function ListCache(c){var u=-1,f=c?c.length:0;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(c){var u=this.__data__,f=assocIndexOf(u,c);return!(f<0)&&(f==u.length-1?u.pop():F.call(u,f,1),!0)}function listCacheGet(c){var u=this.__data__,f=assocIndexOf(u,c);return f<0?void 0:u[f][1]}function listCacheHas(c){return assocIndexOf(this.__data__,c)>-1}function listCacheSet(c,u){var f=this.__data__,g=assocIndexOf(f,c);return g<0?f.push([c,u]):f[g][1]=u,this}function MapCache(c){var u=-1,f=c?c.length:0;for(this.clear();++u<f;){var g=c[u];this.set(g[0],g[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(B||ListCache),string:new Hash}}function mapCacheDelete(c){return getMapData(this,c).delete(c)}function mapCacheGet(c){return getMapData(this,c).get(c)}function mapCacheHas(c){return getMapData(this,c).has(c)}function mapCacheSet(c,u){return getMapData(this,c).set(c,u),this}function SetCache(c){var u=-1,f=c?c.length:0;for(this.__data__=new MapCache;++u<f;)this.add(c[u])}function setCacheAdd(c){return this.__data__.set(c,b),this}function setCacheHas(c){return this.__data__.has(c)}function assocIndexOf(c,u){for(var f=c.length;f--;)if(eq(c[f][0],u))return f;return -1}function baseIsNative(c){return!(!isObject(c)||isMasked(c))&&(isFunction(c)||isHostObject(c)?L:v).test(toSource(c))}function baseUniq(c,u,f){var g=-1,b=arrayIncludes,v=c.length,x=!0,w=[],_=w;if(f)x=!1,b=arrayIncludesWith;else if(v>=200){var k=u?null:V(c);if(k)return setToArray(k);x=!1,b=cacheHas,_=new SetCache}else _=u?[]:w;e:for(;++g<v;){var E=c[g],T=u?u(E):E;if(E=f||0!==E?E:0,x&&T==T){for(var $=_.length;$--;)if(_[$]===T)continue e;u&&_.push(T),w.push(E)}else b(_,T,f)||(_!==w&&_.push(T),w.push(E))}return w}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var V=G&&1/setToArray(new G([,-0]))[1]==1/0?function(c){return new G(c)}:noop;function getMapData(c,u){var f=c.__data__;return isKeyable(u)?f["string"==typeof u?"string":"hash"]:f.map}function getNative(c,u){var f=getValue(c,u);return baseIsNative(f)?f:void 0}function isKeyable(c){var u=typeof c;return"string"==u||"number"==u||"symbol"==u||"boolean"==u?"__proto__"!==c:null===c}function isMasked(c){return!!I&&I in c}function toSource(c){if(null!=c){try{return M.call(c)}catch(c){}try{return c+""}catch(c){}}return""}function uniq(c){return c&&c.length?baseUniq(c):[]}function eq(c,u){return c===u||c!=c&&u!=u}function isFunction(c){var u=isObject(c)?D.call(c):"";return"[object Function]"==u||"[object GeneratorFunction]"==u}function isObject(c){var u=typeof c;return!!c&&("object"==u||"function"==u)}function noop(){}c.exports=uniq},80352:function(c,u,f){var g,b=function(){var c=String.fromCharCode,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",g={};function getBaseValue(c,u){if(!g[c]){g[c]={};for(var f=0;f<c.length;f++)g[c][c.charAt(f)]=f}return g[c][u]}var b={compressToBase64:function(c){if(null==c)return"";var f=b._compress(c,6,function(c){return u.charAt(c)});switch(f.length%4){default:case 0:return f;case 1:return f+"===";case 2:return f+"==";case 3:return f+"="}},decompressFromBase64:function(c){return null==c?"":""==c?null:b._decompress(c.length,32,function(f){return getBaseValue(u,c.charAt(f))})},compressToUTF16:function(u){return null==u?"":b._compress(u,15,function(u){return c(u+32)})+" "},decompressFromUTF16:function(c){return null==c?"":""==c?null:b._decompress(c.length,16384,function(u){return c.charCodeAt(u)-32})},compressToUint8Array:function(c){for(var u=b.compress(c),f=new Uint8Array(2*u.length),g=0,v=u.length;g<v;g++){var x=u.charCodeAt(g);f[2*g]=x>>>8,f[2*g+1]=x%256}return f},decompressFromUint8Array:function(u){if(null==u)return b.decompress(u);for(var f=Array(u.length/2),g=0,v=f.length;g<v;g++)f[g]=256*u[2*g]+u[2*g+1];var x=[];return f.forEach(function(u){x.push(c(u))}),b.decompress(x.join(""))},compressToEncodedURIComponent:function(c){return null==c?"":b._compress(c,6,function(c){return f.charAt(c)})},decompressFromEncodedURIComponent:function(c){return null==c?"":""==c?null:(c=c.replace(/ /g,"+"),b._decompress(c.length,32,function(u){return getBaseValue(f,c.charAt(u))}))},compress:function(u){return b._compress(u,16,function(u){return c(u)})},_compress:function(c,u,f){if(null==c)return"";var g,b,v,x={},w={},_="",k="",E="",T=2,$=3,I=2,M=[],j=0,D=0;for(v=0;v<c.length;v+=1)if(_=c.charAt(v),Object.prototype.hasOwnProperty.call(x,_)||(x[_]=$++,w[_]=!0),k=E+_,Object.prototype.hasOwnProperty.call(x,k))E=k;else{if(Object.prototype.hasOwnProperty.call(w,E)){if(256>E.charCodeAt(0)){for(g=0;g<I;g++)j<<=1,D==u-1?(D=0,M.push(f(j)),j=0):D++;for(g=0,b=E.charCodeAt(0);g<8;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1}else{for(g=0,b=1;g<I;g++)j=j<<1|b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b=0;for(g=0,b=E.charCodeAt(0);g<16;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1}0==--T&&(T=Math.pow(2,I),I++),delete w[E]}else for(g=0,b=x[E];g<I;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1;0==--T&&(T=Math.pow(2,I),I++),x[k]=$++,E=String(_)}if(""!==E){if(Object.prototype.hasOwnProperty.call(w,E)){if(256>E.charCodeAt(0)){for(g=0;g<I;g++)j<<=1,D==u-1?(D=0,M.push(f(j)),j=0):D++;for(g=0,b=E.charCodeAt(0);g<8;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1}else{for(g=0,b=1;g<I;g++)j=j<<1|b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b=0;for(g=0,b=E.charCodeAt(0);g<16;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1}0==--T&&(T=Math.pow(2,I),I++),delete w[E]}else for(g=0,b=x[E];g<I;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1;0==--T&&(T=Math.pow(2,I),I++)}for(g=0,b=2;g<I;g++)j=j<<1|1&b,D==u-1?(D=0,M.push(f(j)),j=0):D++,b>>=1;for(;;){if(j<<=1,D==u-1){M.push(f(j));break}D++}return M.join("")},decompress:function(c){return null==c?"":""==c?null:b._decompress(c.length,32768,function(u){return c.charCodeAt(u)})},_decompress:function(u,f,g){var b,v,x,w,_,k,E,T=[],$=4,I=4,M=3,j="",D=[],L={val:g(0),position:f,index:1};for(b=0;b<3;b+=1)T[b]=b;for(x=0,_=4,k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;switch(x){case 0:for(x=0,_=256,k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;E=c(x);break;case 1:for(x=0,_=65536,k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;E=c(x);break;case 2:return""}for(T[3]=E,v=E,D.push(E);;){if(L.index>u)return"";for(x=0,_=Math.pow(2,M),k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;switch(E=x){case 0:for(x=0,_=256,k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;T[I++]=c(x),E=I-1,$--;break;case 1:for(x=0,_=65536,k=1;k!=_;)w=L.val&L.position,L.position>>=1,0==L.position&&(L.position=f,L.val=g(L.index++)),x|=(w>0?1:0)*k,k<<=1;T[I++]=c(x),E=I-1,$--;break;case 2:return D.join("")}if(0==$&&($=Math.pow(2,M),M++),T[E])j=T[E];else{if(E!==I)return null;j=v+v.charAt(0)}D.push(j),T[I++]=v+j.charAt(0),$--,v=j,0==$&&($=Math.pow(2,M),M++)}}};return b}();void 0!==(g=(function(){return b}).call(u,f,u,c))&&(c.exports=g)},62601:function(c,u,f){"use strict";var g,b;c.exports=(null==(g=f.g.process)?void 0:g.env)&&"object"==typeof(null==(b=f.g.process)?void 0:b.env)?f.g.process:f(58960)},28811:function(c,u,f){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(u,"default",{enumerable:!0,get:function(){return dynamic}});let g=f(21024);f(2265);let b=g._(f(57075));function convertModule(c){return{default:(null==c?void 0:c.default)||c}}function dynamic(c,u){let f=b.default,g={loading:c=>{let{error:u,isLoading:f,pastDelay:g}=c;return null}};"function"==typeof c&&(g.loader=c),Object.assign(g,u);let v=g.loader;return f({...g,loader:()=>null!=v?v().then(convertModule):Promise.resolve(convertModule(()=>null))})}("function"==typeof u.default||"object"==typeof u.default&&null!==u.default)&&void 0===u.default.__esModule&&(Object.defineProperty(u.default,"__esModule",{value:!0}),Object.assign(u.default,u),c.exports=u.default)},19167:function(c,u,f){"use strict";function NoSSR(c){let{children:u}=c;return u}Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(u,"NoSSR",{enumerable:!0,get:function(){return NoSSR}}),f(11283)},57075:function(c,u,f){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(u,"default",{enumerable:!0,get:function(){return x}});let g=f(21024),b=g._(f(2265)),v=f(19167);function Loadable(c){let u=Object.assign({loader:null,loading:null,ssr:!0},c);function LoadableComponent(c){let f=u.loading,g=b.default.createElement(f,{isLoading:!0,pastDelay:!0,error:null}),x=u.ssr?b.default.Fragment:v.NoSSR,w=u.lazy;return b.default.createElement(b.default.Suspense,{fallback:g},b.default.createElement(x,null,b.default.createElement(w,c)))}return u.lazy=b.default.lazy(u.loader),LoadableComponent.displayName="LoadableComponent",LoadableComponent}let x=Loadable},81364:function(){},40263:function(c){!function(){var u={675:function(c,u){"use strict";u.byteLength=byteLength,u.toByteArray=toByteArray,u.fromByteArray=fromByteArray;for(var f=[],g=[],b="undefined"!=typeof Uint8Array?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=0,w=v.length;x<w;++x)f[x]=v[x],g[v.charCodeAt(x)]=x;function getLens(c){var u=c.length;if(u%4>0)throw Error("Invalid string. Length must be a multiple of 4");var f=c.indexOf("=");-1===f&&(f=u);var g=f===u?0:4-f%4;return[f,g]}function byteLength(c){var u=getLens(c),f=u[0],g=u[1];return(f+g)*3/4-g}function _byteLength(c,u,f){return(u+f)*3/4-f}function toByteArray(c){var u,f,v=getLens(c),x=v[0],w=v[1],_=new b(_byteLength(c,x,w)),k=0,E=w>0?x-4:x;for(f=0;f<E;f+=4)u=g[c.charCodeAt(f)]<<18|g[c.charCodeAt(f+1)]<<12|g[c.charCodeAt(f+2)]<<6|g[c.charCodeAt(f+3)],_[k++]=u>>16&255,_[k++]=u>>8&255,_[k++]=255&u;return 2===w&&(u=g[c.charCodeAt(f)]<<2|g[c.charCodeAt(f+1)]>>4,_[k++]=255&u),1===w&&(u=g[c.charCodeAt(f)]<<10|g[c.charCodeAt(f+1)]<<4|g[c.charCodeAt(f+2)]>>2,_[k++]=u>>8&255,_[k++]=255&u),_}function tripletToBase64(c){return f[c>>18&63]+f[c>>12&63]+f[c>>6&63]+f[63&c]}function encodeChunk(c,u,f){for(var g=[],b=u;b<f;b+=3)g.push(tripletToBase64((c[b]<<16&16711680)+(c[b+1]<<8&65280)+(255&c[b+2])));return g.join("")}function fromByteArray(c){for(var u,g=c.length,b=g%3,v=[],x=0,w=g-b;x<w;x+=16383)v.push(encodeChunk(c,x,x+16383>w?w:x+16383));return 1===b?v.push(f[(u=c[g-1])>>2]+f[u<<4&63]+"=="):2===b&&v.push(f[(u=(c[g-2]<<8)+c[g-1])>>10]+f[u>>4&63]+f[u<<2&63]+"="),v.join("")}g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63},72:function(c,u,f){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var g=f(675),b=f(783),v="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function typedArraySupport(){try{var c=new Uint8Array(1),u={foo:function(){return 42}};return Object.setPrototypeOf(u,Uint8Array.prototype),Object.setPrototypeOf(c,u),42===c.foo()}catch(c){return!1}}function createBuffer(c){if(c>2147483647)throw RangeError('The value "'+c+'" is invalid for option "size"');var u=new Uint8Array(c);return Object.setPrototypeOf(u,Buffer.prototype),u}function Buffer(c,u,f){if("number"==typeof c){if("string"==typeof u)throw TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(c)}return from(c,u,f)}function from(c,u,f){if("string"==typeof c)return fromString(c,u);if(ArrayBuffer.isView(c))return fromArrayLike(c);if(null==c)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(isInstance(c,ArrayBuffer)||c&&isInstance(c.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(isInstance(c,SharedArrayBuffer)||c&&isInstance(c.buffer,SharedArrayBuffer)))return fromArrayBuffer(c,u,f);if("number"==typeof c)throw TypeError('The "value" argument must not be of type number. Received type number');var g=c.valueOf&&c.valueOf();if(null!=g&&g!==c)return Buffer.from(g,u,f);var b=fromObject(c);if(b)return b;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof c[Symbol.toPrimitive])return Buffer.from(c[Symbol.toPrimitive]("string"),u,f);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}function assertSize(c){if("number"!=typeof c)throw TypeError('"size" argument must be of type number');if(c<0)throw RangeError('The value "'+c+'" is invalid for option "size"')}function alloc(c,u,f){return(assertSize(c),c<=0)?createBuffer(c):void 0!==u?"string"==typeof f?createBuffer(c).fill(u,f):createBuffer(c).fill(u):createBuffer(c)}function allocUnsafe(c){return assertSize(c),createBuffer(c<0?0:0|checked(c))}function fromString(c,u){if(("string"!=typeof u||""===u)&&(u="utf8"),!Buffer.isEncoding(u))throw TypeError("Unknown encoding: "+u);var f=0|byteLength(c,u),g=createBuffer(f),b=g.write(c,u);return b!==f&&(g=g.slice(0,b)),g}function fromArrayLike(c){for(var u=c.length<0?0:0|checked(c.length),f=createBuffer(u),g=0;g<u;g+=1)f[g]=255&c[g];return f}function fromArrayBuffer(c,u,f){var g;if(u<0||c.byteLength<u)throw RangeError('"offset" is outside of buffer bounds');if(c.byteLength<u+(f||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(g=void 0===u&&void 0===f?new Uint8Array(c):void 0===f?new Uint8Array(c,u):new Uint8Array(c,u,f),Buffer.prototype),g}function fromObject(c){if(Buffer.isBuffer(c)){var u,f=0|checked(c.length),g=createBuffer(f);return 0===g.length||c.copy(g,0,0,f),g}return void 0!==c.length?"number"!=typeof c.length||(u=c.length)!=u?createBuffer(0):fromArrayLike(c):"Buffer"===c.type&&Array.isArray(c.data)?fromArrayLike(c.data):void 0}function checked(c){if(c>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|c}function SlowBuffer(c){return+c!=c&&(c=0),Buffer.alloc(+c)}function byteLength(c,u){if(Buffer.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||isInstance(c,ArrayBuffer))return c.byteLength;if("string"!=typeof c)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);var f=c.length,g=arguments.length>2&&!0===arguments[2];if(!g&&0===f)return 0;for(var b=!1;;)switch(u){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return utf8ToBytes(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*f;case"hex":return f>>>1;case"base64":return base64ToBytes(c).length;default:if(b)return g?-1:utf8ToBytes(c).length;u=(""+u).toLowerCase(),b=!0}}function slowToString(c,u,f){var g=!1;if((void 0===u||u<0)&&(u=0),u>this.length||((void 0===f||f>this.length)&&(f=this.length),f<=0||(f>>>=0)<=(u>>>=0)))return"";for(c||(c="utf8");;)switch(c){case"hex":return hexSlice(this,u,f);case"utf8":case"utf-8":return utf8Slice(this,u,f);case"ascii":return asciiSlice(this,u,f);case"latin1":case"binary":return latin1Slice(this,u,f);case"base64":return base64Slice(this,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,u,f);default:if(g)throw TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),g=!0}}function swap(c,u,f){var g=c[u];c[u]=c[f],c[f]=g}function bidirectionalIndexOf(c,u,f,g,b){var v;if(0===c.length)return -1;if("string"==typeof f?(g=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),(v=f=+f)!=v&&(f=b?0:c.length-1),f<0&&(f=c.length+f),f>=c.length){if(b)return -1;f=c.length-1}else if(f<0){if(!b)return -1;f=0}if("string"==typeof u&&(u=Buffer.from(u,g)),Buffer.isBuffer(u))return 0===u.length?-1:arrayIndexOf(c,u,f,g,b);if("number"==typeof u)return(u&=255,"function"==typeof Uint8Array.prototype.indexOf)?b?Uint8Array.prototype.indexOf.call(c,u,f):Uint8Array.prototype.lastIndexOf.call(c,u,f):arrayIndexOf(c,[u],f,g,b);throw TypeError("val must be string, number or Buffer")}function arrayIndexOf(c,u,f,g,b){var v,x=1,w=c.length,_=u.length;if(void 0!==g&&("ucs2"===(g=String(g).toLowerCase())||"ucs-2"===g||"utf16le"===g||"utf-16le"===g)){if(c.length<2||u.length<2)return -1;x=2,w/=2,_/=2,f/=2}function read(c,u){return 1===x?c[u]:c.readUInt16BE(u*x)}if(b){var k=-1;for(v=f;v<w;v++)if(read(c,v)===read(u,-1===k?0:v-k)){if(-1===k&&(k=v),v-k+1===_)return k*x}else -1!==k&&(v-=v-k),k=-1}else for(f+_>w&&(f=w-_),v=f;v>=0;v--){for(var E=!0,T=0;T<_;T++)if(read(c,v+T)!==read(u,T)){E=!1;break}if(E)return v}return -1}function hexWrite(c,u,f,g){f=Number(f)||0;var b=c.length-f;g?(g=Number(g))>b&&(g=b):g=b;var v=u.length;g>v/2&&(g=v/2);for(var x=0;x<g;++x){var w=parseInt(u.substr(2*x,2),16);if(w!=w)break;c[f+x]=w}return x}function utf8Write(c,u,f,g){return blitBuffer(utf8ToBytes(u,c.length-f),c,f,g)}function latin1Write(c,u,f,g){return blitBuffer(asciiToBytes(u),c,f,g)}function base64Write(c,u,f,g){return blitBuffer(base64ToBytes(u),c,f,g)}function ucs2Write(c,u,f,g){return blitBuffer(utf16leToBytes(u,c.length-f),c,f,g)}function base64Slice(c,u,f){return 0===u&&f===c.length?g.fromByteArray(c):g.fromByteArray(c.slice(u,f))}function utf8Slice(c,u,f){f=Math.min(c.length,f);for(var g=[],b=u;b<f;){var v,x,w,_,k=c[b],E=null,T=k>239?4:k>223?3:k>191?2:1;if(b+T<=f)switch(T){case 1:k<128&&(E=k);break;case 2:(192&(v=c[b+1]))==128&&(_=(31&k)<<6|63&v)>127&&(E=_);break;case 3:v=c[b+1],x=c[b+2],(192&v)==128&&(192&x)==128&&(_=(15&k)<<12|(63&v)<<6|63&x)>2047&&(_<55296||_>57343)&&(E=_);break;case 4:v=c[b+1],x=c[b+2],w=c[b+3],(192&v)==128&&(192&x)==128&&(192&w)==128&&(_=(15&k)<<18|(63&v)<<12|(63&x)<<6|63&w)>65535&&_<1114112&&(E=_)}null===E?(E=65533,T=1):E>65535&&(E-=65536,g.push(E>>>10&1023|55296),E=56320|1023&E),g.push(E),b+=T}return decodeCodePointsArray(g)}function decodeCodePointsArray(c){var u=c.length;if(u<=4096)return String.fromCharCode.apply(String,c);for(var f="",g=0;g<u;)f+=String.fromCharCode.apply(String,c.slice(g,g+=4096));return f}function asciiSlice(c,u,f){var g="";f=Math.min(c.length,f);for(var b=u;b<f;++b)g+=String.fromCharCode(127&c[b]);return g}function latin1Slice(c,u,f){var g="";f=Math.min(c.length,f);for(var b=u;b<f;++b)g+=String.fromCharCode(c[b]);return g}function hexSlice(c,u,f){var g=c.length;(!u||u<0)&&(u=0),(!f||f<0||f>g)&&(f=g);for(var b="",v=u;v<f;++v)b+=w[c[v]];return b}function utf16leSlice(c,u,f){for(var g=c.slice(u,f),b="",v=0;v<g.length;v+=2)b+=String.fromCharCode(g[v]+256*g[v+1]);return b}function checkOffset(c,u,f){if(c%1!=0||c<0)throw RangeError("offset is not uint");if(c+u>f)throw RangeError("Trying to access beyond buffer length")}function checkInt(c,u,f,g,b,v){if(!Buffer.isBuffer(c))throw TypeError('"buffer" argument must be a Buffer instance');if(u>b||u<v)throw RangeError('"value" argument is out of bounds');if(f+g>c.length)throw RangeError("Index out of range")}function checkIEEE754(c,u,f,g,b,v){if(f+g>c.length||f<0)throw RangeError("Index out of range")}function writeFloat(c,u,f,g,v){return u=+u,f>>>=0,v||checkIEEE754(c,u,f,4,34028234663852886e22,-34028234663852886e22),b.write(c,u,f,g,23,4),f+4}function writeDouble(c,u,f,g,v){return u=+u,f>>>=0,v||checkIEEE754(c,u,f,8,17976931348623157e292,-17976931348623157e292),b.write(c,u,f,g,52,8),f+8}u.Buffer=Buffer,u.SlowBuffer=SlowBuffer,u.INSPECT_MAX_BYTES=50,u.kMaxLength=2147483647,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(c,u,f){return from(c,u,f)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(c,u,f){return alloc(c,u,f)},Buffer.allocUnsafe=function(c){return allocUnsafe(c)},Buffer.allocUnsafeSlow=function(c){return allocUnsafe(c)},Buffer.isBuffer=function(c){return null!=c&&!0===c._isBuffer&&c!==Buffer.prototype},Buffer.compare=function(c,u){if(isInstance(c,Uint8Array)&&(c=Buffer.from(c,c.offset,c.byteLength)),isInstance(u,Uint8Array)&&(u=Buffer.from(u,u.offset,u.byteLength)),!Buffer.isBuffer(c)||!Buffer.isBuffer(u))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;for(var f=c.length,g=u.length,b=0,v=Math.min(f,g);b<v;++b)if(c[b]!==u[b]){f=c[b],g=u[b];break}return f<g?-1:g<f?1:0},Buffer.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(c,u){if(!Array.isArray(c))throw TypeError('"list" argument must be an Array of Buffers');if(0===c.length)return Buffer.alloc(0);if(void 0===u)for(f=0,u=0;f<c.length;++f)u+=c[f].length;var f,g=Buffer.allocUnsafe(u),b=0;for(f=0;f<c.length;++f){var v=c[f];if(isInstance(v,Uint8Array)&&(v=Buffer.from(v)),!Buffer.isBuffer(v))throw TypeError('"list" argument must be an Array of Buffers');v.copy(g,b),b+=v.length}return g},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var c=this.length;if(c%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<c;u+=2)swap(this,u,u+1);return this},Buffer.prototype.swap32=function(){var c=this.length;if(c%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<c;u+=4)swap(this,u,u+3),swap(this,u+1,u+2);return this},Buffer.prototype.swap64=function(){var c=this.length;if(c%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<c;u+=8)swap(this,u,u+7),swap(this,u+1,u+6),swap(this,u+2,u+5),swap(this,u+3,u+4);return this},Buffer.prototype.toString=function(){var c=this.length;return 0===c?"":0==arguments.length?utf8Slice(this,0,c):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(c){if(!Buffer.isBuffer(c))throw TypeError("Argument must be a Buffer");return this===c||0===Buffer.compare(this,c)},Buffer.prototype.inspect=function(){var c="",f=u.INSPECT_MAX_BYTES;return c=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(c+=" ... "),"<Buffer "+c+">"},v&&(Buffer.prototype[v]=Buffer.prototype.inspect),Buffer.prototype.compare=function(c,u,f,g,b){if(isInstance(c,Uint8Array)&&(c=Buffer.from(c,c.offset,c.byteLength)),!Buffer.isBuffer(c))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(void 0===u&&(u=0),void 0===f&&(f=c?c.length:0),void 0===g&&(g=0),void 0===b&&(b=this.length),u<0||f>c.length||g<0||b>this.length)throw RangeError("out of range index");if(g>=b&&u>=f)return 0;if(g>=b)return -1;if(u>=f)return 1;if(u>>>=0,f>>>=0,g>>>=0,b>>>=0,this===c)return 0;for(var v=b-g,x=f-u,w=Math.min(v,x),_=this.slice(g,b),k=c.slice(u,f),E=0;E<w;++E)if(_[E]!==k[E]){v=_[E],x=k[E];break}return v<x?-1:x<v?1:0},Buffer.prototype.includes=function(c,u,f){return -1!==this.indexOf(c,u,f)},Buffer.prototype.indexOf=function(c,u,f){return bidirectionalIndexOf(this,c,u,f,!0)},Buffer.prototype.lastIndexOf=function(c,u,f){return bidirectionalIndexOf(this,c,u,f,!1)},Buffer.prototype.write=function(c,u,f,g){if(void 0===u)g="utf8",f=this.length,u=0;else if(void 0===f&&"string"==typeof u)g=u,f=this.length,u=0;else if(isFinite(u))u>>>=0,isFinite(f)?(f>>>=0,void 0===g&&(g="utf8")):(g=f,f=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var b,v,x=this.length-u;if((void 0===f||f>x)&&(f=x),c.length>0&&(f<0||u<0)||u>this.length)throw RangeError("Attempt to write outside buffer bounds");g||(g="utf8");for(var w=!1;;)switch(g){case"hex":return hexWrite(this,c,u,f);case"utf8":case"utf-8":return utf8Write(this,c,u,f);case"ascii":return b=u,v=f,blitBuffer(asciiToBytes(c),this,b,v);case"latin1":case"binary":return latin1Write(this,c,u,f);case"base64":return base64Write(this,c,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,c,u,f);default:if(w)throw TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),w=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(c,u){var f=this.length;c=~~c,u=void 0===u?f:~~u,c<0?(c+=f)<0&&(c=0):c>f&&(c=f),u<0?(u+=f)<0&&(u=0):u>f&&(u=f),u<c&&(u=c);var g=this.subarray(c,u);return Object.setPrototypeOf(g,Buffer.prototype),g},Buffer.prototype.readUIntLE=function(c,u,f){c>>>=0,u>>>=0,f||checkOffset(c,u,this.length);for(var g=this[c],b=1,v=0;++v<u&&(b*=256);)g+=this[c+v]*b;return g},Buffer.prototype.readUIntBE=function(c,u,f){c>>>=0,u>>>=0,f||checkOffset(c,u,this.length);for(var g=this[c+--u],b=1;u>0&&(b*=256);)g+=this[c+--u]*b;return g},Buffer.prototype.readUInt8=function(c,u){return c>>>=0,u||checkOffset(c,1,this.length),this[c]},Buffer.prototype.readUInt16LE=function(c,u){return c>>>=0,u||checkOffset(c,2,this.length),this[c]|this[c+1]<<8},Buffer.prototype.readUInt16BE=function(c,u){return c>>>=0,u||checkOffset(c,2,this.length),this[c]<<8|this[c+1]},Buffer.prototype.readUInt32LE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]},Buffer.prototype.readUInt32BE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])},Buffer.prototype.readIntLE=function(c,u,f){c>>>=0,u>>>=0,f||checkOffset(c,u,this.length);for(var g=this[c],b=1,v=0;++v<u&&(b*=256);)g+=this[c+v]*b;return g>=(b*=128)&&(g-=Math.pow(2,8*u)),g},Buffer.prototype.readIntBE=function(c,u,f){c>>>=0,u>>>=0,f||checkOffset(c,u,this.length);for(var g=u,b=1,v=this[c+--g];g>0&&(b*=256);)v+=this[c+--g]*b;return v>=(b*=128)&&(v-=Math.pow(2,8*u)),v},Buffer.prototype.readInt8=function(c,u){return(c>>>=0,u||checkOffset(c,1,this.length),128&this[c])?-((255-this[c]+1)*1):this[c]},Buffer.prototype.readInt16LE=function(c,u){c>>>=0,u||checkOffset(c,2,this.length);var f=this[c]|this[c+1]<<8;return 32768&f?4294901760|f:f},Buffer.prototype.readInt16BE=function(c,u){c>>>=0,u||checkOffset(c,2,this.length);var f=this[c+1]|this[c]<<8;return 32768&f?4294901760|f:f},Buffer.prototype.readInt32LE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},Buffer.prototype.readInt32BE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},Buffer.prototype.readFloatLE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),b.read(this,c,!0,23,4)},Buffer.prototype.readFloatBE=function(c,u){return c>>>=0,u||checkOffset(c,4,this.length),b.read(this,c,!1,23,4)},Buffer.prototype.readDoubleLE=function(c,u){return c>>>=0,u||checkOffset(c,8,this.length),b.read(this,c,!0,52,8)},Buffer.prototype.readDoubleBE=function(c,u){return c>>>=0,u||checkOffset(c,8,this.length),b.read(this,c,!1,52,8)},Buffer.prototype.writeUIntLE=function(c,u,f,g){if(c=+c,u>>>=0,f>>>=0,!g){var b=Math.pow(2,8*f)-1;checkInt(this,c,u,f,b,0)}var v=1,x=0;for(this[u]=255&c;++x<f&&(v*=256);)this[u+x]=c/v&255;return u+f},Buffer.prototype.writeUIntBE=function(c,u,f,g){if(c=+c,u>>>=0,f>>>=0,!g){var b=Math.pow(2,8*f)-1;checkInt(this,c,u,f,b,0)}var v=f-1,x=1;for(this[u+v]=255&c;--v>=0&&(x*=256);)this[u+v]=c/x&255;return u+f},Buffer.prototype.writeUInt8=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,1,255,0),this[u]=255&c,u+1},Buffer.prototype.writeUInt16LE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,2,65535,0),this[u]=255&c,this[u+1]=c>>>8,u+2},Buffer.prototype.writeUInt16BE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=255&c,u+2},Buffer.prototype.writeUInt32LE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=255&c,u+4},Buffer.prototype.writeUInt32BE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=255&c,u+4},Buffer.prototype.writeIntLE=function(c,u,f,g){if(c=+c,u>>>=0,!g){var b=Math.pow(2,8*f-1);checkInt(this,c,u,f,b-1,-b)}var v=0,x=1,w=0;for(this[u]=255&c;++v<f&&(x*=256);)c<0&&0===w&&0!==this[u+v-1]&&(w=1),this[u+v]=(c/x>>0)-w&255;return u+f},Buffer.prototype.writeIntBE=function(c,u,f,g){if(c=+c,u>>>=0,!g){var b=Math.pow(2,8*f-1);checkInt(this,c,u,f,b-1,-b)}var v=f-1,x=1,w=0;for(this[u+v]=255&c;--v>=0&&(x*=256);)c<0&&0===w&&0!==this[u+v+1]&&(w=1),this[u+v]=(c/x>>0)-w&255;return u+f},Buffer.prototype.writeInt8=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=255&c,u+1},Buffer.prototype.writeInt16LE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,2,32767,-32768),this[u]=255&c,this[u+1]=c>>>8,u+2},Buffer.prototype.writeInt16BE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=255&c,u+2},Buffer.prototype.writeInt32LE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,4,2147483647,-2147483648),this[u]=255&c,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},Buffer.prototype.writeInt32BE=function(c,u,f){return c=+c,u>>>=0,f||checkInt(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=255&c,u+4},Buffer.prototype.writeFloatLE=function(c,u,f){return writeFloat(this,c,u,!0,f)},Buffer.prototype.writeFloatBE=function(c,u,f){return writeFloat(this,c,u,!1,f)},Buffer.prototype.writeDoubleLE=function(c,u,f){return writeDouble(this,c,u,!0,f)},Buffer.prototype.writeDoubleBE=function(c,u,f){return writeDouble(this,c,u,!1,f)},Buffer.prototype.copy=function(c,u,f,g){if(!Buffer.isBuffer(c))throw TypeError("argument should be a Buffer");if(f||(f=0),g||0===g||(g=this.length),u>=c.length&&(u=c.length),u||(u=0),g>0&&g<f&&(g=f),g===f||0===c.length||0===this.length)return 0;if(u<0)throw RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw RangeError("Index out of range");if(g<0)throw RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),c.length-u<g-f&&(g=c.length-u+f);var b=g-f;if(this===c&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(u,f,g);else if(this===c&&f<u&&u<g)for(var v=b-1;v>=0;--v)c[v+u]=this[v+f];else Uint8Array.prototype.set.call(c,this.subarray(f,g),u);return b},Buffer.prototype.fill=function(c,u,f,g){if("string"==typeof c){if("string"==typeof u?(g=u,u=0,f=this.length):"string"==typeof f&&(g=f,f=this.length),void 0!==g&&"string"!=typeof g)throw TypeError("encoding must be a string");if("string"==typeof g&&!Buffer.isEncoding(g))throw TypeError("Unknown encoding: "+g);if(1===c.length){var b,v=c.charCodeAt(0);("utf8"===g&&v<128||"latin1"===g)&&(c=v)}}else"number"==typeof c?c&=255:"boolean"==typeof c&&(c=Number(c));if(u<0||this.length<u||this.length<f)throw RangeError("Out of range index");if(f<=u)return this;if(u>>>=0,f=void 0===f?this.length:f>>>0,c||(c=0),"number"==typeof c)for(b=u;b<f;++b)this[b]=c;else{var x=Buffer.isBuffer(c)?c:Buffer.from(c,g),w=x.length;if(0===w)throw TypeError('The value "'+c+'" is invalid for argument "value"');for(b=0;b<f-u;++b)this[b+u]=x[b%w]}return this};var x=/[^+/0-9A-Za-z-_]/g;function base64clean(c){if((c=(c=c.split("=")[0]).trim().replace(x,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}function utf8ToBytes(c,u){u=u||1/0;for(var f,g=c.length,b=null,v=[],x=0;x<g;++x){if((f=c.charCodeAt(x))>55295&&f<57344){if(!b){if(f>56319||x+1===g){(u-=3)>-1&&v.push(239,191,189);continue}b=f;continue}if(f<56320){(u-=3)>-1&&v.push(239,191,189),b=f;continue}f=(b-55296<<10|f-56320)+65536}else b&&(u-=3)>-1&&v.push(239,191,189);if(b=null,f<128){if((u-=1)<0)break;v.push(f)}else if(f<2048){if((u-=2)<0)break;v.push(f>>6|192,63&f|128)}else if(f<65536){if((u-=3)<0)break;v.push(f>>12|224,f>>6&63|128,63&f|128)}else if(f<1114112){if((u-=4)<0)break;v.push(f>>18|240,f>>12&63|128,f>>6&63|128,63&f|128)}else throw Error("Invalid code point")}return v}function asciiToBytes(c){for(var u=[],f=0;f<c.length;++f)u.push(255&c.charCodeAt(f));return u}function utf16leToBytes(c,u){for(var f,g,b=[],v=0;v<c.length&&!((u-=2)<0);++v)g=(f=c.charCodeAt(v))>>8,b.push(f%256),b.push(g);return b}function base64ToBytes(c){return g.toByteArray(base64clean(c))}function blitBuffer(c,u,f,g){for(var b=0;b<g&&!(b+f>=u.length)&&!(b>=c.length);++b)u[b+f]=c[b];return b}function isInstance(c,u){return c instanceof u||null!=c&&null!=c.constructor&&null!=c.constructor.name&&c.constructor.name===u.name}var w=function(){for(var c="0123456789abcdef",u=Array(256),f=0;f<16;++f)for(var g=16*f,b=0;b<16;++b)u[g+b]=c[f]+c[b];return u}()},783:function(c,u){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */u.read=function(c,u,f,g,b){var v,x,w=8*b-g-1,_=(1<<w)-1,k=_>>1,E=-7,T=f?b-1:0,$=f?-1:1,I=c[u+T];for(T+=$,v=I&(1<<-E)-1,I>>=-E,E+=w;E>0;v=256*v+c[u+T],T+=$,E-=8);for(x=v&(1<<-E)-1,v>>=-E,E+=g;E>0;x=256*x+c[u+T],T+=$,E-=8);if(0===v)v=1-k;else{if(v===_)return x?NaN:(I?-1:1)*(1/0);x+=Math.pow(2,g),v-=k}return(I?-1:1)*x*Math.pow(2,v-g)},u.write=function(c,u,f,g,b,v){var x,w,_,k=8*v-b-1,E=(1<<k)-1,T=E>>1,$=23===b?5960464477539062e-23:0,I=g?0:v-1,M=g?1:-1,j=u<0||0===u&&1/u<0?1:0;for(isNaN(u=Math.abs(u))||u===1/0?(w=isNaN(u)?1:0,x=E):(x=Math.floor(Math.log(u)/Math.LN2),u*(_=Math.pow(2,-x))<1&&(x--,_*=2),x+T>=1?u+=$/_:u+=$*Math.pow(2,1-T),u*_>=2&&(x++,_/=2),x+T>=E?(w=0,x=E):x+T>=1?(w=(u*_-1)*Math.pow(2,b),x+=T):(w=u*Math.pow(2,T-1)*Math.pow(2,b),x=0));b>=8;c[f+I]=255&w,I+=M,w/=256,b-=8);for(x=x<<b|w,k+=b;k>0;c[f+I]=255&x,I+=M,x/=256,k-=8);c[f+I-M]|=128*j}}},f={};function __nccwpck_require__(c){var g=f[c];if(void 0!==g)return g.exports;var b=f[c]={exports:{}},v=!0;try{u[c](b,b.exports,__nccwpck_require__),v=!1}finally{v&&delete f[c]}return b.exports}__nccwpck_require__.ab="//";var g=__nccwpck_require__(72);c.exports=g}()},58960:function(c){!function(){var u={229:function(c){var u,f,g,b=c.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(c){if(u===setTimeout)return setTimeout(c,0);if((u===defaultSetTimout||!u)&&setTimeout)return u=setTimeout,setTimeout(c,0);try{return u(c,0)}catch(f){try{return u.call(null,c,0)}catch(f){return u.call(this,c,0)}}}function runClearTimeout(c){if(f===clearTimeout)return clearTimeout(c);if((f===defaultClearTimeout||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(c);try{return f(c)}catch(u){try{return f.call(null,c)}catch(u){return f.call(this,c)}}}!function(){try{u="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(c){u=defaultSetTimout}try{f="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(c){f=defaultClearTimeout}}();var v=[],x=!1,w=-1;function cleanUpNextTick(){x&&g&&(x=!1,g.length?v=g.concat(v):w=-1,v.length&&drainQueue())}function drainQueue(){if(!x){var c=runTimeout(cleanUpNextTick);x=!0;for(var u=v.length;u;){for(g=v,v=[];++w<u;)g&&g[w].run();w=-1,u=v.length}g=null,x=!1,runClearTimeout(c)}}function Item(c,u){this.fun=c,this.array=u}function noop(){}b.nextTick=function(c){var u=Array(arguments.length-1);if(arguments.length>1)for(var f=1;f<arguments.length;f++)u[f-1]=arguments[f];v.push(new Item(c,u)),1!==v.length||x||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={},b.on=noop,b.addListener=noop,b.once=noop,b.off=noop,b.removeListener=noop,b.removeAllListeners=noop,b.emit=noop,b.prependListener=noop,b.prependOnceListener=noop,b.listeners=function(c){return[]},b.binding=function(c){throw Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(c){throw Error("process.chdir is not supported")},b.umask=function(){return 0}}},f={};function __nccwpck_require__(c){var g=f[c];if(void 0!==g)return g.exports;var b=f[c]={exports:{}},v=!0;try{u[c](b,b.exports,__nccwpck_require__),v=!1}finally{v&&delete f[c]}return b.exports}__nccwpck_require__.ab="//";var g=__nccwpck_require__(229);c.exports=g}()},30622:function(c,u,f){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=f(2265),b=Symbol.for("react.element"),v=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,w=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function q(c,u,f){var g,v={},k=null,E=null;for(g in void 0!==f&&(k=""+f),void 0!==u.key&&(k=""+u.key),void 0!==u.ref&&(E=u.ref),u)x.call(u,g)&&!_.hasOwnProperty(g)&&(v[g]=u[g]);if(c&&c.defaultProps)for(g in u=c.defaultProps)void 0===v[g]&&(v[g]=u[g]);return{$$typeof:b,type:c,key:k,ref:E,props:v,_owner:w.current}}u.Fragment=v,u.jsx=q,u.jsxs=q},57437:function(c,u,f){"use strict";c.exports=f(30622)},81853:function(c,u,f){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=f(2265);function h(c,u){return c===u&&(0!==c||1/c==1/u)||c!=c&&u!=u}var b="function"==typeof Object.is?Object.is:h,v=g.useState,x=g.useEffect,w=g.useLayoutEffect,_=g.useDebugValue;function q(c,u){var f=u(),g=v({inst:{value:f,getSnapshot:u}}),b=g[0].inst,k=g[1];return w(function(){b.value=f,b.getSnapshot=u,r(b)&&k({inst:b})},[c,f,u]),x(function(){return r(b)&&k({inst:b}),c(function(){r(b)&&k({inst:b})})},[c]),_(f),f}function r(c){var u=c.getSnapshot;c=c.value;try{var f=u();return!b(c,f)}catch(c){return!0}}function t(c,u){return u()}var k="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?t:q;u.useSyncExternalStore=void 0!==g.useSyncExternalStore?g.useSyncExternalStore:k},78704:function(c,u,f){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=f(2265),b=f(26272);function p(c,u){return c===u&&(0!==c||1/c==1/u)||c!=c&&u!=u}var v="function"==typeof Object.is?Object.is:p,x=b.useSyncExternalStore,w=g.useRef,_=g.useEffect,k=g.useMemo,E=g.useDebugValue;u.useSyncExternalStoreWithSelector=function(c,u,f,g,b){var T=w(null);if(null===T.current){var $={hasValue:!1,value:null};T.current=$}else $=T.current;var I=x(c,(T=k(function(){function a(u){if(!w){if(w=!0,c=u,u=g(u),void 0!==b&&$.hasValue){var f=$.value;if(b(f,u))return x=f}return x=u}if(f=x,v(c,u))return f;var _=g(u);return void 0!==b&&b(f,_)?f:(c=u,x=_)}var c,x,w=!1,_=void 0===f?null:f;return[function(){return a(u())},null===_?void 0:function(){return a(_())}]},[u,f,g,b]))[0],T[1]);return _(function(){$.hasValue=!0,$.value=I},[I]),E(I),I}},26272:function(c,u,f){"use strict";c.exports=f(81853)},65401:function(c,u,f){"use strict";c.exports=f(78704)},42744:function(c,u){var f;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var g={}.hasOwnProperty;function classNames(){for(var c="",u=0;u<arguments.length;u++){var f=arguments[u];f&&(c=appendClass(c,parseValue(f)))}return c}function parseValue(c){if("string"==typeof c||"number"==typeof c)return c;if("object"!=typeof c)return"";if(Array.isArray(c))return classNames.apply(null,c);if(c.toString!==Object.prototype.toString&&!c.toString.toString().includes("[native code]"))return c.toString();var u="";for(var f in c)g.call(c,f)&&c[f]&&(u=appendClass(u,f));return u}function appendClass(c,u){return u?c?c+" "+u:c+u:c}c.exports?(classNames.default=classNames,c.exports=classNames):void 0!==(f=(function(){return classNames}).apply(u,[]))&&(c.exports=f)}()},29228:function(c,u,f){"use strict";f(47933);var g=f(89632);c.exports=g("Array","at")},35134:function(c,u,f){"use strict";f(67781),f(79328);var g=f(89632);c.exports=g("Array","flatMap")},61521:function(c,u,f){"use strict";f(53896),f(21767);var g=f(89632);c.exports=g("Array","flat")},47942:function(c,u,f){"use strict";f(4554);var g=f(89632);c.exports=g("String","at")},30632:function(c,u,f){"use strict";f(789),f(31490),f(43510);var g=f(89632);c.exports=g("String","replaceAll")},86284:function(c,u,f){"use strict";var g=f(80043),b=f(71747),v=TypeError;c.exports=function(c){if(g(c))return c;throw new v(b(c)+" is not a function")}},38609:function(c,u,f){"use strict";var g=f(61350),b=f(42957),v=f(94982).f,x=g("unscopables"),w=Array.prototype;void 0===w[x]&&v(w,x,{configurable:!0,value:b(null)}),c.exports=function(c){w[x][c]=!0}},44531:function(c,u,f){"use strict";var g=f(42068).charAt;c.exports=function(c,u,f){return u+(f?g(c,u).length:1)}},51485:function(c,u,f){"use strict";var g=f(56695),b=String,v=TypeError;c.exports=function(c){if(g(c))return c;throw new v(b(c)+" is not an object")}},28786:function(c,u,f){"use strict";var g=f(50949),b=f(70076),v=f(24464),createMethod=function(c){return function(u,f,x){var w,_=g(u),k=v(_);if(0===k)return!c&&-1;var E=b(x,k);if(c&&f!=f){for(;k>E;)if((w=_[E++])!=w)return!0}else for(;k>E;E++)if((c||E in _)&&_[E]===f)return c||E||0;return!c&&-1}};c.exports={includes:createMethod(!0),indexOf:createMethod(!1)}},665:function(c,u,f){"use strict";var g=f(97631),b=f(71357),v=f(56695),x=f(61350)("species"),w=Array;c.exports=function(c){var u;return g(c)&&(b(u=c.constructor)&&(u===w||g(u.prototype))?u=void 0:v(u)&&null===(u=u[x])&&(u=void 0)),void 0===u?w:u}},60747:function(c,u,f){"use strict";var g=f(665);c.exports=function(c,u){return new(g(c))(0===u?0:u)}},6938:function(c,u,f){"use strict";var g=f(58842),b=g({}.toString),v=g("".slice);c.exports=function(c){return v(b(c),8,-1)}},99743:function(c,u,f){"use strict";var g=f(8830),b=f(80043),v=f(6938),x=f(61350)("toStringTag"),w=Object,_="Arguments"===v(function(){return arguments}()),tryGet=function(c,u){try{return c[u]}catch(c){}};c.exports=g?v:function(c){var u,f,g;return void 0===c?"Undefined":null===c?"Null":"string"==typeof(f=tryGet(u=w(c),x))?f:_?v(u):"Object"===(g=v(u))&&b(u.callee)?"Arguments":g}},70783:function(c,u,f){"use strict";var g=f(19472),b=f(35191),v=f(85575),x=f(94982);c.exports=function(c,u,f){for(var w=b(u),_=x.f,k=v.f,E=0;E<w.length;E++){var T=w[E];g(c,T)||f&&g(f,T)||_(c,T,k(u,T))}}},60549:function(c,u,f){"use strict";var g=f(12534),b=f(94982),v=f(29085);c.exports=g?function(c,u,f){return b.f(c,u,v(1,f))}:function(c,u,f){return c[u]=f,c}},29085:function(c){"use strict";c.exports=function(c,u){return{enumerable:!(1&c),configurable:!(2&c),writable:!(4&c),value:u}}},64897:function(c,u,f){"use strict";var g=f(80043),b=f(94982),v=f(75412),x=f(12501);c.exports=function(c,u,f,w){w||(w={});var _=w.enumerable,k=void 0!==w.name?w.name:u;if(g(f)&&v(f,k,w),w.global)_?c[u]=f:x(u,f);else{try{w.unsafe?c[u]&&(_=!0):delete c[u]}catch(c){}_?c[u]=f:b.f(c,u,{value:f,enumerable:!1,configurable:!w.nonConfigurable,writable:!w.nonWritable})}return c}},12501:function(c,u,f){"use strict";var g=f(97738),b=Object.defineProperty;c.exports=function(c,u){try{b(g,c,{value:u,configurable:!0,writable:!0})}catch(f){g[c]=u}return u}},12534:function(c,u,f){"use strict";var g=f(44256);c.exports=!g(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},47039:function(c,u,f){"use strict";var g=f(97738),b=f(56695),v=g.document,x=b(v)&&b(v.createElement);c.exports=function(c){return x?v.createElement(c):{}}},53745:function(c){"use strict";var u=TypeError;c.exports=function(c){if(c>9007199254740991)throw u("Maximum allowed index exceeded");return c}},57960:function(c){"use strict";c.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},4130:function(c,u,f){"use strict";var g,b,v=f(97738),x=f(57960),w=v.process,_=v.Deno,k=w&&w.versions||_&&_.version,E=k&&k.v8;E&&(b=(g=E.split("."))[0]>0&&g[0]<4?1:+(g[0]+g[1])),!b&&x&&(!(g=x.match(/Edge\/(\d+)/))||g[1]>=74)&&(g=x.match(/Chrome\/(\d+)/))&&(b=+g[1]),c.exports=b},89632:function(c,u,f){"use strict";var g=f(97738),b=f(58842);c.exports=function(c,u){return b(g[c].prototype[u])}},51971:function(c){"use strict";c.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},69272:function(c,u,f){"use strict";var g=f(97738),b=f(85575).f,v=f(60549),x=f(64897),w=f(12501),_=f(70783),k=f(51559);c.exports=function(c,u){var f,E,T,$,I,M=c.target,j=c.global,D=c.stat;if(f=j?g:D?g[M]||w(M,{}):g[M]&&g[M].prototype)for(E in u){if($=u[E],T=c.dontCallGetSet?(I=b(f,E))&&I.value:f[E],!k(j?E:M+(D?".":"#")+E,c.forced)&&void 0!==T){if(typeof $==typeof T)continue;_($,T)}(c.sham||T&&T.sham)&&v($,"sham",!0),x(f,E,$,c)}}},44256:function(c){"use strict";c.exports=function(c){try{return!!c()}catch(c){return!0}}},2571:function(c,u,f){"use strict";f(789);var g=f(55817),b=f(64897),v=f(13955),x=f(44256),w=f(61350),_=f(60549),k=w("species"),E=RegExp.prototype;c.exports=function(c,u,f,T){var $=w(c),I=!x(function(){var u={};return u[$]=function(){return 7},7!==""[c](u)}),M=I&&!x(function(){var u=!1,f=/a/;return"split"===c&&((f={}).constructor={},f.constructor[k]=function(){return f},f.flags="",f[$]=/./[$]),f.exec=function(){return u=!0,null},f[$](""),!u});if(!I||!M||f){var j=/./[$],D=u($,""[c],function(c,u,f,b,x){var w=u.exec;return w===v||w===E.exec?I&&!x?{done:!0,value:g(j,u,f,b)}:{done:!0,value:g(c,f,u,b)}:{done:!1}});b(String.prototype,c,D[0]),b(E,$,D[1])}T&&_(E[$],"sham",!0)}},89162:function(c,u,f){"use strict";var g=f(97631),b=f(24464),v=f(53745),x=f(39668),flattenIntoArray=function(c,u,f,w,_,k,E,T){for(var $,I,M=_,j=0,D=!!E&&x(E,T);j<w;)j in f&&($=D?D(f[j],j,u):f[j],k>0&&g($)?(I=b($),M=flattenIntoArray(c,u,$,I,M,k-1)-1):(v(M+1),c[M]=$),M++),j++;return M};c.exports=flattenIntoArray},35815:function(c,u,f){"use strict";var g=f(21115),b=Function.prototype,v=b.apply,x=b.call;c.exports="object"==typeof Reflect&&Reflect.apply||(g?x.bind(v):function(){return x.apply(v,arguments)})},39668:function(c,u,f){"use strict";var g=f(16919),b=f(86284),v=f(21115),x=g(g.bind);c.exports=function(c,u){return b(c),void 0===u?c:v?x(c,u):function(){return c.apply(u,arguments)}}},21115:function(c,u,f){"use strict";var g=f(44256);c.exports=!g(function(){var c=(function(){}).bind();return"function"!=typeof c||c.hasOwnProperty("prototype")})},55817:function(c,u,f){"use strict";var g=f(21115),b=Function.prototype.call;c.exports=g?b.bind(b):function(){return b.apply(b,arguments)}},56309:function(c,u,f){"use strict";var g=f(12534),b=f(19472),v=Function.prototype,x=g&&Object.getOwnPropertyDescriptor,w=b(v,"name"),_=w&&(!g||g&&x(v,"name").configurable);c.exports={EXISTS:w,PROPER:w&&"something"===(function(){}).name,CONFIGURABLE:_}},16919:function(c,u,f){"use strict";var g=f(6938),b=f(58842);c.exports=function(c){if("Function"===g(c))return b(c)}},58842:function(c,u,f){"use strict";var g=f(21115),b=Function.prototype,v=b.call,x=g&&b.bind.bind(v,v);c.exports=g?x:function(c){return function(){return v.apply(c,arguments)}}},35651:function(c,u,f){"use strict";var g=f(97738),b=f(80043);c.exports=function(c,u){var f;return arguments.length<2?b(f=g[c])?f:void 0:g[c]&&g[c][u]}},22112:function(c,u,f){"use strict";var g=f(86284),b=f(86617);c.exports=function(c,u){var f=c[u];return b(f)?void 0:g(f)}},7175:function(c,u,f){"use strict";var g=f(58842),b=f(84405),v=Math.floor,x=g("".charAt),w=g("".replace),_=g("".slice),k=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,E=/\$([$&'`]|\d{1,2})/g;c.exports=function(c,u,f,g,T,$){var I=f+c.length,M=g.length,j=E;return void 0!==T&&(T=b(T),j=k),w($,j,function(b,w){var k;switch(x(w,0)){case"$":return"$";case"&":return c;case"`":return _(u,0,f);case"'":return _(u,I);case"<":k=T[_(w,1,-1)];break;default:var E=+w;if(0===E)return b;if(E>M){var $=v(E/10);if(0===$)return b;if($<=M)return void 0===g[$-1]?x(w,1):g[$-1]+x(w,1);return b}k=g[E-1]}return void 0===k?"":k})}},97738:function(c,u,f){"use strict";var check=function(c){return c&&c.Math===Math&&c};c.exports=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof f.g&&f.g)||check("object"==typeof this&&this)||function(){return this}()||Function("return this")()},19472:function(c,u,f){"use strict";var g=f(58842),b=f(84405),v=g({}.hasOwnProperty);c.exports=Object.hasOwn||function(c,u){return v(b(c),u)}},68347:function(c){"use strict";c.exports={}},91162:function(c,u,f){"use strict";var g=f(35651);c.exports=g("document","documentElement")},11149:function(c,u,f){"use strict";var g=f(12534),b=f(44256),v=f(47039);c.exports=!g&&!b(function(){return 7!==Object.defineProperty(v("div"),"a",{get:function(){return 7}}).a})},33910:function(c,u,f){"use strict";var g=f(58842),b=f(44256),v=f(6938),x=Object,w=g("".split);c.exports=b(function(){return!x("z").propertyIsEnumerable(0)})?function(c){return"String"===v(c)?w(c,""):x(c)}:x},12402:function(c,u,f){"use strict";var g=f(58842),b=f(80043),v=f(29145),x=g(Function.toString);b(v.inspectSource)||(v.inspectSource=function(c){return x(c)}),c.exports=v.inspectSource},65230:function(c,u,f){"use strict";var g,b,v,x=f(99819),w=f(97738),_=f(56695),k=f(60549),E=f(19472),T=f(29145),$=f(80050),I=f(68347),M="Object already initialized",j=w.TypeError,D=w.WeakMap;if(x||T.state){var L=T.state||(T.state=new D);L.get=L.get,L.has=L.has,L.set=L.set,g=function(c,u){if(L.has(c))throw new j(M);return u.facade=c,L.set(c,u),u},b=function(c){return L.get(c)||{}},v=function(c){return L.has(c)}}else{var F=$("state");I[F]=!0,g=function(c,u){if(E(c,F))throw new j(M);return u.facade=c,k(c,F,u),u},b=function(c){return E(c,F)?c[F]:{}},v=function(c){return E(c,F)}}c.exports={set:g,get:b,has:v,enforce:function(c){return v(c)?b(c):g(c,{})},getterFor:function(c){return function(u){var f;if(!_(u)||(f=b(u)).type!==c)throw new j("Incompatible receiver, "+c+" required");return f}}}},97631:function(c,u,f){"use strict";var g=f(6938);c.exports=Array.isArray||function(c){return"Array"===g(c)}},80043:function(c){"use strict";var u="object"==typeof document&&document.all;c.exports=void 0===u&&void 0!==u?function(c){return"function"==typeof c||c===u}:function(c){return"function"==typeof c}},71357:function(c,u,f){"use strict";var g=f(58842),b=f(44256),v=f(80043),x=f(99743),w=f(35651),_=f(12402),noop=function(){},k=w("Reflect","construct"),E=/^\s*(?:class|function)\b/,T=g(E.exec),$=!E.test(noop),isConstructorModern=function(c){if(!v(c))return!1;try{return k(noop,[],c),!0}catch(c){return!1}},isConstructorLegacy=function(c){if(!v(c))return!1;switch(x(c)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $||!!T(E,_(c))}catch(c){return!0}};isConstructorLegacy.sham=!0,c.exports=!k||b(function(){var c;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern(function(){c=!0})||c})?isConstructorLegacy:isConstructorModern},51559:function(c,u,f){"use strict";var g=f(44256),b=f(80043),v=/#|\.prototype\./,isForced=function(c,u){var f=w[x(c)];return f===k||f!==_&&(b(u)?g(u):!!u)},x=isForced.normalize=function(c){return String(c).replace(v,".").toLowerCase()},w=isForced.data={},_=isForced.NATIVE="N",k=isForced.POLYFILL="P";c.exports=isForced},86617:function(c){"use strict";c.exports=function(c){return null==c}},56695:function(c,u,f){"use strict";var g=f(80043);c.exports=function(c){return"object"==typeof c?null!==c:g(c)}},9168:function(c){"use strict";c.exports=!1},91059:function(c,u,f){"use strict";var g=f(56695),b=f(6938),v=f(61350)("match");c.exports=function(c){var u;return g(c)&&(void 0!==(u=c[v])?!!u:"RegExp"===b(c))}},65375:function(c,u,f){"use strict";var g=f(35651),b=f(80043),v=f(50112),x=f(20327),w=Object;c.exports=x?function(c){return"symbol"==typeof c}:function(c){var u=g("Symbol");return b(u)&&v(u.prototype,w(c))}},24464:function(c,u,f){"use strict";var g=f(42510);c.exports=function(c){return g(c.length)}},75412:function(c,u,f){"use strict";var g=f(58842),b=f(44256),v=f(80043),x=f(19472),w=f(12534),_=f(56309).CONFIGURABLE,k=f(12402),E=f(65230),T=E.enforce,$=E.get,I=String,M=Object.defineProperty,j=g("".slice),D=g("".replace),L=g([].join),F=w&&!b(function(){return 8!==M(function(){},"length",{value:8}).length}),B=String(String).split("String"),G=c.exports=function(c,u,f){"Symbol("===j(I(u),0,7)&&(u="["+D(I(u),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),f&&f.getter&&(u="get "+u),f&&f.setter&&(u="set "+u),(!x(c,"name")||_&&c.name!==u)&&(w?M(c,"name",{value:u,configurable:!0}):c.name=u),F&&f&&x(f,"arity")&&c.length!==f.arity&&M(c,"length",{value:f.arity});try{f&&x(f,"constructor")&&f.constructor?w&&M(c,"prototype",{writable:!1}):c.prototype&&(c.prototype=void 0)}catch(c){}var g=T(c);return x(g,"source")||(g.source=L(B,"string"==typeof u?u:"")),c};Function.prototype.toString=G(function(){return v(this)&&$(this).source||k(this)},"toString")},61325:function(c){"use strict";var u=Math.ceil,f=Math.floor;c.exports=Math.trunc||function(c){var g=+c;return(g>0?f:u)(g)}},42957:function(c,u,f){"use strict";var g,b=f(51485),v=f(79400),x=f(51971),w=f(68347),_=f(91162),k=f(47039),E=f(80050),T="prototype",$="script",I=E("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(c){return"<"+$+">"+c+"</"+$+">"},NullProtoObjectViaActiveX=function(c){c.write(scriptTag("")),c.close();var u=c.parentWindow.Object;return c=null,u},NullProtoObjectViaIFrame=function(){var c,u=k("iframe");return u.style.display="none",_.appendChild(u),u.src=String("java"+$+":"),(c=u.contentWindow.document).open(),c.write(scriptTag("document.F=Object")),c.close(),c.F},NullProtoObject=function(){try{g=new ActiveXObject("htmlfile")}catch(c){}NullProtoObject="undefined"!=typeof document?document.domain&&g?NullProtoObjectViaActiveX(g):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(g);for(var c=x.length;c--;)delete NullProtoObject[T][x[c]];return NullProtoObject()};w[I]=!0,c.exports=Object.create||function(c,u){var f;return null!==c?(EmptyConstructor[T]=b(c),f=new EmptyConstructor,EmptyConstructor[T]=null,f[I]=c):f=NullProtoObject(),void 0===u?f:v.f(f,u)}},79400:function(c,u,f){"use strict";var g=f(12534),b=f(81887),v=f(94982),x=f(51485),w=f(50949),_=f(15540);u.f=g&&!b?Object.defineProperties:function(c,u){x(c);for(var f,g=w(u),b=_(u),k=b.length,E=0;k>E;)v.f(c,f=b[E++],g[f]);return c}},94982:function(c,u,f){"use strict";var g=f(12534),b=f(11149),v=f(81887),x=f(51485),w=f(87843),_=TypeError,k=Object.defineProperty,E=Object.getOwnPropertyDescriptor,T="enumerable",$="configurable",I="writable";u.f=g?v?function(c,u,f){if(x(c),u=w(u),x(f),"function"==typeof c&&"prototype"===u&&"value"in f&&I in f&&!f[I]){var g=E(c,u);g&&g[I]&&(c[u]=f.value,f={configurable:$ in f?f[$]:g[$],enumerable:T in f?f[T]:g[T],writable:!1})}return k(c,u,f)}:k:function(c,u,f){if(x(c),u=w(u),x(f),b)try{return k(c,u,f)}catch(c){}if("get"in f||"set"in f)throw new _("Accessors not supported");return"value"in f&&(c[u]=f.value),c}},85575:function(c,u,f){"use strict";var g=f(12534),b=f(55817),v=f(96787),x=f(29085),w=f(50949),_=f(87843),k=f(19472),E=f(11149),T=Object.getOwnPropertyDescriptor;u.f=g?T:function(c,u){if(c=w(c),u=_(u),E)try{return T(c,u)}catch(c){}if(k(c,u))return x(!b(v.f,c,u),c[u])}},67613:function(c,u,f){"use strict";var g=f(49852),b=f(51971).concat("length","prototype");u.f=Object.getOwnPropertyNames||function(c){return g(c,b)}},4531:function(c,u){"use strict";u.f=Object.getOwnPropertySymbols},50112:function(c,u,f){"use strict";var g=f(58842);c.exports=g({}.isPrototypeOf)},49852:function(c,u,f){"use strict";var g=f(58842),b=f(19472),v=f(50949),x=f(28786).indexOf,w=f(68347),_=g([].push);c.exports=function(c,u){var f,g=v(c),k=0,E=[];for(f in g)!b(w,f)&&b(g,f)&&_(E,f);for(;u.length>k;)b(g,f=u[k++])&&(~x(E,f)||_(E,f));return E}},15540:function(c,u,f){"use strict";var g=f(49852),b=f(51971);c.exports=Object.keys||function(c){return g(c,b)}},96787:function(c,u){"use strict";var f={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,b=g&&!f.call({1:2},1);u.f=b?function(c){var u=g(this,c);return!!u&&u.enumerable}:f},61823:function(c,u,f){"use strict";var g=f(55817),b=f(80043),v=f(56695),x=TypeError;c.exports=function(c,u){var f,w;if("string"===u&&b(f=c.toString)&&!v(w=g(f,c))||b(f=c.valueOf)&&!v(w=g(f,c))||"string"!==u&&b(f=c.toString)&&!v(w=g(f,c)))return w;throw new x("Can't convert object to primitive value")}},35191:function(c,u,f){"use strict";var g=f(35651),b=f(58842),v=f(67613),x=f(4531),w=f(51485),_=b([].concat);c.exports=g("Reflect","ownKeys")||function(c){var u=v.f(w(c)),f=x.f;return f?_(u,f(c)):u}},38911:function(c,u,f){"use strict";var g=f(55817),b=f(51485),v=f(80043),x=f(6938),w=f(13955),_=TypeError;c.exports=function(c,u){var f=c.exec;if(v(f)){var k=g(f,c,u);return null!==k&&b(k),k}if("RegExp"===x(c))return g(w,c,u);throw new _("RegExp#exec called on incompatible receiver")}},13955:function(c,u,f){"use strict";var g,b,v=f(55817),x=f(58842),w=f(92455),_=f(4045),k=f(9602),E=f(93801),T=f(42957),$=f(65230).get,I=f(27541),M=f(5682),j=E("native-string-replace",String.prototype.replace),D=RegExp.prototype.exec,L=D,F=x("".charAt),B=x("".indexOf),G=x("".replace),U=x("".slice),V=(b=/b*/g,v(D,g=/a/,"a"),v(D,b,"a"),0!==g.lastIndex||0!==b.lastIndex),K=k.BROKEN_CARET,Z=void 0!==/()??/.exec("")[1];(V||Z||K||I||M)&&(L=function(c){var u,f,g,b,x,k,E,I=$(this),M=w(c),Y=I.raw;if(Y)return Y.lastIndex=this.lastIndex,u=v(L,Y,M),this.lastIndex=Y.lastIndex,u;var X=I.groups,J=K&&this.sticky,Q=v(_,this),ee=this.source,et=0,en=M;if(J&&(-1===B(Q=G(Q,"y",""),"g")&&(Q+="g"),en=U(M,this.lastIndex),this.lastIndex>0&&(!this.multiline||this.multiline&&"\n"!==F(M,this.lastIndex-1))&&(ee="(?: "+ee+")",en=" "+en,et++),f=RegExp("^(?:"+ee+")",Q)),Z&&(f=RegExp("^"+ee+"$(?!\\s)",Q)),V&&(g=this.lastIndex),b=v(D,J?f:this,en),J?b?(b.input=U(b.input,et),b[0]=U(b[0],et),b.index=this.lastIndex,this.lastIndex+=b[0].length):this.lastIndex=0:V&&b&&(this.lastIndex=this.global?b.index+b[0].length:g),Z&&b&&b.length>1&&v(j,b[0],f,function(){for(x=1;x<arguments.length-2;x++)void 0===arguments[x]&&(b[x]=void 0)}),b&&X)for(x=0,b.groups=k=T(null);x<X.length;x++)k[(E=X[x])[0]]=b[E[1]];return b}),c.exports=L},4045:function(c,u,f){"use strict";var g=f(51485);c.exports=function(){var c=g(this),u="";return c.hasIndices&&(u+="d"),c.global&&(u+="g"),c.ignoreCase&&(u+="i"),c.multiline&&(u+="m"),c.dotAll&&(u+="s"),c.unicode&&(u+="u"),c.unicodeSets&&(u+="v"),c.sticky&&(u+="y"),u}},80290:function(c,u,f){"use strict";var g=f(55817),b=f(19472),v=f(50112),x=f(4045),w=RegExp.prototype;c.exports=function(c){var u=c.flags;return!(void 0===u&&!("flags"in w)&&!b(c,"flags")&&v(w,c))?u:g(x,c)}},9602:function(c,u,f){"use strict";var g=f(44256),b=f(97738).RegExp,v=g(function(){var c=b("a","y");return c.lastIndex=2,null!==c.exec("abcd")}),x=v||g(function(){return!b("a","y").sticky}),w=v||g(function(){var c=b("^r","gy");return c.lastIndex=2,null!==c.exec("str")});c.exports={BROKEN_CARET:w,MISSED_STICKY:x,UNSUPPORTED_Y:v}},27541:function(c,u,f){"use strict";var g=f(44256),b=f(97738).RegExp;c.exports=g(function(){var c=b(".","s");return!(c.dotAll&&c.test("\n")&&"s"===c.flags)})},5682:function(c,u,f){"use strict";var g=f(44256),b=f(97738).RegExp;c.exports=g(function(){var c=b("(?<a>b)","g");return"b"!==c.exec("b").groups.a||"bc"!=="b".replace(c,"$<a>c")})},12924:function(c,u,f){"use strict";var g=f(86617),b=TypeError;c.exports=function(c){if(g(c))throw new b("Can't call method on "+c);return c}},80050:function(c,u,f){"use strict";var g=f(93801),b=f(97246),v=g("keys");c.exports=function(c){return v[c]||(v[c]=b(c))}},29145:function(c,u,f){"use strict";var g=f(9168),b=f(97738),v=f(12501),x="__core-js_shared__",w=c.exports=b[x]||v(x,{});(w.versions||(w.versions=[])).push({version:"3.36.1",mode:g?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"})},93801:function(c,u,f){"use strict";var g=f(29145);c.exports=function(c,u){return g[c]||(g[c]=u||{})}},42068:function(c,u,f){"use strict";var g=f(58842),b=f(55963),v=f(92455),x=f(12924),w=g("".charAt),_=g("".charCodeAt),k=g("".slice),createMethod=function(c){return function(u,f){var g,E,T=v(x(u)),$=b(f),I=T.length;return $<0||$>=I?c?"":void 0:(g=_(T,$))<55296||g>56319||$+1===I||(E=_(T,$+1))<56320||E>57343?c?w(T,$):g:c?k(T,$,$+2):(g-55296<<10)+(E-56320)+65536}};c.exports={codeAt:createMethod(!1),charAt:createMethod(!0)}},24072:function(c,u,f){"use strict";var g=f(4130),b=f(44256),v=f(97738).String;c.exports=!!Object.getOwnPropertySymbols&&!b(function(){var c=Symbol("symbol detection");return!v(c)||!(Object(c) instanceof Symbol)||!Symbol.sham&&g&&g<41})},70076:function(c,u,f){"use strict";var g=f(55963),b=Math.max,v=Math.min;c.exports=function(c,u){var f=g(c);return f<0?b(f+u,0):v(f,u)}},50949:function(c,u,f){"use strict";var g=f(33910),b=f(12924);c.exports=function(c){return g(b(c))}},55963:function(c,u,f){"use strict";var g=f(61325);c.exports=function(c){var u=+c;return u!=u||0===u?0:g(u)}},42510:function(c,u,f){"use strict";var g=f(55963),b=Math.min;c.exports=function(c){var u=g(c);return u>0?b(u,9007199254740991):0}},84405:function(c,u,f){"use strict";var g=f(12924),b=Object;c.exports=function(c){return b(g(c))}},61777:function(c,u,f){"use strict";var g=f(55817),b=f(56695),v=f(65375),x=f(22112),w=f(61823),_=f(61350),k=TypeError,E=_("toPrimitive");c.exports=function(c,u){if(!b(c)||v(c))return c;var f,_=x(c,E);if(_){if(void 0===u&&(u="default"),!b(f=g(_,c,u))||v(f))return f;throw new k("Can't convert object to primitive value")}return void 0===u&&(u="number"),w(c,u)}},87843:function(c,u,f){"use strict";var g=f(61777),b=f(65375);c.exports=function(c){var u=g(c,"string");return b(u)?u:u+""}},8830:function(c,u,f){"use strict";var g=f(61350)("toStringTag"),b={};b[g]="z",c.exports="[object z]"===String(b)},92455:function(c,u,f){"use strict";var g=f(99743),b=String;c.exports=function(c){if("Symbol"===g(c))throw TypeError("Cannot convert a Symbol value to a string");return b(c)}},71747:function(c){"use strict";var u=String;c.exports=function(c){try{return u(c)}catch(c){return"Object"}}},97246:function(c,u,f){"use strict";var g=f(58842),b=0,v=Math.random(),x=g(1..toString);c.exports=function(c){return"Symbol("+(void 0===c?"":c)+")_"+x(++b+v,36)}},20327:function(c,u,f){"use strict";var g=f(24072);c.exports=g&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},81887:function(c,u,f){"use strict";var g=f(12534),b=f(44256);c.exports=g&&b(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},99819:function(c,u,f){"use strict";var g=f(97738),b=f(80043),v=g.WeakMap;c.exports=b(v)&&/native code/.test(String(v))},61350:function(c,u,f){"use strict";var g=f(97738),b=f(93801),v=f(19472),x=f(97246),w=f(24072),_=f(20327),k=g.Symbol,E=b("wks"),T=_?k.for||k:k&&k.withoutSetter||x;c.exports=function(c){return v(E,c)||(E[c]=w&&v(k,c)?k[c]:T("Symbol."+c)),E[c]}},47933:function(c,u,f){"use strict";var g=f(69272),b=f(84405),v=f(24464),x=f(55963),w=f(38609);g({target:"Array",proto:!0},{at:function(c){var u=b(this),f=v(u),g=x(c),w=g>=0?g:f+g;return w<0||w>=f?void 0:u[w]}}),w("at")},67781:function(c,u,f){"use strict";var g=f(69272),b=f(89162),v=f(86284),x=f(84405),w=f(24464),_=f(60747);g({target:"Array",proto:!0},{flatMap:function(c){var u,f=x(this),g=w(f);return v(c),(u=_(f,0)).length=b(u,f,f,g,0,1,c,arguments.length>1?arguments[1]:void 0),u}})},53896:function(c,u,f){"use strict";var g=f(69272),b=f(89162),v=f(84405),x=f(24464),w=f(55963),_=f(60747);g({target:"Array",proto:!0},{flat:function(){var c=arguments.length?arguments[0]:void 0,u=v(this),f=x(u),g=_(u,0);return g.length=b(g,u,u,f,0,void 0===c?1:w(c)),g}})},79328:function(c,u,f){"use strict";f(38609)("flatMap")},21767:function(c,u,f){"use strict";f(38609)("flat")},789:function(c,u,f){"use strict";var g=f(69272),b=f(13955);g({target:"RegExp",proto:!0,forced:/./.exec!==b},{exec:b})},4554:function(c,u,f){"use strict";var g=f(69272),b=f(58842),v=f(12924),x=f(55963),w=f(92455),_=f(44256),k=b("".charAt);g({target:"String",proto:!0,forced:_(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(c){var u=w(v(this)),f=u.length,g=x(c),b=g>=0?g:f+g;return b<0||b>=f?void 0:k(u,b)}})},43510:function(c,u,f){"use strict";var g=f(69272),b=f(55817),v=f(58842),x=f(12924),w=f(80043),_=f(86617),k=f(91059),E=f(92455),T=f(22112),$=f(80290),I=f(7175),M=f(61350),j=f(9168),D=M("replace"),L=TypeError,F=v("".indexOf),B=v("".replace),G=v("".slice),U=Math.max;g({target:"String",proto:!0},{replaceAll:function(c,u){var f,g,v,M,V,K,Z,Y,X=x(this),J=0,Q=0,ee="";if(!_(c)){if((f=k(c))&&!~F(E(x($(c))),"g"))throw new L("`.replaceAll` does not allow non-global regexes");if(g=T(c,D))return b(g,c,X,u);if(j&&f)return B(E(X),c,u)}for(v=E(X),M=E(c),(V=w(u))||(u=E(u)),Z=U(1,K=M.length),J=F(v,M);-1!==J;)Y=V?E(u(M,J,v)):I(M,v,J,[],void 0,u),ee+=G(v,Q,J)+Y,Q=J+K,J=J+Z>v.length?-1:F(v,M,J+Z);return Q<v.length&&(ee+=G(v,Q)),ee}})},31490:function(c,u,f){"use strict";var g=f(35815),b=f(55817),v=f(58842),x=f(2571),w=f(44256),_=f(51485),k=f(80043),E=f(86617),T=f(55963),$=f(42510),I=f(92455),M=f(12924),j=f(44531),D=f(22112),L=f(7175),F=f(38911),B=f(61350)("replace"),G=Math.max,U=Math.min,V=v([].concat),K=v([].push),Z=v("".indexOf),Y=v("".slice),X="$0"==="a".replace(/./,"$0"),J=!!/./[B]&&""===/./[B]("a","$0");x("replace",function(c,u,f){var v=J?"$":"$0";return[function(c,f){var g=M(this),v=E(c)?void 0:D(c,B);return v?b(v,c,g,f):b(u,I(g),c,f)},function(c,b){var x=_(this),w=I(c);if("string"==typeof b&&-1===Z(b,v)&&-1===Z(b,"$<")){var E=f(u,x,w,b);if(E.done)return E.value}var M=k(b);M||(b=I(b));var D=x.global;D&&(et=x.unicode,x.lastIndex=0);for(var B=[];null!==(en=F(x,w))&&(K(B,en),D);)""===I(en[0])&&(x.lastIndex=j(w,$(x.lastIndex),et));for(var X="",J=0,Q=0;Q<B.length;Q++){for(var ee,et,en,er,ei=I((en=B[Q])[0]),eo=G(U(T(en.index),w.length),0),ea=[],es=1;es<en.length;es++)K(ea,void 0===(ee=en[es])?ee:String(ee));var el=en.groups;if(M){var ec=V([ei],ea,eo,w);void 0!==el&&K(ec,el),er=I(g(b,void 0,ec))}else er=L(ei,w,eo,ea,el,b);eo>=J&&(X+=Y(w,J,eo)+er,J=eo+ei.length)}return X+Y(w,J)}]},!!w(function(){var c=/./;return c.exec=function(){var c=[];return c.groups={a:"7"},c},"7"!=="".replace(c,"$<a>")})||!X||J)},69645:function(c,u,f){"use strict";var g=f(29228);c.exports=g},86930:function(c,u,f){"use strict";var g=f(35134);c.exports=g},64770:function(c,u,f){"use strict";var g=f(61521);c.exports=g},92880:function(c,u,f){"use strict";var g=f(47942);c.exports=g},19304:function(c,u,f){"use strict";var g=f(30632);c.exports=g},17295:function(c,u,f){"use strict";f.d(u,{g:function(){return SVGContainer}});var g=f(57437);function SVGContainer({children:c,className:u="",...f}){return(0,g.jsx)("svg",{...f,className:`tl-svg-container ${u}`,children:c})}},45894:function(c,u,f){"use strict";f.d(u,{A6:function(){return $},JM:function(){return getUserPreferences},MO:function(){return getFreshUserPreferences},ks:function(){return I},ng:function(){return userPrefersDarkUI},yu:function(){return setUserPreferences}});var g=f(39957),b=f(83925),v=f(40563),x=f(45958),w=f(65596);f(62601);let _="TLDRAW_USER_DATA_v3",k=x.T.object({id:x.T.string,name:x.T.string.nullable().optional(),locale:x.T.string.nullable().optional(),color:x.T.string.nullable().optional(),isDarkMode:x.T.boolean.nullable().optional(),animationSpeed:x.T.number.nullable().optional(),isSnapMode:x.T.boolean.nullable().optional()}),E={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3},T=(0,b.zn)({currentVersion:E.MakeFieldsNullable,migrators:{[E.AddAnimationSpeed]:{up:c=>({...c,animationSpeed:1}),down:({animationSpeed:c,...u})=>u},[E.AddIsSnapMode]:{up:c=>({...c,isSnapMode:!1}),down:({isSnapMode:c,...u})=>u},[E.MakeFieldsNullable]:{up:c=>c,down:c=>({id:c.id,name:c.name??I.name,locale:c.locale??I.locale,color:c.color??I.color,isDarkMode:c.isDarkMode??I.isDarkMode,animationSpeed:c.animationSpeed??I.animationSpeed,isSnapMode:c.isSnapMode??I.isSnapMode})}}}),$=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function getRandomColor(){return $[Math.floor(Math.random()*$.length)]}function userPrefersDarkUI(){return"undefined"!=typeof window&&(window.matchMedia?.("(prefers-color-scheme: dark)")?.matches??!1)}function userPrefersReducedMotion(){return"undefined"!=typeof window&&(window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1)}let I=Object.freeze({name:"New User",locale:(0,v.Bz)(),color:getRandomColor(),isDarkMode:!1,animationSpeed:userPrefersReducedMotion()?0:1,isSnapMode:!1});function getFreshUserPreferences(){return{id:(0,w.E)()}}function migrateUserPreferences(c){if(null===c||"object"!=typeof c||!("version"in c)||!("user"in c)||"number"!=typeof c.version)return getFreshUserPreferences();let u=(0,b.Te)({value:c.user,fromVersion:c.version,toVersion:T.currentVersion??0,migrations:T});if("error"===u.type)return getFreshUserPreferences();try{k.validate(u.value)}catch(c){return getFreshUserPreferences()}return u.value}function loadUserPreferences(){let c="undefined"==typeof window?null:JSON.parse(window?.localStorage?.getItem(_)||"null")??null;return migrateUserPreferences(c)}let M=(0,g.cn)("globalUserData",loadUserPreferences());function storeUserPreferences(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.setItem(_,JSON.stringify({version:T.currentVersion,user:M.value}))}function setUserPreferences(c){k.validate(c),M.set(c),storeUserPreferences(),broadcastUserPreferencesChange()}let j="undefined"==typeof BroadcastChannel?null:new BroadcastChannel("tldraw-user-sync");j?.addEventListener("message",c=>{let u=c.data;u?.type===L&&u?.origin!==D&&M.set(migrateUserPreferences(u.data))});let D=(0,w.E)(),L="tldraw-user-preferences-change";function broadcastUserPreferencesChange(){j?.postMessage({type:L,origin:D,data:{user:M.value,version:T.currentVersion}})}function getUserPreferences(){return M.value}},7217:function(c,u,f){"use strict";f.d(u,{L:function(){return createTLUser}});var g=f(39957),b=f(45894);function createTLUser(c={}){return{derivePresenceState:c.derivePresenceState??(()=>(0,g.Fl)("presence",()=>null)),userPreferences:c.userPreferences??(0,g.Fl)("userPreferences",()=>(0,b.JM)()),setUserPreferences:c.setUserPreferences??b.yu}}},29968:function(c,u,f){"use strict";f.d(u,{m:function(){return checkShapesAndAddCore},u:function(){return b}});var g=f(82772);let b=[g.Q],v=new Set(b.map(c=>c.type));function checkShapesAndAddCore(c){let u=[...b],f=new Set;for(let g of c){if(v.has(g.type))throw Error(`Shape type "${g.type}" is a core shapes type and cannot be overridden`);if(f.has(g.type))throw Error(`Shape type "${g.type}" is defined more than once`);u.push(g),f.add(g.type)}return u}},57655:function(c,u,f){"use strict";f.d(u,{$G:function(){return K},CK:function(){return Q},CN:function(){return T},E:function(){return _},Et:function(){return v},KD:function(){return w},MN:function(){return J},Ns:function(){return M},O8:function(){return X},Pz:function(){return L},Qd:function(){return I},RH:function(){return j},RZ:function(){return Y},Sk:function(){return B},UD:function(){return F},Xy:function(){return V},Zj:function(){return k},aR:function(){return et},dW:function(){return Z},iF:function(){return U},kx:function(){return b},qV:function(){return D},sZ:function(){return E},s_:function(){return G},uJ:function(){return x},wM:function(){return en},wi:function(){return $},yV:function(){return ee}});var g=f(31986);let b=2e3,v=40,x=80,w=320,_=[.1,.25,.5,1,2,4,8],k=.1,E=8,T=.5,$=.1,I=.2,M=.005,j=.05,D=450,L=200,F=6,B=4,G=32,U={};for(let c=1;c<=Math.ceil(E);c++)U[c+"_dark"]=`hash_pattern_zoom_${c}_dark`,U[c+"_light"]=`hash_pattern_zoom_${c}_light`;let V={duration:0,easing:g.L.easeInOutCubic},K=.09,Z=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],Y=6e4,X=3e3,J=1200,Q={CAMERA_MOVE:-10},ee=64,et=620,en=8},46912:function(c,u,f){"use strict";f.d(u,{w:function(){return arrowBindingsIndex}});var g=f(39957);let arrowBindingsIndex=c=>{let{store:u}=c,f=u.query.filterHistory("shape"),b=u.query.records("shape",()=>({type:{eq:"arrow"}}));function fromScratch(){let c=b.value,u={};for(let f of c){let{start:c,end:g}=f.props;if("binding"===c.type){let g=u[c.boundShapeId];g?g.push({arrowId:f.id,handleId:"start"}):u[c.boundShapeId]=[{arrowId:f.id,handleId:"start"}]}if("binding"===g.type){let c=u[g.boundShapeId];c?c.push({arrowId:f.id,handleId:"end"}):u[g.boundShapeId]=[{arrowId:f.id,handleId:"end"}]}}return u}return(0,g.Fl)("arrowBindingsIndex",(u,b)=>{let v;if((0,g.e1)(u))return fromScratch();let x=f.getDiffSince(b);if(x===g.SB)return fromScratch();function ensureNewArray(c){v||(v={...u}),v[c]?v[c]===u[c]&&(v[c]=[...v[c]]):v[c]=[]}function removingBinding(c,u,f){ensureNewArray(c),v[c]=v[c].filter(c=>c.arrowId!==u||c.handleId!==f),0===v[c].length&&delete v[c]}function addBinding(c,u,f){ensureNewArray(c),v[c].push({arrowId:u,handleId:f})}for(let u of x){for(let f of Object.values(u.added))if(c.isShapeOfType(f,"arrow")){let{start:c,end:u}=f.props;"binding"===c.type&&addBinding(c.boundShapeId,f.id,"start"),"binding"===u.type&&addBinding(u.boundShapeId,f.id,"end")}for(let[f,g]of Object.values(u.updated))if(c.isShapeOfType(f,"arrow")&&c.isShapeOfType(g,"arrow"))for(let c of["start","end"]){let u=f.props[c],b=g.props[c];"binding"===u.type&&"point"===b.type?removingBinding(u.boundShapeId,f.id,c):"point"===u.type&&"binding"===b.type?addBinding(b.boundShapeId,g.id,c):"binding"===u.type&&"binding"===b.type&&u.boundShapeId!==b.boundShapeId&&(removingBinding(u.boundShapeId,f.id,c),addBinding(b.boundShapeId,g.id,c))}for(let f of Object.values(u.removed))if(c.isShapeOfType(f,"arrow")){let{start:c,end:u}=f.props;"binding"===c.type&&removingBinding(c.boundShapeId,f.id,"start"),"binding"===u.type&&removingBinding(u.boundShapeId,f.id,"end")}}return v??u})}},69078:function(c,u,f){"use strict";f.d(u,{s:function(){return parentsToChildren}});var g=f(39957),b=f(40563),v=f(47110),x=f(64078);let parentsToChildren=c=>{let u=c.query.ids("shape");function fromScratch(){let f={},g=u.value,b=Array(g.size);return g.forEach(u=>b.push(c.get(u))),b.sort(x.hl),b.forEach(c=>{f[c.parentId]||(f[c.parentId]=[]),f[c.parentId].push(c.id)}),f}return(0,g.Fl)("parentsToChildrenWithIndexes",(u,f)=>{let w;if((0,g.e1)(u))return fromScratch();let _=c.history.getDiffSince(f);if(_===g.SB)return fromScratch();if(0===_.length)return u;let k=null,ensureNewArray=c=>{k||(k={...u}),k[c]?k[c]===u[c]&&(k[c]=[...k[c]]):k[c]=[]},E=new Set;for(let c=0,u=_.length;c<u;c++){for(let u of Object.values((w=_[c]).added))(0,b.VV)(u)&&(ensureNewArray(u.parentId),k[u.parentId].push(u.id),E.add(k[u.parentId]));for(let[c,u]of Object.values(w.updated))if((0,b.VV)(u)&&(0,b.VV)(c)){if(c.parentId!==u.parentId)ensureNewArray(c.parentId),ensureNewArray(u.parentId),k[c.parentId].splice(k[c.parentId].indexOf(u.id),1),k[u.parentId].push(u.id),E.add(k[u.parentId]);else if(c.index!==u.index){ensureNewArray(u.parentId);let c=k[u.parentId].indexOf(u.id);k[u.parentId][c]=u.id,E.add(k[u.parentId])}}for(let c of Object.values(w.removed))(0,b.VV)(c)&&(ensureNewArray(c.parentId),k[c.parentId].splice(k[c.parentId].indexOf(c.id),1))}for(let u of E){let f=(0,v.oA)(u.map(u=>c.get(u)));f.sort(x.hl),u.splice(0,u.length,...f.map(c=>c.id))}return k??u})}},94211:function(c,u,f){"use strict";f.d(u,{Q:function(){return deriveShapeIdsInCurrentPage}});var g=f(39957),b=f(83925),v=f(40563);let isShapeInPage=(c,u,f)=>{for(;!(0,v.r5)(f.parentId);){let u=c.get(f.parentId);if(!u)return!1;f=u}return f.parentId===u},deriveShapeIdsInCurrentPage=(c,u)=>{let f=c.query.ids("shape"),x=null;function fromScratch(){let g=u();return x=g,new Set([...f.value].filter(u=>isShapeInPage(c,g,c.get(u))))}return(0,g.Fl)("_shapeIdsInCurrentPage",(f,w)=>{if((0,g.e1)(f))return fromScratch();let _=u();if(_!==x)return fromScratch();let k=c.history.getDiffSince(w);if(k===g.SB)return fromScratch();let E=new b.mW(f);for(let u of k){for(let f of Object.values(u.added))(0,v.VV)(f)&&isShapeInPage(c,_,f)&&E.add(f.id);for(let[f,g]of Object.values(u.updated))(0,v.VV)(g)&&(isShapeInPage(c,_,g)?E.add(g.id):E.remove(g.id));for(let c of Object.keys(u.removed))(0,v.YT)(c)&&E.remove(c)}let T=E.get();return T?(0,g.qo)(T.value,T.diff):f})}},50829:function(c,u,f){"use strict";f.d(u,{o:function(){return ClickManager}});var g=f(57655),b=f(56799),v=f(65596);let ClickManager=class ClickManager{constructor(c){this.editor=c}_clickId="";_clickTimeout;_clickScreenPoint;_previousScreenPoint;_getClickTimeout=(c,u=(0,v.E)())=>{this._clickId=u,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===c&&this._clickId===u){switch(this._clickState){case"pendingTriple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break;case"pendingQuadruple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break;case"pendingOverflow":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"})}this._clickState="idle"}},"idle"===c||"pendingDouble"===c?g.qV:g.Pz)};_clickState="idle";get clickState(){return this._clickState}lastPointerInfo={};transformPointerDownEvent=c=>{if(!this._clickState)return c;switch(this._clickScreenPoint=b.G.From(c.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>40&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=c,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),c;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...c,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...c,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...c,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),c;default:return this._clickTimeout=this._getClickTimeout(this._clickState),c}};transformPointerUpEvent=c=>{if(!this._clickState)return c;switch(this._clickScreenPoint=b.G.From(c.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return c}};cancelDoubleClickTimeout=()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"};handleMove=()=>{"idle"!==this._clickState&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.instanceState.isCoarsePointer?g.UD:g.Sk)&&this.cancelDoubleClickTimeout()}}},60106:function(c,u,f){"use strict";f.d(u,{l:function(){return EnvironmentManager}});let EnvironmentManager=class EnvironmentManager{constructor(c){this.editor=c,"undefined"!=typeof window&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}isSafari;isIos;isChromeForIos;isFirefox;isAndroid}},87055:function(c,u,f){"use strict";f.d(u,{E:function(){return HistoryManager}});var g=f(39957),b=f(83925),v=f(65596);function stack(c){if(c){let u=x;for(;c.length;)u=u.push(c.pop());return u}return x}let EmptyStackItem=class EmptyStackItem{length=0;head=null;tail=this;push(c){return new StackItem(c,this)}toArray(){return g.LZ}[Symbol.iterator](){return{next:()=>({value:void 0,done:!0})}}};let x=new EmptyStackItem;let StackItem=class StackItem{constructor(c,u){this.head=c,this.tail=u,this.length=u.length+1}length;push(c){return new StackItem(c,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let c=this;return{next(){if(!c.length)return{value:void 0,done:!0};{let u=c.head;return c=c.tail,{value:u,done:!1}}}}}};let HistoryManager=class HistoryManager{constructor(c,u){this.ctx=c,this.annotateError=u}_undos=(0,g.cn)("HistoryManager.undos",stack());_redos=(0,g.cn)("HistoryManager.redos",stack());_batchDepth=0;onBatchComplete=()=>void 0;_commands={};get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}createCommand=(c,u,f)=>{if(this._commands[c])throw Error(`Duplicate command: ${c}`);this._commands[c]=f;let exec=(...g)=>{if(!this._batchDepth)return this.batch(()=>exec(...g)),this.ctx;let x=u(...g);if(!x)return this.ctx;let{data:w,ephemeral:_,squashing:k,preservesRedoStack:E}=x;if(this.ignoringUpdates((c,u)=>(f.do(w),{undos:c,redos:u})),!_){let u=this._undos.value.head;k&&u&&"command"===u.type&&u.name===c&&u.preservesRedoStack===E?this._undos.update(c=>c.tail.push({...u,id:(0,v.E)(),data:(0,b.ZV)(f.squash(u.data,w))})):this._undos.update(u=>u.push({type:"command",name:c,data:(0,b.ZV)(w),id:(0,v.E)(),preservesRedoStack:E})),x.preservesRedoStack||this._redos.set(stack()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return exec};batch=c=>{try{this._batchDepth++,1===this._batchDepth?(0,g.ay)(()=>{let u=this._undos.value.head?.id;c(),u!==this._undos.value.head?.id&&this.onBatchComplete()}):c()}catch(c){throw this.annotateError(c),c}finally{this._batchDepth--}return this};ignoringUpdates=c=>{let u=this._undos.value,f=this._redos.value;this._undos.set(stack()),this._redos.set(stack());try{({undos:u,redos:f}=(0,g.ay)(()=>c(u,f)))}finally{this._undos.set(u),this._redos.set(f)}};_undo=({pushToRedoStack:c,toMark:u})=>(this.ignoringUpdates((f,g)=>{if(0===f.length)return{undos:f,redos:g};for(;f.head?.type==="STOP";){let b=f.head;if(f=f.tail,c&&(g=g.push(b)),b.id===u)return this.ctx.emit("change-history",c?{reason:"undo"}:{reason:"bail",markId:u}),{undos:f,redos:g}}if(0===f.length)return this.ctx.emit("change-history",c?{reason:"undo"}:{reason:"bail",markId:u}),{undos:f,redos:g};for(;f.head;){let b=f.head;if(f=f.tail,c&&(g=g.push(b)),"STOP"===b.type){if(b.onUndo&&(!u||b.id===u))break}else{let c=this._commands[b.name];c.undo(b.data)}}return this.ctx.emit("change-history",c?{reason:"undo"}:{reason:"bail",markId:u}),{undos:f,redos:g}}),this);undo=()=>(this._undo({pushToRedoStack:!0}),this);redo=()=>(this.ignoringUpdates((c,u)=>{if(0===u.length)return{undos:c,redos:u};for(;u.head?.type==="STOP";)c=c.push(u.head),u=u.tail;if(0===u.length)return this.ctx.emit("change-history",{reason:"redo"}),{undos:c,redos:u};for(;u.head;){let f=u.head;if(c=c.push(u.head),u=u.tail,"STOP"===f.type){if(f.onRedo)break}else{let c=this._commands[f.name];c.redo?c.redo(f.data):c.do(f.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:c,redos:u}}),this);bail=()=>(this._undo({pushToRedoStack:!1}),this);bailToMark=c=>(this._undo({pushToRedoStack:!1,toMark:c}),this);mark=(c=(0,v.E)(),u=!0,f=!0)=>{let g=this._undos.value.head;return g&&"STOP"===g.type&&g.id===c&&g.onUndo===u&&g.onRedo===f?g.id:(this._undos.update(g=>g.push({type:"STOP",id:c,onUndo:u,onRedo:f})),this.ctx.emit("mark-history",{id:c}),c)};clear(){this._undos.set(stack()),this._redos.set(stack())}}},75084:function(c,u,f){"use strict";f.d(u,{Y:function(){return SideEffectManager}});let SideEffectManager=class SideEffectManager{constructor(c){this.editor=c,c.store.onBeforeCreate=(c,u)=>{let f=this._beforeCreateHandlers[c.typeName];if(f){let g=c;for(let c of f)g=c(g,u);return g}return c},c.store.onAfterCreate=(c,u)=>{let f=this._afterCreateHandlers[c.typeName];if(f)for(let g of f)g(c,u)},c.store.onBeforeChange=(c,u,f)=>{let g=this._beforeChangeHandlers[u.typeName];if(g){let b=u;for(let u of g)b=u(c,b,f);return b}return u};let u=0;c.store.onAfterChange=(c,f,g)=>{if(++u>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{let u=this._afterChangeHandlers[f.typeName];if(u)for(let b of u)b(c,f,g)}u--},c.store.onBeforeDelete=(c,u)=>{let f=this._beforeDeleteHandlers[c.typeName];if(f){for(let g of f)if(!1===g(c,u))return!1}},c.store.onAfterDelete=(c,u)=>{let f=this._afterDeleteHandlers[c.typeName];if(f)for(let g of f)g(c,u)},c.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach(c=>c())}}_beforeCreateHandlers={};_afterCreateHandlers={};_beforeChangeHandlers={};_afterChangeHandlers={};_beforeDeleteHandlers={};_afterDeleteHandlers={};_batchCompleteHandlers=[];registerBeforeCreateHandler(c,u){let f=this._beforeCreateHandlers[c];return f||(this._beforeCreateHandlers[c]=[]),this._beforeCreateHandlers[c].push(u),()=>remove(this._beforeCreateHandlers[c],u)}registerAfterCreateHandler(c,u){let f=this._afterCreateHandlers[c];return f||(this._afterCreateHandlers[c]=[]),this._afterCreateHandlers[c].push(u),()=>remove(this._afterCreateHandlers[c],u)}registerBeforeChangeHandler(c,u){let f=this._beforeChangeHandlers[c];return f||(this._beforeChangeHandlers[c]=[]),this._beforeChangeHandlers[c].push(u),()=>remove(this._beforeChangeHandlers[c],u)}registerAfterChangeHandler(c,u){let f=this._afterChangeHandlers[c];return f||(this._afterChangeHandlers[c]=[]),this._afterChangeHandlers[c].push(u),()=>remove(this._afterChangeHandlers[c],u)}registerBeforeDeleteHandler(c,u){let f=this._beforeDeleteHandlers[c];return f||(this._beforeDeleteHandlers[c]=[]),this._beforeDeleteHandlers[c].push(u),()=>remove(this._beforeDeleteHandlers[c],u)}registerAfterDeleteHandler(c,u){let f=this._afterDeleteHandlers[c];return f||(this._afterDeleteHandlers[c]=[]),this._afterDeleteHandlers[c].push(u),()=>remove(this._afterDeleteHandlers[c],u)}registerBatchCompleteHandler(c){return this._batchCompleteHandlers.push(c),()=>remove(this._batchCompleteHandlers,c)}};function remove(c,u){let f=c.indexOf(u);f>=0&&c.splice(f,1)}},82278:function(c,u,f){"use strict";f.d(u,{f:function(){return SnapManager}});var g=f(39957),b=f(47110),v=f(99303),x=f(60498),w=f(46166),_=f(56799),k=f(65596),E=Object.defineProperty,T=Object.getOwnPropertyDescriptor,__decorateClass=(c,u,f,g)=>{for(var b,v=g>1?void 0:g?T(u,f):u,x=c.length-1;x>=0;x--)(b=c[x])&&(v=(g?b(u,f,v):b(v))||v);return g&&v&&E(u,f,v),v};let round=c=>Math.round(1e8*c)/1e8;function findAdjacentGaps(c,u,f,g,b){let v=c.filter(c=>("forward"===g?c.startNode.id===u:c.endNode.id===u)&&round(c.length)===round(f)&&(0,w.mW)(c.breadthIntersection[0],c.breadthIntersection[1],b[0],b[1]));if(0===v.length)return[];let x=new Set;return v.forEach(u=>{let _="forward"===g?u.endNode.id:u.startNode.id;if(!x.has(_)){x.add(_);let k=findAdjacentGaps(c,_,f,g,(0,w.mW)(u.breadthIntersection[0],u.breadthIntersection[1],b[0],b[1]));v.push(...k)}}),v}function dedupeGapSnaps(c){c.sort((c,u)=>u.gaps.length-c.gaps.length);for(let u=c.length-1;u>0;u--){let f=c[u];for(let g=u-1;g>=0;g--){let b=c[g];if(b.direction===f.direction&&f.gaps.every(c=>b.gaps.some(u=>round(c.startEdge[0].x)===round(u.startEdge[0].x)&&round(c.startEdge[0].y)===round(u.startEdge[0].y)&&round(c.startEdge[1].x)===round(u.startEdge[1].x)&&round(c.startEdge[1].y)===round(u.startEdge[1].y))&&b.gaps.some(u=>round(c.endEdge[0].x)===round(u.endEdge[0].x)&&round(c.endEdge[0].y)===round(u.endEdge[0].y)&&round(c.endEdge[1].x)===round(u.endEdge[1].x)&&round(c.endEdge[1].y)===round(u.endEdge[1].y)))){c.splice(u,1);break}}}}let SnapManager=class SnapManager{constructor(c){this.editor=c}_snapLines=(0,g.cn)("snapLines",void 0);get lines(){return this._snapLines.value??g.LZ}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(c){this._snapLines.set(c)}get snapPointsCache(){let{editor:c}=this;return c.store.createComputedCache("snapPoints",u=>{let f=c.getShapePageTransform(u.id);if(!f)return;let g=this.editor.getShapeGeometry(u).snapPoints;return g.map((c,g)=>{let{x:b,y:v}=x.y.applyToPoint(f,c);return{x:b,y:v,id:`${u.id}:${g}`}})})}get snapThreshold(){return 8/this.editor.zoomLevel}get snappableShapes(){let{editor:c}=this,{selectedShapeIds:u,renderingBounds:f}=c,g=[],collectSnappableShapesFromParent=b=>{let v=c.getSortedChildIdsForParent(b);for(let b of v){if(u.includes(b))continue;let v=c.getShape(b);if(!v)continue;let x=c.getShapeUtil(v);if(!x.canSnap(v))continue;let w=c.getShapePageBounds(b);if(w&&f.includes(w)){if(c.isShapeOfType(v,"group")){collectSnappableShapesFromParent(b);continue}g.push({id:b,pageBounds:w,isClosed:c.getShapeGeometry(v).isClosed})}}};return collectSnappableShapesFromParent(this.currentCommonAncestor??c.currentPageId),g}get currentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}get snappablePoints(){let{snappableShapes:c,snapPointsCache:u}=this,f=[];return c.forEach(c=>{let g=u.get(c.id);g&&f.push(...g)}),f}get visibleGaps(){let c,u;let f=[],g=[],b=this.snappableShapes.sort((c,u)=>c.pageBounds.minX-u.pageBounds.minX);for(let g=0;g<b.length;g++){c=b[g];for(let v=g+1;v<b.length;v++)u=b[v],c.pageBounds.maxX<u.pageBounds.minX&&(0,w.ep)(c.pageBounds.minY,c.pageBounds.maxY,u.pageBounds.minY,u.pageBounds.maxY)&&f.push({startNode:c,endNode:u,startEdge:[new _.G(c.pageBounds.maxX,c.pageBounds.minY),new _.G(c.pageBounds.maxX,c.pageBounds.maxY)],endEdge:[new _.G(u.pageBounds.minX,u.pageBounds.minY),new _.G(u.pageBounds.minX,u.pageBounds.maxY)],length:u.pageBounds.minX-c.pageBounds.maxX,breadthIntersection:(0,w.mW)(c.pageBounds.minY,c.pageBounds.maxY,u.pageBounds.minY,u.pageBounds.maxY)})}let v=b.sort((c,u)=>c.pageBounds.minY-u.pageBounds.minY);for(let f=0;f<v.length;f++){c=v[f];for(let b=f+1;b<v.length;b++)u=v[b],c.pageBounds.maxY<u.pageBounds.minY&&(0,w.ep)(c.pageBounds.minX,c.pageBounds.maxX,u.pageBounds.minX,u.pageBounds.maxX)&&g.push({startNode:c,endNode:u,startEdge:[new _.G(c.pageBounds.minX,c.pageBounds.maxY),new _.G(c.pageBounds.maxX,c.pageBounds.maxY)],endEdge:[new _.G(u.pageBounds.minX,u.pageBounds.minY),new _.G(u.pageBounds.maxX,u.pageBounds.minY)],length:u.pageBounds.minY-c.pageBounds.maxY,breadthIntersection:(0,w.mW)(c.pageBounds.minX,c.pageBounds.maxX,u.pageBounds.minX,u.pageBounds.maxX)})}return{horizontal:f,vertical:g}}snapTranslate({lockedAxis:c,initialSelectionPageBounds:u,initialSelectionSnapPoints:f,dragDelta:g}){let{snappablePoints:b,snapThreshold:v}=this,x=u.clone().translate(g),w=f.map(({x:c,y:u},f)=>({id:"selection:"+f,x:c+g.x,y:u+g.y})),k=[],E=[],T=new _.G(v,v);this.collectPointSnaps({minOffset:T,nearestSnapsX:k,nearestSnapsY:E,otherNodeSnapPoints:b,selectionSnapPoints:w}),this.collectGapSnaps({selectionPageBounds:x,nearestSnapsX:k,nearestSnapsY:E,minOffset:T});let $=new _.G("x"===c?0:k[0]?.nudge??0,"y"===c?0:E[0]?.nudge??0);T.x=0,T.y=0,k.length=0,E.length=0,w.forEach(c=>{c.x+=$.x,c.y+=$.y}),x.translate($),this.collectPointSnaps({minOffset:T,nearestSnapsX:k,nearestSnapsY:E,otherNodeSnapPoints:b,selectionSnapPoints:w}),this.collectGapSnaps({selectionPageBounds:x,nearestSnapsX:k,nearestSnapsY:E,minOffset:T});let I=this.getPointSnapLines({nearestSnapsX:k,nearestSnapsY:E}),M=this.getGapSnapLines({selectionPageBounds:x,nearestSnapsX:k,nearestSnapsY:E});return this._snapLines.set([...M,...I]),{nudge:$}}get outlinesInPageSpace(){return this.snappableShapes.map(({id:c,isClosed:u})=>{let f=(0,b.p$)(this.editor.getShapeGeometry(c).vertices);u&&f.push(f[0]);let g=this.editor.getShapePageTransform(c);if(!g)throw Error("No page transform");return x.y.applyToPoints(g,f)})}getSnappingHandleDelta({handlePoint:c,additionalSegments:u}){let f,g,b,v;let{outlinesInPageSpace:x,snapThreshold:w}=this,E=w,T=null,$=[...x,...u];for(let u of $)for(let x=0;x<u.length-1;x++)f=u[x],g=u[x+1],b=_.G.NearestPointOnLineSegment(f,g,c),!isNaN(v=_.G.Dist(c,b))&&v<E&&(E=v,T=b);return T?(this._snapLines.set([{id:(0,k.E)(),type:"points",points:[T]}]),_.G.Sub(T,c)):null}snapResize({initialSelectionPageBounds:c,dragDelta:u,handle:f,isAspectRatioLocked:g,isResizingFromCenter:b}){let{snapThreshold:x}=this,{box:w,scaleX:k,scaleY:E}=v.No.Resize(c,f,b?2*u.x:u.x,b?2*u.y:u.y,g),T=f;k<0&&(T=(0,v.Ee)(T)),E<0&&(T=(0,v.Op)(T)),b&&(w.center=c.center);let $="top"===T||"bottom"===T,I="left"===T||"right"===T,M=getResizeSnapPointsForHandle(T,w),j=this.snappablePoints,D=[],L=[],F=new _.G(x,x);this.collectPointSnaps({minOffset:F,nearestSnapsX:D,nearestSnapsY:L,otherNodeSnapPoints:j,selectionSnapPoints:M});let B=new _.G($?0:D[0]?.nudge??0,I?0:L[0]?.nudge??0);if(g&&(0,v.m3)(T)&&0!==B.len()){let u=D.length&&L.length?Math.abs(B.x)<Math.abs(B.y)?"x":"y":D.length?"x":"y",f=c.aspectRatio;"x"===u?(L.length=0,B.y=B.x/f,("bottom_left"===T||"top_right"===T)&&(B.y=-B.y)):(D.length=0,B.x=B.y*f,("bottom_left"===T||"top_right"===T)&&(B.x=-B.x))}let G=_.G.Add(u,B),{box:U}=v.No.Resize(c,f,b?2*G.x:G.x,b?2*G.y:G.y,g);b&&(U.center=c.center);let V=getResizeSnapPointsForHandle("any",U);D.length=0,L.length=0,F.x=0,F.y=0,this.collectPointSnaps({minOffset:F,nearestSnapsX:D,nearestSnapsY:L,otherNodeSnapPoints:j,selectionSnapPoints:V});let K=this.getPointSnapLines({nearestSnapsX:D,nearestSnapsY:L});return this._snapLines.set([...K]),{nudge:B}}collectPointSnaps({selectionSnapPoints:c,otherNodeSnapPoints:u,minOffset:f,nearestSnapsX:g,nearestSnapsY:b}){for(let v of c)for(let c of u){let u=_.G.Sub(v,c),x=Math.abs(u.x),w=Math.abs(u.y);round(x)<=round(f.x)&&(round(x)<round(f.x)&&(g.length=0),g.push({type:"points",points:{thisPoint:v,otherPoint:c},nudge:c.x-v.x}),f.x=x),round(w)<=round(f.y)&&(round(w)<round(f.y)&&(b.length=0),b.push({type:"points",points:{thisPoint:v,otherPoint:c},nudge:c.y-v.y}),f.y=w)}}collectGapSnaps({selectionPageBounds:c,minOffset:u,nearestSnapsX:f,nearestSnapsY:g}){let{horizontal:b,vertical:v}=this.visibleGaps;for(let g of b){if(!(0,w.ep)(g.breadthIntersection[0],g.breadthIntersection[1],c.minY,c.maxY))continue;let b=g.startEdge[0].x+g.length/2,v=b-c.center.x,x=g.length>c.width;if(x&&round(Math.abs(v))<=round(u.x)){round(Math.abs(v))<round(u.x)&&(f.length=0),u.x=Math.abs(v);let c={type:"gap_center",gap:g,nudge:v},b=f.find(({type:c})=>"gap_center"===c),x=b&&(0,w.mW)(g.breadthIntersection[0],g.breadthIntersection[1],b.gap.breadthIntersection[0],b.gap.breadthIntersection[1]);b&&b.gap.length>g.length&&x?f[f.indexOf(b)]=c:b&&x||f.push(c)}let _=g.startNode.pageBounds.minX-g.length,k=c.maxX,E=_-k;round(Math.abs(E))<=round(u.x)&&(round(Math.abs(E))<round(u.x)&&(f.length=0),u.x=Math.abs(E),f.push({type:"gap_duplicate",gap:g,protrusionDirection:"left",nudge:E}));let T=g.endNode.pageBounds.maxX+g.length,$=c.minX,I=T-$;round(Math.abs(I))<=round(u.x)&&(round(Math.abs(I))<round(u.x)&&(f.length=0),u.x=Math.abs(I),f.push({type:"gap_duplicate",gap:g,protrusionDirection:"right",nudge:I}))}for(let f of v){if(!(0,w.ep)(f.breadthIntersection[0],f.breadthIntersection[1],c.minX,c.maxX))continue;let b=f.startEdge[0].y+f.length/2,v=b-c.center.y,x=f.length>c.height;if(x&&round(Math.abs(v))<=round(u.y)){round(Math.abs(v))<round(u.y)&&(g.length=0),u.y=Math.abs(v);let c={type:"gap_center",gap:f,nudge:v},b=g.find(({type:c})=>"gap_center"===c),x=b&&(0,w.ep)(b.gap.breadthIntersection[0],b.gap.breadthIntersection[1],f.breadthIntersection[0],f.breadthIntersection[1]);b&&b.gap.length>f.length&&x?g[g.indexOf(b)]=c:b&&x||g.push(c);continue}let _=f.startNode.pageBounds.minY-f.length,k=c.maxY,E=_-k;round(Math.abs(E))<=round(u.y)&&(round(Math.abs(E))<round(u.y)&&(g.length=0),u.y=Math.abs(E),g.push({type:"gap_duplicate",gap:f,protrusionDirection:"top",nudge:E}));let T=f.endNode.pageBounds.maxY+f.length,$=c.minY,I=T-$;round(Math.abs(I))<=round(u.y)&&(round(Math.abs(I))<round(u.y)&&(g.length=0),u.y=Math.abs(I),g.push({type:"gap_duplicate",gap:f,protrusionDirection:"bottom",nudge:I}))}}getPointSnapLines({nearestSnapsX:c,nearestSnapsY:u}){let f={},g={};if(c.length>0){for(let u of c)if("points"===u.type){let c=round(u.points.otherPoint.x);f[c]||(f[c]=[]),f[c].push(u.points)}}if(u.length>0){for(let c of u)if("points"===c.type){let u=round(c.points.otherPoint.y);g[u]||(g[u]=[]),g[u].push(c.points)}}return Object.values(f).concat(Object.values(g)).map(c=>({id:(0,k.E)(),type:"points",points:(0,b.D8)(c.map(c=>_.G.From(c.otherPoint)).concat(c.map(c=>_.G.From(c.thisPoint))),(c,u)=>c.equals(u))}))}getGapSnapLines({selectionPageBounds:c,nearestSnapsX:u,nearestSnapsY:f}){let{vertical:g,horizontal:b}=this.visibleGaps,v={top:c.sides[0],right:c.sides[1],bottom:[c.corners[3],c.corners[2]],left:[c.corners[0],c.corners[3]]},x=[];if(u.length>0)for(let f of u){if("points"===f.type)continue;let{gap:{breadthIntersection:u,startEdge:g,startNode:_,endNode:E,length:T,endEdge:$}}=f;switch(f.type){case"gap_center":{let f=(T-c.width)/2,I=(0,w.mW)(u[0],u[1],c.minY,c.maxY);x.push({type:"gaps",direction:"horizontal",id:(0,k.E)(),gaps:[...findAdjacentGaps(b,_.id,f,"backward",I),{startEdge:g,endEdge:v.left},{startEdge:v.right,endEdge:$},...findAdjacentGaps(b,E.id,f,"forward",I)]});break}case"gap_duplicate":{let I=(0,w.mW)(u[0],u[1],c.minY,c.maxY);x.push({type:"gaps",direction:"horizontal",id:(0,k.E)(),gaps:"left"===f.protrusionDirection?[{startEdge:v.right,endEdge:g.map(c=>c.clone().addXY(-_.pageBounds.width,0))},{startEdge:g,endEdge:$},...findAdjacentGaps(b,E.id,T,"forward",I)]:[...findAdjacentGaps(b,_.id,T,"backward",I),{startEdge:g,endEdge:$},{startEdge:$.map(c=>c.clone().addXY(f.gap.endNode.pageBounds.width,0)),endEdge:v.left}]})}}}if(f.length>0)for(let u of f){if("points"===u.type)continue;let{gap:{breadthIntersection:f,startEdge:b,startNode:_,endNode:E,length:T,endEdge:$}}=u;switch(u.type){case"gap_center":{let E=(T-c.height)/2,I=(0,w.mW)(f[0],f[1],c.minX,c.maxX);x.push({type:"gaps",direction:"vertical",id:(0,k.E)(),gaps:[...findAdjacentGaps(g,_.id,E,"backward",I),{startEdge:b,endEdge:v.top},{startEdge:v.bottom,endEdge:$},...findAdjacentGaps(g,u.gap.endNode.id,E,"forward",I)]});break}case"gap_duplicate":{let I=(0,w.mW)(f[0],f[1],c.minX,c.maxX);x.push({type:"gaps",direction:"vertical",id:(0,k.E)(),gaps:"top"===u.protrusionDirection?[{startEdge:v.bottom,endEdge:b.map(c=>c.clone().addXY(0,-_.pageBounds.height))},{startEdge:b,endEdge:$},...findAdjacentGaps(g,E.id,T,"forward",I)]:[...findAdjacentGaps(g,_.id,T,"backward",I),{startEdge:b,endEdge:$},{startEdge:$.map(c=>c.clone().addXY(0,E.pageBounds.height)),endEdge:v.top}]})}}}return dedupeGapSnaps(x),x}};function getResizeSnapPointsForHandle(c,u){let{minX:f,maxX:g,minY:b,maxY:v}=u,x=[];switch(c){case"top":case"left":case"top_left":case"any":x.push({id:"top_left",handle:"top_left",x:f,y:b})}switch(c){case"top":case"right":case"top_right":case"any":x.push({id:"top_right",handle:"top_right",x:g,y:b})}switch(c){case"bottom":case"right":case"bottom_right":case"any":x.push({id:"bottom_right",handle:"bottom_right",x:g,y:v})}switch(c){case"bottom":case"left":case"bottom_left":case"any":x.push({id:"bottom_left",handle:"bottom_left",x:f,y:v})}return x}__decorateClass([g.Fl],SnapManager.prototype,"snapPointsCache",1),__decorateClass([g.Fl],SnapManager.prototype,"snapThreshold",1),__decorateClass([g.Fl],SnapManager.prototype,"snappableShapes",1),__decorateClass([g.Fl],SnapManager.prototype,"currentCommonAncestor",1),__decorateClass([g.Fl],SnapManager.prototype,"snappablePoints",1),__decorateClass([g.Fl],SnapManager.prototype,"visibleGaps",1),__decorateClass([g.Fl],SnapManager.prototype,"outlinesInPageSpace",1)},63197:function(c,u,f){"use strict";f.d(u,{R:function(){return TextManager}});var g=f(65596);let b=/\r?\n|\r/g;function normalizeTextForDom(c){return c.replace(b,"\n").split("\n").map(c=>c||" ").join("\n")}let v={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},x=/\s/;let TextManager=class TextManager{constructor(c){this.editor=c}getTextElement(){let c=document.querySelector(".tl-text-measure");c?.remove();let u=document.createElement("div");return this.editor.getContainer().appendChild(u),u.id=`__textMeasure_${(0,g.E)()}`,u.classList.add("tl-text"),u.classList.add("tl-text-measure"),u.tabIndex=-1,u}measureText=(c,u)=>{let f=this.getTextElement();f.setAttribute("dir","ltr"),f.style.setProperty("font-family",u.fontFamily),f.style.setProperty("font-style",u.fontStyle),f.style.setProperty("font-weight",u.fontWeight),f.style.setProperty("font-size",u.fontSize+"px"),f.style.setProperty("line-height",u.lineHeight*u.fontSize+"px"),f.style.setProperty("max-width",null===u.maxWidth?null:u.maxWidth+"px"),f.style.setProperty("min-width",u.minWidth??null),f.style.setProperty("padding",u.padding),f.textContent=normalizeTextForDom(c);let g=f.getBoundingClientRect();return{x:0,y:0,w:g.width,h:g.height}};measureElementTextNodeSpans(c,{shouldTruncateToFirstLine:u=!1}={}){let f=[],g=c.getBoundingClientRect(),b=-g.left,v=-g.top,w=new Range,_=c.childNodes[0],k=0,E=null,T=null,$=0,I=!1;for(let g of c.childNodes)if(g.nodeType===Node.TEXT_NODE)for(let c of g.textContent??""){w.setStart(_,k),w.setEnd(_,k+c.length);let g=w.getClientRects(),M=g[g.length-1],j=M.top+v,D=M.left+b,L=M.right+b,F=x.test(c);if(F===T&&j===$&&E)E.box.w=L-E.box.x,E.text+=c;else{if(E){if(u&&j!==$){I=!0;break}f.push(E)}E={box:{x:D,y:j,w:M.width,h:M.height},text:c}}T=F,$=j,k+=c.length}return E&&f.push(E),{spans:f,didTruncate:I}}measureTextSpans(c,u){if(""===c)return[];let f="truncate-ellipsis"===u.overflow||"truncate-clip"===u.overflow,g=this.getTextElement(),b=Math.ceil(u.width-2*u.padding);g.style.setProperty("width",`${b}px`),g.style.setProperty("height","min-content"),g.style.setProperty("dir","ltr"),g.style.setProperty("font-size",`${u.fontSize}px`),g.style.setProperty("font-family",u.fontFamily),g.style.setProperty("font-weight",u.fontWeight),g.style.setProperty("line-height",`${u.lineHeight*u.fontSize}px`),g.style.setProperty("text-align",v[u.textAlign]),f&&(g.style.setProperty("overflow-wrap","anywhere"),g.style.setProperty("word-break","break-all")),c=normalizeTextForDom(c),g.textContent=c;let{spans:x,didTruncate:w}=this.measureElementTextNodeSpans(g,{shouldTruncateToFirstLine:f});if("truncate-ellipsis"===u.overflow&&w){g.textContent="…";let f=Math.ceil(this.measureElementTextNodeSpans(g).spans[0].box.w);g.style.setProperty("width",`${b-f}px`),g.textContent=c;let v=this.measureElementTextNodeSpans(g,{shouldTruncateToFirstLine:!0}).spans,x=v[v.length-1];return v.push({text:"…",box:{x:Math.min(x.box.x+x.box.w,u.width-u.padding-f),y:x.box.y,w:f,h:x.box.h}}),v}return g.remove(),x}}},6541:function(c,u,f){"use strict";f.d(u,{r:function(){return TickManager}});var g=f(56799);let TickManager=class TickManager{constructor(c){this.editor=c,this.editor.disposables.add(this.dispose),this.start()}raf;isPaused=!0;last=0;t=0;start=()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()};tick=()=>{if(this.isPaused)return;let c=Date.now(),u=c-this.last;if(this.last=c,this.t+=u,this.editor.emit("frame",u),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(u),this.editor.emit("tick",u),this.raf=requestAnimationFrame(this.tick)};dispose=()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)};prevPoint=new g.G;updatePointerVelocity=c=>{let{prevPoint:u,editor:{inputs:{currentScreenPoint:f,pointerVelocity:b}}}=this;if(0===c)return;let v=g.G.Sub(f,u);this.prevPoint=f.clone();let x=v.len(),w=x?v.div(x):new g.G(0,0),_=b.clone().lrp(w.mul(x/c),.5);.01>Math.abs(_.x)&&(_.x=0),.01>Math.abs(_.y)&&(_.y=0),b.equals(_)||(this.editor.inputs.pointerVelocity=_)}}},36393:function(c,u,f){"use strict";f.d(u,{K:function(){return UserPreferencesManager}});var g=f(39957),b=f(45894),v=Object.defineProperty,x=Object.getOwnPropertyDescriptor,__decorateClass=(c,u,f,g)=>{for(var b,w=g>1?void 0:g?x(u,f):u,_=c.length-1;_>=0;_--)(b=c[_])&&(w=(g?b(u,f,w):b(w))||w);return g&&w&&v(u,f,w),w};let UserPreferencesManager=class UserPreferencesManager{constructor(c,u){this.user=c,this.inferDarkMode=u}updateUserPreferences=c=>{this.user.setUserPreferences({...this.user.userPreferences.value,...c})};get userPreferences(){return{id:this.id,name:this.name,locale:this.locale,color:this.color,isDarkMode:this.isDarkMode,animationSpeed:this.animationSpeed,isSnapMode:this.isSnapMode}}get isDarkMode(){return this.user.userPreferences.value.isDarkMode??(!!this.inferDarkMode&&(0,b.ng)())}get animationSpeed(){return this.user.userPreferences.value.animationSpeed??b.ks.animationSpeed}get id(){return this.user.userPreferences.value.id}get name(){return this.user.userPreferences.value.name??b.ks.name}get locale(){return this.user.userPreferences.value.locale??b.ks.locale}get color(){return this.user.userPreferences.value.color??b.ks.color}get isSnapMode(){return this.user.userPreferences.value.isSnapMode??b.ks.isSnapMode}};__decorateClass([g.Fl],UserPreferencesManager.prototype,"userPreferences",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"isDarkMode",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"animationSpeed",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"id",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"name",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"locale",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"color",1),__decorateClass([g.Fl],UserPreferencesManager.prototype,"isSnapMode",1)},25859:function(c,u,f){"use strict";f.d(u,{E:function(){return ShapeUtil}});let ShapeUtil=class ShapeUtil{constructor(c){this.editor=c}static props;static migrations;static type;canSnap=()=>!0;canScroll=()=>!1;canUnmount=()=>!0;canBind=(c,u)=>!0;canEdit=()=>!1;canResize=()=>!0;canEditInReadOnly=()=>!1;canCrop=()=>!1;providesBackgroundForChildren(c){return!1}hideResizeHandles=()=>!1;hideRotateHandle=()=>!1;hideSelectionBoundsBg=()=>!1;hideSelectionBoundsFg=()=>!1;isAspectRatioLocked=()=>!1;getOutlineSegments(c){return[this.editor.getShapeGeometry(c).vertices]}canReceiveNewChildrenOfType(c,u){return!1}canDropShapes(c,u){return!1}expandSelectionOutlinePx(c){return 0}getCanvasSvgDefs(){return[]}onBeforeCreate;onBeforeUpdate;onDragShapesOver;onDragShapesOut;onDropShapesOver;onResizeStart;onResize;onResizeEnd;onTranslateStart;onTranslate;onTranslateEnd;onRotateStart;onRotate;onRotateEnd;onHandleChange;onBindingChange;onChildrenChange;onDoubleClickHandle;onDoubleClickEdge;onDoubleClick;onClick;onEditEnd}},82772:function(c,u,f){"use strict";f.d(u,{Q:function(){return GroupShapeUtil}});var g=f(57437),b=f(40563),v=f(17295),x=f(87684),w=f(92042),_=f(86368),k=f(29234),E=f(25859),T=f(39957),$=f(3373);function getPerfectDashProps(c,u,f={}){let{closed:g=!1,snap:b=1,start:v="outset",end:x="outset",lengthRatio:w=2,style:_="dashed"}=f,k=0,E=0,T=1,$=0,I=0;switch(_){case"dashed":T=1,k=Math.min(u*w,c/4);break;case"dotted":k=u/(T=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return g||("outset"===v?(c+=k/2,I+=k/2):"skip"===v&&(c-=k,I-=k),"outset"===x?c+=k/2:"skip"!==x||(c-=k)),E=Math.floor(c/k/(2*T)),(E-=E%b)<3&&"dashed"===_?c/u<5?(k=c,E=1,$=0):(k=.333*c,$=.333*c):(k=c/(E=Math.max(E,3))/(2*T),g?(I=k/2,$=(c-E*k)/E):$=(c-E*k)/Math.max(1,E-1)),{strokeDasharray:[k,$].join(" "),strokeDashoffset:I.toString()}}function DashedOutlineBox({bounds:c,className:u}){let f=(0,$.j)(),b=(0,T.Hg)("zoom level",()=>f.zoomLevel,[f]);return(0,g.jsx)("g",{className:u,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:c.sides.map((c,u)=>{let{strokeDasharray:f,strokeDashoffset:v}=getPerfectDashProps(c[0].dist(c[1]),1/b,{style:"dashed",lengthRatio:4});return(0,g.jsx)("line",{x1:c[0].x,y1:c[0].y,x2:c[1].x,y2:c[1].y,strokeDasharray:f,strokeDashoffset:v},u)})})}let GroupShapeUtil=class GroupShapeUtil extends E.E{static type="group";static props=b.A7;static migrations=b.c4;hideSelectionBoundsFg=()=>!0;canBind=()=>!1;getDefaultProps(){return{}}getGeometry(c){let u=this.editor.getSortedChildIdsForParent(c.id);return 0===u.length?new k.z({width:1,height:1,isFilled:!1}):new x.m({children:u.map(c=>{let u=this.editor.getShape(c),f=this.editor.getShapeGeometry(c),g=this.editor.getShapeLocalTransform(u).applyToPoints(f.vertices);return f.isClosed?new w.w({points:g,isFilled:!0}):new _.q({points:g})})})}component(c){let u=this.editor.erasingShapeIds.includes(c.id),{hintingShapeIds:f}=this.editor.currentPageState,b=f.length>0&&f.some(u=>u!==c.id&&this.editor.isShapeOfType(this.editor.getShape(u),"group")),x=this.editor.currentPageState.focusedGroupId!==c.id;if(!u&&(x||b))return null;let w=this.editor.getShapeGeometry(c).bounds;return(0,g.jsx)(v.g,{id:c.id,children:(0,g.jsx)(DashedOutlineBox,{className:"tl-group",bounds:w})})}indicator(c){let u=this.editor.getShapeGeometry(c).bounds;return(0,g.jsx)(DashedOutlineBox,{className:"",bounds:u})}onChildrenChange=c=>{let u=this.editor.getSortedChildIdsForParent(c.id);if(0===u.length){this.editor.currentPageState.focusedGroupId===c.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([c.id]);return}if(1===u.length){this.editor.currentPageState.focusedGroupId===c.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(u,c.parentId),this.editor.deleteShapes([c.id]);return}}}},14214:function(c,u,f){"use strict";f.d(u,{dz:function(){return getCurvedArrowHandlePath},pe:function(){return getCurvedArrowInfo},t9:function(){return getSolidCurvedArrowPath}}),f(99303);var g=f(60498),b=f(56799),v=f(30224),x=f(46166),w=f(57761),_=f(3308);function getCurvedArrowInfo(c,u,f=0){let{arrowheadEnd:k,arrowheadStart:E}=u.props,T=u.props.bend+f;if(Math.abs(T)>Math.abs(u.props.bend*w.Od))return(0,_.rc)(c,u);let $=(0,w.Qs)(c,u),I=b.G.Med($.start,$.end),M=b.G.Sub($.end,$.start).uni(),j=b.G.Add(I,M.per().mul(-T)),D=(0,w.Up)(c,u.props.start),L=(0,w.Up)(c,u.props.end),F=$.start.clone(),B=$.end.clone(),G=j.clone(),U=u.props.bend<0,V=U?x.VK:x.pc,K=getArcInfo(F,B,G),Z=b.G.Angle(K.center,F),Y=b.G.Angle(K.center,B),X=V(Z,Y);if(0===K.length||0===K.size||!(0,x.AV)(K.length)||!(0,x.AV)(K.size))return(0,_.rc)(c,u);let J=F.clone(),Q=B.clone(),ee=G.clone(),et=c.getShapePageTransform(u),en=0,er=0;if(D&&!D.isExact){let f;let b=g.y.applyToPoint(et,J),x=g.y.applyToPoint(et,K.center),_=g.y.applyToPoint(et,Q),k=g.y.Inverse(D.transform),T=g.y.applyToPoint(k,b),$=g.y.applyToPoint(k,x),I=g.y.applyToPoint(k,_),{isClosed:M}=D,j=M?v.h9:v.XS,L=j($,K.radius,D.outline);if(L){let c=$.angle(T),u=$.angle(I),g=V(c,u);L=L.filter(u=>V(c,$.angle(u))<=g);let b=.25*g;L.sort(M?(u,f)=>Math.abs(V(c,$.angle(u))-b)<Math.abs(V(c,$.angle(f))-b)?-1:1:(u,f)=>V(c,$.angle(u))<V(c,$.angle(f))?-1:1),f=L[0]??(M?void 0:T)}else f=M?void 0:T;f&&(J.setTo(c.getPointInShapeSpace(u,g.y.applyToPoint(D.transform,f))),D.didIntersect=!0,"none"!==E&&(en=w.oF+w.L$[u.props.size]/2+("size"in D.shape.props?w.L$[D.shape.props.size]/2:0)))}if(L&&!L.isExact){let f;let b=g.y.applyToPoint(et,J),x=g.y.applyToPoint(et,Q),_=g.y.applyToPoint(et,K.center),E=g.y.Inverse(L.transform),T=g.y.applyToPoint(E,b),$=g.y.applyToPoint(E,_),I=g.y.applyToPoint(E,x),M=L.isClosed,j=M?v.h9:v.XS,D=j($,K.radius,L.outline);if(D){let c=$.angle(T),u=$.angle(I),g=V(c,u),b=.75*g;(D=D.filter(u=>V(c,$.angle(u))<=g)).sort(M?(u,f)=>Math.abs(V(c,$.angle(u))-b)<Math.abs(V(c,$.angle(f))-b)?-1:1:(u,f)=>V(c,$.angle(u))<V(c,$.angle(f))?-1:1),f=D[0]?D[0]:M?void 0:I}else f=M?void 0:I;f&&(Q.setTo(c.getPointInShapeSpace(u,g.y.applyToPoint(L.transform,f))),L.didIntersect=!0,"none"!==k&&(er=w.oF+w.L$[u.props.size]/2+("size"in L.shape.props?w.L$[L.shape.props.size]/2:0)))}let ei=b.G.Angle(K.center,J),eo=b.G.Angle(K.center,Q),ea=V(ei,eo),es=ea*K.radius,el=J.clone(),ec=Q.clone();if(0!==en){let c=en/es*(U?1:-1),u=b.G.FromAngle(ei+ea*c);el.setTo(K.center).add(u.mul(K.radius))}if(0!==er){let c=er/es*(U?-1:1),u=b.G.FromAngle(eo+ea*c);ec.setTo(K.center).add(u.mul(K.radius))}let eu=b.G.Dist(el,ec);if(eu<w.Kn&&(0!==en&&0!==er?(en*=-1.5,er*=-1.5):0!==en?en*=-2:0!==er?er*=-2:eu<10&&(D?en=-(10-eu):L&&(er=-(10-eu)))),0!==en){let c=en/es*(U?1:-1),u=b.G.FromAngle(ei+ea*c);J.setTo(K.center).add(u.mul(K.radius))}if(0!==er){let c=er/es*(U?-1:1),u=b.G.FromAngle(eo+ea*c);Q.setTo(K.center).add(u.mul(K.radius))}if(D&&L&&!D.isExact&&!L.isExact){if(es=(ea=V(ei=b.G.Angle(K.center,J),eo=b.G.Angle(K.center,Q)))*K.radius,D.shape===L.shape)es<100&&(J.setTo(F),Q.setTo(B),ee.setTo(G));else if(D&&!D.didIntersect&&J.setTo(F),L&&!L.didIntersect||V(Z,ei)>V(Z,eo)){let c=Math.min(.9,w.Kn/es)*(U?1:-1),u=b.G.FromAngle(ei+ea*c);Q.setTo(K.center).add(u.mul(K.radius))}}placeCenterHandle(K.center,K.radius,J,Q,ee,X,U),J.equals(Q)&&(J.setTo(ee.clone().addXY(1,1)),Q.setTo(ee.clone().subXY(1,1))),F.setTo(J),B.setTo(Q),G.setTo(ee);let ed=getArcInfo(F,B,G);return{isStraight:!1,start:{point:F,handle:$.start,arrowhead:u.props.arrowheadStart},end:{point:B,handle:$.end,arrowhead:u.props.arrowheadEnd},middle:G,handleArc:K,bodyArc:ed,isValid:0!==ed.length&&isFinite(ed.center.x)&&isFinite(ed.center.y)}}function getCurvedArrowHandlePath(c){let{start:u,end:f,handleArc:{radius:g,largeArcFlag:b,sweepFlag:v}}=c;return`M${u.handle.x},${u.handle.y} A${g} ${g} 0 ${b} ${v} ${f.handle.x},${f.handle.y}`}function getSolidCurvedArrowPath(c){let{start:u,end:f,bodyArc:{radius:g,largeArcFlag:b,sweepFlag:v}}=c;return`M${u.point.x},${u.point.y} A${g} ${g} 0 ${b} ${v} ${f.point.x},${f.point.y}`}function getArcInfo(c,u,f){let g=-2*(c.x*(u.y-f.y)-c.y*(u.x-f.x)+u.x*f.y-f.x*u.y),v={x:((c.x*c.x+c.y*c.y)*(f.y-u.y)+(u.x*u.x+u.y*u.y)*(c.y-f.y)+(f.x*f.x+f.y*f.y)*(u.y-c.y))/g,y:((c.x*c.x+c.y*c.y)*(u.x-f.x)+(u.x*u.x+u.y*u.y)*(f.x-c.x)+(f.x*f.x+f.y*f.y)*(c.x-u.x))/g},w=b.G.Dist(v,c),_=+b.G.Clockwise(c,f,u),k=Math.hypot(c.y-u.y,c.x-u.x),E=Math.hypot(u.y-f.y,u.x-f.x),T=Math.hypot(f.y-c.y,f.x-c.x),$=2*Math.acos((E*E+T*T-k*k)/(2*E*T)),I=+(x.PI>$),M=(x.yo-$)*(_?1:-1);return{center:v,radius:w,size:M,length:M*w,largeArcFlag:I,sweepFlag:_}}function placeCenterHandle(c,u,f,g,v,w,_){let k=b.G.Angle(c,f),E=b.G.Angle(c,g),T=(0,x.VK)(k,E);_||(T=x.yo-T);let $=b.G.FromAngle(k+T*(.5*(_?1:-1)));if(v.setTo(c).add($.mul(u)),T>w){v.rotWith(c,x.PI);let u=g.clone();g.setTo(f),f.setTo(u)}}},57761:function(c,u,f){"use strict";f.d(u,{Kn:function(){return x},L$:function(){return k},Od:function(){return _},Qs:function(){return getArrowTerminalsInArrowSpace},Up:function(){return getBoundShapeInfoForTerminal},el:function(){return getIsArrowStraight},oF:function(){return w}});var g=f(60498),b=f(56799),v=f(87684);function getIsArrowStraight(c){return 8>Math.abs(c.props.bend)}function getBoundShapeInfoForTerminal(c,u){if("point"===u.type)return;let f=c.getShape(u.boundShapeId),g=c.getShapePageTransform(f),b=c.getShapeGeometry(f),x=b instanceof v.m?b.children[0].vertices:b.vertices;return{shape:f,transform:g,isClosed:b.isClosed,isExact:u.isExact,didIntersect:!1,outline:x}}function getArrowTerminalInArrowSpace(c,u,f){if("point"===f.type)return b.G.From(f);let v=c.getShape(f.boundShapeId);if(!v)return new b.G(0,0);{let{point:x,size:w}=c.getShapeGeometry(v).bounds,_=b.G.Add(x,b.G.MulV(f.normalizedAnchor,w)),k=g.y.applyToPoint(c.getShapePageTransform(v),_),E=g.y.applyToPoint(g.y.Inverse(u),k);return E}}function getArrowTerminalsInArrowSpace(c,u){let f=c.getShapePageTransform(u),g=getArrowTerminalInArrowSpace(c,f,u.props.start),b=getArrowTerminalInArrowSpace(c,f,u.props.end);return{start:g,end:b}}let x=32,w=10,_=10,k={s:2,m:3.5,l:5,xl:10}},3308:function(c,u,f){"use strict";f.d(u,{$w:function(){return getStraightArrowHandlePath},N7:function(){return getSolidStraightArrowPath},rc:function(){return getStraightArrowInfo}}),f(99303);var g=f(60498),b=f(56799),v=f(30224),x=f(57761);function getStraightArrowInfo(c,u){let{start:f,end:g,arrowheadStart:v,arrowheadEnd:w}=u.props,_=(0,x.Qs)(c,u),k=_.start.clone(),E=_.end.clone(),T=b.G.Med(k,E),$=b.G.Sub(E,k).uni(),I=(0,x.Up)(c,f),M=(0,x.Up)(c,g),j=c.getShapePageTransform(u);updateArrowheadPointWithBoundShape(E,_.start,j,M),updateArrowheadPointWithBoundShape(k,_.end,j,I);let D=0,L=0,F=I&&M&&I.shape===M.shape;I&&M&&!F&&!I.isExact&&!M.isExact&&(M.didIntersect&&!I.didIntersect?I.isClosed&&k.setTo(E.clone().add($.clone().mul(x.Kn))):!M.didIntersect&&M.isClosed&&E.setTo(k.clone().sub($.clone().mul(x.Kn))));let B=b.G.Sub(E,k).uni(),G=!b.G.Equals(B,$);F||(I&&"none"!==v&&!I.isExact&&(D=x.oF+x.L$[u.props.size]/2+("size"in I.shape.props?x.L$[I.shape.props.size]/2:0)),!M||"none"===w||M.isExact||(L=x.oF+x.L$[u.props.size]/2+("size"in M.shape.props?x.L$[M.shape.props.size]/2:0)));let U=k.clone().add(B.clone().mul(D*(G?-1:1))),V=E.clone().sub(B.clone().mul(L*(G?-1:1))),K=b.G.Dist(U,V);K<x.Kn&&(0!==D&&0!==L?(D*=-1.5,L*=-1.5):0!==D?D*=-2:0!==L?L*=-2:K<10&&(I?D=-(10-K):M&&(L=-(10-K)))),k.add(B.clone().mul(D*(G?-1:1))),E.sub(B.clone().mul(L*(G?-1:1))),G?(I&&M&&E.setTo(b.G.Add(k,B.clone().mul(-x.Kn))),T.setTo(b.G.Med(_.start,_.end))):T.setTo(b.G.Med(k,E));let Z=b.G.Dist(k,E);return{isStraight:!0,start:{handle:_.start,point:k,arrowhead:u.props.arrowheadStart},end:{handle:_.end,point:E,arrowhead:u.props.arrowheadEnd},middle:T,isValid:Z>0,length:Z}}function updateArrowheadPointWithBoundShape(c,u,f,x){let w;if(void 0===x||x.isExact)return;let _=g.y.applyToPoint(f,u),k=g.y.applyToPoint(f,c),E=g.y.applyToPoint(g.y.Inverse(x.transform),_),T=g.y.applyToPoint(g.y.Inverse(x.transform),k),$=x.isClosed,I=$?v.qZ:v.Gc,M=I(E,T,x.outline);if(null!==M&&(w=M.sort((c,u)=>b.G.Dist(c,E)-b.G.Dist(u,E))[0]??($?void 0:T)),void 0===w)return;let j=g.y.applyToPoint(x.transform,w),D=g.y.applyToPoint(g.y.Inverse(f),j);c.setTo(D),x.didIntersect=!0}function getStraightArrowHandlePath(c){return getArrowPath(c.start.handle,c.end.handle)}function getSolidStraightArrowPath(c){return getArrowPath(c.start.point,c.end.point)}function getArrowPath(c,u){return`M${c.x},${c.y}L${u.x},${u.y}`}},59040:function(c,u,f){"use strict";f.d(u,{m:function(){return RootState}});var g=f(22797);let RootState=class RootState extends g.n{static id="root";static initial="";static children=()=>[];onKeyDown=c=>{if("KeyZ"===c.code&&!(c.shiftKey||c.ctrlKey)){let u=this.current.value;u&&u.current.value?.id==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...c,onInteractionEnd:u.id})}}}},22797:function(c,u,f){"use strict";f.d(u,{n:function(){return StateNode}});var g=f(39957),b=f(40521),v=Object.defineProperty,x=Object.getOwnPropertyDescriptor;let StateNode=class StateNode{constructor(c,u){this.editor=c;let{id:f,children:b,initial:v}=this.constructor;this.id=f,this.current=(0,g.cn)("toolState"+this.id,void 0),this.path=(0,g.Fl)("toolPath"+this.id,()=>{let c=this.current.value;return this.id+(c?`.${c.path.value}`:"")}),this.parent=u??{},this.parent?b&&v?(this.type="branch",this.initial=v,this.children=Object.fromEntries(b().map(c=>[c.id,new c(this.editor,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",b&&v&&(this.initial=v,this.children=Object.fromEntries(b().map(c=>[c.id,new c(this.editor,this)])),this.current.set(this.children[this.initial])))}path;static id;static initial;static children;id;current;type;shapeType;initial;children;parent;isActive=!1;transition=(c,u)=>{let f=c.split("."),g=this;for(let c=0;c<f.length;c++){let b=f[c],v=g.current.value,x=g.children?.[b];if(!x)throw Error(`${g.id} - no child state exists with the id ${b}.`);if(v?.id!==x.id&&(v?.exit(u,b),g.current.set(x),x.enter(u,v?.id||"initial"),!x.isActive))break;g=x}return this};handleEvent=c=>{let u=b.J[c.name],f=this.current.value;this[u]?.(c),this.current.value===f&&this.isActive&&f?.handleEvent(c)};enter=(c,u)=>{if(this.isActive=!0,this.onEnter?.(c,u),this.children&&this.initial&&this.isActive){let f=this.children[this.initial];this.current.set(f),f.enter(c,u)}};exit=(c,u)=>{this.isActive=!1,this.onExit?.(c,u),this.isActive||this.current.value?.exit(c,u)};_currentToolIdMask=(0,g.cn)("curent tool id mask",void 0);get currentToolIdMask(){return this._currentToolIdMask.value}set currentToolIdMask(c){this._currentToolIdMask.set(c)}onWheel;onPointerDown;onPointerMove;onPointerUp;onDoubleClick;onTripleClick;onQuadrupleClick;onRightClick;onMiddleClick;onKeyDown;onKeyUp;onKeyRepeat;onCancel;onComplete;onInterrupt;onEnter;onExit};((c,u,f,g)=>{for(var b,w=g>1?void 0:g?x(u,f):u,_=c.length-1;_>=0;_--)(b=c[_])&&(w=(g?b(u,f,w):b(w))||w);return g&&w&&v(u,f,w)})([g.Fl],StateNode.prototype,"currentToolIdMask",1)},40521:function(c,u,f){"use strict";f.d(u,{J:function(){return g}});let g={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"}},3373:function(c,u,f){"use strict";f.d(u,{j:function(){return useEditor},r:function(){return b}});var g=f(2265);let b=g.createContext({}),useEditor=()=>g.useContext(b)},99303:function(c,u,f){"use strict";f.d(u,{Ee:function(){return flipSelectionHandleX},No:function(){return Box2d},Op:function(){return flipSelectionHandleY},dC:function(){return rotateSelectionHandle},m3:function(){return isSelectionCorner},rf:function(){return x}});var g=f(56799),b=f(46166);let Box2d=class Box2d{constructor(c=0,u=0,f=0,g=0){this.x=c,this.y=u,this.w=f,this.h=g}x=0;y=0;w=0;h=0;get point(){return new g.G(this.x,this.y)}set point(c){this.x=c.x,this.y=c.y}get minX(){return this.x}set minX(c){this.x=c}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(c){this.y=c}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(c){this.w=c}get height(){return this.h}set height(c){this.h=c}get aspectRatio(){return this.width/this.height}get center(){return new g.G(this.midX,this.midY)}set center(c){this.minX=c.x-this.width/2,this.minY=c.y-this.height/2}get corners(){return[new g.G(this.minX,this.minY),new g.G(this.maxX,this.minY),new g.G(this.maxX,this.maxY),new g.G(this.minX,this.maxY)]}get snapPoints(){return[new g.G(this.minX,this.minY),new g.G(this.maxX,this.minY),new g.G(this.maxX,this.maxY),new g.G(this.minX,this.maxY),this.center]}get sides(){let{corners:c}=this;return[[c[0],c[1]],[c[1],c[2]],[c[2],c[3]],[c[3],c[0]]]}get size(){return new g.G(this.w,this.h)}toFixed(){return this.x=(0,b.Zd)(this.x),this.y=(0,b.Zd)(this.y),this.w=(0,b.Zd)(this.w),this.h=(0,b.Zd)(this.h),this}setTo(c){return this.x=c.x,this.y=c.y,this.w=c.w,this.h=c.h,this}set(c=0,u=0,f=0,g=0){return this.x=c,this.y=u,this.w=f,this.h=g,this}expand(c){let u=Math.min(this.minX,c.minX),f=Math.min(this.minY,c.minY),g=Math.max(this.maxX,c.maxX),b=Math.max(this.maxY,c.maxY);return this.x=u,this.y=f,this.w=g-u,this.h=b-f,this}expandBy(c){return this.x-=c,this.y-=c,this.w+=2*c,this.h+=2*c,this}scale(c){return this.x/=c,this.y/=c,this.w/=c,this.h/=c,this}clone(){let{x:c,y:u,w:f,h:g}=this;return new Box2d(c,u,f,g)}translate(c){return this.x+=c.x,this.y+=c.y,this}snapToGrid(c){let u=Math.round(this.minX/c)*c,f=Math.round(this.minY/c)*c,g=Math.round(this.maxX/c)*c,b=Math.round(this.maxY/c)*c;this.minX=u,this.minY=f,this.width=Math.max(1,g-u),this.height=Math.max(1,b-f)}collides(c){return Box2d.Collides(this,c)}contains(c){return Box2d.Contains(this,c)}includes(c){return Box2d.Includes(this,c)}containsPoint(c,u=0){return Box2d.ContainsPoint(this,c,u)}getHandlePoint(c){switch(c){case"top_left":return new g.G(this.minX,this.minY);case"top_right":return new g.G(this.maxX,this.minY);case"bottom_left":return new g.G(this.minX,this.maxY);case"bottom_right":return new g.G(this.maxX,this.maxY);case"top":return new g.G(this.midX,this.minY);case"right":return new g.G(this.maxX,this.midY);case"bottom":return new g.G(this.midX,this.maxY);case"left":return new g.G(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(c,u,f){let{minX:g,minY:b,maxX:v,maxY:x}=this,{minX:w,minY:_,maxX:k,maxY:E}=this;switch(c){case"left":case"top_left":case"bottom_left":w+=u;break;case"right":case"top_right":case"bottom_right":k+=u}switch(c){case"top":case"top_left":case"top_right":_+=f;break;case"bottom":case"bottom_left":case"bottom_right":E+=f}let T=(k-w)/(v-g),$=(E-_)/(x-b);if(T<0){let c=k;k=w,w=c}if($<0){let c=E;E=_,_=c}this.minX=w,this.minY=_,this.width=Math.abs(k-w),this.height=Math.abs(E-_)}union(c){let u=Math.min(this.minX,c.x),f=Math.min(this.minY,c.y),g=Math.max(this.maxX,c.w+c.x),b=Math.max(this.maxY,c.h+c.y);return this.x=u,this.y=f,this.width=g-u,this.height=b-f,this}static From(c){return new Box2d(c.x,c.y,c.w,c.h)}static FromPoints(c){let u;if(0===c.length)return new Box2d;let f=1/0,g=1/0,b=-1/0,v=-1/0;for(let x=0,w=c.length;x<w;x++)f=Math.min((u=c[x]).x,f),g=Math.min(u.y,g),b=Math.max(u.x,b),v=Math.max(u.y,v);return new Box2d(f,g,b-f,v-g)}static Expand(c,u){let f=Math.min(u.minX,c.minX),g=Math.min(u.minY,c.minY),b=Math.max(u.maxX,c.maxX),v=Math.max(u.maxY,c.maxY);return new Box2d(f,g,b-f,v-g)}static ExpandBy(c,u){return new Box2d(c.minX-u,c.minY-u,c.width+2*u,c.height+2*u)}static Collides=(c,u)=>!(c.maxX<u.minX||c.minX>u.maxX||c.maxY<u.minY||c.minY>u.maxY);static Contains=(c,u)=>c.minX<u.minX&&c.minY<u.minY&&c.maxY>u.maxY&&c.maxX>u.maxX;static Includes=(c,u)=>Box2d.Collides(c,u)||Box2d.Contains(c,u);static ContainsPoint=(c,u,f=0)=>!(u.x<c.minX-f||u.y<c.minY-f||u.x>c.maxX+f||u.y>c.maxY+f);static Common=c=>{let u=1/0,f=1/0,g=-1/0,b=-1/0;for(let v=0;v<c.length;v++){let x=c[v];u=Math.min(u,x.minX),f=Math.min(f,x.minY),g=Math.max(g,x.maxX),b=Math.max(b,x.maxY)}return new Box2d(u,f,g-u,b-f)};static Sides=(c,u=0)=>{let{corners:f}=c;return[[f[0],f[1]],[f[1],f[2]],[f[2],f[3]],[f[3],f[0]]]};static Resize(c,u,f,g,b=!1){let{minX:v,minY:x,maxX:w,maxY:_}=c,{minX:k,minY:E,maxX:T,maxY:$}=c;switch(u){case"left":case"top_left":case"bottom_left":k+=f;break;case"right":case"top_right":case"bottom_right":T+=f}switch(u){case"top":case"top_left":case"top_right":E+=g;break;case"bottom":case"bottom_left":case"bottom_right":$+=g}let I=(T-k)/(w-v),M=($-E)/(_-x);if(b){let c=(w-v)/(_-x),f=Math.abs(T-k),g=Math.abs($-E),b=f*(M<0?1:-1)*(1/c),j=g*(I<0?1:-1)*c,D=c<f/g;switch(u){case"top_left":D?E=$+b:k=T+j;break;case"top_right":D?E=$+b:T=k-j;break;case"bottom_right":D?$=E-b:T=k-j;break;case"bottom_left":D?$=E-b:k=T+j;break;case"bottom":case"top":{let u=(k+T)/2,f=g*c;k=u-f/2,T=u+f/2;break}case"left":case"right":{let u=(E+$)/2,g=f/c;E=u-g/2,$=u+g/2}}}if(I<0){let c=T;T=k,k=c}if(M<0){let c=$;$=E,E=c}let j=new Box2d(k,E,Math.abs(T-k),Math.abs($-E));return{box:j,scaleX:+(j.width/c.width*(I>0?1:-1)).toFixed(5),scaleY:+(j.height/c.height*(M>0?1:-1)).toFixed(5)}}equals(c){return Box2d.Equals(this,c)}static Equals(c,u){return u.x===c.x&&u.y===c.y&&u.w===c.w&&u.h===c.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(c){return new Box2d(c.x,c.y,Math.max(1,c.w),Math.max(1,c.h))}};function flipSelectionHandleY(c){switch(c){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return c}}function flipSelectionHandleX(c){switch(c){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return c}}let v=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function rotateSelectionHandle(c,u){u%=b.yo;let f=Math.round(u/(b.PI/4)),g=v.indexOf(c);return v[(g+f)%v.length]}function isSelectionCorner(c){return"top_left"===c||"top_right"===c||"bottom_right"===c||"bottom_left"===c}let x={top_left_rotate:"top_left",top_right_rotate:"top_right",bottom_right_rotate:"bottom_right",bottom_left_rotate:"bottom_left",mobile_rotate:"top_left"}},60498:function(c,u,f){"use strict";f.d(u,{y:function(){return Matrix2d}});var g=f(99303),b=f(46166),v=f(56799);let Matrix2d=class Matrix2d{constructor(c,u,f,g,b,v){this.a=c,this.b=u,this.c=f,this.d=g,this.e=b,this.f=v}a=1;b=0;c=0;d=1;e=0;f=0;equals(c){return this.a===c.a&&this.b===c.b&&this.c===c.c&&this.d===c.d&&this.e===c.e&&this.f===c.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(c){let{a:u,b:f,c:g,d:b,e:v,f:x}=this;return this.a=u*c.a+g*c.b,this.c=u*c.c+g*c.d,this.e=u*c.e+g*c.f+v,this.b=f*c.a+b*c.b,this.d=f*c.c+b*c.d,this.f=f*c.e+b*c.f+x,this}rotate(c,u,f){return 0===c?this:void 0===u?this.multiply(Matrix2d.Rotate(c)):this.translate(u,f).multiply(Matrix2d.Rotate(c)).translate(-u,-f)}translate(c,u){return this.multiply(Matrix2d.Translate(c,u))}scale(c,u){return this.multiply(Matrix2d.Scale(c,u))}invert(){let{a:c,b:u,c:f,d:g,e:b,f:v}=this,x=c*g-u*f;return this.a=g/x,this.b=-(u/x),this.c=-(f/x),this.d=c/x,this.e=-((g*b-f*v)/x),this.f=(u*b-c*v)/x,this}applyToPoint(c){return Matrix2d.applyToPoint(this,c)}applyToPoints(c){return Matrix2d.applyToPoints(this,c)}rotation(){return Matrix2d.Rotation(this)}point(){return Matrix2d.Point(this)}decomposed(){return Matrix2d.Decompose(this)}toCssString(){return Matrix2d.toCssString(this)}setTo(c){return Object.assign(this,c),this}decompose(){return Matrix2d.Decompose(this)}clone(){return new Matrix2d(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new Matrix2d(1,0,0,1,0,0)}static Translate(c,u){return new Matrix2d(1,0,0,1,c,u)}static Rotate(c,u,f){if(0===c)return Matrix2d.Identity();let g=Math.cos(c),b=Math.sin(c),v=new Matrix2d(g,b,-b,g,0,0);return void 0===u?v:Matrix2d.Compose(Matrix2d.Translate(u,f),v,Matrix2d.Translate(-u,-f))}static Scale=(c,u,f,g)=>{let b=new Matrix2d(c,0,0,0,u,0);return void 0===f?b:Matrix2d.Compose(Matrix2d.Translate(f,g),b,Matrix2d.Translate(-f,-g))};static Multiply(c,u){return{a:c.a*u.a+c.c*u.b,c:c.a*u.c+c.c*u.d,e:c.a*u.e+c.c*u.f+c.e,b:c.b*u.a+c.d*u.b,d:c.b*u.c+c.d*u.d,f:c.b*u.e+c.d*u.f+c.f}}static Inverse(c){let u=c.a*c.d-c.b*c.c;return{a:c.d/u,b:-(c.b/u),c:-(c.c/u),d:c.a/u,e:-((c.d*c.e-c.c*c.f)/u),f:(c.b*c.e-c.a*c.f)/u}}static Absolute(c){let u=c.a*c.d-c.b*c.c;return{a:c.d/u,b:-(c.b/u),c:-(c.c/u),d:c.a/u,e:(c.d*c.e-c.c*c.f)/u,f:-((c.b*c.e-c.a*c.f)/u)}}static Compose(...c){let u=Matrix2d.Identity();for(let f=0,g=c.length;f<g;f++)u.multiply(c[f]);return u}static Point(c){return new v.G(c.e,c.f)}static Rotation(c){let u;if(0!==c.a||0!==c.c){let f=Math.hypot(c.a,c.c);u=Math.acos(c.a/f)*(c.c>0?-1:1)}else if(0!==c.b||0!==c.d){let f=Math.hypot(c.b,c.d);u=b.gc+Math.acos(c.b/f)*(c.d>0?-1:1)}else u=0;return(0,b.Ci)(u)}static Decompose(c){let u,f,g;if(0!==c.a||0!==c.c){let b=Math.hypot(c.a,c.c);u=b,f=(c.a*c.d-c.b*c.c)/b,g=Math.acos(c.a/b)*(c.c>0?-1:1)}else if(0!==c.b||0!==c.d){let v=Math.hypot(c.b,c.d);u=(c.a*c.d-c.b*c.c)/v,f=v,g=b.gc+Math.acos(c.b/v)*(c.d>0?-1:1)}else u=0,f=0,g=0;return{x:c.e,y:c.f,scaleX:u,scaleY:f,rotation:(0,b.Ci)(g)}}static Smooth(c,u=1e10){return c.a=Math.round(c.a*u)/u,c.b=Math.round(c.b*u)/u,c.c=Math.round(c.c*u)/u,c.d=Math.round(c.d*u)/u,c.e=Math.round(c.e*u)/u,c.f=Math.round(c.f*u)/u,c}static toCssString(c){return`matrix(${(0,b.$Z)(c.a)}, ${(0,b.$Z)(c.b)}, ${(0,b.$Z)(c.c)}, ${(0,b.$Z)(c.d)}, ${(0,b.$Z)(c.e)}, ${(0,b.$Z)(c.f)})`}static applyToPoint(c,u){return new v.G(c.a*u.x+c.c*u.y+c.e,c.b*u.x+c.d*u.y+c.f,u.z)}static applyToXY(c,u,f){return[c.a*u+c.c*f+c.e,c.b*u+c.d*f+c.f]}static applyToPoints(c,u){return u.map(u=>new v.G(c.a*u.x+c.c*u.y+c.e,c.b*u.x+c.d*u.y+c.f,u.z))}static applyToBounds(c,u){return new g.No(c.e+u.minX,c.f+u.minY,u.width,u.height)}static From(c){return new Matrix2d(c.a,c.b,c.c,c.d,c.e,c.f)}static Cast(c){return c instanceof Matrix2d?c:Matrix2d.From(c)}}},56799:function(c,u,f){"use strict";f.d(u,{G:function(){return Vec2d}});var g=f(31986);let Vec2d=class Vec2d{constructor(c=0,u=0,f=1){this.x=c,this.y=u,this.z=f}get pressure(){return this.z}set(c=this.x,u=this.y,f=this.z){return this.x=c,this.y=u,this.z=f,this}setTo({x:c=0,y:u=0,z:f=1}){return this.x=c,this.y=u,this.z=f,this}rot(c){if(0===c)return this;let{x:u,y:f}=this,g=Math.sin(c),b=Math.cos(c);return this.x=u*b-f*g,this.y=u*g+f*b,this}rotWith(c,u){if(0===u)return this;let f=this.x-c.x,g=this.y-c.y,b=Math.sin(u),v=Math.cos(u);return this.x=c.x+(f*v-g*b),this.y=c.y+(f*b+g*v),this}clone(){let{x:c,y:u,z:f}=this;return new Vec2d(c,u,f)}sub(c){return this.x-=c.x,this.y-=c.y,this}subXY(c,u){return this.x-=c,this.y-=u,this}subScalar(c){return this.x-=c,this.y-=c,this}add(c){return this.x+=c.x,this.y+=c.y,this}addXY(c,u){return this.x+=c,this.y+=u,this}addScalar(c){return this.x+=c,this.y+=c,this}clamp(c,u){return this.x=Math.max(this.x,c),this.y=Math.max(this.y,c),void 0!==u&&(this.x=Math.min(this.x,u),this.y=Math.min(this.y,u)),this}div(c){return this.x/=c,this.y/=c,this}divV(c){return this.x/=c.x,this.y/=c.y,this}mul(c){return this.x*=c,this.y*=c,this}mulV(c){return this.x*=c.x,this.y*=c.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(c,u){let f=Vec2d.Tan(c,this);return this.add(f.mul(u))}neg(){return this.x*=-1,this.y*=-1,this}cross(c){return this.x=this.y*c.z-this.z*c.y,this.y=this.z*c.x-this.x*c.z,this}dpr(c){return Vec2d.Dpr(this,c)}cpr(c){return Vec2d.Cpr(this,c)}len2(){return Vec2d.Len2(this)}len(){return Vec2d.Len(this)}pry(c){return Vec2d.Pry(this,c)}per(){let{x:c,y:u}=this;return this.x=u,this.y=-c,this}uni(){return Vec2d.Uni(this)}tan(c){return Vec2d.Tan(this,c)}dist(c){return Vec2d.Dist(this,c)}distanceToLineSegment(c,u){return Vec2d.DistanceToLineSegment(c,u,this)}slope(c){return Vec2d.Slope(this,c)}snapToGrid(c){return this.x=Math.round(this.x/c)*c,this.y=Math.round(this.y/c)*c,this}angle(c){return Vec2d.Angle(this,c)}toAngle(){return Vec2d.ToAngle(this)}lrp(c,u){return this.x=this.x+(c.x-this.x)*u,this.y=this.y+(c.y-this.y)*u,this}equals(c){return Vec2d.Equals(this,c)}equalsXY(c,u){return Vec2d.EqualsXY(this,c,u)}norm(){let c=this.len();return this.x=0===c?0:this.x/c,this.y=0===c?0:this.y/c,this}toFixed(){return Vec2d.ToFixed(this)}toString(){return Vec2d.ToString(Vec2d.ToFixed(this))}toJson(){return Vec2d.ToJson(this)}toArray(){return Vec2d.ToArray(this)}static Add(c,u){return new Vec2d(c.x+u.x,c.y+u.y)}static AddXY(c,u,f){return new Vec2d(c.x+u,c.y+f)}static Sub(c,u){return new Vec2d(c.x-u.x,c.y-u.y)}static SubXY(c,u,f){return new Vec2d(c.x-u,c.y-f)}static AddScalar(c,u){return new Vec2d(c.x+u,c.y+u)}static SubScalar(c,u){return new Vec2d(c.x-u,c.y-u)}static Div(c,u){return new Vec2d(c.x/u,c.y/u)}static Mul(c,u){return new Vec2d(c.x*u,c.y*u)}static DivV(c,u){return new Vec2d(c.x/u.x,c.y/u.y)}static MulV(c,u){return new Vec2d(c.x*u.x,c.y*u.y)}static Neg(c){return new Vec2d(-c.x,-c.y)}static Per(c){return new Vec2d(c.y,-c.x)}static Dist2(c,u){return Vec2d.Sub(c,u).len2()}static Abs(c){return new Vec2d(Math.abs(c.x),Math.abs(c.y))}static Dist(c,u){return Math.hypot(c.y-u.y,c.x-u.x)}static Dpr(c,u){return c.x*u.x+c.y*u.y}static Cross(c,u){return new Vec2d(c.y*u.z-c.z*u.y,c.z*u.x-c.x*u.z)}static Cpr(c,u){return c.x*u.y-u.x*c.y}static Len2(c){return c.x*c.x+c.y*c.y}static Len(c){return Math.hypot(c.x,c.y)}static Pry(c,u){return Vec2d.Dpr(c,u)/Vec2d.Len(u)}static Uni(c){return Vec2d.Div(c,Vec2d.Len(c))}static Tan(c,u){return Vec2d.Uni(Vec2d.Sub(c,u))}static Min(c,u){return new Vec2d(Math.min(c.x,u.x),Math.min(c.y,u.y))}static Max(c,u){return new Vec2d(Math.max(c.x,u.x),Math.max(c.y,u.y))}static From({x:c,y:u,z:f=1}){return new Vec2d(c,u,f)}static FromArray(c){return new Vec2d(c[0],c[1])}static Rot(c,u=0){let f=Math.sin(u),g=Math.cos(u);return new Vec2d(c.x*g-c.y*f,c.x*f+c.y*g)}static RotWith(c,u,f){let g=c.x-u.x,b=c.y-u.y,v=Math.sin(f),x=Math.cos(f);return new Vec2d(u.x+(g*x-b*v),u.y+(g*v+b*x))}static NearestPointOnLineThroughPoint(c,u,f){return Vec2d.Mul(u,Vec2d.Sub(f,c).pry(u)).add(c)}static NearestPointOnLineSegment(c,u,f,g=!0){let b=Vec2d.Tan(u,c),v=Vec2d.Add(c,Vec2d.Mul(b,Vec2d.Sub(f,c).pry(b)));if(g){if(v.x<Math.min(c.x,u.x))return Vec2d.Cast(c.x<u.x?c:u);if(v.x>Math.max(c.x,u.x))return Vec2d.Cast(c.x>u.x?c:u);if(v.y<Math.min(c.y,u.y))return Vec2d.Cast(c.y<u.y?c:u);if(v.y>Math.max(c.y,u.y))return Vec2d.Cast(c.y>u.y?c:u)}return v}static DistanceToLineThroughPoint(c,u,f){return Vec2d.Dist(f,Vec2d.NearestPointOnLineThroughPoint(c,u,f))}static DistanceToLineSegment(c,u,f,g=!0){return Vec2d.Dist(f,Vec2d.NearestPointOnLineSegment(c,u,f,g))}static Snap(c,u=1){return new Vec2d(Math.round(c.x/u)*u,Math.round(c.y/u)*u)}static Cast(c){return c instanceof Vec2d?c:Vec2d.From(c)}static Slope(c,u){return c.x===u.y?NaN:(c.y-u.y)/(c.x-u.x)}static Angle(c,u){return Math.atan2(u.y-c.y,u.x-c.x)}static Lrp(c,u,f){return Vec2d.Sub(u,c).mul(f).add(c)}static Med(c,u){return new Vec2d((c.x+u.x)/2,(c.y+u.y)/2)}static Equals(c,u){return 1e-4>Math.abs(c.x-u.x)&&1e-4>Math.abs(c.y-u.y)}static EqualsXY(c,u,f){return c.x===u&&c.y===f}static Clockwise(c,u,f){return(f.x-c.x)*(u.y-c.y)-(u.x-c.x)*(f.y-c.y)<0}static Rescale(c,u){let f=Vec2d.Len(c);return new Vec2d(u*c.x/f,u*c.y/f)}static ScaleWithOrigin(c,u,f){return Vec2d.Sub(c,f).mul(u).add(f)}static ToFixed(c,u=2){return new Vec2d(+c.x.toFixed(u),+c.y.toFixed(u),+c.z.toFixed(u))}static Nudge(c,u,f){return Vec2d.Add(c,Vec2d.Tan(u,c).mul(f))}static ToString(c){return`${c.x}, ${c.y}`}static ToAngle(c){let u=Math.atan2(c.y,c.x);return u<0&&(u+=2*Math.PI),u}static FromAngle(c,u=1){return new Vec2d(Math.cos(c)*u,Math.sin(c)*u)}static ToArray(c){return[c.x,c.y,c.z]}static ToJson(c){let{x:u,y:f,z:g}=c;return{x:u,y:f,z:g}}static Average(c){let u=c.length,f=new Vec2d(0,0);for(let g=0;g<u;g++)f.add(c[g]);return f.div(u)}static Clamp(c,u,f){return void 0===f?new Vec2d(Math.min(Math.max(c.x,u)),Math.min(Math.max(c.y,u))):new Vec2d(Math.min(Math.max(c.x,u),f),Math.min(Math.max(c.y,u),f))}static PointsBetween(c,u,f=6){let b=[];for(let v=0;v<f;v++){let x=g.L.easeInQuad(v/(f-1)),w=Vec2d.Lrp(c,u,x);w.z=Math.min(1,.5+.65*Math.abs(.5-ease(x))),b.push(w)}return b}static SnapToGrid(c,u=8){return new Vec2d(Math.round(c.x/u)*u,Math.round(c.y/u)*u)}};let ease=c=>c<.5?2*c*c:-1+(4-2*c)*c},31986:function(c,u,f){"use strict";f.d(u,{L:function(){return g}});let g={linear:c=>c,easeInQuad:c=>c*c,easeOutQuad:c=>c*(2-c),easeInOutQuad:c=>c<.5?2*c*c:-1+(4-2*c)*c,easeInCubic:c=>c*c*c,easeOutCubic:c=>--c*c*c+1,easeInOutCubic:c=>c<.5?4*c*c*c:(c-1)*(2*c-2)*(2*c-2)+1,easeInQuart:c=>c*c*c*c,easeOutQuart:c=>1- --c*c*c*c,easeInOutQuart:c=>c<.5?8*c*c*c*c:1-8*--c*c*c*c,easeInQuint:c=>c*c*c*c*c,easeOutQuint:c=>1+--c*c*c*c*c,easeInOutQuint:c=>c<.5?16*c*c*c*c*c:1+16*--c*c*c*c*c,easeInSine:c=>1-Math.cos(c*Math.PI/2),easeOutSine:c=>Math.sin(c*Math.PI/2),easeInOutSine:c=>-(Math.cos(Math.PI*c)-1)/2,easeInExpo:c=>c<=0?0:Math.pow(2,10*c-10),easeOutExpo:c=>c>=1?1:1-Math.pow(2,-10*c),easeInOutExpo:c=>c<=0?0:c>=1?1:c<.5?Math.pow(2,20*c-10)/2:(2-Math.pow(2,-20*c+10))/2}},84137:function(c,u,f){"use strict";f.d(u,{W:function(){return Edge2d}});var g=f(56799),b=f(30224),v=f(74519);let Edge2d=class Edge2d extends v.l{start;end;d;u;ul;constructor(c){super({...c,isClosed:!1,isFilled:!1});let{start:u,end:f}=c;this.start=u,this.end=f,this.d=u.clone().sub(f),this.u=this.d.clone().uni(),this.ul=this.u.len()}_length;get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(c){let{start:u,end:f,u:b,ul:v}=this;if(0===v)return u;let x=g.G.Sub(c,u).dpr(b)/v,w=u.x+b.x*x;if(w<Math.min(u.x,f.x))return u.x<f.x?u:f;if(w>Math.max(u.x,f.x))return u.x>f.x?u:f;let _=u.y+b.y*x;return _<Math.min(u.y,f.y)?u.y<f.y?u:f:_>Math.max(u.y,f.y)?u.y>f.y?u:f:new g.G(w,_)}hitTestLineSegment(c,u,f){return(0,b.cB)(c,u,this.start,this.end)}}},74519:function(c,u,f){"use strict";f.d(u,{l:function(){return Geometry2d}});var g=f(99303),b=f(56799),v=f(46166);let Geometry2d=class Geometry2d{isFilled=!1;isClosed=!0;isLabel=!1;isSnappable=!0;constructor(c){this.isFilled=c.isFilled,this.isClosed=c.isClosed,this.isSnappable=c.isSnappable??!1,this.isLabel=c.isLabel??!1}hitTestPoint(c,u=0,f=!1){return this.distanceToPoint(c,f)<=u}distanceToPoint(c,u=!1){let f=c.dist(this.nearestPoint(c));return this.isClosed&&(this.isFilled||u)&&(0,v.Of)(c,this.vertices)?-f:f}distanceToLineSegment(c,u){let f=this.nearestPointOnLineSegment(c,u),g=b.G.DistanceToLineSegment(c,u,f);return this.isClosed&&this.isFilled&&(0,v.Of)(f,this.vertices)?-g:g}hitTestLineSegment(c,u,f=0){return this.distanceToLineSegment(c,u)<=f}nearestPointOnLineSegment(c,u){let f,g=1/0;for(let v=0;v<this.vertices.length;v++){let x=this.vertices[v],w=b.G.DistanceToLineSegment(c,u,x);w<g&&(g=w,f=x)}if(!f)throw Error("nearest point not found");return f}isPointInBounds(c,u=0){let{bounds:f}=this;return!(c.x<f.minX-u||c.y<f.minY-u||c.x>f.maxX+u||c.y>f.maxY+u)}_vertices;get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return g.No.FromPoints(this.vertices)}_bounds;get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}_snapPoints;get snapPoints(){return this._snapPoints||(this._snapPoints=this.bounds.snapPoints),this._snapPoints}get center(){return this.bounds.center}_area;get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;let{vertices:c}=this,u=0;for(let f=0,g=c.length;f<g;f++){let b=c[f],v=c[(f+1)%g];u+=b.x*v.y-v.x*b.y}return u/2}toSimpleSvgPath(){let c="",{vertices:u}=this,f=u.length;if(0===f)return c;c+=`M${u[0].x},${u[0].y}`;for(let g=1;g<f;g++)c+=`L${u[g].x},${u[g].y}`;return this.isClosed&&(c+="Z"),c}}},87684:function(c,u,f){"use strict";f.d(u,{m:function(){return Group2d}});var g=f(99303),b=f(74519);let Group2d=class Group2d extends b.l{children;constructor(c){super({...c,isClosed:!0,isFilled:!1});let{children:u}=c;if(0===u.length)throw Error("Group2d must have at least one child");this.children=u}getVertices(){return this.children.filter(c=>!c.isLabel).flatMap(c=>c.vertices)}nearestPoint(c){let u,f=1/0,{children:g}=this;if(0===g.length)throw Error("no children");for(let b of g){let g=b.nearestPoint(c),v=g.dist(c);v<f&&(f=v,u=g)}if(!u)throw Error("nearest point not found");return u}distanceToPoint(c,u=!1){return Math.min(...this.children.map((f,g)=>f.distanceToPoint(c,u||g>0)))}hitTestPoint(c,u,f){return!!this.children.filter(c=>!c.isLabel).find(g=>g.hitTestPoint(c,u,f))}hitTestLineSegment(c,u,f){return!!this.children.filter(c=>!c.isLabel).find(g=>g.hitTestLineSegment(c,u,f))}getArea(){return this.children[0].area}toSimpleSvgPath(){let c="";for(let u of this.children)c+=u.toSimpleSvgPath();let u=g.No.FromPoints(this.vertices).corners;for(let f=0,g=u.length;f<g;f++){let b=u[f],v=u[(f-1+g)%g],x=b.dist(v),w=u[(f+1)%g],_=b.dist(w),k=b.clone().lrp(v,4/x),E=b.clone().lrp(w,4/_);c+=`M${k.x},${k.y} L${b.x},${b.y} L${E.x},${E.y} `}return c}}},92042:function(c,u,f){"use strict";f.d(u,{w:function(){return Polygon2d}});var g=f(86368);let Polygon2d=class Polygon2d extends g.q{constructor(c){super({...c}),this.isClosed=!0}}},86368:function(c,u,f){"use strict";f.d(u,{q:function(){return Polyline2d}});var g=f(84137),b=f(74519);let Polyline2d=class Polyline2d extends b.l{points;constructor(c){super({isClosed:!1,isFilled:!1,...c});let{points:u}=c;this.points=u}_segments;get segments(){if(!this._segments){this._segments=[];let{vertices:c}=this;for(let u=0,f=c.length-1;u<f;u++){let f=c[u],b=c[u+1];this._segments.push(new g.W({start:f,end:b}))}this.isClosed&&this._segments.push(new g.W({start:c[c.length-1],end:c[0]}))}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce((c,u)=>c+u.length,0)),this._length}getVertices(){return this.points}nearestPoint(c){let u,f;let{segments:g}=this,b=this.points[0],v=1/0;for(let x=0;x<g.length;x++)(f=(u=g[x].nearestPoint(c)).dist(c))<v&&(b=u,v=f);return b}hitTestLineSegment(c,u,f){return this.segments.some(g=>g.hitTestLineSegment(c,u,f))}}},29234:function(c,u,f){"use strict";f.d(u,{z:function(){return Rectangle2d}});var g=f(99303),b=f(56799),v=f(92042);let Rectangle2d=class Rectangle2d extends v.w{x;y;w;h;constructor(c){let{x:u=0,y:f=0,width:g,height:v}=c;super({...c,points:[new b.G(u,f),new b.G(u+g,f),new b.G(u+g,f+v),new b.G(u,f+v)]}),this.x=u,this.y=f,this.w=g,this.h=v}getBounds(){return new g.No(this.x,this.y,this.w,this.h)}}},30224:function(c,u,f){"use strict";f.d(u,{Gc:function(){return intersectLineSegmentPolyline},UQ:function(){return polygonsIntersect},XS:function(){return intersectCirclePolyline},ZM:function(){return intersectLineSegmentCircle},bO:function(){return intersectCircleCircle},cB:function(){return linesIntersect},h9:function(){return intersectCirclePolygon},qZ:function(){return intersectLineSegmentPolygon},tY:function(){return intersectPolygonPolygon}});var g=f(46166),b=f(56799);function intersectLineSegmentLineSegment(c,u,f,g){let v=c.x-f.x,x=c.y-f.y,w=g.x-f.x,_=g.y-f.y,k=u.x-c.x,E=u.y-c.y,T=w*x-_*v,$=k*x-E*v,I=_*k-w*E;if(0===T||0===$||0===I)return null;if(0!==I){let u=T/I,f=$/I;if(0<=u&&u<=1&&0<=f&&f<=1)return b.G.AddXY(c,u*k,u*E)}return null}function intersectLineSegmentCircle(c,u,f,g){let v=(u.x-c.x)*(u.x-c.x)+(u.y-c.y)*(u.y-c.y),x=2*((u.x-c.x)*(c.x-f.x)+(u.y-c.y)*(c.y-f.y)),w=f.x*f.x+f.y*f.y+c.x*c.x+c.y*c.y-2*(f.x*c.x+f.y*c.y)-g*g,_=x*x-4*v*w;if(_<0||0===_)return null;let k=Math.sqrt(_),E=(-x+k)/(2*v),T=(-x-k)/(2*v);if((E<0||E>1)&&(T<0||T>1))return null;let $=[];return(0<=E&&E<=1&&$.push(b.G.Lrp(c,u,E)),0<=T&&T<=1&&$.push(b.G.Lrp(c,u,T)),0===$.length)?null:$}function intersectLineSegmentPolyline(c,u,f){let g;let b=[];for(let v=0,x=f.length-1;v<x;v++)(g=intersectLineSegmentLineSegment(c,u,f[v],f[v+1]))&&b.push(g);return 0===b.length?null:b}function intersectLineSegmentPolygon(c,u,f){let g;let b=[];for(let v=1,x=f.length;v<x+1;v++)(g=intersectLineSegmentLineSegment(c,u,f[v-1],f[v%f.length]))&&b.push(g);return 0===b.length?null:b}function intersectCircleCircle(c,u,f,g){let v=f.x-c.x,x=f.y-c.y,w=Math.sqrt(v*v+x*x),_=(w*w-g*g+u*u)/(2*w),k=Math.sqrt(u*u-_*_);return v/=w,x/=w,[new b.G(c.x+v*_-x*k,c.y+x*_+v*k),new b.G(c.x+v*_+x*k,c.y+x*_-v*k)]}function intersectCirclePolygon(c,u,f){let g;let b=[];for(let v=0,x=f.length;v<x;v++)(g=intersectLineSegmentCircle(f[v],f[(v+1)%f.length],c,u))&&b.push(...g);return 0===b.length?null:b}function intersectCirclePolyline(c,u,f){let g;let b=[];for(let v=1,x=f.length;v<x;v++)(g=intersectLineSegmentCircle(f[v-1],f[v],c,u))&&b.push(...g);return 0===b.length?null:b}function ccw(c,u,f){return(f.y-c.y)*(u.x-c.x)>(u.y-c.y)*(f.x-c.x)}function linesIntersect(c,u,f,g){return ccw(c,f,g)!==ccw(u,f,g)&&ccw(c,u,f)!==ccw(c,u,g)}function intersectPolygonPolygon(c,u){let f,b,v,x;let w=[];for(let b=0,v=c.length;b<v;b++)f=c[b],(0,g.Of)(f,u)&&w.push(f);for(let b=0,v=u.length;b<v;b++)f=u[b],(0,g.Of)(f,c)&&w.push(f);for(let g=0,_=c.length;g<_;g++){f=c[g],b=c[(g+1)%c.length];for(let c=0,g=u.length;c<g;c++){v=u[c],x=u[(c+1)%u.length];let g=intersectLineSegmentLineSegment(f,b,v,x);null!==g&&w.push(g)}}return 0===w.length?null:orderClockwise(w)}function orderClockwise(c){let u=b.G.Average(c);return c.sort((c,f)=>b.G.Angle(u,c)-b.G.Angle(u,f))}function polygonsIntersect(c,u){let f,g;for(let b=0,v=c.length;b<v;b++){f=c[b],g=c[(b+1)%v];for(let c=0,b=u.length;c<b;c++)if(linesIntersect(f,g,u[c],u[(c+1)%b]))return!0}return!1}},46166:function(c,u,f){"use strict";f.d(u,{$Z:function(){return toDomPrecision},AV:function(){return isSafeFloat},C2:function(){return approximately},Cc:function(){return angleDelta},Ci:function(){return clampRadians},FH:function(){return toFixed},FO:function(){return isAngleBetween},Ht:function(){return degreesToRadians},Ib:function(){return _},KP:function(){return pointNearToLineSegment},LP:function(){return getStarBounds},M7:function(){return lerpAngles},Oe:function(){return getPolygonVertices},Of:function(){return pointInPolygon},PI:function(){return v},Pl:function(){return getArcLength},Rp:function(){return perimeterOfEllipse},V7:function(){return pointInPolyline},VK:function(){return clockwiseAngleDist},WU:function(){return pointInEllipse},XD:function(){return getPointOnCircle},Xh:function(){return pointNearToPolyline},Y8:function(){return average},Yk:function(){return precise},Z7:function(){return shortAngleDist},Zd:function(){return toPrecision},_G:function(){return areAnglesCompatible},dv:function(){return k},ep:function(){return rangesOverlap},f5:function(){return canonicalizeRotation},gc:function(){return x},hQ:function(){return getSweep},mD:function(){return pointInCircle},mW:function(){return rangeIntersection},nD:function(){return snapAngle},pc:function(){return counterClockwiseAngleDist},qr:function(){return pointInRect},uZ:function(){return clamp},vi:function(){return radiansToDegrees},wM:function(){return pointInBounds},yE:function(){return longAngleDist},yo:function(){return w}});var g=f(99303),b=f(56799);function precise(c){return`${toDomPrecision(c.x)},${toDomPrecision(c.y)} `}function average(c,u){return`${toDomPrecision((c.x+u.x)/2)},${toDomPrecision((c.y+u.y)/2)} `}let v=Math.PI,x=v/2,w=2*v,_=Math.PI/180,k=Math.sin;function clamp(c,u,f){return Math.max(u,void 0!==f?Math.min(c,f):c)}function toPrecision(c,u=1e10){return c?Math.round(c*u)/u:0}function approximately(c,u,f=1e-6){return Math.abs(c-u)<=f}function perimeterOfEllipse(c,u){let f=Math.pow(c-u,2)/Math.pow(c+u,2);return v*(c+u)*(1+3*f/(10+Math.sqrt(4-3*f)))}function canonicalizeRotation(c){return(c%=w)<0?c+=w:0===c&&(c=0),c}function clockwiseAngleDist(c,u){return(c=canonicalizeRotation(c))>(u=canonicalizeRotation(u))&&(u+=w),u-c}function counterClockwiseAngleDist(c,u){return w-clockwiseAngleDist(c,u)}function shortAngleDist(c,u){let f=(u-c)%w;return 2*f%w-f}function longAngleDist(c,u){return w-shortAngleDist(c,u)}function lerpAngles(c,u,f){return c+shortAngleDist(c,u)*f}function angleDelta(c,u){return shortAngleDist(c,u)}function getSweep(c,u,f){return shortAngleDist(b.G.Angle(c,u),b.G.Angle(c,f))}function clampRadians(c){return(w+c)%w}function snapAngle(c,u){let f=w/u,g=Math.floor((clampRadians(c)+f/2)/f)*f%w;return g<v&&(g+=w),g>v&&(g-=w),g}function areAnglesCompatible(c,u){return c===u||approximately(c%(Math.PI/2)-u%(Math.PI/2),0)}function isAngleBetween(c,u,f){c=canonicalizeRotation(c),u=canonicalizeRotation(u),f=canonicalizeRotation(f);let g=Math.cos(c),b=Math.sin(c),v=Math.cos(u),x=Math.sin(u),w=Math.cos(f),_=Math.sin(f);return g*w+b*_>=0&&v*w+x*_>=0}function degreesToRadians(c){return c*v/180}function radiansToDegrees(c){return 180*c/v}function getArcLength(c,u,f,g){let b=getSweep(c,f,g);return u*w*(b/w)}function getPointOnCircle(c,u,f,g){return new b.G(c+f*Math.cos(g),u+f*Math.sin(g))}function getPolygonVertices(c,u,f){let g=c/2,v=u/2,_=[],k=1/0,E=1/0;for(let c=0;c<f;c++){let u=w/f,T=-x+c*u,$=g+g*Math.cos(T),I=v+v*Math.sin(T);$<k&&(k=$),I<E&&(E=I),_.push(new b.G($,I))}if(0!==k||0!==E)for(let c=0;c<_.length;c++){let u=_[c];u.x-=k,u.y-=E}return _}function rangesOverlap(c,u,f,g){return c<g&&f<u}function rangeIntersection(c,u,f,g){let b=Math.max(c,f),v=Math.min(u,g);return b<=v?[b,v]:null}let getStarBounds=(c,u,f)=>{let b=w/c/2,v=2*Math.floor(c/4);return new g.No(0,0,Math.cos(-x+v*b)*u/2-Math.cos(-x+(2*c-v)*b)*u/2,Math.sin(-x+2*Math.floor(c/2)*b)*f/2-Math.sin(-x+0*b)*f/2)};function cross(c,u,f){return(u.x-c.x)*(f.y-c.y)-(f.x-c.x)*(u.y-c.y)}function pointInCircle(c,u,f){return b.G.Dist(c,u)<=f}function pointInEllipse(c,u,f,g,v=0){v=v||0;let x=Math.cos(v),w=Math.sin(v),_=b.G.Sub(c,u),k=x*_.x+w*_.y,E=w*_.x-x*_.y;return k*k/(f*f)+E*E/(g*g)<=1}function pointInRect(c,u,f){return!(c.x<u.x||c.x>u.x+f.x||c.y<u.y||c.y>u.y+f.y)}function pointInPolygon(c,u){let f,g,b=0;for(let v=0;v<u.length;v++)f=u[v],g=u[(v+1)%u.length],f.y<=c.y?g.y>c.y&&cross(f,g,c)>0&&(b+=1):g.y<=c.y&&0>cross(f,g,c)&&(b-=1);return 0!==b}function pointInBounds(c,u){return!(c.x<u.minX||c.x>u.maxX||c.y<u.minY||c.y>u.maxY)}function pointInPolyline(c,u,f=3){for(let g=1;g<u.length;g++)if(b.G.DistanceToLineSegment(u[g-1],u[g],c)<f)return!0;return!1}function pointNearToPolyline(c,u,f=8){let g=u.length;for(let v=1;v<g;v++){let g=u[v-1],x=u[v],w=b.G.DistanceToLineSegment(g,x,c);if(w<f)return!0}return!1}function pointNearToLineSegment(c,u,f,g=8){let v=b.G.DistanceToLineSegment(u,f,c);return v<g}function toDomPrecision(c){return+c.toFixed(4)}function toFixed(c){return+c.toFixed(2)}let isSafeFloat=c=>Math.abs(c)<Number.MAX_SAFE_INTEGER},9006:function(c,u,f){"use strict";f.d(u,{_:function(){return ReadonlySharedStyleMap},o:function(){return SharedStyleMap}});var g=f(47110);function sharedStyleEquals(c,u){if(!u)return!1;switch(c.type){case"mixed":return"mixed"===u.type;case"shared":return"shared"===u.type&&c.value===u.value;default:throw(0,g.iP)(c)}}let ReadonlySharedStyleMap=class ReadonlySharedStyleMap{map;constructor(c){this.map=new Map(c)}get(c){return this.map.get(c)}getAsKnownValue(c){let u=this.get(c);if(u&&"mixed"!==u.type)return u.value}get size(){return this.map.size}equals(c){if(this.size!==c.size)return!1;let u=new Set;for(let[f,g]of this){if(!sharedStyleEquals(g,c.get(f)))return!1;u.add(f)}for(let[f,g]of c)if(!u.has(f)&&!sharedStyleEquals(g,this.get(f)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}};let SharedStyleMap=class SharedStyleMap extends ReadonlySharedStyleMap{set(c,u){this.map.set(c,u)}applyValue(c,u){let f=this.get(c);if(!f){this.set(c,{type:"shared",value:u});return}switch(f.type){case"mixed":return;case"shared":f.value!==u&&this.set(c,{type:"mixed"});return;default:(0,g.iP)(f,"type")}}}},91230:function(c,u,f){"use strict";f.d(u,{_:function(){return WeakMapCache}});let WeakMapCache=class WeakMapCache{items=new WeakMap;get(c,u){return this.items.has(c)||this.items.set(c,u(c)),this.items.get(c)}access(c){return this.items.get(c)}set(c,u){this.items.set(c,u)}has(c){return this.items.has(c)}invalidate(c){this.items.delete(c)}bust(){this.items=new WeakMap}}},50280:function(c,u,f){"use strict";function dataUrlToFile(c,u,f){return fetch(c).then(function(c){return c.arrayBuffer()}).then(function(c){return new File([c],u,{type:f})})}f.d(u,{B:function(){return dataUrlToFile}})},41605:function(c,u,f){"use strict";function getIncrementedName(c,u){let f=c,g=new Set(u);for(;g.has(f);)f=/^.*(\d+)$/.exec(f)?.[1]?f.replace(/(\d+)(?=\D?)$/,c=>(+c+1).toString()):`${f} 1`;return f}f.d(u,{u:function(){return getIncrementedName}})},10853:function(c,u,f){"use strict";f.d(u,{B:function(){return getReorderingShapesChanges}});var g=f(47110),b=f(64078);function getReorderingShapesChanges(c,u,f){if(0===f.length)return[];let b=new Map;for(let u of(0,g.oA)(f.map(u=>c.getShape(u)))){let{parentId:f}=u;b.has(f)||b.set(f,{children:(0,g.oA)(c.getSortedChildIdsForParent(f).map(u=>c.getShape(u))),moving:new Set}),b.get(f).moving.add(u)}let v=[];switch(u){case"toBack":b.forEach(({moving:c,children:u})=>reorderToBack(c,u,v));break;case"toFront":b.forEach(({moving:c,children:u})=>reorderToFront(c,u,v));break;case"forward":b.forEach(({moving:c,children:u})=>reorderForward(c,u,v));break;case"backward":b.forEach(({moving:c,children:u})=>reorderBackward(c,u,v))}return v}function reorderToBack(c,u,f){let g,v;let x=u.length;if(c.size!==x){for(let f=0;f<x;f++){let b=u[f];if(c.has(b))g=b.index,c.delete(b);else{v=b.index;break}}if(0===c.size)return;{let u=(0,b.Xv)(g,v,c.size);f.push(...Array.from(c.values()).sort(b.hl).map((c,f)=>({...c,index:u[f]})))}}}function reorderToFront(c,u,f){let g,v;let x=u.length;if(c.size!==x){for(let f=x-1;f>-1;f--){let b=u[f];if(c.has(b))v=b.index,c.delete(b);else{g=b.index;break}}if(0===c.size)return;{let u=(0,b.Xv)(g,v,c.size);f.push(...Array.from(c.values()).sort(b.hl).map((c,f)=>({...c,index:u[f]})))}}}function reorderForward(c,u,f){let g=u.length;if(c.size===g)return;let v={name:"skipping"};for(let x=0;x<g;x++){let g=c.has(u[x]);switch(v.name){case"skipping":if(!g)continue;v={name:"selecting",selectIndex:x};break;case"selecting":{if(g)continue;let{selectIndex:c}=v;(0,b.Xv)(u[x].index,u[x+1]?.index,x-c).forEach((g,b)=>f.push({...u[c+b],index:g})),v={name:"skipping"}}}}}function reorderBackward(c,u,f){let g=u.length;if(c.size===g)return;let v={name:"skipping"};for(let x=g-1;x>-1;x--){let g=c.has(u[x]);switch(v.name){case"skipping":if(!g)continue;v={name:"selecting",selectIndex:x};break;case"selecting":if(g)continue;(0,b.Xv)(u[x-1]?.index,u[x].index,v.selectIndex-x).forEach((c,g)=>{f.push({...u[x+g+1],index:c})}),v={name:"skipping"}}}}},64078:function(c,u,f){"use strict";f.d(u,{_L:function(){return getIndexAbove},Xg:function(){return getIndexBelow},eI:function(){return getIndexBetween},H$:function(){return getIndices},vw:function(){return getIndicesAbove},dk:function(){return getIndicesBelow},Xv:function(){return getIndicesBetween},hl:function(){return sortByIndex}});let g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",b="A00000000000000000000000000";function getIntegerLength(c){if(c>="a"&&c<="z")return c.charCodeAt(0)-97+2;if(c>="A"&&c<="Z")return 90-c.charCodeAt(0)+2;throw Error("Invalid index key head: "+c)}function validateInteger(c){if(c.length!==getIntegerLength(c.charAt(0)))throw Error("invalid integer part of index key: "+c)}function isNotUndefined(c){if(void 0===c)throw Error("n is undefined")}function incrementInteger(c){validateInteger(c);let[u,...f]=c.split(""),b=!0;for(let c=f.length-1;b&&c>=0;c--){let u=g.indexOf(f[c])+1;u===g.length?f[c]="0":(f[c]=g.charAt(u),b=!1)}if(!b)return u+f.join("");{if("Z"===u)return"a0";if("z"===u)return;let c=String.fromCharCode(u.charCodeAt(0)+1);return c>"a"?f.push("0"):f.pop(),c+f.join("")}}function decrementInteger(c){validateInteger(c);let[u,...f]=c.split(""),b=!0;for(let c=f.length-1;b&&c>=0;c--){let u=g.indexOf(f[c])-1;-1===u?f[c]=g.slice(-1):(f[c]=g.charAt(u),b=!1)}if(!b)return u+f.join("");{if("a"===u)return"Z"+g.slice(-1);if("A"===u)return;let c=String.fromCharCode(u.charCodeAt(0)-1);return c<"Z"?f.push(g.slice(-1)):f.pop(),c+f.join("")}}function midpoint(c,u){if(void 0!==u&&c>=u)throw Error(c+" >= "+u);if("0"===c.slice(-1)||u&&"0"===u.slice(-1))throw Error("trailing zero");if(u){let f=0;for(;(c.charAt(f)||"0")===u.charAt(f);)f++;if(f>0)return u.slice(0,f)+midpoint(c.slice(f),u.slice(f))}let f=c?g.indexOf(c.charAt(0)):0,b=void 0!==u?g.indexOf(u.charAt(0)):g.length;if(b-f>1){let c=Math.round(.5*(f+b));return g.charAt(c)}return u&&u.length>1?u.slice(0,1):g.charAt(f)+midpoint(c.slice(1),void 0)}function getIntegerPart(c){let u=getIntegerLength(c.charAt(0));if(u>c.length)throw Error("invalid index: "+c);return c.slice(0,u)}function validateOrder(c){if(c===b)throw Error("invalid index: "+c);let u=getIntegerPart(c),f=c.slice(u.length);if("0"===f.slice(-1))throw Error("invalid index: "+c)}function generateKeyBetween(c,u){if(void 0!==c&&validateOrder(c),void 0!==u&&validateOrder(u),void 0!==c&&void 0!==u&&c>=u)throw Error(c+" >= "+u);if(void 0===c&&void 0===u)return"a0";if(void 0===c){if(void 0===u)throw Error("b is undefined");let c=getIntegerPart(u),f=u.slice(c.length);if(c===b)return c+midpoint("",f);if(c<u)return c;let g=decrementInteger(c);return isNotUndefined(g),g}if(void 0===u){let u=getIntegerPart(c),f=c.slice(u.length),g=incrementInteger(u);return void 0===g?u+midpoint(f,void 0):g}let f=getIntegerPart(c),g=c.slice(f.length),v=getIntegerPart(u),x=u.slice(v.length);if(f===v)return f+midpoint(g,x);let w=incrementInteger(f);return isNotUndefined(w),w<u?w:f+midpoint(g,void 0)}function generateNKeysBetween(c,u,f){if(0===f)return[];if(1===f)return[generateKeyBetween(c,u)];if(void 0===u){let g=generateKeyBetween(c,u),b=[g];for(let c=0;c<f-1;c++)b.push(g=generateKeyBetween(g,u));return b}if(void 0===c){let g=generateKeyBetween(c,u),b=[g];for(let u=0;u<f-1;u++)b.push(g=generateKeyBetween(c,g));return b.reverse(),b}let g=Math.floor(f/2),b=generateKeyBetween(c,u);return[...generateNKeysBetween(c,b,g),b,...generateNKeysBetween(b,u,f-g-1)]}function getIndicesBetween(c,u,f){return generateNKeysBetween(c,u,f)}function getIndicesAbove(c,u){return generateNKeysBetween(c,void 0,u)}function getIndicesBelow(c,u){return generateNKeysBetween(void 0,c,u)}function getIndexBetween(c,u){return generateNKeysBetween(c,u,1)[0]}function getIndexAbove(c){return generateNKeysBetween(c,void 0,1)[0]}function getIndexBelow(c){return generateNKeysBetween(void 0,c,1)[0]}function getIndices(c,u="a1"){return[u,...generateNKeysBetween(u,void 0,c)]}function sortByIndex(c,u){return c.index<u.index?-1:c.index>u.index?1:0}},17556:function(c,u,f){"use strict";f.d(u,{Z:function(){return applyRotationToSnapshotShapes},o:function(){return getRotationSnapshot}});var g=f(40563),b=f(47110),v=f(60498),x=f(46166),w=f(56799);function getRotationSnapshot({editor:c}){let{selectionRotation:u,selectionRotatedPageBounds:f,inputs:{originPagePoint:g},selectedShapes:v}=c;if(!f)return null;let x=f.center.clone().rotWith(f.point,u);return{selectionPageCenter:x,initialCursorAngle:x.angle(g),initialSelectionRotation:u,shapeSnapshots:v.map(u=>({shape:(0,b.v4)(u),initialPagePoint:c.getShapePageTransform(u.id).point()}))}}function applyRotationToSnapshotShapes({delta:c,editor:u,snapshot:f,stage:b}){let{selectionPageCenter:_,shapeSnapshots:k}=f;u.updateShapes(k.map(({shape:f,initialPagePoint:b})=>{let k=(0,g.YT)(f.parentId)?u.getShapePageTransform(f.parentId):v.y.Identity(),E=w.G.RotWith(b,_,c),T=v.y.applyToPoint(v.y.Inverse(k),E),$=(0,x.f5)(f.rotation+c);return{id:f.id,type:f.type,x:T.x,y:T.y,rotation:$}}));let E=[];k.forEach(({shape:c})=>{let f=u.getShape(c.id);if(!f)return;let g=u.getShapeUtil(c);if("start"===b||"one-off"===b){let u=g.onRotateStart?.(c);u&&E.push(u)}let v=g.onRotate?.(c,f);if(v&&E.push(v),"end"===b||"one-off"===b){let u=g.onRotateEnd?.(c,f);u&&E.push(u)}}),E.length>0&&u.updateShapes(E)}},65596:function(c,u,f){"use strict";f.d(u,{E:function(){return uniqueId}});var g=f(37350);function uniqueId(){return(0,g.nanoid)()}},39957:function(c,u,f){"use strict";f.d(u,{LZ:function(){return g},R0:function(){return EffectScheduler},SB:function(){return w},cn:function(){return Atom_atom},Fl:function(){return computed},e1:function(){return isUninitialized},Ym:function(){return react},zH:function(){return reactor},j:function(){return track},ay:function(){return transact},PS:function(){return transaction},vc:function(){return useComputed},BK:function(){return useQuickReactor},vC:function(){return useReactor},uC:function(){return useStateTracking},Hg:function(){return useValue},iJ:function(){return whyAmIRunning},qo:function(){return withDiff}});let ArraySet=class ArraySet{arraySize=0;array=Array(8);set=null;get isEmpty(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw Error("no set or array")}add(c){if(this.array){let u=this.array.indexOf(c);return -1===u&&(this.arraySize<8?(this.array[this.arraySize]=c,this.arraySize++):(this.set=new Set(this.array),this.array=null,this.set.add(c)),!0)}if(this.set)return!this.set.has(c)&&(this.set.add(c),!0);throw Error("no set or array")}remove(c){if(this.array){let u=this.array.indexOf(c);return -1!==u&&(this.array[u]=void 0,this.arraySize--,u!==this.arraySize&&(this.array[u]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(c)&&(this.set.delete(c),!0);throw Error("no set or array")}visit(c){if(this.array){for(let u=0;u<this.arraySize;u++){let f=this.array[u];void 0!==f&&c(f)}return}if(this.set){this.set.forEach(c);return}throw Error("no set or array")}};function isChild(c){return c&&"object"==typeof c&&"parents"in c}function haveParentsChanged(c){for(let u=0,f=c.parents.length;u<f;u++)if(c.parents[u].__unsafe__getWithoutCapture(),c.parents[u].lastChangedEpoch!==c.parentEpochs[u])return!0;return!1}let detach=(c,u)=>{if(c.children.remove(u)&&c.children.isEmpty&&isChild(c))for(let u=0,f=c.parents.length;u<f;u++)detach(c.parents[u],c)},attach=(c,u)=>{if(c.children.add(u)&&isChild(c))for(let u=0,f=c.parents.length;u<f;u++)attach(c.parents[u],c)};function equals(c,u){let f=c===u||Object.is(c,u)||!!(c&&u&&"function"==typeof c.equals&&c.equals(u));return f}let g=Object.freeze([]),b=Symbol.for("__@tldraw/state__"),v=globalThis;v[b]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):v[b]=!0;let CaptureStackFrame=class CaptureStackFrame{constructor(c,u){this.below=c,this.child=u}offset=0;numNewParents=0;maybeRemoved};let x=null;function startCapturingParents(c){x=new CaptureStackFrame(x,c)}function stopCapturingParents(){let c=x;x=c.below;let u=c.numNewParents>0||c.offset!==c.child.parents.length;if(u){for(let u=c.offset;u<c.child.parents.length;u++){let f=c.child.parents[u],g=c.child.parents.indexOf(f)>=c.offset;g&&detach(f,c.child)}if(c.child.parents.length=c.offset,c.child.parentEpochs.length=c.offset,x?.maybeRemoved)for(let u=0;u<x.maybeRemoved.length;u++){let f=x.maybeRemoved[u];-1===c.child.parents.indexOf(f)&&detach(f,c.child)}}}function maybeCaptureParent(c){if(x){let u=x.child.parents.indexOf(c);if(u<0&&(x.numNewParents++,x.child.isActivelyListening&&attach(c,x.child)),u<0||u>=x.offset){if(u!==x.offset&&u>0){let c=x.child.parents[x.offset];x.maybeRemoved?-1===x.maybeRemoved.indexOf(c)&&x.maybeRemoved.push(c):x.maybeRemoved=[c]}x.child.parents[x.offset]=c,x.child.parentEpochs[x.offset]=c.lastChangedEpoch,x.offset++}}}function whyAmIRunning(){let c=x?.child;if(!c)throw Error("whyAmIRunning() called outside of a reactive context");let u=[];for(let f=0;f<c.parents.length;f++){let g=c.parents[f];g.lastChangedEpoch>c.parentEpochs[f]&&u.push(g)}if(0===u.length)console.log(c.name,"is running but none of the parents changed");else for(let f of(console.log(c.name,"is running because:"),u))console.log("	",f.name,"changed =>",f.__unsafe__getWithoutCapture())}let w=Symbol("RESET_VALUE");let HistoryBuffer=class HistoryBuffer{constructor(c){this.capacity=c,this.buffer=Array(c)}index=0;buffer;pushEntry(c,u,f){if(void 0!==f){if(f===w){this.clear();return}this.buffer[this.index]=[c,u,f],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(c){let{index:u,capacity:f,buffer:g}=this;for(let b=0;b<f;b++){let v=(u-1+f-b)%f,x=g[v];if(!x)break;let[w,_]=x;if(0===b&&c>=_)return[];if(w<=c&&c<_){let c=b+1,u=Array(c);for(let b=0;b<c;b++)u[b]=g[(v+b)%f][2];return u}}return w}};let _=0,k=!1;function advanceGlobalEpoch(){_++}let Transaction=class Transaction{constructor(c){this.parent=c}initialAtomValues=new Map;get isRoot(){return null===this.parent}commit(){if(this.isRoot){let c=this.initialAtomValues;this.initialAtomValues=new Map,flushChanges(c.keys())}else this.initialAtomValues.forEach((c,u)=>{this.parent.initialAtomValues.has(u)||this.parent.initialAtomValues.set(u,c)})}abort(){_++,this.initialAtomValues.forEach((c,u)=>{u.set(c),u.historyBuffer?.clear()}),this.commit()}};function flushChanges(c){if(k)throw Error("cannot change atoms during reaction cycle");try{k=!0;let u=new Set,traverse=c=>{c.lastTraversedEpoch!==_&&(c.lastTraversedEpoch=_,"maybeScheduleEffect"in c?u.add(c):c.children.visit(traverse))};for(let u of c)u.children.visit(traverse);for(let c of u)c.maybeScheduleEffect()}finally{k=!1}}function atomDidChange(c,u){E?E.initialAtomValues.has(c)||E.initialAtomValues.set(c,u):flushChanges([c])}let E=null;function transaction(c){let u=new Transaction(E);E=u;try{let f=!1,g=c(()=>f=!0);return f?u.abort():u.commit(),g}catch(c){throw u.abort(),c}finally{E=E.parent}}function transact(c){return E?c():transaction(c)}let Atom_Atom=class Atom_Atom{constructor(c,u,f){if(this.name=c,this.current=u,this.isEqual=f?.isEqual??null,!f)return;f.historyLength&&(this.historyBuffer=new HistoryBuffer(f.historyLength)),this.computeDiff=f.computeDiff}isEqual;computeDiff;lastChangedEpoch=_;children=new ArraySet;historyBuffer;__unsafe__getWithoutCapture(){return this.current}get value(){return maybeCaptureParent(this),this.current}set(c,u){if(this.isEqual?.(this.current,c)??equals(this.current,c))return this.current;advanceGlobalEpoch(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,_,u??this.computeDiff?.(this.current,c,this.lastChangedEpoch,_)??w),this.lastChangedEpoch=_;let f=this.current;return this.current=c,atomDidChange(this,f),c}update(c){return this.set(c(this.current))}getDiffSince(c){return(maybeCaptureParent(this),c>=this.lastChangedEpoch)?g:this.historyBuffer?.getChangesSince(c)??w}};function Atom_atom(c,u,f){return new Atom_Atom(c,u,f)}let T=Symbol("UNINITIALIZED"),isUninitialized=c=>c===T;let WithDiff=class WithDiff{constructor(c,u){this.value=c,this.diff=u}};function withDiff(c,u){return new WithDiff(c,u)}let Computed_Computed=class Computed_Computed{constructor(c,u,f){this.name=c,this.derive=u,f?.historyLength&&(this.historyBuffer=new HistoryBuffer(f.historyLength)),this.computeDiff=f?.computeDiff,this.isEqual=f?.isEqual??equals}lastChangedEpoch=-1;lastTraversedEpoch=-1;lastCheckedEpoch=-1;parents=[];parentEpochs=[];children=new ArraySet;get isActivelyListening(){return!this.children.isEmpty}historyBuffer;state=T;computeDiff;isEqual;__unsafe__getWithoutCapture(){let c=-1===this.lastChangedEpoch;if(!c&&(this.lastCheckedEpoch===_||!haveParentsChanged(this)))return this.lastCheckedEpoch=_,this.state;try{startCapturingParents(this);let u=this.derive(this.state,this.lastCheckedEpoch),f=u instanceof WithDiff?u.value:u;if(this.state===T||!this.isEqual(f,this.state)){if(this.historyBuffer&&!c){let c=u instanceof WithDiff?u.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,_,c??this.computeDiff?.(this.state,f,this.lastCheckedEpoch,_)??w)}this.lastChangedEpoch=_,this.state=f}return this.lastCheckedEpoch=_,this.state}finally{stopCapturingParents()}}get value(){let c=this.__unsafe__getWithoutCapture();return maybeCaptureParent(this),c}getDiffSince(c){return(this.value,c>=this.lastChangedEpoch)?g:this.historyBuffer?.getChangesSince(c)??w}};function computedAnnotation(c={},u,f,g){let b=g.get,v=Symbol.for("__@tldraw/state__computed__"+f);return g.get=function(){let u=this[v];return u||Object.defineProperty(this,v,{enumerable:!1,configurable:!1,writable:!1,value:u=new Computed_Computed(f,b.bind(this),c)}),u.value},g}function computed(){if(1==arguments.length){let c=arguments[0];return(u,f,g)=>computedAnnotation(c,u,f,g)}return"string"==typeof arguments[0]?new Computed_Computed(arguments[0],arguments[1],arguments[2]):computedAnnotation(void 0,arguments[0],arguments[1],arguments[2])}let EffectScheduler=class EffectScheduler{constructor(c,u,f){this.name=c,this.runEffect=u,this._scheduleEffect=f?.scheduleEffect}_isActivelyListening=!1;get isActivelyListening(){return this._isActivelyListening}lastTraversedEpoch=-1;lastReactedEpoch=-1;_scheduleCount=0;get scheduleCount(){return this._scheduleCount}parentEpochs=[];parents=[];_scheduleEffect;maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==_){if(this.parents.length&&!haveParentsChanged(this)){this.lastReactedEpoch=_;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}maybeExecute=()=>{this._isActivelyListening&&this.execute()};attach(){this._isActivelyListening=!0;for(let c=0,u=this.parents.length;c<u;c++)attach(this.parents[c],this)}detach(){this._isActivelyListening=!1;for(let c=0,u=this.parents.length;c<u;c++)detach(this.parents[c],this)}execute(){try{startCapturingParents(this);let c=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=_,c}finally{stopCapturingParents()}}};function react(c,u,f){let g=new EffectScheduler(c,u,f);return g.attach(),g.scheduleEffect(),()=>{g.detach()}}function reactor(c,u,f){let g=new EffectScheduler(c,u,f);return{scheduler:g,start:c=>{let u=c?.force??!1;g.attach(),u?g.scheduleEffect():g.maybeScheduleEffect()},stop:()=>{g.detach()}}}var $=f(2265);function useStateTracking(c,u){let f=$.useRef(u);f.current=u;let[g,b,v]=$.useMemo(()=>{let u=null,g=new EffectScheduler(`useStateTracking(${c})`,()=>f.current?.(),{scheduleEffect(){u?.()}});return[g,c=>(u=c,()=>{u=null}),()=>g.scheduleCount]},[c]);return $.useSyncExternalStore(b,v,v),$.useEffect(()=>(g.attach(),g.maybeScheduleEffect(),()=>{g.detach()}),[g]),g.execute()}let I={apply:(c,u,f)=>useStateTracking(c.displayName??c.name??"tracked(???)",()=>c.apply(u,f))},M=Symbol.for("react.memo"),j=Symbol.for("react.forward_ref");function track(c){let u=null,f=c.$$typeof;return(f===M&&(u=(c=c.type).compare),f===j)?(0,$.memo)((0,$.forwardRef)(new Proxy(c.render,I))):(0,$.memo)(new Proxy(c,I),u)}function useComputed(){let c=arguments[0],u=arguments[1],f=3==arguments.length?void 0:arguments[2],g=3==arguments.length?arguments[2]:arguments[3];return(0,$.useMemo)(()=>computed(`useComputed(${c})`,u,f),g)}function useQuickReactor(c,u,f=g){(0,$.useEffect)(()=>{let f=new EffectScheduler(c,u);return f.attach(),f.execute(),()=>{f.detach()}},f)}function useReactor(c,u,f=[]){let g=(0,$.useMemo)(()=>new EffectScheduler(c,u,{scheduleEffect:c=>requestAnimationFrame(c)}),f);(0,$.useEffect)(()=>(g.attach(),g.execute(),()=>{g.detach()}),[g])}function useValue(){let c=arguments,u=3===c.length?c[2]:[c[0]],f=3===c.length?c[0]:`useValue(${c[0].name})`,g=(0,$.useRef)(!0);g.current=!0;let b=(0,$.useMemo)(()=>1===c.length?c[0]:computed(f,()=>{if(g.current)return c[1]();try{return c[1]()}catch{return{}}}),u);try{let{subscribe:c,getSnapshot:u}=(0,$.useMemo)(()=>({subscribe:c=>react(`useValue(${f})`,()=>{b.value,c()}),getSnapshot:()=>b.value}),[b]);return(0,$.useSyncExternalStore)(c,u,u)}finally{g.current=!1}}},83925:function(c,u,f){"use strict";f.d(u,{mW:function(){return IncrementalSetConstructor},qx:function(){return _},oX:function(){return RecordType},yh:function(){return Store},sS:function(){return StoreSchema},lS:function(){return assertIdType},ix:function(){return compareRecordVersions},$F:function(){return compareSchemas},ju:function(){return createRecordType},zn:function(){return defineMigrations},ZV:function(){return devFreeze},C$:function(){return getRecordVersion},Te:function(){return migrate},wJ:function(){return migrateRecord},kJ:function(){return reverseRecordsDiff},bs:function(){return squashRecordDiffs}});let IncrementalSetConstructor=class IncrementalSetConstructor{constructor(c){this.previousValue=c}nextValue;diff;get(){let c=this.diff?.removed?.size??0,u=this.diff?.added?.size??0;if(0!==c||0!==u)return{value:this.nextValue,diff:this.diff}}_add(c,u){this.nextValue??=new Set(this.previousValue),this.nextValue.add(c),this.diff??={},u?this.diff.removed?.delete(c):(this.diff.added??=new Set,this.diff.added.add(c))}add(c){let u=this.previousValue.has(c);if(u){let f=this.diff?.removed?.has(c);if(!f)return;return this._add(c,u)}let f=this.nextValue?.has(c);f||this._add(c,u)}_remove(c,u){this.nextValue??=new Set(this.previousValue),this.nextValue.delete(c),this.diff??={},u?(this.diff.removed??=new Set,this.diff.removed.add(c)):this.diff.added?.delete(c)}remove(c){let u=this.previousValue.has(c);if(!u){let f=this.diff?.added?.has(c);if(!f)return;return this._remove(c,u)}let f=this.diff?.removed?.has(c);f||this._remove(c,u)}};var g,b=f(47110),v=f(37350);let RecordType=class RecordType{constructor(c,u){this.typeName=c,this.createDefaultProperties=u.createDefaultProperties,this.migrations=u.migrations,this.validator=u.validator??{validate:c=>c},this.scope=u.scope??"document"}createDefaultProperties;migrations;validator;scope;create(c){let u={...this.createDefaultProperties(),id:this.createId()};for(let[f,g]of Object.entries(c))void 0!==g&&(u[f]=g);return u.typeName=this.typeName,u}clone(c){return{...(0,b.v4)(c),id:this.createId()}}createId(c){return this.typeName+":"+(c??(0,v.nanoid)())}createCustomId(c){return this.typeName+":"+c}parseId(c){if(!this.isId(c))throw Error(`ID "${c}" is not a valid ID for type "${this.typeName}"`);return c.slice(this.typeName.length+1)}isInstance=c=>c?.typeName===this.typeName;isId(c){if(!c)return!1;for(let u=0;u<this.typeName.length;u++)if(c[u]!==this.typeName[u])return!1;return":"===c[this.typeName.length]}withDefaultProperties(c){return new RecordType(this.typeName,{createDefaultProperties:c,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(c){return this.validator.validate(c)}};function createRecordType(c,u){return new RecordType(c,{createDefaultProperties:()=>({}),migrations:u.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:u.validator,scope:u.scope})}function assertIdType(c,u){if(!c||!u.isId(c))throw Error(`string ${JSON.stringify(c)} is not a valid ${u.typeName} id`)}var x=f(39957);let Cache=class Cache{items=new WeakMap;get(c,u){return this.items.has(c)||this.items.set(c,u(c)),this.items.get(c)}};var w=f(99780);function intersectSets(c){if(0===c.length)return new Set;let u=c[0],f=c.slice(1),g=new Set;for(let c of u)f.every(u=>u.has(c))&&g.add(c);return g}function diffSets(c,u){let f={};for(let g of u)c.has(g)||(f.added??=new Set,f.added.add(g));for(let g of c)u.has(g)||(f.removed??=new Set,f.removed.add(g));return f.added||f.removed?f:void 0}function objectMatchesQuery(c,u){for(let[f,g]of Object.entries(c)){let c=u[f];if("eq"in g&&c!==g.eq||"neq"in g&&c===g.neq||"gt"in g&&("number"!=typeof c||c<=g.gt))return!1}return!0}function executeQuery(c,u,f){let g=Object.fromEntries(Object.keys(f).map(c=>[c,new Set]));for(let[b,v]of Object.entries(f))if("eq"in v){let f=c.index(u,b),x=f.value.get(v.eq);if(x)for(let c of x)g[b].add(c)}else if("neq"in v){let f=c.index(u,b);for(let[c,u]of f.value)if(c!==v.neq)for(let c of u)g[b].add(c)}else if("gt"in v){let f=c.index(u,b);for(let[c,u]of f.value)if(c>v.gt)for(let c of u)g[b].add(c)}return intersectSets(Object.values(g))}let StoreQueries=class StoreQueries{constructor(c,u){this.atoms=c,this.history=u}indexCache=new Map;historyCache=new Map;filterHistory(c){if(this.historyCache.has(c))return this.historyCache.get(c);let u=(0,x.Fl)("filterHistory:"+c,(u,f)=>{if((0,x.e1)(u))return this.history.value;let g=this.history.getDiffSince(f);if(g===x.SB)return this.history.value;let v={added:{},removed:{},updated:{}},w=0,_=0,k=0;for(let u of g){for(let f of(0,b.UM)(u.added))if(f.typeName===c){if(v.removed[f.id]){let c=v.removed[f.id];delete v.removed[f.id],_--,c!==f&&(v.updated[f.id]=[c,f],k++)}else v.added[f.id]=f,w++}for(let[f,g]of(0,b.UM)(u.updated))g.typeName===c&&(v.added[g.id]?v.added[g.id]=g:v.updated[g.id]?v.updated[g.id]=[v.updated[g.id][0],g]:(v.updated[g.id]=[f,g],k++));for(let f of(0,b.UM)(u.removed))f.typeName===c&&(v.added[f.id]?(delete v.added[f.id],w--):(v.updated[f.id]?(v.removed[f.id]=v.updated[f.id][0],delete v.updated[f.id],k--):v.removed[f.id]=f,_++))}return w||_||k?(0,x.qo)(this.history.value,v):u},{historyLength:100});return this.historyCache.set(c,u),u}index(c,u){let f=c+":"+u;if(this.indexCache.has(f))return this.indexCache.get(f);let g=this.__uncached_createIndex(c,u);return this.indexCache.set(f,g),g}__uncached_createIndex(c,u){let f=this.filterHistory(c),fromScratch=()=>{f.value;let g=new Map;for(let f of(0,b.UM)(this.atoms.value)){let b=f.value;if(b.typeName===c){let c=b[u];g.has(c)||g.set(c,new Set),g.get(c).add(b.id)}}return g};return(0,x.Fl)("index:"+c+":"+u,(g,v)=>{let w,_;if((0,x.e1)(g))return fromScratch();let k=f.getDiffSince(v);if(k===x.SB)return fromScratch();let E=new Map,add=(c,u)=>{let f=E.get(c);f||(f=new IncrementalSetConstructor(g.get(c)??new Set)),f.add(u),E.set(c,f)},remove=(c,u)=>{let f=E.get(c);f||(f=new IncrementalSetConstructor(g.get(c)??new Set)),f.remove(u),E.set(c,f)};for(let f of k){for(let g of(0,b.UM)(f.added))if(g.typeName===c){let c=g[u];add(c,g.id)}for(let[g,v]of(0,b.UM)(f.updated))if(v.typeName===c){let c=g[u],f=v[u];c!==f&&(remove(c,v.id),add(f,v.id))}for(let g of(0,b.UM)(f.removed))if(g.typeName===c){let c=g[u];remove(c,g.id)}}for(let[c,u]of E){let f=u.get();f&&(w||(w=new Map(g)),_||(_=new Map),0===f.value.size?w.delete(c):w.set(c,f.value),_.set(c,f.diff))}return w&&_?(0,x.qo)(w,_):g},{historyLength:100})}record(c,u=()=>({}),f="record:"+c+(u?":"+u.toString():"")){let g=this.ids(c,u,f);return(0,x.Fl)(f,()=>{for(let c of g.value)return this.atoms.value[c]?.value})}records(c,u=()=>({}),f="records:"+c+(u?":"+u.toString():"")){let g=this.ids(c,u,"ids:"+f);return(0,x.Fl)(f,()=>[...g.value].map(c=>{let u=this.atoms.value[c];if(!u)throw Error("no atom found for record id: "+c);return u.value}))}ids(c,u=()=>({}),f="ids:"+c+(u?":"+u.toString():"")){let g=this.filterHistory(c),fromScratch=()=>{g.value;let f=u();return 0===Object.keys(f).length?new Set((0,b.UM)(this.atoms.value).flatMap(u=>{let f=u.value;return f.typeName===c?f.id:[]})):executeQuery(this,c,f)},fromScratchWithDiff=c=>{let u=fromScratch(),f=diffSets(c,u);return f?(0,x.qo)(u,f):c},v=(0,x.Fl)("ids_query:"+f,u,{isEqual:w});return(0,x.Fl)("query:"+f,(u,f)=>{let w=v.value;if((0,x.e1)(u))return fromScratch();if(f<v.lastChangedEpoch)return fromScratchWithDiff(u);let _=g.getDiffSince(f);if(_===x.SB)return fromScratchWithDiff(u);let k=new IncrementalSetConstructor(u);for(let u of _){for(let f of(0,b.UM)(u.added))f.typeName===c&&objectMatchesQuery(w,f)&&k.add(f.id);for(let[f,g]of(0,b.UM)(u.updated))g.typeName===c&&(objectMatchesQuery(w,g)?k.add(g.id):k.remove(g.id));for(let f of(0,b.UM)(u.removed))f.typeName===c&&k.remove(f.id)}let E=k.get();return E?(0,x.qo)(E.value,E.diff):u},{historyLength:50})}exec(c,u){let f=executeQuery(this,c,u);if(0===f.size)return x.LZ;let g=this.atoms.value;return[...f].map(c=>g[c].value)}};function devFreeze(c){return c}let Store=class Store{id=(0,v.nanoid)();atoms=(0,x.cn)("store_atoms",{});history=(0,x.cn)("history",0,{historyLength:1e3});query=new StoreQueries(this.atoms,this.history);listeners=new Set;historyAccumulator=new HistoryAccumulator;historyReactor;schema;props;scopedTypes;constructor(c){let{initialData:u,schema:f}=c;this.schema=f,this.props=c.props,u&&this.atoms.set((0,b.Ls)((0,b.EP)(u).map(([c,u])=>[c,(0,x.cn)("atom:"+c,this.schema.validateRecord(this,u,"initialize",null))]))),this.historyReactor=(0,x.zH)("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:c=>(0,b.xP)(c)}),this.scopedTypes={document:new Set((0,b.UM)(this.schema.types).filter(c=>"document"===c.scope).map(c=>c.typeName)),session:new Set((0,b.UM)(this.schema.types).filter(c=>"session"===c.scope).map(c=>c.typeName)),presence:new Set((0,b.UM)(this.schema.types).filter(c=>"presence"===c.scope).map(c=>c.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){let c=this.historyAccumulator.flush();for(let{changes:u,source:f}of c){let c=null,g=null,b=null;for(let{onHistory:v,filters:x}of this.listeners)if("all"===x.source||x.source===f){if("all"!==x.scope){if("document"===x.scope){if(!(g??=this.filterChangesByScope(u,"document")))continue;v({changes:g,source:f})}else if("session"===x.scope){if(!(c??=this.filterChangesByScope(u,"session")))continue;v({changes:c,source:f})}else{if(!(b??=this.filterChangesByScope(u,"presence")))continue;v({changes:b,source:f})}}else v({changes:u,source:f})}}}}filterChangesByScope(c,u){let f={added:(0,b.H4)(c.added,(c,f)=>this.scopedTypes[u].has(f.typeName)),updated:(0,b.H4)(c.updated,(c,f)=>this.scopedTypes[u].has(f[1].typeName)),removed:(0,b.H4)(c.removed,(c,f)=>this.scopedTypes[u].has(f.typeName))};return 0===Object.keys(f.added).length&&0===Object.keys(f.updated).length&&0===Object.keys(f.removed).length?null:f}updateHistory(c){this.historyAccumulator.add({changes:c,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,c)}validate(c){this.allRecords().forEach(u=>this.schema.validateRecord(this,u,c,null))}onBeforeCreate;onAfterCreate;onBeforeChange;onAfterChange;onBeforeDelete;onAfterDelete;_runCallbacks=!0;put=(c,u)=>{(0,x.ay)(()=>{let f;let g={},b={},v=this.atoms.__unsafe__getWithoutCapture(),w=null,_=!1,k=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,E=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,T=this.isMergingRemoteChanges?"remote":"user";for(let $=0,I=c.length;$<I;$++){f=c[$];let I=(w??v)[f.id];if(I){E&&(f=E(I.value,f,T));let c=I.__unsafe__getWithoutCapture();f=this.schema.validateRecord(this,f,u??"updateRecord",c),I.set(f);let b=I.__unsafe__getWithoutCapture();c!==b&&(_=!0,g[f.id]=[c,b])}else k&&(f=k(f,T)),_=!0,b[(f=this.schema.validateRecord(this,f,u??"createRecord",null)).id]=f,w||(w={...v}),w[f.id]=(0,x.cn)("atom:"+f.id,f)}if(w&&this.atoms.set(w),_&&(this.updateHistory({added:b,updated:g,removed:{}}),this._runCallbacks)){let{onAfterCreate:c,onAfterChange:u}=this;c&&Object.values(b).forEach(u=>{c(u,T)}),u&&Object.values(g).forEach(([c,f])=>{u(c,f,T)})}})};remove=c=>{(0,x.ay)(()=>{let u;let f=[],g=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(let u of c){let c=this.atoms.__unsafe__getWithoutCapture()[u];c&&!1===this.onBeforeDelete(c.value,g)&&f.push(u)}if(this.atoms.update(g=>{let b;for(let v of c)!f.includes(v)&&v in g&&(b||(b={...g}),u||(u={}),delete b[v],u[v]=g[v].value);return b??g}),u&&(this.updateHistory({added:{},updated:{},removed:u}),this.onAfterDelete&&this._runCallbacks)){let f;for(let b=0,v=c.length;b<v;b++)(f=u[c[b]])&&this.onAfterDelete(f,g)}})};get=c=>this.atoms.value[c]?.value;unsafeGetWithoutCapture=c=>this.atoms.value[c]?.__unsafe__getWithoutCapture();serialize=(c="document")=>{let u={};for(let[f,g]of(0,b.EP)(this.atoms.value)){let b=g.value;("all"===c||this.scopedTypes[c].has(b.typeName))&&(u[f]=b)}return u};getSnapshot(c="document"){return{store:this.serialize(c),schema:this.schema.serialize()}}migrateSnapshot(c){let u=this.schema.migrateStoreSnapshot(c);if("error"===u.type)throw Error(`Failed to migrate snapshot: ${u.reason}`);return{store:u.value,schema:this.schema.serialize()}}loadSnapshot(c){let u=this.schema.migrateStoreSnapshot(c);if("error"===u.type)throw Error(`Failed to migrate snapshot: ${u.reason}`);(0,x.ay)(()=>{this.clear(),this.put(Object.values(u.value)),this.ensureStoreIsUsable()})}allRecords=()=>(0,b.UM)(this.atoms.value).map(c=>c.value);clear=()=>{this.remove((0,b.GH)(this.atoms.value))};update=(c,u)=>{let f=this.atoms.value[c];if(!f){console.error(`Record ${c} not found. This is probably an error`);return}this.put([u(f.__unsafe__getWithoutCapture())])};has=c=>!!this.atoms.value[c];listen=(c,u)=>{this._flushHistory();let f={onHistory:c,filters:{source:u?.source??"all",scope:u?.scope??"all"}};return this.listeners.add(f),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(f),0===this.listeners.size&&this.historyReactor.stop()}};isMergingRemoteChanges=!1;mergeRemoteChanges=c=>{if(this.isMergingRemoteChanges)return c();try{this.isMergingRemoteChanges=!0,(0,x.ay)(c)}finally{this.isMergingRemoteChanges=!1}};extractingChanges(c){let u=[],f=this.historyAccumulator.intercepting(c=>u.push(c.changes));try{return(0,x.ay)(c),squashRecordDiffs(u)}finally{f()}}applyDiff(c,u=!0){let f=this._runCallbacks;try{this._runCallbacks=u,(0,x.ay)(()=>{let u=(0,b.UM)(c.added).concat((0,b.UM)(c.updated).map(([c,u])=>u)),f=(0,b.GH)(c.removed);u.length&&this.put(u),f.length&&this.remove(f)})}finally{this._runCallbacks=f}}createComputedCache=(c,u,f)=>{let g=new Cache;return{get:b=>{let v=this.atoms.value[b];if(v)return g.get(v,()=>{let g=f?(0,x.Fl)(v.name+":equals",()=>v.value,{isEqual:f}):v;return(0,x.Fl)(c+":"+b,()=>u(g.value))}).value}}};createSelectedComputedCache=(c,u,f)=>{let g=new Cache;return{get:b=>{let v=this.atoms.value[b];if(!v)return;let w=(0,x.Fl)(c+":"+b+":selector",()=>u(v.value));return g.get(v,()=>(0,x.Fl)(c+":"+b,()=>f(w.value))).value}}};getRecordType=c=>{let u=this.schema.types[c.typeName];if(!u)throw Error(`Record type ${c.typeName} not found`);return u};_integrityChecker;ensureStoreIsUsable(){this._integrityChecker??=this.schema.createIntegrityChecker(this),this._integrityChecker?.()}_isPossiblyCorrupted=!1;markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}};function squashRecordDiffs(c){let u={added:{},removed:{},updated:{}};for(let f of c){for(let[c,g]of(0,b.EP)(f.added))if(u.removed[c]){let f=u.removed[c];delete u.removed[c],f!==g&&(u.updated[c]=[f,g])}else u.added[c]=g;for(let[c,[g,v]]of(0,b.EP)(f.updated)){if(u.added[c]){u.added[c]=v,delete u.updated[c],delete u.removed[c];continue}if(u.updated[c]){u.updated[c][1]=v,delete u.removed[c];continue}u.updated[c]=f.updated[c],delete u.removed[c]}for(let[c,g]of(0,b.EP)(f.removed))u.added[c]?delete u.added[c]:u.updated[c]?(u.removed[c]=u.updated[c][0],delete u.updated[c]):u.removed[c]=g}return u}function squashHistoryEntries(c){let u;let f=[],g=c[0];for(let b=1,v=c.length;b<v;b++)u=c[b],g.source!==u.source?(f.push(g),g=u):g={source:g.source,changes:squashRecordDiffs([g.changes,u.changes])};return f.push(g),f}function reverseRecordsDiff(c){let u={added:c.removed,removed:c.added,updated:{}};for(let[f,g]of Object.values(c.updated))u.updated[f.id]=[g,f];return u}let HistoryAccumulator=class HistoryAccumulator{_history=[];_interceptors=new Set;intercepting(c){return this._interceptors.add(c),()=>{this._interceptors.delete(c)}}add(c){for(let u of(this._history.push(c),this._interceptors))u(c)}flush(){let c=squashHistoryEntries(this._history);return this._history=[],c}clear(){this._history=[]}hasChanges(){return this._history.length>0}};function isRecord(c){return"object"==typeof c&&null!==c&&"id"in c&&"typeName"in c}function defineMigrations(c){let{currentVersion:u,firstVersion:f,migrators:g={},subTypeKey:b,subTypeMigrations:v}=c;if("number"==typeof u&&"number"==typeof f){if(u===f)throw Error("Current version is equal to initial version.");if(u<f)throw Error("Current version is lower than initial version.")}return{firstVersion:f??0,currentVersion:u??0,migrators:g,subTypeKey:b,subTypeMigrations:v}}var _=((g=_||{}).IncompatibleSubtype="incompatible-subtype",g.UnknownType="unknown-type",g.TargetVersionTooNew="target-version-too-new",g.TargetVersionTooOld="target-version-too-old",g.MigrationError="migration-error",g.UnrecognizedSubtype="unrecognized-subtype",g);function getRecordVersion(c,u){let f=u.recordVersions[c.typeName];if(!f)return{rootVersion:0};if("subTypeKey"in f){let u=c[f.subTypeKey],g=f.subTypeVersions[u];return{rootVersion:f.version,subTypeVersion:g}}return{rootVersion:f.version}}function compareRecordVersions(c,u){if(c.rootVersion>u.rootVersion)return 1;if(c.rootVersion<u.rootVersion)return -1;if(null!=c.subTypeVersion&&null!=u.subTypeVersion){if(c.subTypeVersion>u.subTypeVersion)return 1;if(c.subTypeVersion<u.subTypeVersion)return -1}return 0}function migrateRecord({record:c,migrations:u,fromVersion:f,toVersion:g}){let b=f;if(!isRecord(c))throw Error("[migrateRecord] object is not a record");let{typeName:v,id:x,...w}=c,_=w;for(;b<g;){let c=b+1,f=u.migrators[c];if(!f)return{type:"error",reason:"target-version-too-new"};_=f.up(_),b=c}for(;b>g;){let c=b-1,f=u.migrators[b];if(!f)return{type:"error",reason:"target-version-too-old"};_=f.down(_),b=c}return{type:"success",value:{..._,id:x,typeName:v}}}function migrate({value:c,migrations:u,fromVersion:f,toVersion:g}){let b=f;for(;b<g;){let f=b+1,g=u.migrators[f];if(!g)return{type:"error",reason:"target-version-too-new"};c=g.up(c),b=f}for(;b>g;){let f=b-1,g=u.migrators[b];if(!g)return{type:"error",reason:"target-version-too-old"};c=g.down(c),b=f}return{type:"success",value:c}}let StoreSchema=class StoreSchema{constructor(c,u){this.types=c,this.options=u}static create(c,u){return new StoreSchema(c,u??{})}get currentStoreVersion(){return this.options.snapshotMigrations?.currentVersion??0}validateRecord(c,u,f,g){try{let c=(0,b.eg)(this.types,u.typeName);if(!c)throw Error(`Missing definition for record type ${u.typeName}`);return c.validate(u)}catch(b){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:c,record:u,phase:f,recordBefore:g,error:b});throw b}}migratePersistedRecord(c,u,f="up"){let g=(0,b.eg)(this.types,c.typeName),v=u.recordVersions[c.typeName];if(!v||!g)return{type:"error",reason:_.UnknownType};let x=g.migrations.currentVersion,w=v.version;if(x!==w){let u="up"===f?migrateRecord({record:c,migrations:g.migrations,fromVersion:w,toVersion:x}):migrateRecord({record:c,migrations:g.migrations,fromVersion:x,toVersion:w});if("error"===u.type)return u;c=u.value}if(!g.migrations.subTypeKey)return{type:"success",value:c};let k=g.migrations.subTypeMigrations?.[c[g.migrations.subTypeKey]],E="subTypeVersions"in v?v.subTypeVersions[c[g.migrations.subTypeKey]]:void 0;if(void 0===k)return{type:"error",reason:_.UnrecognizedSubtype};if(void 0===E)return{type:"error",reason:_.IncompatibleSubtype};let T="up"===f?migrateRecord({record:c,migrations:k,fromVersion:E,toVersion:k.currentVersion}):migrateRecord({record:c,migrations:k,fromVersion:k.currentVersion,toVersion:E});return"error"===T.type?T:{type:"success",value:T.value}}migrateStoreSnapshot(c){let{store:u}=c,f=this.options.snapshotMigrations;if(!f)return{type:"success",value:u};let g=f.currentVersion,v=c.schema.storeVersion??0;if(g<v)return{type:"error",reason:_.TargetVersionTooOld};if(g>v){let c=migrate({value:u,migrations:f,fromVersion:v,toVersion:g});if("error"===c.type)return c;u=c.value}let x=[];for(let f of(0,b.UM)(u)){let u=this.migratePersistedRecord(f,c.schema);if("error"===u.type)return u;u.value&&u.value!==f&&x.push(u.value)}if(x.length)for(let c of(u={...u},x))u[c.id]=c;return{type:"success",value:u}}createIntegrityChecker(c){return this.options.createIntegrityChecker?.(c)??void 0}serialize(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.currentVersion??0,recordVersions:Object.fromEntries((0,b.UM)(this.types).map(c=>[c.typeName,c.migrations.subTypeKey&&c.migrations.subTypeMigrations?{version:c.migrations.currentVersion,subTypeKey:c.migrations.subTypeKey,subTypeVersions:c.migrations.subTypeMigrations?Object.fromEntries(Object.entries(c.migrations.subTypeMigrations).map(([c,u])=>[c,u.currentVersion])):void 0}:{version:c.migrations.currentVersion}]))}}serializeEarliestVersion(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.firstVersion??0,recordVersions:Object.fromEntries((0,b.UM)(this.types).map(c=>[c.typeName,c.migrations.subTypeKey&&c.migrations.subTypeMigrations?{version:c.migrations.firstVersion,subTypeKey:c.migrations.subTypeKey,subTypeVersions:c.migrations.subTypeMigrations?Object.fromEntries(Object.entries(c.migrations.subTypeMigrations).map(([c,u])=>[c,u.firstVersion])):void 0}:{version:c.migrations.firstVersion}]))}}};let compareSchemas=(c,u)=>{if(c.schemaVersion>u.schemaVersion)return 1;if(c.schemaVersion<u.schemaVersion)return -1;if(c.storeVersion>u.storeVersion)return 1;if(c.storeVersion<u.storeVersion)return -1;for(let f of Object.keys(c.recordVersions)){let g=c.recordVersions[f],b=u.recordVersions[f];if(g.version>b.version)return 1;if(g.version<b.version)return -1;if("subTypeVersions"in g&&!("subTypeVersions"in b))return 1;if(!("subTypeVersions"in g)&&"subTypeVersions"in b)return -1;if("subTypeVersions"in g&&"subTypeVersions"in b)for(let c of Object.keys(g.subTypeVersions)){let u=g.subTypeVersions[c],f=b.subTypeVersions[c];if(u>f)return 1;if(u<f)return -1}}return 0}},55606:function(c,u,f){"use strict";let g,b,v,x,w;f.r(u),f.d(u,{ANIMATION_MEDIUM_MS:function(){return td.KD},ANIMATION_SHORT_MS:function(){return td.uJ},Arc2d:function(){return Arc2d},ArrayOfValidator:function(){return e6.UR},ArrowShapeArrowheadEndStyle:function(){return e8.ZJ},ArrowShapeArrowheadStartStyle:function(){return e8.TA},ArrowShapeTool:function(){return ArrowShapeTool},ArrowShapeUtil:function(){return ArrowShapeUtil},AssetRecordType:function(){return e8.Yk},AssetUrlsProvider:function(){return AssetUrlsProvider},BaseBoxShapeTool:function(){return BaseBoxShapeTool},BaseBoxShapeUtil:function(){return BaseBoxShapeUtil},BookmarkShapeUtil:function(){return BookmarkShapeUtil},Box2d:function(){return nT.No},BreakPointProvider:function(){return BreakPointProvider},Button:function(){return nq},CAMERA_SLIDE_FRICTION:function(){return td.$G},CameraRecordType:function(){return e8.AN},Canvas:function(){return Canvas},Circle2d:function(){return Circle2d},ContextMenu:function(){return ContextMenu},CubicBezier2d:function(){return CubicBezier2d},CubicSpline2d:function(){return CubicSpline2d},DEFAULT_ACCEPTED_IMG_TYPE:function(){return iF},DEFAULT_ACCEPTED_VID_TYPE:function(){return iB},DEFAULT_ANIMATION_OPTIONS:function(){return td.Xy},DOUBLE_CLICK_DURATION:function(){return td.qV},DRAG_DISTANCE:function(){return td.Sk},DefaultBackground:function(){return DefaultBackground},DefaultBrush:function(){return DefaultBrush},DefaultCollaboratorHint:function(){return DefaultCollaboratorHint},DefaultColorStyle:function(){return e8.R_},DefaultColorThemePalette:function(){return e8.qi},DefaultCursor:function(){return tc},DefaultDashStyle:function(){return e8.ci},DefaultErrorFallback:function(){return DefaultErrorFallback},DefaultFillStyle:function(){return e8.pp},DefaultFontFamilies:function(){return e8.p6},DefaultFontStyle:function(){return e8.Y8},DefaultGrid:function(){return DefaultGrid},DefaultHandle:function(){return DefaultHandle},DefaultHandles:function(){return DefaultHandles},DefaultHorizontalAlignStyle:function(){return e8.Xo},DefaultHoveredShapeIndicator:function(){return DefaultHoveredShapeIndicator},DefaultScribble:function(){return DefaultScribble},DefaultSelectionBackground:function(){return DefaultSelectionBackground},DefaultSelectionForeground:function(){return DefaultSelectionForeground},DefaultSizeStyle:function(){return e8.ST},DefaultSnapLine:function(){return DefaultSnapLine},DefaultSpinner:function(){return DefaultSpinner},DefaultSvgDefs:function(){return DefaultSvgDefs},DefaultVerticalAlignStyle:function(){return e8.HO},Dialog:function(){return G},DictValidator:function(){return e6.oy},DocumentRecordType:function(){return e8._A},DrawShapeTool:function(){return DrawShapeTool},DrawShapeUtil:function(){return DrawShapeUtil},DropdownMenu:function(){return U},EASINGS:function(){return n$.L},EMBED_DEFINITIONS:function(){return e8.Lu},EMPTY_ARRAY:function(){return e5.LZ},EPSILON:function(){return ts.Ib},EVENT_NAME_MAP:function(){return nP.J},Edge2d:function(){return nM.W},Editor:function(){return tK.M},Ellipse2d:function(){return Ellipse2d},EmbedShapeUtil:function(){return EmbedShapeUtil},EnumStyleProp:function(){return e8.$I},EraserTool:function(){return EraserTool},ErrorBoundary:function(){return ErrorBoundary},ErrorScreen:function(){return ErrorScreen},FileHelpers:function(){return e4.P6},FrameShapeTool:function(){return FrameShapeTool},FrameShapeUtil:function(){return FrameShapeUtil},GRID_STEPS:function(){return td.dW},GeoShapeGeoStyle:function(){return e8.Zu},GeoShapeTool:function(){return GeoShapeTool},GeoShapeUtil:function(){return GeoShapeUtil},Geometry2d:function(){return nI.l},Group2d:function(){return nj.m},GroupShapeUtil:function(){return nx.Q},HASH_PATTERN_ZOOM_NAMES:function(){return td.iF},HIT_TEST_MARGIN:function(){return td.wM},HTMLContainer:function(){return HTMLContainer},HandTool:function(){return HandTool},HighlightShapeTool:function(){return HighlightShapeTool},HighlightShapeUtil:function(){return HighlightShapeUtil},Icon:function(){return nW},ImageShapeUtil:function(){return ImageShapeUtil},IncrementalSetConstructor:function(){return e3.mW},Input:function(){return oO},InstancePageStateRecordType:function(){return e8.iS},InstancePresenceRecordType:function(){return e8.AM},LANGUAGES:function(){return e8.a2},LaserTool:function(){return LaserTool},LineShapeSplineStyle:function(){return e8.t8},LineShapeTool:function(){return LineShapeTool},LineShapeUtil:function(){return LineShapeUtil},LoadingScreen:function(){return LoadingScreen},MAX_PAGES:function(){return td.Et},MAX_SHAPES_PER_PAGE:function(){return td.kx},MAX_ZOOM:function(){return td.sZ},MIN_ZOOM:function(){return td.Zj},MULTI_CLICK_DURATION:function(){return td.Pz},Matrix2d:function(){return tO.y},MediaHelpers:function(){return e4.xe},MigrationFailureReason:function(){return e3.qx},NoteShapeTool:function(){return NoteShapeTool},NoteShapeUtil:function(){return NoteShapeUtil},ObjectValidator:function(){return e6.kx},OfflineIndicator:function(){return OfflineIndicator},OptionalErrorBoundary:function(){return OptionalErrorBoundary},PI:function(){return ts.PI},PI2:function(){return ts.yo},PageRecordType:function(){return e8.ez},PngHelpers:function(){return e4.bM},PointerRecordType:function(){return e8.zh},Polygon2d:function(){return nO.w},Polyline2d:function(){return nA.q},PositionedOnCanvas:function(){return ng},ROTATE_CORNER_TO_SELECTION_CORNER:function(){return nT.rf},ReadonlySharedStyleMap:function(){return nR._},RecordType:function(){return e3.oX},Rectangle2d:function(){return nv.z},Result:function(){return e4.x4},SIN:function(){return ts.dv},SVGContainer:function(){return nm.g},SVG_PADDING:function(){return td.s_},SelectTool:function(){return SelectTool},ShapeIndicator:function(){return ta},ShapeUtil:function(){return nS.E},SharedStyleMap:function(){return nR.o},SnapManager:function(){return nb.f},Spinner:function(){return Spinner},Stadium2d:function(){return Stadium2d},StateNode:function(){return nE.n},Store:function(){return e3.yh},StoreSchema:function(){return e3.sS},StyleProp:function(){return e8.fV},T:function(){return e6.T},TAB_ID:function(){return t2},TAU:function(){return ts.gc},TLDOCUMENT_ID:function(){return e8.G4},TLDRAW_FILE_EXTENSION:function(){return lE},TLINSTANCE_ID:function(){return e8.PQ},TLPOINTER_ID:function(){return e8.LV},TL_CANVAS_UI_COLOR_TYPES:function(){return e8.z},TextShapeTool:function(){return TextShapeTool},TextShapeUtil:function(){return TextShapeUtil},Tldraw:function(){return Tldraw},TldrawEditor:function(){return np},TldrawUi:function(){return s5},TldrawUiContextProvider:function(){return TldrawUiContextProvider},USER_COLORS:function(){return ny.A6},UiEventsProvider:function(){return UiEventsProvider},UnionValidator:function(){return e6.zr},Validator:function(){return e6.cX},Vec2d:function(){return tl.G},VideoShapeUtil:function(){return VideoShapeUtil},WeakMapCache:function(){return nD._},ZOOMS:function(){return td.E},ZoomTool:function(){return ZoomTool},angleDelta:function(){return ts.Cc},annotateError:function(){return e4.lw},applyRotationToSnapshotShapes:function(){return nB.Z},approximately:function(){return ts.C2},areAnglesCompatible:function(){return ts._G},arrowShapeMigrations:function(){return e8.Vm},arrowShapeProps:function(){return e8.si},assert:function(){return e4.hu},assertExists:function(){return e4.kP},assertIdType:function(){return e3.lS},assetIdValidator:function(){return e8._3},assetMigrations:function(){return e8.TD},assetValidator:function(){return e8.$A},atom:function(){return e5.cn},average:function(){return ts.Y8},bookmarkShapeMigrations:function(){return e8.h9},bookmarkShapeProps:function(){return e8.qU},box2dModelValidator:function(){return e8.tF},buildFromV1Document:function(){return buildFromV1Document},canonicalizeRotation:function(){return ts.f5},canvasUiColorTypeValidator:function(){return e8.MN},clamp:function(){return ts.uZ},clampRadians:function(){return ts.Ci},clockwiseAngleDist:function(){return ts.VK},compact:function(){return e4.oA},compactMenuItems:function(){return compactMenuItems},compareRecordVersions:function(){return e3.ix},compareSchemas:function(){return e3.$F},computed:function(){return e5.Fl},containBoxSize:function(){return containBoxSize},coreShapes:function(){return nc.u},createAssetValidator:function(){return e8.tL},createPresenceStateDerivation:function(){return e8.GP},createRecordType:function(){return e3.ju},createSessionStateSnapshotSignal:function(){return createSessionStateSnapshotSignal},createShapeId:function(){return e8.F1},createShapeValidator:function(){return e8.JY},createTLSchema:function(){return e8.HH},createTLStore:function(){return createTLStore},createTLUser:function(){return tW.L},dataUrlToFile:function(){return nL.B},debounce:function(){return e4.Ds},debugFlags:function(){return te},dedupe:function(){return e4.D8},deepCopy:function(){return e4.p$},defaultShapeTools:function(){return iG},defaultShapeUtils:function(){return oe},defaultTools:function(){return oa},defaultUserPreferences:function(){return ny.ks},defineMigrations:function(){return e3.zn},degreesToRadians:function(){return ts.Ht},devFreeze:function(){return e3.ZV},drawShapeMigrations:function(){return e8._l},drawShapeProps:function(){return e8.wu},embedShapeMigrations:function(){return e8.BF},embedShapePermissionDefaults:function(){return e8.gB},embedShapeProps:function(){return e8.DW},exhaustiveSwitchError:function(){return e4.iP},extractSessionStateFromLegacySnapshot:function(){return extractSessionStateFromLegacySnapshot},featureFlags:function(){return e9},filterEntries:function(){return e4.H4},findMenuItem:function(){return findMenuItem},frameShapeMigrations:function(){return e8.gR},frameShapeProps:function(){return e8.k7},geoShapeMigrations:function(){return e8.P3},geoShapeProps:function(){return e8.eG},getArcLength:function(){return ts.Pl},getArrowTerminalsInArrowSpace:function(){return nk.Qs},getArrowheadPathForType:function(){return getArrowheadPathForType},getCursor:function(){return getCursor},getCurvedArrowHandlePath:function(){return n_.dz},getDefaultColorTheme:function(){return e8.y6},getDefaultTranslationLocale:function(){return e8.Bz},getEmbedInfo:function(){return getEmbedInfo},getErrorAnnotations:function(){return e4.wi},getFirstFromIterable:function(){return e4.lr},getFreshUserPreferences:function(){return ny.MO},getHashForObject:function(){return e4.pT},getHashForString:function(){return e4.jK},getIncrementedName:function(){return nN.u},getIndexAbove:function(){return nF._L},getIndexBelow:function(){return nF.Xg},getIndexBetween:function(){return nF.eI},getIndices:function(){return nF.H$},getIndicesAbove:function(){return nF.vw},getIndicesBelow:function(){return nF.dk},getIndicesBetween:function(){return nF.Xv},getOwnProperty:function(){return e4.eg},getPointOnCircle:function(){return ts.XD},getPointerInfo:function(){return getPointerInfo},getPolygonVertices:function(){return ts.Oe},getRecordVersion:function(){return e3.C$},getResizedImageDataUrl:function(){return getResizedImageDataUrl},getRotationSnapshot:function(){return nB.o},getShapePropKeysByStyle:function(){return e8.DR},getSolidCurvedArrowPath:function(){return n_.t9},getSolidStraightArrowPath:function(){return nC.N7},getStarBounds:function(){return ts.LP},getStraightArrowHandlePath:function(){return nC.$w},getSvgPathFromPoints:function(){return getSvgPathFromPoints_getSvgPathFromPoints},getSweep:function(){return ts.hQ},getUserPreferences:function(){return ny.JM},groupShapeMigrations:function(){return e8.c4},groupShapeProps:function(){return e8.A7},hardReset:function(){return hardReset},hardResetEditor:function(){return hardResetEditor},hasOwnProperty:function(){return e4.nr},highlightShapeMigrations:function(){return e8.J1},highlightShapeProps:function(){return e8.VW},idValidator:function(){return e8.yd},imageShapeMigrations:function(){return e8.y5},imageShapeProps:function(){return e8.Fc},intersectLineSegmentPolygon:function(){return nw.qZ},intersectLineSegmentPolyline:function(){return nw.Gc},intersectPolygonPolygon:function(){return nw.tY},isAngleBetween:function(){return ts.FO},isDefined:function(){return e4.$K},isGifAnimated:function(){return isGifAnimated},isNonNull:function(){return e4.GT},isNonNullish:function(){return e4.cF},isPageId:function(){return e8.r5},isSafeFloat:function(){return ts.AV},isShape:function(){return e8.VV},isShapeId:function(){return e8.YT},isValidUrl:function(){return e4.jv},last:function(){return e4.Z$},lerp:function(){return e4.t7},lerpAngles:function(){return ts.M7},lineShapeMigrations:function(){return e8.FH},lineShapeProps:function(){return e8.BG},linesIntersect:function(){return nw.cB},lns:function(){return e4.L8},loadSessionStateSnapshotIntoStore:function(){return loadSessionStateSnapshotIntoStore},longAngleDist:function(){return ts.yE},loopToHtmlElement:function(){return loopToHtmlElement},mapObjectMapValues:function(){return e4.Fm},menuCustom:function(){return menuCustom},menuGroup:function(){return menuGroup},menuItem:function(){return menuItem},menuSubmenu:function(){return menuSubmenu},migrate:function(){return e3.Te},migrateRecord:function(){return e3.wJ},minBy:function(){return e4.F},modulate:function(){return e4.vm},noop:function(){return e4.ZT},normalizeWheel:function(){return normalizeWheel},noteShapeMigrations:function(){return e8.C_},noteShapeProps:function(){return e8.m0},objectMapEntries:function(){return e4.EP},objectMapFromEntries:function(){return e4.Ls},objectMapKeys:function(){return e4.GH},objectMapValues:function(){return e4.UM},omitFromStackTrace:function(){return e4.fP},opacityValidator:function(){return e8.jm},openWindow:function(){return openWindow},pageIdValidator:function(){return e8.CF},parentIdValidator:function(){return e8.Mv},parseAndLoadDocument:function(){return parseAndLoadDocument},parseTldrawJsonFile:function(){return parseTldrawJsonFile},partition:function(){return e4.uK},perimeterOfEllipse:function(){return ts.Rp},pointInBounds:function(){return ts.wM},pointInCircle:function(){return ts.mD},pointInEllipse:function(){return ts.WU},pointInPolygon:function(){return ts.Of},pointInPolyline:function(){return ts.V7},pointInRect:function(){return ts.qr},pointNearToLineSegment:function(){return ts.KP},pointNearToPolyline:function(){return ts.Xh},polygonsIntersect:function(){return nw.UQ},precise:function(){return ts.Yk},preventDefault:function(){return preventDefault},promiseWithResolve:function(){return e4.un},radiansToDegrees:function(){return ts.vi},rafThrottle:function(){return e4.TE},rangeIntersection:function(){return ts.mW},react:function(){return e5.Ym},refreshPage:function(){return refreshPage},releasePointerCapture:function(){return releasePointerCapture},resizeBox:function(){return resizeBox},reverseRecordsDiff:function(){return e3.kJ},rng:function(){return e4.Vk},rootShapeMigrations:function(){return e8.cL},rotateArray:function(){return e4.R8},rotateSelectionHandle:function(){return nT.dC},runtime:function(){return tu},scribbleValidator:function(){return e8.gw},serializeTldrawJson:function(){return serializeTldrawJson},serializeTldrawJsonBlob:function(){return serializeTldrawJsonBlob},setDefaultEditorAssetUrls:function(){return setDefaultEditorAssetUrls},setDefaultUiAssetUrls:function(){return setDefaultUiAssetUrls},setPointerCapture:function(){return setPointerCapture},setRuntimeOverrides:function(){return setRuntimeOverrides},setUserPreferences:function(){return ny.yu},shapeIdValidator:function(){return e8.u5},shortAngleDist:function(){return ts.Z7},snapAngle:function(){return ts.nD},sortById:function(){return e4.uv},sortByIndex:function(){return nF.hl},squashRecordDiffs:function(){return e3.bs},stopEventPropagation:function(){return stopEventPropagation},structuredClone:function(){return e4.v4},textShapeMigrations:function(){return e8.pL},textShapeProps:function(){return e8.XB},throttle:function(){return e4.P2},throttledRaf:function(){return e4.xP},toDomPrecision:function(){return ts.$Z},toFixed:function(){return ts.FH},toPrecision:function(){return ts.Zd},toolbarItem:function(){return toolbarItem},track:function(){return e5.j},transact:function(){return e5.ay},transaction:function(){return e5.PS},truncateStringWithEllipsis:function(){return truncateStringWithEllipsis},uniq:function(){return uniq},uniqueId:function(){return tQ.E},useActions:function(){return useActions},useActionsMenuSchema:function(){return useActionsMenuSchema},useAssetUrls:function(){return useAssetUrls},useBreakpoint:function(){return useBreakpoint},useCanRedo:function(){return useCanRedo},useCanUndo:function(){return useCanUndo},useComputed:function(){return e5.vc},useContainer:function(){return useContainer},useContextMenuSchema:function(){return useContextMenuSchema},useCopyAs:function(){return useCopyAs},useDefaultHelpers:function(){return useDefaultHelpers},useDialogs:function(){return useDialogs},useEditor:function(){return tt.j},useExportAs:function(){return useExportAs},useHelpMenuSchema:function(){return useHelpMenuSchema},useIsCropping:function(){return useIsCropping},useIsDarkMode:function(){return useIsDarkMode},useIsEditing:function(){return useIsEditing},useKeyboardShortcuts:function(){return useKeyboardShortcuts},useKeyboardShortcutsSchema:function(){return useKeyboardShortcutsSchema},useLocalStorageState:function(){return useLocalStorageState},useLocalStore:function(){return useLocalStore},useMenuClipboardEvents:function(){return useMenuClipboardEvents},useMenuIsOpen:function(){return useMenuIsOpen},useMenuSchema:function(){return useMenuSchema},useNativeClipboardEvents:function(){return useNativeClipboardEvents},usePeerIds:function(){return usePeerIds},usePresence:function(){return usePresence},useQuickReactor:function(){return e5.BK},useReactor:function(){return e5.vC},useReadonly:function(){return useReadonly},useSelectionEvents:function(){return useSelectionEvents},useTLStore:function(){return useTLStore},useToasts:function(){return useToasts},useToolbarSchema:function(){return useToolbarSchema},useTools:function(){return useTools},useTransform:function(){return useTransform},useTranslation:function(){return useTranslation},useUiEvents:function(){return useUiEvents},useValue:function(){return e5.Hg},vec2dModelValidator:function(){return e8.tn},videoShapeMigrations:function(){return e8.lY},videoShapeProps:function(){return e8.p$},whyAmIRunning:function(){return e5.iJ}});var _,k,E,T,$,I,M,j,D,L,F,B,G={};f.r(G),f.d(G,{Body:function(){return Body},CloseButton:function(){return CloseButton},Footer:function(){return Footer},Header:function(){return Header},Title:function(){return Title}});var U={};f.r(U),f.d(U,{CheckboxItem:function(){return CheckboxItem},Content:function(){return Content},Group:function(){return Group},Indicator:function(){return Indicator},Item:function(){return Item},RadioItem:function(){return RadioItem},Root:function(){return Root},Sub:function(){return Sub},SubContent:function(){return SubContent},SubTrigger:function(){return SubTrigger},Trigger:function(){return Trigger}});var V=f(57437);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(c){for(var u=1;u<arguments.length;u++){var f=arguments[u];for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(c[g]=f[g])}return c}).apply(this,arguments)}var K=f(2265),Z=f.t(K,2);function $e42e1063c40fb3ef$export$b9ecd428b558ff10(c,u,{checkForDefaultPrevented:f=!0}={}){return function(g){if(null==c||c(g),!1===f||!g.defaultPrevented)return null==u?void 0:u(g)}}function $6ed0406888f73fc4$var$setRef(c,u){"function"==typeof c?c(u):null!=c&&(c.current=u)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...c){return u=>c.forEach(c=>$6ed0406888f73fc4$var$setRef(c,u))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...c){return(0,K.useCallback)($6ed0406888f73fc4$export$43e446d32b3d21af(...c),c)}function $c512c27ab02ef895$export$fd42f52fd3ae1109(c,u){let f=(0,K.createContext)(u);function Provider(c){let{children:u,...g}=c,b=(0,K.useMemo)(()=>g,Object.values(g));return(0,K.createElement)(f.Provider,{value:b},u)}function useContext(g){let b=(0,K.useContext)(f);if(b)return b;if(void 0!==u)return u;throw Error(`\`${g}\` must be used within \`${c}\``)}return Provider.displayName=c+"Provider",[Provider,useContext]}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(c,u=[]){let f=[];function $c512c27ab02ef895$export$fd42f52fd3ae1109(u,g){let b=(0,K.createContext)(g),v=f.length;function Provider(u){let{scope:f,children:g,...x}=u,w=(null==f?void 0:f[c][v])||b,_=(0,K.useMemo)(()=>x,Object.values(x));return(0,K.createElement)(w.Provider,{value:_},g)}function useContext(f,x){let w=(null==x?void 0:x[c][v])||b,_=(0,K.useContext)(w);if(_)return _;if(void 0!==g)return g;throw Error(`\`${f}\` must be used within \`${u}\``)}return f=[...f,g],Provider.displayName=u+"Provider",[Provider,useContext]}let createScope=()=>{let u=f.map(c=>(0,K.createContext)(c));return function(f){let g=(null==f?void 0:f[c])||u;return(0,K.useMemo)(()=>({[`__scope${c}`]:{...f,[c]:g}}),[f,g])}};return createScope.scopeName=c,[$c512c27ab02ef895$export$fd42f52fd3ae1109,$c512c27ab02ef895$var$composeContextScopes(createScope,...u)]}function $c512c27ab02ef895$var$composeContextScopes(...c){let u=c[0];if(1===c.length)return u;let createScope1=()=>{let f=c.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(c){let g=f.reduce((u,{useScope:f,scopeName:g})=>{let b=f(c),v=b[`__scope${g}`];return{...u,...v}},{});return(0,K.useMemo)(()=>({[`__scope${u.scopeName}`]:g}),[g])}};return createScope1.scopeName=u.scopeName,createScope1}let Y=(null==globalThis?void 0:globalThis.document)?K.useLayoutEffect:()=>{},X=Z["useId".toString()]||(()=>void 0),J=0;function $1746a345f3d73bb7$export$f680877a34711e37(c){let[u,f]=K.useState(X());return Y(()=>{c||f(c=>null!=c?c:String(J++))},[c]),c||(u?`radix-${u}`:"")}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c){let u=(0,K.useRef)(c);return(0,K.useEffect)(()=>{u.current=c}),(0,K.useMemo)(()=>(...c)=>{var f;return null===(f=u.current)||void 0===f?void 0:f.call(u,...c)},[])}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:c,defaultProp:u,onChange:f=()=>{}}){let[g,b]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:u,onChange:f}),v=void 0!==c,x=v?c:g,w=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(f),_=(0,K.useCallback)(u=>{if(v){let f="function"==typeof u?u(c):u;f!==c&&w(f)}else b(u)},[v,c,b,w]);return[x,_]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:c,onChange:u}){let f=(0,K.useState)(c),[g]=f,b=(0,K.useRef)(g),v=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(u);return(0,K.useEffect)(()=>{b.current!==g&&(v(g),b.current=g)},[g,b,v]),f}var Q=f(54887);let ee=(0,K.forwardRef)((c,u)=>{let{children:f,...g}=c,b=K.Children.toArray(f),v=b.find($5e63c961fc1ce211$var$isSlottable);if(v){let c=v.props.children,f=b.map(u=>u!==v?u:K.Children.count(c)>1?K.Children.only(null):(0,K.isValidElement)(c)?c.props.children:null);return(0,K.createElement)(et,_extends({},g,{ref:u}),(0,K.isValidElement)(c)?(0,K.cloneElement)(c,void 0,f):null)}return(0,K.createElement)(et,_extends({},g,{ref:u}),f)});ee.displayName="Slot";let et=(0,K.forwardRef)((c,u)=>{let{children:f,...g}=c;return(0,K.isValidElement)(f)?(0,K.cloneElement)(f,{...$5e63c961fc1ce211$var$mergeProps(g,f.props),ref:u?$6ed0406888f73fc4$export$43e446d32b3d21af(u,f.ref):f.ref}):K.Children.count(f)>1?K.Children.only(null):null});et.displayName="SlotClone";let $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:c})=>(0,K.createElement)(K.Fragment,null,c);function $5e63c961fc1ce211$var$isSlottable(c){return(0,K.isValidElement)(c)&&c.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(c,u){let f={...u};for(let g in u){let b=c[g],v=u[g],x=/^on[A-Z]/.test(g);x?b&&v?f[g]=(...c)=>{v(...c),b(...c)}:b&&(f[g]=b):"style"===g?f[g]={...b,...v}:"className"===g&&(f[g]=[b,v].filter(Boolean).join(" "))}return{...c,...f}}let en=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((c,u)=>{let f=(0,K.forwardRef)((c,f)=>{let{asChild:g,...b}=c,v=g?ee:u;return(0,K.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,K.createElement)(v,_extends({},b,{ref:f}))});return f.displayName=`Primitive.${u}`,{...c,[u]:f}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(c,u){c&&(0,Q.flushSync)(()=>c.dispatchEvent(u))}function $addc16e1bbe58fd0$export$3a72a57244d6e765(c,u=null==globalThis?void 0:globalThis.document){let f=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c);(0,K.useEffect)(()=>{let handleKeyDown=c=>{"Escape"===c.key&&f(c)};return u.addEventListener("keydown",handleKeyDown),()=>u.removeEventListener("keydown",handleKeyDown)},[f,u])}let er="dismissableLayer.update",ei=(0,K.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eo=(0,K.forwardRef)((c,u)=>{var f;let{disableOutsidePointerEvents:b=!1,onEscapeKeyDown:v,onPointerDownOutside:x,onFocusOutside:w,onInteractOutside:_,onDismiss:k,...E}=c,T=(0,K.useContext)(ei),[$,I]=(0,K.useState)(null),M=null!==(f=null==$?void 0:$.ownerDocument)&&void 0!==f?f:null==globalThis?void 0:globalThis.document,[,j]=(0,K.useState)({}),D=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>I(c)),L=Array.from(T.layers),[F]=[...T.layersWithOutsidePointerEventsDisabled].slice(-1),B=L.indexOf(F),G=$?L.indexOf($):-1,U=T.layersWithOutsidePointerEventsDisabled.size>0,V=G>=B,Z=$5cb92bef7577960e$var$usePointerDownOutside(c=>{let u=c.target,f=[...T.branches].some(c=>c.contains(u));!V||f||(null==x||x(c),null==_||_(c),c.defaultPrevented||null==k||k())},M),Y=$5cb92bef7577960e$var$useFocusOutside(c=>{let u=c.target,f=[...T.branches].some(c=>c.contains(u));f||(null==w||w(c),null==_||_(c),c.defaultPrevented||null==k||k())},M);return $addc16e1bbe58fd0$export$3a72a57244d6e765(c=>{let u=G===T.layers.size-1;u&&(null==v||v(c),!c.defaultPrevented&&k&&(c.preventDefault(),k()))},M),(0,K.useEffect)(()=>{if($)return b&&(0===T.layersWithOutsidePointerEventsDisabled.size&&(g=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),T.layersWithOutsidePointerEventsDisabled.add($)),T.layers.add($),$5cb92bef7577960e$var$dispatchUpdate(),()=>{b&&1===T.layersWithOutsidePointerEventsDisabled.size&&(M.body.style.pointerEvents=g)}},[$,M,b,T]),(0,K.useEffect)(()=>()=>{$&&(T.layers.delete($),T.layersWithOutsidePointerEventsDisabled.delete($),$5cb92bef7577960e$var$dispatchUpdate())},[$,T]),(0,K.useEffect)(()=>{let handleUpdate=()=>j({});return document.addEventListener(er,handleUpdate),()=>document.removeEventListener(er,handleUpdate)},[]),(0,K.createElement)(en.div,_extends({},E,{ref:D,style:{pointerEvents:U?V?"auto":"none":void 0,...c.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusCapture,Y.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onBlurCapture,Y.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDownCapture,Z.onPointerDownCapture)}))}),ea=(0,K.forwardRef)((c,u)=>{let f=(0,K.useContext)(ei),g=(0,K.useRef)(null),b=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,g);return(0,K.useEffect)(()=>{let c=g.current;if(c)return f.branches.add(c),()=>{f.branches.delete(c)}},[f.branches]),(0,K.createElement)(en.div,_extends({},c,{ref:b}))});function $5cb92bef7577960e$var$usePointerDownOutside(c,u=null==globalThis?void 0:globalThis.document){let f=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c),g=(0,K.useRef)(!1),b=(0,K.useRef)(()=>{});return(0,K.useEffect)(()=>{let handlePointerDown=c=>{if(c.target&&!g.current){let g={originalEvent:c};function handleAndDispatchPointerDownOutsideEvent(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.pointerDownOutside",f,g,{discrete:!0})}"touch"===c.pointerType?(u.removeEventListener("click",b.current),b.current=handleAndDispatchPointerDownOutsideEvent,u.addEventListener("click",b.current,{once:!0})):handleAndDispatchPointerDownOutsideEvent()}else u.removeEventListener("click",b.current);g.current=!1},c=window.setTimeout(()=>{u.addEventListener("pointerdown",handlePointerDown)},0);return()=>{window.clearTimeout(c),u.removeEventListener("pointerdown",handlePointerDown),u.removeEventListener("click",b.current)}},[u,f]),{onPointerDownCapture:()=>g.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(c,u=null==globalThis?void 0:globalThis.document){let f=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c),g=(0,K.useRef)(!1);return(0,K.useEffect)(()=>{let handleFocus=c=>{c.target&&!g.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.focusOutside",f,{originalEvent:c},{discrete:!1})};return u.addEventListener("focusin",handleFocus),()=>u.removeEventListener("focusin",handleFocus)},[u,f]),{onFocusCapture:()=>g.current=!0,onBlurCapture:()=>g.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){let c=new CustomEvent(er);document.dispatchEvent(c)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(c,u,f,{discrete:g}){let b=f.originalEvent.target,v=new CustomEvent(c,{bubbles:!1,cancelable:!0,detail:f});u&&b.addEventListener(c,u,{once:!0}),g?$8927f6f2acc4f386$export$6d1a0317bde7de7f(b,v):b.dispatchEvent(v)}let es="focusScope.autoFocusOnMount",el="focusScope.autoFocusOnUnmount",ec={bubbles:!1,cancelable:!0},eu=(0,K.forwardRef)((c,u)=>{let{loop:f=!1,trapped:g=!1,onMountAutoFocus:b,onUnmountAutoFocus:v,...x}=c,[w,_]=(0,K.useState)(null),k=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(b),E=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(v),T=(0,K.useRef)(null),$=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>_(c)),I=(0,K.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,K.useEffect)(()=>{if(g){function handleFocusIn(c){if(I.paused||!w)return;let u=c.target;w.contains(u)?T.current=u:$d3863c46a17e8a28$var$focus(T.current,{select:!0})}function handleFocusOut(c){if(I.paused||!w)return;let u=c.relatedTarget;null===u||w.contains(u)||$d3863c46a17e8a28$var$focus(T.current,{select:!0})}function handleMutations(c){let u=document.activeElement;if(u===document.body)for(let u of c)u.removedNodes.length>0&&$d3863c46a17e8a28$var$focus(w)}document.addEventListener("focusin",handleFocusIn),document.addEventListener("focusout",handleFocusOut);let c=new MutationObserver(handleMutations);return w&&c.observe(w,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",handleFocusIn),document.removeEventListener("focusout",handleFocusOut),c.disconnect()}}},[g,w,I.paused]),(0,K.useEffect)(()=>{if(w){ed.add(I);let c=document.activeElement,u=w.contains(c);if(!u){let u=new CustomEvent(es,ec);w.addEventListener(es,k),w.dispatchEvent(u),u.defaultPrevented||($d3863c46a17e8a28$var$focusFirst($d3863c46a17e8a28$var$removeLinks($d3863c46a17e8a28$var$getTabbableCandidates(w)),{select:!0}),document.activeElement===c&&$d3863c46a17e8a28$var$focus(w))}return()=>{w.removeEventListener(es,k),setTimeout(()=>{let u=new CustomEvent(el,ec);w.addEventListener(el,E),w.dispatchEvent(u),u.defaultPrevented||$d3863c46a17e8a28$var$focus(null!=c?c:document.body,{select:!0}),w.removeEventListener(el,E),ed.remove(I)},0)}}},[w,k,E,I]);let M=(0,K.useCallback)(c=>{if(!f&&!g||I.paused)return;let u="Tab"===c.key&&!c.altKey&&!c.ctrlKey&&!c.metaKey,b=document.activeElement;if(u&&b){let u=c.currentTarget,[g,v]=$d3863c46a17e8a28$var$getTabbableEdges(u),x=g&&v;x?c.shiftKey||b!==v?c.shiftKey&&b===g&&(c.preventDefault(),f&&$d3863c46a17e8a28$var$focus(v,{select:!0})):(c.preventDefault(),f&&$d3863c46a17e8a28$var$focus(g,{select:!0})):b===u&&c.preventDefault()}},[f,g,I.paused]);return(0,K.createElement)(en.div,_extends({tabIndex:-1},x,{ref:$,onKeyDown:M}))});function $d3863c46a17e8a28$var$focusFirst(c,{select:u=!1}={}){let f=document.activeElement;for(let g of c)if($d3863c46a17e8a28$var$focus(g,{select:u}),document.activeElement!==f)return}function $d3863c46a17e8a28$var$getTabbableEdges(c){let u=$d3863c46a17e8a28$var$getTabbableCandidates(c),f=$d3863c46a17e8a28$var$findVisible(u,c),g=$d3863c46a17e8a28$var$findVisible(u.reverse(),c);return[f,g]}function $d3863c46a17e8a28$var$getTabbableCandidates(c){let u=[],f=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{let u="INPUT"===c.tagName&&"hidden"===c.type;return c.disabled||c.hidden||u?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;f.nextNode();)u.push(f.currentNode);return u}function $d3863c46a17e8a28$var$findVisible(c,u){for(let f of c)if(!$d3863c46a17e8a28$var$isHidden(f,{upTo:u}))return f}function $d3863c46a17e8a28$var$isHidden(c,{upTo:u}){if("hidden"===getComputedStyle(c).visibility)return!0;for(;c&&(void 0===u||c!==u);){if("none"===getComputedStyle(c).display)return!0;c=c.parentElement}return!1}function $d3863c46a17e8a28$var$isSelectableInput(c){return c instanceof HTMLInputElement&&"select"in c}function $d3863c46a17e8a28$var$focus(c,{select:u=!1}={}){if(c&&c.focus){let f=document.activeElement;c.focus({preventScroll:!0}),c!==f&&$d3863c46a17e8a28$var$isSelectableInput(c)&&u&&c.select()}}let ed=$d3863c46a17e8a28$var$createFocusScopesStack();function $d3863c46a17e8a28$var$createFocusScopesStack(){let c=[];return{add(u){let f=c[0];u!==f&&(null==f||f.pause()),(c=$d3863c46a17e8a28$var$arrayRemove(c,u)).unshift(u)},remove(u){var f;null===(f=(c=$d3863c46a17e8a28$var$arrayRemove(c,u))[0])||void 0===f||f.resume()}}}function $d3863c46a17e8a28$var$arrayRemove(c,u){let f=[...c],g=f.indexOf(u);return -1!==g&&f.splice(g,1),f}function $d3863c46a17e8a28$var$removeLinks(c){return c.filter(c=>"A"!==c.tagName)}let eh=(0,K.forwardRef)((c,u)=>{var f;let{container:g=null==globalThis?void 0:null===(f=globalThis.document)||void 0===f?void 0:f.body,...b}=c;return g?Q.createPortal((0,K.createElement)(en.div,_extends({},b,{ref:u})),g):null});function $fe963b355347cc68$export$3e6543de14f8614f(c,u){return(0,K.useReducer)((c,f)=>{let g=u[c][f];return null!=g?g:c},c)}let $921a889cee6df7e8$export$99c2b779aa4e8b8b=c=>{let{present:u,children:f}=c,g=$921a889cee6df7e8$var$usePresence(u),b="function"==typeof f?f({present:g.isPresent}):K.Children.only(f),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g.ref,b.ref),x="function"==typeof f;return x||g.isPresent?(0,K.cloneElement)(b,{ref:v}):null};function $921a889cee6df7e8$var$usePresence(c){let[u,f]=(0,K.useState)(),g=(0,K.useRef)({}),b=(0,K.useRef)(c),v=(0,K.useRef)("none"),x=c?"mounted":"unmounted",[w,_]=$fe963b355347cc68$export$3e6543de14f8614f(x,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,K.useEffect)(()=>{let c=$921a889cee6df7e8$var$getAnimationName(g.current);v.current="mounted"===w?c:"none"},[w]),Y(()=>{let u=g.current,f=b.current,x=f!==c;if(x){let g=v.current,x=$921a889cee6df7e8$var$getAnimationName(u);c?_("MOUNT"):"none"===x||(null==u?void 0:u.display)==="none"?_("UNMOUNT"):f&&g!==x?_("ANIMATION_OUT"):_("UNMOUNT"),b.current=c}},[c,_]),Y(()=>{if(u){let handleAnimationEnd=c=>{let f=$921a889cee6df7e8$var$getAnimationName(g.current),b=f.includes(c.animationName);c.target===u&&b&&(0,Q.flushSync)(()=>_("ANIMATION_END"))},handleAnimationStart=c=>{c.target===u&&(v.current=$921a889cee6df7e8$var$getAnimationName(g.current))};return u.addEventListener("animationstart",handleAnimationStart),u.addEventListener("animationcancel",handleAnimationEnd),u.addEventListener("animationend",handleAnimationEnd),()=>{u.removeEventListener("animationstart",handleAnimationStart),u.removeEventListener("animationcancel",handleAnimationEnd),u.removeEventListener("animationend",handleAnimationEnd)}}_("ANIMATION_END")},[u,_]),{isPresent:["mounted","unmountSuspended"].includes(w),ref:(0,K.useCallback)(c=>{c&&(g.current=getComputedStyle(c)),f(c)},[])}}function $921a889cee6df7e8$var$getAnimationName(c){return(null==c?void 0:c.animationName)||"none"}$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";let ep=0;function $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){(0,K.useEffect)(()=>{var c,u;let f=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(c=f[0])&&void 0!==c?c:$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",null!==(u=f[1])&&void 0!==u?u:$3db38b7d1fb3fe6a$var$createFocusGuard()),ep++,()=>{1===ep&&document.querySelectorAll("[data-radix-focus-guard]").forEach(c=>c.remove()),ep--}},[])}function $3db38b7d1fb3fe6a$var$createFocusGuard(){let c=document.createElement("span");return c.setAttribute("data-radix-focus-guard",""),c.tabIndex=0,c.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",c}var __assign=function(){return(__assign=Object.assign||function(c){for(var u,f=1,g=arguments.length;f<g;f++)for(var b in u=arguments[f])Object.prototype.hasOwnProperty.call(u,b)&&(c[b]=u[b]);return c}).apply(this,arguments)};function __rest(c,u){var f={};for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&0>u.indexOf(g)&&(f[g]=c[g]);if(null!=c&&"function"==typeof Object.getOwnPropertySymbols)for(var b=0,g=Object.getOwnPropertySymbols(c);b<g.length;b++)0>u.indexOf(g[b])&&Object.prototype.propertyIsEnumerable.call(c,g[b])&&(f[g[b]]=c[g[b]]);return f}function __spreadArray(c,u,f){if(f||2==arguments.length)for(var g,b=0,v=u.length;b<v;b++)!g&&b in u||(g||(g=Array.prototype.slice.call(u,0,b)),g[b]=u[b]);return c.concat(g||Array.prototype.slice.call(u))}"function"==typeof SuppressedError&&SuppressedError;var ef="right-scroll-bar-position",eg="width-before-scroll-bar";function assignRef(c,u){return"function"==typeof c?c(u):c&&(c.current=u),c}function useCallbackRef(c,u){var f=(0,K.useState)(function(){return{value:c,callback:u,facade:{get current(){return f.value},set current(value){var g=f.value;g!==value&&(f.value=value,f.callback(value,g))}}}})[0];return f.callback=u,f.facade}var em="undefined"!=typeof window?K.useLayoutEffect:K.useEffect,ey=new WeakMap;function useMergeRefs(c,u){var f=useCallbackRef(u||null,function(u){return c.forEach(function(c){return assignRef(c,u)})});return em(function(){var u=ey.get(f);if(u){var g=new Set(u),b=new Set(c),v=f.current;g.forEach(function(c){b.has(c)||assignRef(c,null)}),b.forEach(function(c){g.has(c)||assignRef(c,v)})}ey.set(f,c)},[c]),f}function ItoI(c){return c}var eb=(void 0===_&&(_={}),(k=function innerCreateMedium(c,u){void 0===u&&(u=ItoI);var f=[],g=!1;return{read:function(){if(g)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return f.length?f[f.length-1]:c},useMedium:function(c){var b=u(c,g);return f.push(b),function(){f=f.filter(function(c){return c!==b})}},assignSyncMedium:function(c){for(g=!0;f.length;){var u=f;f=[],u.forEach(c)}f={push:function(u){return c(u)},filter:function(){return f}}},assignMedium:function(c){g=!0;var u=[];if(f.length){var b=f;f=[],b.forEach(c),u=f}var executeQueue=function(){var f=u;u=[],f.forEach(c)},cycle=function(){return Promise.resolve().then(executeQueue)};cycle(),f={push:function(c){u.push(c),cycle()},filter:function(c){return u=u.filter(c),f}}}}}(null)).options=__assign({async:!0,ssr:!1},_),k),nothing=function(){},ev=K.forwardRef(function(c,u){var f=K.useRef(null),g=K.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),b=g[0],v=g[1],x=c.forwardProps,w=c.children,_=c.className,k=c.removeScrollBar,E=c.enabled,T=c.shards,$=c.sideCar,I=c.noIsolation,M=c.inert,j=c.allowPinchZoom,D=c.as,L=void 0===D?"div":D,F=__rest(c,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),B=useMergeRefs([f,u]),G=__assign(__assign({},F),b);return K.createElement(K.Fragment,null,E&&K.createElement($,{sideCar:eb,removeScrollBar:k,shards:T,noIsolation:I,inert:M,setCallbacks:v,allowPinchZoom:!!j,lockRef:f}),x?K.cloneElement(K.Children.only(w),__assign(__assign({},G),{ref:B})):K.createElement(L,__assign({},G,{className:_,ref:B}),w))});ev.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},ev.classNames={fullWidth:eg,zeroRight:ef};var SideCar=function(c){var u=c.sideCar,f=__rest(c,["sideCar"]);if(!u)throw Error("Sidecar: please provide `sideCar` property to import the right car");var g=u.read();if(!g)throw Error("Sidecar medium not found");return K.createElement(g,__assign({},f))};function exportSidecar(c,u){return c.useMedium(u),SideCar}function makeStyleTag(){if(!document)return null;var c=document.createElement("style");c.type="text/css";var u=B||f.nc;return u&&c.setAttribute("nonce",u),c}function injectStyles(c,u){c.styleSheet?c.styleSheet.cssText=u:c.appendChild(document.createTextNode(u))}function insertStyleTag(c){(document.head||document.getElementsByTagName("head")[0]).appendChild(c)}SideCar.isSideCarExport=!0;var stylesheetSingleton=function(){var c=0,u=null;return{add:function(f){0==c&&(u=makeStyleTag())&&(injectStyles(u,f),insertStyleTag(u)),c++},remove:function(){--c||!u||(u.parentNode&&u.parentNode.removeChild(u),u=null)}}},styleHookSingleton=function(){var c=stylesheetSingleton();return function(u,f){K.useEffect(function(){return c.add(u),function(){c.remove()}},[u&&f])}},styleSingleton=function(){var c=styleHookSingleton();return function(u){return c(u.styles,u.dynamic),null}},eS={left:0,top:0,right:0,gap:0},parse=function(c){return parseInt(c||"",10)||0},getOffset=function(c){var u=window.getComputedStyle(document.body),f=u["padding"===c?"paddingLeft":"marginLeft"],g=u["padding"===c?"paddingTop":"marginTop"],b=u["padding"===c?"paddingRight":"marginRight"];return[parse(f),parse(g),parse(b)]},getGapWidth=function(c){if(void 0===c&&(c="margin"),"undefined"==typeof window)return eS;var u=getOffset(c),f=document.documentElement.clientWidth,g=window.innerWidth;return{left:u[0],top:u[1],right:u[2],gap:Math.max(0,g-f+u[2]-u[0])}},ex=styleSingleton(),ew="data-scroll-locked",getStyles=function(c,u,f,g){var b=c.left,v=c.top,x=c.right,w=c.gap;return void 0===f&&(f="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(g,";\n   padding-right: ").concat(w,"px ").concat(g,";\n  }\n  body[").concat(ew,"] {\n    overflow: hidden ").concat(g,";\n    overscroll-behavior: contain;\n    ").concat([u&&"position: relative ".concat(g,";"),"margin"===f&&"\n    padding-left: ".concat(b,"px;\n    padding-top: ").concat(v,"px;\n    padding-right: ").concat(x,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(w,"px ").concat(g,";\n    "),"padding"===f&&"padding-right: ".concat(w,"px ").concat(g,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(ef," {\n    right: ").concat(w,"px ").concat(g,";\n  }\n  \n  .").concat(eg," {\n    margin-right: ").concat(w,"px ").concat(g,";\n  }\n  \n  .").concat(ef," .").concat(ef," {\n    right: 0 ").concat(g,";\n  }\n  \n  .").concat(eg," .").concat(eg," {\n    margin-right: 0 ").concat(g,";\n  }\n  \n  body[").concat(ew,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(w,"px;\n  }\n")},getCurrentUseCounter=function(){var c=parseInt(document.body.getAttribute(ew)||"0",10);return isFinite(c)?c:0},useLockAttribute=function(){K.useEffect(function(){return document.body.setAttribute(ew,(getCurrentUseCounter()+1).toString()),function(){var c=getCurrentUseCounter()-1;c<=0?document.body.removeAttribute(ew):document.body.setAttribute(ew,c.toString())}},[])},RemoveScrollBar=function(c){var u=c.noRelative,f=c.noImportant,g=c.gapMode,b=void 0===g?"margin":g;useLockAttribute();var v=K.useMemo(function(){return getGapWidth(b)},[b]);return K.createElement(ex,{styles:getStyles(v,!u,b,f?"":"!important")})},e_=!1;if("undefined"!=typeof window)try{var ek=Object.defineProperty({},"passive",{get:function(){return e_=!0,!0}});window.addEventListener("test",ek,ek),window.removeEventListener("test",ek,ek)}catch(c){e_=!1}var eC=!!e_&&{passive:!1},elementCanBeScrolled=function(c,u){var f=window.getComputedStyle(c);return"hidden"!==f[u]&&!(f.overflowY===f.overflowX&&"TEXTAREA"!==c.tagName&&"visible"===f[u])},locationCouldBeScrolled=function(c,u){var f=u;do{if("undefined"!=typeof ShadowRoot&&f instanceof ShadowRoot&&(f=f.host),elementCouldBeScrolled(c,f)){var g=getScrollVariables(c,f);if(g[1]>g[2])return!0}f=f.parentNode}while(f&&f!==document.body);return!1},elementCouldBeScrolled=function(c,u){return"v"===c?elementCanBeScrolled(u,"overflowY"):elementCanBeScrolled(u,"overflowX")},getScrollVariables=function(c,u){return"v"===c?[u.scrollTop,u.scrollHeight,u.clientHeight]:[u.scrollLeft,u.scrollWidth,u.clientWidth]},handleScroll=function(c,u,f,g,b){var v,x=(v=window.getComputedStyle(u).direction,"h"===c&&"rtl"===v?-1:1),w=x*g,_=f.target,k=u.contains(_),E=!1,T=w>0,$=0,I=0;do{var M=getScrollVariables(c,_),j=M[0],D=M[1]-M[2]-x*j;(j||D)&&elementCouldBeScrolled(c,_)&&($+=D,I+=j),_=_.parentNode}while(!k&&_!==document.body||k&&(u.contains(_)||u===_));return T&&(b&&0===$||!b&&w>$)?E=!0:!T&&(b&&0===I||!b&&-w>I)&&(E=!0),E},getTouchXY=function(c){return"changedTouches"in c?[c.changedTouches[0].clientX,c.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(c){return[c.deltaX,c.deltaY]},extractRef=function(c){return c&&"current"in c?c.current:c},eE=0,eP=[],eT=exportSidecar(eb,function(c){var u=K.useRef([]),f=K.useRef([0,0]),g=K.useRef(),b=K.useState(eE++)[0],v=K.useState(function(){return styleSingleton()})[0],x=K.useRef(c);K.useEffect(function(){x.current=c},[c]),K.useEffect(function(){if(c.inert){document.body.classList.add("block-interactivity-".concat(b));var u=__spreadArray([c.lockRef.current],(c.shards||[]).map(extractRef),!0).filter(Boolean);return u.forEach(function(c){return c.classList.add("allow-interactivity-".concat(b))}),function(){document.body.classList.remove("block-interactivity-".concat(b)),u.forEach(function(c){return c.classList.remove("allow-interactivity-".concat(b))})}}},[c.inert,c.lockRef.current,c.shards]);var w=K.useCallback(function(c,u){if("touches"in c&&2===c.touches.length)return!x.current.allowPinchZoom;var b,v=getTouchXY(c),w=f.current,_="deltaX"in c?c.deltaX:w[0]-v[0],k="deltaY"in c?c.deltaY:w[1]-v[1],E=c.target,T=Math.abs(_)>Math.abs(k)?"h":"v";if("touches"in c&&"h"===T&&"range"===E.type)return!1;var $=locationCouldBeScrolled(T,E);if(!$)return!0;if($?b=T:(b="v"===T?"h":"v",$=locationCouldBeScrolled(T,E)),!$)return!1;if(!g.current&&"changedTouches"in c&&(_||k)&&(g.current=b),!b)return!0;var I=g.current||b;return handleScroll(I,u,c,"h"===I?_:k,!0)},[]),_=K.useCallback(function(c){if(eP.length&&eP[eP.length-1]===v){var f="deltaY"in c?getDeltaXY(c):getTouchXY(c),g=u.current.filter(function(u){var g;return u.name===c.type&&u.target===c.target&&(g=u.delta)[0]===f[0]&&g[1]===f[1]})[0];if(g&&g.should){c.cancelable&&c.preventDefault();return}if(!g){var b=(x.current.shards||[]).map(extractRef).filter(Boolean).filter(function(u){return u.contains(c.target)});(b.length>0?w(c,b[0]):!x.current.noIsolation)&&c.cancelable&&c.preventDefault()}}},[]),k=K.useCallback(function(c,f,g,b){var v={name:c,delta:f,target:g,should:b};u.current.push(v),setTimeout(function(){u.current=u.current.filter(function(c){return c!==v})},1)},[]),E=K.useCallback(function(c){f.current=getTouchXY(c),g.current=void 0},[]),T=K.useCallback(function(u){k(u.type,getDeltaXY(u),u.target,w(u,c.lockRef.current))},[]),$=K.useCallback(function(u){k(u.type,getTouchXY(u),u.target,w(u,c.lockRef.current))},[]);K.useEffect(function(){return eP.push(v),c.setCallbacks({onScrollCapture:T,onWheelCapture:T,onTouchMoveCapture:$}),document.addEventListener("wheel",_,eC),document.addEventListener("touchmove",_,eC),document.addEventListener("touchstart",E,eC),function(){eP=eP.filter(function(c){return c!==v}),document.removeEventListener("wheel",_,eC),document.removeEventListener("touchmove",_,eC),document.removeEventListener("touchstart",E,eC)}},[]);var I=c.removeScrollBar,M=c.inert;return K.createElement(K.Fragment,null,M?K.createElement(v,{styles:"\n  .block-interactivity-".concat(b," {pointer-events: none;}\n  .allow-interactivity-").concat(b," {pointer-events: all;}\n")}):null,I?K.createElement(RemoveScrollBar,{gapMode:"margin"}):null)}),e$=K.forwardRef(function(c,u){return K.createElement(ev,__assign({},c,{ref:u,sideCar:eT}))});e$.classNames=ev.classNames;var eI=new WeakMap,eA=new WeakMap,eM={},ej=0,unwrapHost=function(c){return c&&(c.host||unwrapHost(c.parentNode))},applyAttributeToOthers=function(c,u,f,g){var b=(Array.isArray(c)?c:[c]).map(function(c){if(u.contains(c))return c;var f=unwrapHost(c);return f&&u.contains(f)?f:(console.error("aria-hidden",c,"in not contained inside",u,". Doing nothing"),null)}).filter(function(c){return!!c});eM[f]||(eM[f]=new WeakMap);var v=eM[f],x=[],w=new Set,_=new Set(b),keep=function(c){!c||w.has(c)||(w.add(c),keep(c.parentNode))};b.forEach(keep);var deep=function(c){!c||_.has(c)||Array.prototype.forEach.call(c.children,function(c){if(w.has(c))deep(c);else{var u=c.getAttribute(g),b=null!==u&&"false"!==u,_=(eI.get(c)||0)+1,k=(v.get(c)||0)+1;eI.set(c,_),v.set(c,k),x.push(c),1===_&&b&&eA.set(c,!0),1===k&&c.setAttribute(f,"true"),b||c.setAttribute(g,"true")}})};return deep(u),w.clear(),ej++,function(){x.forEach(function(c){var u=eI.get(c)-1,b=v.get(c)-1;eI.set(c,u),v.set(c,b),u||(eA.has(c)||c.removeAttribute(g),eA.delete(c)),b||c.removeAttribute(f)}),--ej||(eI=new WeakMap,eI=new WeakMap,eA=new WeakMap,eM={})}},hideOthers=function(c,u,f){void 0===f&&(f="data-aria-hidden");var g=Array.from(Array.isArray(c)?c:[c]),b=u||("undefined"==typeof document?null:(Array.isArray(c)?c[0]:c).ownerDocument.body);return b?(g.push.apply(g,Array.from(b.querySelectorAll("[aria-live]"))),applyAttributeToOthers(g,b,f,"aria-hidden")):function(){return null}};let eO="Dialog",[eR,eD]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(eO),[eL,eN]=eR(eO),eF="DialogPortal",[eB,ez]=eR(eF,{forceMount:void 0}),eG="DialogOverlay",eU=(0,K.forwardRef)((c,u)=>{let f=ez(eG,c.__scopeDialog),{forceMount:g=f.forceMount,...b}=c,v=eN(eG,c.__scopeDialog);return v.modal?(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||v.open},(0,K.createElement)(eH,_extends({},b,{ref:u}))):null}),eH=(0,K.forwardRef)((c,u)=>{let{__scopeDialog:f,...g}=c,b=eN(eG,f);return(0,K.createElement)(e$,{as:ee,allowPinchZoom:!0,shards:[b.contentRef]},(0,K.createElement)(en.div,_extends({"data-state":$5d3850c4d0b4e6c7$var$getState(b.open)},g,{ref:u,style:{pointerEvents:"auto",...g.style}})))}),eV="DialogContent",eW=(0,K.forwardRef)((c,u)=>{let f=ez(eV,c.__scopeDialog),{forceMount:g=f.forceMount,...b}=c,v=eN(eV,c.__scopeDialog);return(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||v.open},v.modal?(0,K.createElement)(eK,_extends({},b,{ref:u})):(0,K.createElement)(eZ,_extends({},b,{ref:u})))}),eK=(0,K.forwardRef)((c,u)=>{let f=eN(eV,c.__scopeDialog),g=(0,K.useRef)(null),b=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,f.contentRef,g);return(0,K.useEffect)(()=>{let c=g.current;if(c)return hideOthers(c)},[]),(0,K.createElement)(eY,_extends({},c,{ref:b,trapFocus:f.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onCloseAutoFocus,c=>{var u;c.preventDefault(),null===(u=f.triggerRef.current)||void 0===u||u.focus()}),onPointerDownOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDownOutside,c=>{let u=c.detail.originalEvent,f=0===u.button&&!0===u.ctrlKey,g=2===u.button||f;g&&c.preventDefault()}),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusOutside,c=>c.preventDefault())}))}),eZ=(0,K.forwardRef)((c,u)=>{let f=eN(eV,c.__scopeDialog),g=(0,K.useRef)(!1),b=(0,K.useRef)(!1);return(0,K.createElement)(eY,_extends({},c,{ref:u,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var v,x;null===(v=c.onCloseAutoFocus)||void 0===v||v.call(c,u),u.defaultPrevented||(g.current||null===(x=f.triggerRef.current)||void 0===x||x.focus(),u.preventDefault()),g.current=!1,b.current=!1},onInteractOutside:u=>{var v,x;null===(v=c.onInteractOutside)||void 0===v||v.call(c,u),u.defaultPrevented||(g.current=!0,"pointerdown"!==u.detail.originalEvent.type||(b.current=!0));let w=u.target,_=null===(x=f.triggerRef.current)||void 0===x?void 0:x.contains(w);_&&u.preventDefault(),"focusin"===u.detail.originalEvent.type&&b.current&&u.preventDefault()}}))}),eY=(0,K.forwardRef)((c,u)=>{let{__scopeDialog:f,trapFocus:g,onOpenAutoFocus:b,onCloseAutoFocus:v,...x}=c,w=eN(eV,f),_=(0,K.useRef)(null),k=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,_);return $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),(0,K.createElement)(K.Fragment,null,(0,K.createElement)(eu,{asChild:!0,loop:!0,trapped:g,onMountAutoFocus:b,onUnmountAutoFocus:v},(0,K.createElement)(eo,_extends({role:"dialog",id:w.contentId,"aria-describedby":w.descriptionId,"aria-labelledby":w.titleId,"data-state":$5d3850c4d0b4e6c7$var$getState(w.open)},x,{ref:k,onDismiss:()=>w.onOpenChange(!1)}))),!1)}),eX="DialogTitle",eJ=(0,K.forwardRef)((c,u)=>{let{__scopeDialog:f,...g}=c,b=eN(eX,f);return(0,K.createElement)(en.h2,_extends({id:b.titleId},g,{ref:u}))}),eQ=(0,K.forwardRef)((c,u)=>{let{__scopeDialog:f,...g}=c,b=eN("DialogClose",f);return(0,K.createElement)(en.button,_extends({type:"button"},g,{ref:u,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onClick,()=>b.onOpenChange(!1))}))});function $5d3850c4d0b4e6c7$var$getState(c){return c?"open":"closed"}let[e0,e1]=$c512c27ab02ef895$export$fd42f52fd3ae1109("DialogTitleWarning",{contentName:eV,titleName:eX,docsSlug:"dialog"}),$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9=c=>{let{__scopeDialog:u,children:f,open:g,defaultOpen:b,onOpenChange:v,modal:x=!0}=c,w=(0,K.useRef)(null),_=(0,K.useRef)(null),[k=!1,E]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:g,defaultProp:b,onChange:v});return(0,K.createElement)(eL,{scope:u,triggerRef:w,contentRef:_,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),titleId:$1746a345f3d73bb7$export$f680877a34711e37(),descriptionId:$1746a345f3d73bb7$export$f680877a34711e37(),open:k,onOpenChange:E,onOpenToggle:(0,K.useCallback)(()=>E(c=>!c),[E]),modal:x},f)},$5d3850c4d0b4e6c7$export$602eac185826482c=c=>{let{__scopeDialog:u,forceMount:f,children:g,container:b}=c,v=eN(eF,u);return(0,K.createElement)(eB,{scope:u,forceMount:f},K.Children.map(g,c=>(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:f||v.open},(0,K.createElement)(eh,{asChild:!0,container:b},c))))};var e2=f(42744),e5=f(39957),e3=f(83925),e8=f(40563),e4=f(47110),e6=f(45958),e7=f(62601);let e9={},te={preventDefaultLogging:createDebugValue("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:createDebugValue("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:createDebugValue("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:createDebugValue("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:createDebugValue("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:createDebugValue("debugSvg",{defaults:{all:!1}}),throwToBlob:createDebugValue("throwToBlob",{defaults:{all:!1}}),logMessages:createDebugValue("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:createDebugValue("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:createDebugValue("debugCursors",{defaults:{all:!1}}),forceSrgb:createDebugValue("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:createDebugValue("debugGeometry",{defaults:{all:!1}}),hideShapes:createDebugValue("hideShapes",{defaults:{all:!1}})};if("undefined"!=typeof window&&(window.tldrawLog=c=>{te.logMessages.set(te.logMessages.value.concat(c))}),"undefined"!=typeof Element){let c=Element.prototype.removeChild;(0,e5.Ym)("element removal logging",()=>{te.elementRemovalLogging.value?Element.prototype.removeChild=function(u){return console.warn("[tldraw] removing child:",u),c.call(this,u)}:Element.prototype.removeChild=c})}function createDebugValue(c,{defaults:u,shouldStoreForSession:f=!0}){return createDebugValueBase({name:c,defaults:u,shouldStoreForSession:f})}function createDebugValueBase(c){let u=getDefaultValue(c),f=c.shouldStoreForSession?getStoredInitialValue(c.name):null,g=(0,e5.cn)(`debug:${c.name}`,f??u);return"undefined"!=typeof window&&(c.shouldStoreForSession&&(0,e5.Ym)(`debug:${c.name}`,()=>{let f=g.value;try{f===u?window.sessionStorage.removeItem(`tldraw_debug:${c.name}`):window.sessionStorage.setItem(`tldraw_debug:${c.name}`,JSON.stringify(f))}catch{}}),Object.defineProperty(window,`tldraw${c.name.replace(/^[a-z]/,c=>c.toUpperCase())}`,{get:()=>g.value,set(c){g.set(c)},configurable:!0})),Object.assign(g,c)}function getStoredInitialValue(c){try{return JSON.parse(window?.sessionStorage.getItem(`tldraw_debug:${c}`)??"null")}catch(c){return null}}function readEnv(c){try{return c()}catch{return null}}function getDefaultValue(c){let u=readEnv(()=>e7.env.TLDRAW_ENV)??readEnv(()=>e7.env.VERCEL_PUBLIC_TLDRAW_ENV)??readEnv(()=>e7.env.NEXT_PUBLIC_TLDRAW_ENV)??"production";switch(u){case"production":return c.defaults.production??c.defaults.all;case"preview":case"staging":return c.defaults.staging??c.defaults.all;default:return c.defaults.development??c.defaults.all}}function loopToHtmlElement(c){if(c instanceof HTMLElement)return c;if(c.parentElement)return loopToHtmlElement(c.parentElement);throw Error("Could not find a parent element of an HTML type!")}function preventDefault(c){c.preventDefault(),te.preventDefaultLogging.value&&console.warn("preventDefault called on event:",c)}function setPointerCapture(c,u){if(c.setPointerCapture(u.pointerId),te.pointerCaptureTracking.value){let u=te.pointerCaptureTrackingObject.value;u.set(c,(u.get(c)??0)+1)}te.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",c,u)}function releasePointerCapture(c,u){if(c.hasPointerCapture(u.pointerId)){if(c.releasePointerCapture(u.pointerId),te.pointerCaptureTracking.value){let u=te.pointerCaptureTrackingObject.value;1===u.get(c)?u.delete(c):u.has(c)?u.set(c,u.get(c)-1):console.warn("Release without capture")}te.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",c,u)}}let stopEventPropagation=c=>c.stopPropagation();function getPointerInfo(c){return c.isKilled=!0,{point:{x:c.clientX,y:c.clientY,z:c.pressure},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:c.pointerId,button:c.button,isPen:"pen"===c.pointerType}}var tt=f(3373);function useCanvasEvents(){let c=(0,tt.j)(),u=(0,K.useMemo)(function(){let u,f;return{onPointerDown:function(u){if(!u.isKilled){if(2===u.button){c.dispatch({type:"pointer",target:"canvas",name:"right_click",...getPointerInfo(u)});return}(0===u.button||1===u.button||5===u.button)&&(setPointerCapture(u.currentTarget,u),c.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...getPointerInfo(u)}),c.openMenus.length>0&&(document.body.click(),c.getContainer().focus()))}},onPointerMove:function(g){g.isKilled||g.clientX===u&&g.clientY===f||(u=g.clientX,f=g.clientY,c.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...getPointerInfo(g)}))},onPointerUp:function(g){g.isKilled||0!==g.button&&1!==g.button&&2!==g.button&&5!==g.button||(u=g.clientX,f=g.clientY,releasePointerCapture(g.currentTarget,g),c.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...getPointerInfo(g)}))},onPointerEnter:function(u){if(u.isKilled||c.instanceState.isPenMode&&"pen"!==u.pointerType)return;let f="mouse"===u.pointerType||"pen"===u.pointerType;c.updateInstanceState({isHoveringCanvas:!!f||null})},onPointerLeave:function(u){if(u.isKilled||c.instanceState.isPenMode&&"pen"!==u.pointerType)return;let f="mouse"===u.pointerType||"pen"===u.pointerType;c.updateInstanceState({isHoveringCanvas:!f&&null})},onDragOver:function(c){preventDefault(c)},onDrop:async function(u){if(preventDefault(u),!u.dataTransfer?.files?.length)return;let f=Array.from(u.dataTransfer.files);await c.putExternalContent({type:"files",files:f,point:c.screenToPage({x:u.clientX,y:u.clientY}),ignoreParent:!1})},onTouchStart:function(c){c.isKilled=!0,document.body.click(),preventDefault(c)},onTouchEnd:function(c){c.isKilled=!0,"A"!==c.target.tagName&&"TEXTAREA"!==c.target.tagName&&preventDefault(c)},onClick:function(c){stopEventPropagation(c)}}},[c]);return u}function useCoarsePointer(){let c=(0,tt.j)();(0,K.useEffect)(()=>{if(c.environment.isFirefox&&!c.environment.isAndroid&&!c.environment.isIos){c.updateInstanceState({isCoarsePointer:!1});return}if(window.matchMedia){let u=window.matchMedia("(pointer: coarse)"),handler=()=>{c.updateInstanceState({isCoarsePointer:!!u.matches})};if(handler(),u)return u.addEventListener("change",handler),()=>u.removeEventListener("change",handler)}},[c])}let tn=(0,K.createContext)(null);function ContainerProvider({container:c,children:u}){return(0,V.jsx)(tn.Provider,{value:c,children:u})}function useContainer(){return(0,e4.kP)((0,K.useContext)(tn),"useContainer used outside of <Tldraw />")}function useDocumentEvents(){let c=(0,tt.j)(),u=useContainer(),f=(0,e5.Hg)("isFocused",()=>c.instanceState.isFocused,[c]);(0,K.useEffect)(()=>{let u=null,updatePixelRatio=()=>{null!=u&&u();let f=`(resolution: ${window.devicePixelRatio}dppx)`,g=matchMedia(f);g.addEventListener("change",updatePixelRatio),u=()=>{g.removeEventListener("change",updatePixelRatio)},c.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return updatePixelRatio(),()=>{u?.()}},[c]),(0,K.useEffect)(()=>{if(!f)return;let handleKeyDown=f=>{if(f.altKey&&(c.isIn("zoom")||!c.root.path.value.endsWith(".idle"))&&!isFocusingInput()&&preventDefault(f),f.isKilled)return;switch(f.isKilled=!0,f.key){case"=":case"-":case"0":if(f.metaKey||f.ctrlKey){preventDefault(f);return}break;case"Tab":default:if(isFocusingInput()||c.isMenuOpen)return;break;case",":if(!isFocusingInput()&&(preventDefault(f),!c.inputs.keys.has("Comma"))){let{x:u,y:g,z:b}=c.inputs.currentScreenPoint;c.inputs.keys.add("Comma");let v={type:"pointer",name:"pointer_down",point:{x:u,y:g,z:b},shiftKey:f.shiftKey,altKey:f.altKey,ctrlKey:f.metaKey||f.ctrlKey,pointerId:0,button:0,isPen:c.instanceState.isPenMode,target:"canvas"};c.dispatch(v);return}break;case"Escape":if((c.editingShape||c.selectedShapeIds.length>0)&&f.preventDefault(),c.openMenus.length>0)return;c.inputs.keys.has("Escape")||(c.inputs.keys.add("Escape"),c.cancel(),u.focus());return}let g={type:"keyboard",name:f.repeat?"key_repeat":"key_down",key:f.key,code:f.code,shiftKey:f.shiftKey,altKey:f.altKey,ctrlKey:f.metaKey||f.ctrlKey};c.dispatch(g)},handleKeyUp=u=>{if(u.isKilled||(u.isKilled=!0,isFocusingInput()||c.isMenuOpen))return;if(","===u.key&&(document.activeElement?.ELEMENT_NODE&&preventDefault(u),c.inputs.keys.has(u.code))){let{x:f,y:g,z:b}=c.inputs.currentScreenPoint;c.inputs.keys.delete(u.code);let v={type:"pointer",name:"pointer_up",point:{x:f,y:g,z:b},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey,pointerId:0,button:0,isPen:c.instanceState.isPenMode,target:"canvas"};c.dispatch(v);return}let f={type:"keyboard",name:"key_up",key:u.key,code:u.code,shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey};c.dispatch(f)};function handleTouchStart(f){if(u.contains(f.target)){let u=f.touches[0].pageX,g=f.touches[0].radiusX||0;(u-g<10||u+g>c.viewportScreenBounds.width-10)&&(f.target?.tagName==="BUTTON"&&f.target?.click(),preventDefault(f))}}let handleWheel=c=>{u.contains(c.target)&&(c.ctrlKey||c.metaKey)&&preventDefault(c)};return u.addEventListener("touchstart",handleTouchStart,{passive:!1}),u.addEventListener("wheel",handleWheel,{passive:!1}),document.addEventListener("gesturestart",preventDefault),document.addEventListener("gesturechange",preventDefault),document.addEventListener("gestureend",preventDefault),u.addEventListener("keydown",handleKeyDown),u.addEventListener("keyup",handleKeyUp),()=>{u.removeEventListener("touchstart",handleTouchStart),u.removeEventListener("wheel",handleWheel),document.removeEventListener("gesturestart",preventDefault),document.removeEventListener("gesturechange",preventDefault),document.removeEventListener("gestureend",preventDefault),u.removeEventListener("keydown",handleKeyDown),u.removeEventListener("keyup",handleKeyUp)}},[c,u,f])}let ti=["input","select","button","textarea"];function isFocusingInput(){let{activeElement:c}=document;return!!(c&&(c.getAttribute("contenteditable")||ti.indexOf(c.tagName.toLowerCase())>-1))}let to={error:null};let ErrorBoundary=class ErrorBoundary extends K.Component{static getDerivedStateFromError(c){return{error:c}}state=to;componentDidCatch(c){this.props.onError?.(c)}render(){let{error:c}=this.state;if(null!==c){let{fallback:u}=this.props;return(0,V.jsx)(u,{error:c})}return this.props.children}};function OptionalErrorBoundary({children:c,fallback:u,...f}){return null===u?(0,V.jsx)(V.Fragment,{children:c}):(0,V.jsx)(ErrorBoundary,{fallback:u,...f,children:c})}let ShapeWithPropsEquality=class ShapeWithPropsEquality{constructor(c){this.shape=c}equals(c){return this.shape?.isLocked===c?.shape?.isLocked&&this.shape?.props===c?.shape?.props&&this.shape?.meta===c?.shape?.meta}};let EvenInnererIndicator=({shape:c,util:u})=>(0,e5.uC)("Indicator:"+c.type,()=>u.indicator(c)),InnerIndicator=({editor:c,id:u})=>{let f=(0,e5.Hg)("shape",()=>new ShapeWithPropsEquality(c.store.get(u)),[c,u]),{ShapeIndicatorErrorFallback:g}=useEditorComponents();return!f.shape||f.shape.isLocked?null:(0,V.jsx)(OptionalErrorBoundary,{fallback:g,onError:u=>c.annotateError(u,{origin:"react.shapeIndicator",willCrashApp:!1}),children:(0,V.jsx)(EvenInnererIndicator,{shape:f.shape,util:c.getShapeUtil(f.shape)},f.shape.id)})},ta=K.memo(({id:c,className:u,color:f,opacity:g})=>{let b=(0,tt.j)(),v=(0,e5.Hg)("transform",()=>{let u=b.getShapePageTransform(c);return u?u.toCssString():""},[b,c]);return(0,V.jsx)("svg",{className:e2("tl-overlays__item",u),children:(0,V.jsx)("g",{className:"tl-shape-indicator",transform:v,stroke:f??"var(--color-selected)",opacity:g,children:(0,V.jsx)(InnerIndicator,{editor:b,id:c})})})});function DefaultBackground(){return(0,V.jsx)("div",{className:"tl-background"})}function useTransform(c,u,f,g,b,v){(0,K.useLayoutEffect)(()=>{let x=c.current;if(!x||void 0===u)return;let w=`translate(${u}px, ${f}px)`;void 0!==g&&(w+=` scale(${g})`),void 0!==b&&(w+=` rotate(${b}rad)`),v&&(w+=` translate(${v.x}px, ${v.y}px)`),x.style.transform=w})}var ts=f(46166);let DefaultBrush=({brush:c,color:u,opacity:f})=>{let g=(0,K.useRef)(null);useTransform(g,c.x,c.y);let b=(0,ts.$Z)(Math.max(1,c.w)),v=(0,ts.$Z)(Math.max(1,c.h));return(0,V.jsx)("svg",{className:"tl-overlays__item",ref:g,children:u?(0,V.jsxs)("g",{className:"tl-brush",opacity:f,children:[(0,V.jsx)("rect",{width:b,height:v,fill:u,opacity:.75}),(0,V.jsx)("rect",{width:b,height:v,fill:"none",stroke:u,opacity:.1})]}):(0,V.jsx)("rect",{className:"tl-brush tl-brush__default",width:b,height:v})})};var tl=f(56799);let DefaultCollaboratorHint=({className:c,zoom:u,point:f,color:g,viewport:b,opacity:v=1})=>{let x=(0,K.useRef)(null);return useTransform(x,(0,ts.uZ)(f.x,b.minX+5/u,b.maxX-5/u),(0,ts.uZ)(f.y,b.minY+5/u,b.maxY-5/u),1/u,tl.G.Angle(b.center,f)),(0,V.jsxs)("svg",{ref:x,className:e2("tl-overlays__item",c),children:[(0,V.jsx)("use",{href:"#cursor_hint",color:g,strokeWidth:3,stroke:"var(--color-background)"}),(0,V.jsx)("use",{href:"#cursor_hint",color:g,opacity:v})]})},tc=(0,K.memo)(({className:c,zoom:u,point:f,color:g,name:b,chatMessage:v})=>{let x=(0,K.useRef)(null);return(useTransform(x,f?.x,f?.y,1/u),f)?(0,V.jsxs)("div",{ref:x,className:e2("tl-overlays__item",c),children:[(0,V.jsx)("svg",{className:"tl-cursor",children:(0,V.jsx)("use",{href:"#cursor",color:g})}),v?(0,V.jsxs)(V.Fragment,{children:[b&&(0,V.jsx)("div",{className:"tl-nametag-title",style:{color:g},children:b}),(0,V.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:g},children:v})]}):b&&(0,V.jsx)("div",{className:"tl-nametag",style:{backgroundColor:g},children:b})]}):null}),tu={openWindow:(c,u)=>window.open(c,u,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>await window.__tldraw__hardReset?.()};function setRuntimeOverrides(c){Object.assign(tu,c)}function hardResetEditor(){tu.hardReset()}function refreshPage(){tu.refreshPage()}function noop(){}let DefaultErrorFallback=({error:c,editor:u})=>{let f=(0,K.useRef)(null),[g,b]=(0,K.useState)(!1),[v,x]=(0,K.useState)(!1),[w,_]=(0,K.useState)(!1),k=c instanceof Error?c.message:String(c),E=c instanceof Error?c.stack:null,T=(0,e5.Hg)("isDarkMode",()=>{try{if(u)return u.user.isDarkMode}catch{}return null},[u]),[$,I]=(0,K.useState)(null);(0,K.useLayoutEffect)(()=>{null!==T&&I(T);let c=f.current?.parentElement,u=!1;for(;c;){if(c.classList.contains("tl-theme__dark")||c.classList.contains("tl-theme__light")){u=!0;break}c=c.parentElement}if(u){I(null);return}I(window.matchMedia("(prefers-color-scheme: dark)").matches)},[T]),(0,K.useEffect)(()=>{if(v){let c=setTimeout(()=>{x(!1)},2e3);return()=>clearTimeout(c)}},[v]);let resetLocalState=async()=>{hardResetEditor()},M=new URL("https://github.com/tldraw/tldraw/issues/new");return M.searchParams.set("title",k),M.searchParams.set("labels","bug"),M.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${E??k}
\`\`\`

My browser: ${navigator.userAgent}`),(0,V.jsxs)("div",{ref:f,className:e2("tl-container tl-error-boundary",null===$?"":$?"tl-theme__dark":"tl-theme__light"),children:[(0,V.jsx)("div",{className:"tl-error-boundary__overlay"}),u&&(0,V.jsx)(ErrorBoundary,{onError:noop,fallback:()=>null,children:(0,V.jsx)(tt.r.Provider,{value:u,children:(0,V.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,V.jsx)(Canvas,{})})})}),(0,V.jsx)("div",{className:e2("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":g&&!w}),children:w?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("h2",{children:"Are you sure?"}),(0,V.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,V.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,V.jsx)("button",{onClick:()=>_(!1),children:"Cancel"}),(0,V.jsx)("button",{className:"tl-error-boundary__reset",onClick:resetLocalState,children:"Reset data"})]})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("h2",{children:"Something's gone wrong."}),(0,V.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,V.jsx)("a",{href:M.toString(),children:"create a GitHub issue"})," or"," ",(0,V.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),g&&(0,V.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,V.jsx)("pre",{children:(0,V.jsx)("code",{children:E??k})}),(0,V.jsx)("button",{onClick:()=>{let c=document.createElement("textarea");c.value=E??k,document.body.appendChild(c),c.select(),document.execCommand("copy"),c.remove(),x(!0)},children:v?"Copied!":"Copy"})]}),(0,V.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,V.jsx)("button",{onClick:()=>b(!g),children:g?"Hide details":"Show details"}),(0,V.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,V.jsx)("button",{className:"tl-error-boundary__reset",onClick:()=>_(!0),children:"Reset data"}),(0,V.jsx)("button",{className:"tl-error-boundary__refresh",onClick:()=>{refreshPage()},children:"Refresh Page"})]})]})]})})]})};var td=f(57655);let DefaultGrid=({x:c,y:u,z:f,size:g})=>(0,V.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,V.jsx)("defs",{children:td.dW.map(({min:b,mid:v,step:x},w)=>{let _=x*g*f,k=.5+c*f,E=.5+u*f,T=f<v?(0,e4.vm)(f,[b,v],[0,1]):1;return(0,V.jsx)("pattern",{id:`grid-${x}`,width:_,height:_,patternUnits:"userSpaceOnUse",children:(0,V.jsx)("circle",{className:"tl-grid-dot",cx:k>0?k%_:_+k%_,cy:E>0?E%_:_+E%_,r:1,opacity:T})},`grid-pattern-${w}`)})}),td.dW.map(({step:c},u)=>(0,V.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${c})`},`grid-rect-${u}`))]}),DefaultHandle=({handle:c,isCoarse:u,className:f,zoom:g})=>{let b=("create"===c.type&&u?3:4)/g;return(0,V.jsxs)("g",{className:e2("tl-handle",{"tl-handle__virtual":"virtual"===c.type,"tl-handle__create":"create"===c.type},f),children:[(0,V.jsx)("circle",{className:"tl-handle__bg",r:(u?20:12)/g}),(0,V.jsx)("circle",{className:"tl-handle__fg",r:b})]})},DefaultHandles=({children:c})=>(0,V.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:c}),DefaultHoveredShapeIndicator=({shapeId:c})=>(0,V.jsx)(ta,{className:"tl-user-indicator__hovered",id:c});function getSvgPathFromPoints_getSvgPathFromPoints(c,u=!0){let f=c.length;if(f<2)return"";let g=c[0],b=c[1];if(2===f)return`M${(0,ts.Yk)(g)}L${(0,ts.Yk)(b)}`;let v="";for(let u=2,x=f-1;u<x;u++)g=c[u],b=c[u+1],v+=(0,ts.Y8)(g,b);return u?`M${(0,ts.Y8)(c[0],c[1])}Q${(0,ts.Yk)(c[1])}${(0,ts.Y8)(c[1],c[2])}T${v}${(0,ts.Y8)(c[f-1],c[0])}${(0,ts.Y8)(c[0],c[1])}Z`:`M${(0,ts.Yk)(c[0])}Q${(0,ts.Yk)(c[1])}${(0,ts.Y8)(c[1],c[2])}${c.length>3?"T":""}${v}L${(0,ts.Yk)(c[f-1])}`}let DefaultScribble=({scribble:c,zoom:u,color:f,opacity:g,className:b})=>c.points.length?(0,V.jsx)("svg",{className:b?e2("tl-overlays__item",b):b,children:(0,V.jsx)("path",{className:"tl-scribble",d:getSvgPathFromPoints_getSvgPathFromPoints(c.points,!1),stroke:f??`var(--color-${c.color})`,fill:"none",strokeWidth:8/u,opacity:g??c.opacity})}):null,DefaultSelectionBackground=({bounds:c,rotation:u})=>{let f=K.useRef(null);return useTransform(f,c.x,c.y,1,u),K.useLayoutEffect(()=>{let u=f.current;u&&(u.style.width=(0,ts.$Z)(Math.max(1,c.width))+"px",u.style.height=(0,ts.$Z)(Math.max(1,c.height))+"px")},[c.width,c.height]),(0,V.jsx)("div",{ref:f,className:"tl-selection__bg",draggable:!1})},DefaultSelectionForeground=({bounds:c,rotation:u})=>{let f=(0,tt.j)(),g=(0,K.useRef)(null),b=(0,e5.Hg)("only selected shape",()=>f.onlySelectedShape,[f]),v=b?f.getShapeUtil(b).expandSelectionOutlinePx(b):0;return useTransform(g,c?.x,c?.y,1,u,{x:-v,y:-v}),c=c.clone().expandBy(v).zeroFix(),(0,V.jsx)("svg",{ref:g,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:(0,V.jsx)("rect",{className:e2("tl-selection__fg__outline"),width:(0,ts.$Z)(c.width),height:(0,ts.$Z)(c.height)})})},DefaultShapeErrorFallback=()=>(0,V.jsx)("div",{className:"tl-shape-error-boundary"}),DefaultShapeIndicatorErrorFallback=()=>(0,V.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function PointsSnapLine({points:c,zoom:u}){let f,g,b,v;let x=2.5/u,w=c.reduce((c,u)=>Math.min(c,u.x),1/0),_=c.reduce((c,u)=>Math.max(c,u.x),-1/0),k=c.reduce((c,u)=>Math.min(c,u.y),1/0),E=c.reduce((c,u)=>Math.max(c,u.y),-1/0),T=c.some(c=>c.x===w&&c.y===k);return T?(f=w,g=k,b=_,v=E):(f=w,g=E,b=_,v=k),(0,V.jsxs)("g",{className:"tl-snap-line",children:[(0,V.jsx)("line",{x1:f,y1:g,x2:b,y2:v}),c.map((c,u)=>(0,V.jsx)("g",{transform:`translate(${c.x},${c.y})`,children:(0,V.jsx)("path",{className:"tl-snap-point",d:`M ${-x},${-x} L ${x},${x} M ${-x},${x} L ${x},${-x}`})},u))]})}function GapsSnapLine({gaps:c,direction:u,zoom:f}){let g=3.5/f,b=[-1/0,1/0],v=null,x="horizontal"===u;for(let u of c)(v=(0,ts.mW)(b[0],b[1],x?u.startEdge[0].y:u.startEdge[0].x,x?u.startEdge[1].y:u.startEdge[1].x))&&(b=v,(v=(0,ts.mW)(b[0],b[1],x?u.endEdge[0].y:u.endEdge[0].x,x?u.endEdge[1].y:u.endEdge[1].x))&&(b=v));if(null===b)return null;let w=(b[0]+b[1])/2;return(0,V.jsx)("g",{className:"tl-snap-line",children:c.map(({startEdge:c,endEdge:u},f)=>(0,V.jsx)(K.Fragment,{children:x?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("line",{x1:c[0].x,y1:w-2*g,x2:c[1].x,y2:w+2*g}),(0,V.jsx)("line",{x1:u[0].x,y1:w-2*g,x2:u[1].x,y2:w+2*g}),(0,V.jsx)("line",{x1:c[0].x,y1:w,x2:u[0].x,y2:w}),(0,V.jsx)("line",{x1:(c[0].x+u[0].x)/2,y1:w-g,x2:(c[0].x+u[0].x)/2,y2:w+g})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("line",{x1:w-2*g,y1:c[0].y,x2:w+2*g,y2:c[1].y}),(0,V.jsx)("line",{x1:w-2*g,y1:u[0].y,x2:w+2*g,y2:u[1].y}),(0,V.jsx)("line",{x1:w,y1:c[0].y,x2:w,y2:u[0].y}),(0,V.jsx)("line",{x1:w-g,y1:(c[0].y+u[0].y)/2,x2:w+g,y2:(c[0].y+u[0].y)/2})]})},f))})}let DefaultSnapLine=({className:c,line:u,zoom:f})=>(0,V.jsx)("svg",{className:e2("tl-overlays__item",c),children:"points"===u.type?(0,V.jsx)(PointsSnapLine,{...u,zoom:f}):"gaps"===u.type?(0,V.jsx)(GapsSnapLine,{...u,zoom:f}):null}),DefaultSpinner=()=>(0,V.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,V.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,V.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,V.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,V.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),DefaultSvgDefs=()=>null,th=(0,K.createContext)({});function EditorComponentsProvider({overrides:c,children:u}){return(0,V.jsx)(th.Provider,{value:(0,K.useMemo)(()=>({Background:DefaultBackground,SvgDefs:DefaultSvgDefs,Brush:DefaultBrush,ZoomBrush:DefaultBrush,CollaboratorBrush:DefaultBrush,Cursor:tc,CollaboratorCursor:tc,CollaboratorHint:DefaultCollaboratorHint,CollaboratorShapeIndicator:ta,Grid:DefaultGrid,Scribble:DefaultScribble,SnapLine:DefaultSnapLine,Handles:DefaultHandles,Handle:DefaultHandle,CollaboratorScribble:DefaultScribble,ErrorFallback:DefaultErrorFallback,ShapeErrorFallback:DefaultShapeErrorFallback,ShapeIndicatorErrorFallback:DefaultShapeIndicatorErrorFallback,Spinner:DefaultSpinner,SelectionBackground:DefaultSelectionBackground,SelectionForeground:DefaultSelectionForeground,HoveredShapeIndicator:DefaultHoveredShapeIndicator,...c}),[c]),children:u})}function useEditorComponents(){return(0,K.useContext)(th)}let tp=["textarea","input"];function useFixSafariDoubleTapZoomPencilEvents(c){let u=(0,tt.j)();(0,K.useEffect)(()=>{let f=c.current;if(!f)return;let handleEvent=c=>{if(c instanceof PointerEvent&&"pen"===c.pointerType){c.isKilled=!0;let{target:f}=c;tp.includes(f.tagName?.toLocaleLowerCase())||u.isIn("select.editing_shape")||preventDefault(c)}};return f.addEventListener("touchstart",handleEvent),f.addEventListener("touchend",handleEvent),()=>{f.removeEventListener("touchstart",handleEvent),f.addEventListener("touchend",handleEvent)}},[u,c])}function clamp(c,u,f){return Math.max(u,Math.min(c,f))}let tf={toVector:(c,u)=>(void 0===c&&(c=u),Array.isArray(c)?c:[c,c]),add:(c,u)=>[c[0]+u[0],c[1]+u[1]],sub:(c,u)=>[c[0]-u[0],c[1]-u[1]],addTo(c,u){c[0]+=u[0],c[1]+=u[1]},subTo(c,u){c[0]-=u[0],c[1]-=u[1]}};function rubberband(c,u,f){return 0===u||Math.abs(u)===1/0?Math.pow(c,5*f):c*u*f/(u+f*c)}function rubberbandIfOutOfBounds(c,u,f,g=.15){return 0===g?clamp(c,u,f):c<u?-rubberband(u-c,f-u,g)+u:c>f?+rubberband(c-f,f-u,g)+f:c}function computeRubberband(c,[u,f],[g,b]){let[[v,x],[w,_]]=c;return[rubberbandIfOutOfBounds(u,v,x,g),rubberbandIfOutOfBounds(f,w,_,b)]}function _toPrimitive(c,u){if("object"!=typeof c||null===c)return c;var f=c[Symbol.toPrimitive];if(void 0!==f){var g=f.call(c,u||"default");if("object"!=typeof g)return g;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(c)}function _toPropertyKey(c){var u=_toPrimitive(c,"string");return"symbol"==typeof u?u:String(u)}function _defineProperty(c,u,f){return(u=_toPropertyKey(u))in c?Object.defineProperty(c,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[u]=f,c}function ownKeys(c,u){var f=Object.keys(c);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(c);u&&(g=g.filter(function(u){return Object.getOwnPropertyDescriptor(c,u).enumerable})),f.push.apply(f,g)}return f}function _objectSpread2(c){for(var u=1;u<arguments.length;u++){var f=null!=arguments[u]?arguments[u]:{};u%2?ownKeys(Object(f),!0).forEach(function(u){_defineProperty(c,u,f[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(f)):ownKeys(Object(f)).forEach(function(u){Object.defineProperty(c,u,Object.getOwnPropertyDescriptor(f,u))})}return c}let tg={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(c){return c?c[0].toUpperCase()+c.slice(1):""}let tm=["enter","leave"];function hasCapture(c=!1,u){return c&&!tm.includes(u)}function toHandlerProp(c,u="",f=!1){let g=tg[c],b=g&&g[u]||u;return"on"+capitalize(c)+capitalize(b)+(hasCapture(f,b)?"Capture":"")}let ty=["gotpointercapture","lostpointercapture"];function parseProp(c){let u=c.substring(2).toLowerCase(),f=!!~u.indexOf("passive");f&&(u=u.replace("passive",""));let g=ty.includes(u)?"capturecapture":"capture",b=!!~u.indexOf(g);return b&&(u=u.replace("capture","")),{device:u,capture:b,passive:f}}function toDomEventType(c,u=""){let f=tg[c],g=f&&f[u]||u;return c+g}function isTouch(c){return"touches"in c}function getPointerType(c){return isTouch(c)?"touch":"pointerType"in c?c.pointerType:"mouse"}function getCurrentTargetTouchList(c){return Array.from(c.touches).filter(u=>{var f,g;return u.target===c.currentTarget||(null===(f=c.currentTarget)||void 0===f||null===(g=f.contains)||void 0===g?void 0:g.call(f,u.target))})}function distanceAngle(c,u){try{let f=u.clientX-c.clientX,g=u.clientY-c.clientY,b=(u.clientX+c.clientX)/2,v=(u.clientY+c.clientY)/2;return{angle:-(180*Math.atan2(f,g))/Math.PI,distance:Math.hypot(f,g),origin:[b,v]}}catch(c){}return null}function touchIds(c){return getCurrentTargetTouchList(c).map(c=>c.identifier)}function touchDistanceAngle(c,u){let[f,g]=Array.from(c.touches).filter(c=>u.includes(c.identifier));return distanceAngle(f,g)}function wheelValues(c){let{deltaX:u,deltaY:f,deltaMode:g}=c;return 1===g?(u*=40,f*=40):2===g&&(u*=800,f*=800),[u,f]}function getEventDetails(c){let u={};if("buttons"in c&&(u.buttons=c.buttons),"shiftKey"in c){let{shiftKey:f,altKey:g,metaKey:b,ctrlKey:v}=c;Object.assign(u,{shiftKey:f,altKey:g,metaKey:b,ctrlKey:v})}return u}function call(c,...u){return"function"==typeof c?c(...u):c}function actions_fe213e88_esm_noop(){}function chain(...c){return 0===c.length?actions_fe213e88_esm_noop:1===c.length?c[0]:function(){let u;for(let f of c)u=f.apply(this,arguments)||u;return u}}function assignDefault(c,u){return Object.assign({},u,c||{})}let Engine=class Engine{constructor(c,u,f){this.ctrl=c,this.args=u,this.key=f,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(c){this.ctrl.state[this.key]=c}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:c,shared:u,ingKey:f,args:g}=this;u[f]=c._active=c.active=c._blocked=c._force=!1,c._step=[!1,!1],c.intentional=!1,c._movement=[0,0],c._distance=[0,0],c._direction=[0,0],c._delta=[0,0],c._bounds=[[-1/0,1/0],[-1/0,1/0]],c.args=g,c.axis=void 0,c.memo=void 0,c.elapsedTime=c.timeDelta=0,c.direction=[0,0],c.distance=[0,0],c.overflow=[0,0],c._movementBound=[!1,!1],c.velocity=[0,0],c.movement=[0,0],c.delta=[0,0],c.timeStamp=0}start(c){let u=this.state,f=this.config;u._active||(this.reset(),this.computeInitial(),u._active=!0,u.target=c.target,u.currentTarget=c.currentTarget,u.lastOffset=f.from?call(f.from,u):u.offset,u.offset=u.lastOffset,u.startTime=u.timeStamp=c.timeStamp)}computeValues(c){let u=this.state;u._values=c,u.values=this.config.transform(c)}computeInitial(){let c=this.state;c._initial=c._values,c.initial=c.values}compute(c){let{state:u,config:f,shared:g}=this;u.args=this.args;let b=0;if(c&&(u.event=c,f.preventDefault&&c.cancelable&&u.event.preventDefault(),u.type=c.type,g.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,g.locked=!!document.pointerLockElement,Object.assign(g,getEventDetails(c)),g.down=g.pressed=g.buttons%2==1||g.touches>0,b=c.timeStamp-u.timeStamp,u.timeStamp=c.timeStamp,u.elapsedTime=u.timeStamp-u.startTime),u._active){let c=u._delta.map(Math.abs);tf.addTo(u._distance,c)}this.axisIntent&&this.axisIntent(c);let[v,x]=u._movement,[w,_]=f.threshold,{_step:k,values:E}=u;if(f.hasCustomTransform?(!1===k[0]&&(k[0]=Math.abs(v)>=w&&E[0]),!1===k[1]&&(k[1]=Math.abs(x)>=_&&E[1])):(!1===k[0]&&(k[0]=Math.abs(v)>=w&&Math.sign(v)*w),!1===k[1]&&(k[1]=Math.abs(x)>=_&&Math.sign(x)*_)),u.intentional=!1!==k[0]||!1!==k[1],!u.intentional)return;let T=[0,0];if(f.hasCustomTransform){let[c,u]=E;T[0]=!1!==k[0]?c-k[0]:0,T[1]=!1!==k[1]?u-k[1]:0}else T[0]=!1!==k[0]?v-k[0]:0,T[1]=!1!==k[1]?x-k[1]:0;this.restrictToAxis&&!u._blocked&&this.restrictToAxis(T);let $=u.offset,I=u._active&&!u._blocked||u.active;I&&(u.first=u._active&&!u.active,u.last=!u._active&&u.active,u.active=g[this.ingKey]=u._active,c&&(u.first&&("bounds"in f&&(u._bounds=call(f.bounds,u)),this.setup&&this.setup()),u.movement=T,this.computeOffset()));let[M,j]=u.offset,[[D,L],[F,B]]=u._bounds;u.overflow=[M<D?-1:M>L?1:0,j<F?-1:j>B?1:0],u._movementBound[0]=!!u.overflow[0]&&(!1===u._movementBound[0]?u._movement[0]:u._movementBound[0]),u._movementBound[1]=!!u.overflow[1]&&(!1===u._movementBound[1]?u._movement[1]:u._movementBound[1]);let G=u._active&&f.rubberband||[0,0];if(u.offset=computeRubberband(u._bounds,u.offset,G),u.delta=tf.sub(u.offset,$),this.computeMovement(),I&&(!u.last||b>32)){u.delta=tf.sub(u.offset,$);let c=u.delta.map(Math.abs);tf.addTo(u.distance,c),u.direction=u.delta.map(Math.sign),u._direction=u._delta.map(Math.sign),!u.first&&b>0&&(u.velocity=[c[0]/b,c[1]/b],u.timeDelta=b)}}emit(){let c=this.state,u=this.shared,f=this.config;if(c._active||this.clean(),(c._blocked||!c.intentional)&&!c._force&&!f.triggerAllEvents)return;let g=this.handler(_objectSpread2(_objectSpread2(_objectSpread2({},u),c),{},{[this.aliasKey]:c.values}));void 0!==g&&(c.memo=g)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function selectAxis([c,u],f){let g=Math.abs(c),b=Math.abs(u);return g>b&&g>f?"x":b>g&&b>f?"y":void 0}let CoordinatesEngine=class CoordinatesEngine extends Engine{constructor(...c){super(...c),_defineProperty(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=tf.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=tf.sub(this.state.offset,this.state.lastOffset)}axisIntent(c){let u=this.state,f=this.config;if(!u.axis&&c){let g="object"==typeof f.axisThreshold?f.axisThreshold[getPointerType(c)]:f.axisThreshold;u.axis=selectAxis(u._movement,g)}u._blocked=(f.lockDirection||!!f.axis)&&!u.axis||!!f.axis&&f.axis!==u.axis}restrictToAxis(c){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":c[1]=0;break;case"y":c[0]=0}}};let identity=c=>c,tb={enabled:(c=!0)=>c,eventOptions:(c,u,f)=>_objectSpread2(_objectSpread2({},f.shared.eventOptions),c),preventDefault:(c=!1)=>c,triggerAllEvents:(c=!1)=>c,rubberband(c=0){switch(c){case!0:return[.15,.15];case!1:return[0,0];default:return tf.toVector(c)}},from:c=>"function"==typeof c?c:null!=c?tf.toVector(c):void 0,transform(c,u,f){let g=c||f.shared.transform;return this.hasCustomTransform=!!g,g||identity},threshold:c=>tf.toVector(c,0)},tv=0,tS=_objectSpread2(_objectSpread2({},tb),{},{axis(c,u,{axis:f}){if(this.lockDirection="lock"===f,!this.lockDirection)return f},axisThreshold:(c=tv)=>c,bounds(c={}){if("function"==typeof c)return u=>tS.bounds(c(u));if("current"in c)return()=>c.current;if("function"==typeof HTMLElement&&c instanceof HTMLElement)return c;let{left:u=-1/0,right:f=1/0,top:g=-1/0,bottom:b=1/0}=c;return[[u,f],[g,b]]}}),tx="undefined"!=typeof window&&window.document&&window.document.createElement;function supportsTouchEvents(){return tx&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||tx&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return tx&&"onpointerdown"in window}function supportsPointerLock(){return tx&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch(c){return!1}}let tw={isBrowser:tx,gesture:supportsGestureEvents(),touch:supportsTouchEvents(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},t_=10,tk={mouse:0,touch:0,pen:8};function clampStateInternalMovementToBounds(c){let[u,f]=c.overflow,[g,b]=c._delta,[v,x]=c._direction;(u<0&&g>0&&v<0||u>0&&g<0&&v>0)&&(c._movement[0]=c._movementBound[0]),(f<0&&b>0&&x<0||f>0&&b<0&&x>0)&&(c._movement[1]=c._movementBound[1])}_objectSpread2(_objectSpread2({},tS),{},{device(c,u,{pointer:{touch:f=!1,lock:g=!1,mouse:b=!1}={}}){return(this.pointerLock=g&&tw.pointerLock,tw.touch&&f)?"touch":this.pointerLock?"mouse":tw.pointer&&!b?"pointer":tw.touch?"touch":"mouse"},preventScrollAxis(c,u,{preventScroll:f}){if(this.preventScrollDelay="number"==typeof f?f:f||void 0===f&&c?250:void 0,tw.touchscreen&&!1!==f)return c||(void 0!==f?"y":void 0)},pointerCapture(c,u,{pointer:{capture:f=!0,buttons:g=1,keys:b=!0}={}}){return this.pointerButtons=g,this.keys=b,!this.pointerLock&&"pointer"===this.device&&f},threshold(c,u,{filterTaps:f=!1,tapsThreshold:g=3,axis:b}){let v=tf.toVector(c,f?g:b?1:0);return this.filterTaps=f,this.tapsThreshold=g,v},swipe({velocity:c=.5,distance:u=50,duration:f=250}={}){return{velocity:this.transform(tf.toVector(c)),distance:this.transform(tf.toVector(u)),duration:f}},delay(c=0){switch(c){case!0:return 180;case!1:return 0;default:return c}},axisThreshold:c=>c?_objectSpread2(_objectSpread2({},tk),c):tk,keyboardDisplacement:(c=t_)=>c});let PinchEngine=class PinchEngine extends Engine{constructor(...c){super(...c),_defineProperty(this,"ingKey","pinching"),_defineProperty(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let c=this.state;c._touchIds=[],c.canceled=!1,c.cancel=this.cancel.bind(this),c.turns=0}computeOffset(){let{type:c,movement:u,lastOffset:f}=this.state;"wheel"===c?this.state.offset=tf.add(u,f):this.state.offset=[(1+u[0])*f[0],u[1]+f[1]]}computeMovement(){let{offset:c,lastOffset:u}=this.state;this.state.movement=[c[0]/u[0],c[1]-u[1]]}axisIntent(){let c=this.state,[u,f]=c._movement;if(!c.axis){let g=30*Math.abs(u)-Math.abs(f);g<0?c.axis="angle":g>0&&(c.axis="scale")}}restrictToAxis(c){this.config.lockDirection&&("scale"===this.state.axis?c[1]=0:"angle"===this.state.axis&&(c[0]=0))}cancel(){let c=this.state;c.canceled||setTimeout(()=>{c.canceled=!0,c._active=!1,this.compute(),this.emit()},0)}touchStart(c){this.ctrl.setEventIds(c);let u=this.state,f=this.ctrl.touchIds;if(u._active&&u._touchIds.every(c=>f.has(c))||f.size<2)return;this.start(c),u._touchIds=Array.from(f).slice(0,2);let g=touchDistanceAngle(c,u._touchIds);g&&this.pinchStart(c,g)}pointerStart(c){if(null!=c.buttons&&c.buttons%2!=1)return;this.ctrl.setEventIds(c),c.target.setPointerCapture(c.pointerId);let u=this.state,f=u._pointerEvents,g=this.ctrl.pointerIds;if(u._active&&Array.from(f.keys()).every(c=>g.has(c))||(f.size<2&&f.set(c.pointerId,c),u._pointerEvents.size<2))return;this.start(c);let b=distanceAngle(...Array.from(f.values()));b&&this.pinchStart(c,b)}pinchStart(c,u){let f=this.state;f.origin=u.origin,this.computeValues([u.distance,u.angle]),this.computeInitial(),this.compute(c),this.emit()}touchMove(c){if(!this.state._active)return;let u=touchDistanceAngle(c,this.state._touchIds);u&&this.pinchMove(c,u)}pointerMove(c){let u=this.state._pointerEvents;if(u.has(c.pointerId)&&u.set(c.pointerId,c),!this.state._active)return;let f=distanceAngle(...Array.from(u.values()));f&&this.pinchMove(c,f)}pinchMove(c,u){let f=this.state,g=f._values[1],b=u.angle-g,v=0;Math.abs(b)>270&&(v+=Math.sign(b)),this.computeValues([u.distance,u.angle-360*v]),f.origin=u.origin,f.turns=v,f._movement=[f._values[0]/f._initial[0]-1,f._values[1]-f._initial[1]],this.compute(c),this.emit()}touchEnd(c){this.ctrl.setEventIds(c),this.state._active&&this.state._touchIds.some(c=>!this.ctrl.touchIds.has(c))&&(this.state._active=!1,this.compute(c),this.emit())}pointerEnd(c){let u=this.state;this.ctrl.setEventIds(c);try{c.target.releasePointerCapture(c.pointerId)}catch(c){}u._pointerEvents.has(c.pointerId)&&u._pointerEvents.delete(c.pointerId),u._active&&u._pointerEvents.size<2&&(u._active=!1,this.compute(c),this.emit())}gestureStart(c){c.cancelable&&c.preventDefault();let u=this.state;u._active||(this.start(c),this.computeValues([c.scale,c.rotation]),u.origin=[c.clientX,c.clientY],this.compute(c),this.emit())}gestureMove(c){if(c.cancelable&&c.preventDefault(),!this.state._active)return;let u=this.state;this.computeValues([c.scale,c.rotation]),u.origin=[c.clientX,c.clientY];let f=u._movement;u._movement=[c.scale-1,c.rotation],u._delta=tf.sub(u._movement,f),this.compute(c),this.emit()}gestureEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}wheel(c){let u=this.config.modifierKey;(!u||(Array.isArray(u)?u.find(u=>c[u]):c[u]))&&(this.state._active?this.wheelChange(c):this.wheelStart(c),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(c){this.start(c),this.wheelChange(c)}wheelChange(c){let u="uv"in c;!u&&c.cancelable&&c.preventDefault();let f=this.state;f._delta=[-wheelValues(c)[1]/100*f.offset[0],0],tf.addTo(f._movement,f._delta),clampStateInternalMovementToBounds(f),this.state.origin=[c.clientX,c.clientY],this.compute(c),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){let u=this.config.device;u&&(c(u,"start",this[u+"Start"].bind(this)),c(u,"change",this[u+"Move"].bind(this)),c(u,"end",this[u+"End"].bind(this)),c(u,"cancel",this[u+"End"].bind(this)),c("lostPointerCapture","",this[u+"End"].bind(this))),this.config.pinchOnWheel&&c("wheel","",this.wheel.bind(this),{passive:!1})}};let tC=_objectSpread2(_objectSpread2({},tb),{},{device(c,u,{shared:f,pointer:{touch:g=!1}={}}){if(f.target&&!tw.touch&&tw.gesture)return"gesture";if(tw.touch&&g)return"touch";if(tw.touchscreen){if(tw.pointer)return"pointer";if(tw.touch)return"touch"}},bounds(c,u,{scaleBounds:f={},angleBounds:g={}}){let _scaleBounds=c=>{let u=assignDefault(call(f,c),{min:-1/0,max:1/0});return[u.min,u.max]},_angleBounds=c=>{let u=assignDefault(call(g,c),{min:-1/0,max:1/0});return[u.min,u.max]};return"function"!=typeof f&&"function"!=typeof g?[_scaleBounds(),_angleBounds()]:c=>[_scaleBounds(c),_angleBounds(c)]},threshold(c,u,f){this.lockDirection="lock"===f.axis;let g=tf.toVector(c,this.lockDirection?[.1,3]:0);return g},modifierKey:c=>void 0===c?"ctrlKey":c,pinchOnWheel:(c=!0)=>c});_objectSpread2(_objectSpread2({},tS),{},{mouseOnly:(c=!0)=>c});let WheelEngine=class WheelEngine extends CoordinatesEngine{constructor(...c){super(...c),_defineProperty(this,"ingKey","wheeling")}wheel(c){this.state._active||this.start(c),this.wheelChange(c),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(c){let u=this.state;u._delta=wheelValues(c),tf.addTo(u._movement,u._delta),clampStateInternalMovementToBounds(u),this.compute(c),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){c("wheel","",this.wheel.bind(this))}};_objectSpread2(_objectSpread2({},tS),{},{mouseOnly:(c=!0)=>c});let tE=new Map,tP=new Map;function registerAction(c){tE.set(c.key,c.engine),tP.set(c.key,c.resolver)}function _objectWithoutPropertiesLoose(c,u){if(null==c)return{};var f,g,b={},v=Object.keys(c);for(g=0;g<v.length;g++)f=v[g],u.indexOf(f)>=0||(b[f]=c[f]);return b}function _objectWithoutProperties(c,u){if(null==c)return{};var f,g,b=_objectWithoutPropertiesLoose(c,u);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(c);for(g=0;g<v.length;g++)f=v[g],!(u.indexOf(f)>=0)&&Object.prototype.propertyIsEnumerable.call(c,f)&&(b[f]=c[f])}return b}let tT={target(c){if(c)return()=>"current"in c?c.current:c},enabled:(c=!0)=>c,window:(c=tw.isBrowser?window:void 0)=>c,eventOptions:({passive:c=!0,capture:u=!1}={})=>({passive:c,capture:u}),transform:c=>c},t$=["target","eventOptions","window","enabled","transform"];function resolveWith(c={},u){let f={};for(let[g,b]of Object.entries(u))switch(typeof b){case"function":f[g]=b.call(f,c[g],g,c);break;case"object":f[g]=resolveWith(c[g],b);break;case"boolean":b&&(f[g]=c[g])}return f}function use_gesture_core_esm_parse(c,u,f={}){let{target:g,eventOptions:b,window:v,enabled:x,transform:w}=c,_=_objectWithoutProperties(c,t$);if(f.shared=resolveWith({target:g,eventOptions:b,window:v,enabled:x,transform:w},tT),u){let c=tP.get(u);f[u]=resolveWith(_objectSpread2({shared:f.shared},_),c)}else for(let c in _){let u=tP.get(c);u&&(f[c]=resolveWith(_objectSpread2({shared:f.shared},_[c]),u))}return f}let EventStore=class EventStore{constructor(c,u){_defineProperty(this,"_listeners",new Set),this._ctrl=c,this._gestureKey=u}add(c,u,f,g,b){let v=this._listeners,x=toDomEventType(u,f),w=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},_=_objectSpread2(_objectSpread2({},w),b);c.addEventListener(x,g,_);let remove=()=>{c.removeEventListener(x,g,_),v.delete(remove)};return v.add(remove),remove}clean(){this._listeners.forEach(c=>c()),this._listeners.clear()}};let TimeoutStore=class TimeoutStore{constructor(){_defineProperty(this,"_timeouts",new Map)}add(c,u,f=140,...g){this.remove(c),this._timeouts.set(c,window.setTimeout(u,f,...g))}remove(c){let u=this._timeouts.get(c);u&&window.clearTimeout(u)}clean(){this._timeouts.forEach(c=>void window.clearTimeout(c)),this._timeouts.clear()}};let Controller=class Controller{constructor(c){_defineProperty(this,"gestures",new Set),_defineProperty(this,"_targetEventStore",new EventStore(this)),_defineProperty(this,"gestureEventStores",{}),_defineProperty(this,"gestureTimeoutStores",{}),_defineProperty(this,"handlers",{}),_defineProperty(this,"config",{}),_defineProperty(this,"pointerIds",new Set),_defineProperty(this,"touchIds",new Set),_defineProperty(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,c)}setEventIds(c){return isTouch(c)?(this.touchIds=new Set(touchIds(c)),this.touchIds):"pointerId"in c?("pointerup"===c.type||"pointercancel"===c.type?this.pointerIds.delete(c.pointerId):"pointerdown"===c.type&&this.pointerIds.add(c.pointerId),this.pointerIds):void 0}applyHandlers(c,u){this.handlers=c,this.nativeHandlers=u}applyConfig(c,u){this.config=use_gesture_core_esm_parse(c,u,this.config)}clean(){for(let c of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[c].clean(),this.gestureTimeoutStores[c].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...c){let u;let f=this.config.shared,g={};if(!f.target||(u=f.target())){if(f.enabled){for(let f of this.gestures){let b=this.config[f],v=bindToProps(g,b.eventOptions,!!u);if(b.enabled){let u=tE.get(f);new u(this,c,f).bind(v)}}let b=bindToProps(g,f.eventOptions,!!u);for(let u in this.nativeHandlers)b(u,"",f=>this.nativeHandlers[u](_objectSpread2(_objectSpread2({},this.state.shared),{},{event:f,args:c})),void 0,!0)}for(let c in g)g[c]=chain(...g[c]);if(!u)return g;for(let c in g){let{device:f,capture:b,passive:v}=parseProp(c);this._targetEventStore.add(u,f,"",g[c],{capture:b,passive:v})}}}};function setupGesture(c,u){c.gestures.add(u),c.gestureEventStores[u]=new EventStore(c,u),c.gestureTimeoutStores[u]=new TimeoutStore}function resolveGestures(c,u){u.drag&&setupGesture(c,"drag"),u.wheel&&setupGesture(c,"wheel"),u.scroll&&setupGesture(c,"scroll"),u.move&&setupGesture(c,"move"),u.pinch&&setupGesture(c,"pinch"),u.hover&&setupGesture(c,"hover")}let bindToProps=(c,u,f)=>(g,b,v,x={},w=!1)=>{var _,k;let E=null!==(_=x.capture)&&void 0!==_?_:u.capture,T=null!==(k=x.passive)&&void 0!==k?k:u.passive,$=w?g:toHandlerProp(g,b,E);f&&T&&($+="Passive"),c[$]=c[$]||[],c[$].push(v)},tI=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function sortHandlers(c){let u={},f={},g=new Set;for(let b in c)tI.test(b)?(g.add(RegExp.lastMatch),f[b]=c[b]):u[b]=c[b];return[f,u,g]}function registerGesture(c,u,f,g,b,v){if(!c.has(f)||!tE.has(g))return;let x=f+"Start",w=f+"End";b[g]=c=>{let g;return c.first&&x in u&&u[x](c),f in u&&(g=u[f](c)),c.last&&w in u&&u[w](c),g},v[g]=v[g]||{}}function parseMergedHandlers(c,u){let[f,g,b]=sortHandlers(c),v={};return registerGesture(b,f,"onDrag","drag",v,u),registerGesture(b,f,"onWheel","wheel",v,u),registerGesture(b,f,"onScroll","scroll",v,u),registerGesture(b,f,"onPinch","pinch",v,u),registerGesture(b,f,"onMove","move",v,u),registerGesture(b,f,"onHover","hover",v,u),{handlers:v,config:u,nativeHandlers:g}}function useRecognizers(c,u={},f,g){let b=K.useMemo(()=>new Controller(c),[]);if(b.applyHandlers(c,g),b.applyConfig(u,f),K.useEffect(b.effect.bind(b)),K.useEffect(()=>b.clean.bind(b),[]),void 0===u.target)return b.bind.bind(b)}function createUseGesture(c){return c.forEach(registerAction),function(c,u){let{handlers:f,nativeHandlers:g,config:b}=parseMergedHandlers(c,u||{});return useRecognizers(f,b,void 0,g)}}f(62729);let tA=/Mac|iPod|iPhone|iPad/.test("undefined"==typeof window?"node":window.navigator.platform);function normalizeWheel(c){let{deltaY:u,deltaX:f}=c,g=0;if(c.ctrlKey||c.altKey||c.metaKey){let f=Math.sign(c.deltaY),b=Math.abs(c.deltaY),v=u;b>10&&(v=10*f),g=v/100}else c.shiftKey&&!tA&&(f=u,u=0);return{x:-f,y:-u,z:-g}}let tM=createUseGesture([{key:"wheel",engine:WheelEngine,resolver:tS},{key:"pinch",engine:PinchEngine,resolver:tC}]),isWheelEndEvent=c=>void 0===w?(w=c,!1):c-w>120&&c-w<160?(w=c,!0):(w=c,!1);function useGestureEvents(c){let u=(0,tt.j)(),f=K.useMemo(()=>{let f="not sure",g=1,b=1,v=1,x=0,w=new tl.G,_=new tl.G,updatePinchState=c=>{if(c&&(f="zooming"),"zooming"===f)return;let u=Math.abs(x-g),b=tl.G.Dist(w,_);switch(f){case"not sure":u>24?f="zooming":b>16&&(f="panning");break;case"panning":u>64&&(f="zooming")}};return{onWheel:({event:c})=>{if(!u.instanceState.isFocused||(f="not sure",isWheelEndEvent(Date.now())))return;if(u.editingShapeId){let c=u.getShape(u.editingShapeId);if(c){let f=u.getShapeUtil(c);if(f.canScroll(c)){let c=u.getShapePageBounds(u.editingShapeId);if(c?.containsPoint(u.inputs.currentPagePoint))return}}}preventDefault(c);let g=normalizeWheel(c);if(0===g.x&&0===g.y)return;let b={type:"wheel",name:"wheel",delta:g,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};u.dispatch(b)},onPinchStart:v=>{let x=c.current;f="not sure";let{event:k,origin:E,da:T}=v;!(k instanceof WheelEvent)&&(k.target===x||x?.contains(k.target))&&(_.x=E[0],_.y=E[1],w.x=E[0],w.y=E[1],g=T[0],b=u.zoomLevel,u.dispatch({type:"pinch",name:"pinch_start",point:{x:E[0],y:E[1],z:u.zoomLevel},delta:{x:0,y:0},shiftKey:k.shiftKey,altKey:k.altKey,ctrlKey:k.metaKey||k.ctrlKey}))},onPinchEnd:g=>{let b=c.current,{event:v,origin:x,offset:w}=g;if(v instanceof WheelEvent||!(v.target===b||b?.contains(v.target)))return;let _=w[0];f="not sure",requestAnimationFrame(()=>{u.dispatch({type:"pinch",name:"pinch_end",point:{x:x[0],y:x[1],z:_},delta:{x:x[0],y:x[1]},shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey})})},onPinch:g=>{let w=c.current,{event:k,origin:E,offset:T,da:$}=g;if(k instanceof WheelEvent||!(k.target===w||w?.contains(k.target)))return;let I="gesturechange"===g.type||"gestureend"===g.type;x=$[0];let M=E[0]-_.x,j=E[1]-_.y;switch(_.x=E[0],_.y=E[1],updatePinchState(I),f){case"zooming":v=T[0],u.dispatch({type:"pinch",name:"pinch",point:{x:E[0],y:E[1],z:v},delta:{x:M,y:j},shiftKey:k.shiftKey,altKey:k.altKey,ctrlKey:k.metaKey||k.ctrlKey});break;case"panning":u.dispatch({type:"pinch",name:"pinch",point:{x:E[0],y:E[1],z:b},delta:{x:M,y:j},shiftKey:k.shiftKey,altKey:k.altKey,ctrlKey:k.metaKey||k.ctrlKey})}}}},[u,c]);tM(f,{target:c,eventOptions:{passive:!1},pinch:{from:()=>[u.zoomLevel,0],scaleBounds:()=>({from:u.zoomLevel,max:8,min:.05})}})}function getHandle(c,u,f){let g=c.getShape(u),b=c.getShapeHandles(g);return{shape:g,handle:b.find(c=>c.id===f)}}function useHandleEvents(c,u){let f=(0,tt.j)();return K.useMemo(()=>{let g,b;return{onPointerDown:g=>{if(g.isKilled)return;let b=loopToHtmlElement(g.currentTarget);setPointerCapture(b,g);let{shape:v,handle:x}=getHandle(f,c,u);x&&f.dispatch({type:"pointer",target:"handle",handle:x,shape:v,name:"pointer_down",...getPointerInfo(g)})},onPointerMove:v=>{if(v.isKilled||v.clientX===g&&v.clientY===b)return;g=v.clientX,b=v.clientY;let{shape:x,handle:w}=getHandle(f,c,u);w&&f.dispatch({type:"pointer",target:"handle",handle:w,shape:x,name:"pointer_move",...getPointerInfo(v)})},onPointerUp:g=>{if(g.isKilled)return;let b=loopToHtmlElement(g.currentTarget);releasePointerCapture(b,g);let{shape:v,handle:x}=getHandle(f,c,u);x&&f.dispatch({type:"pointer",target:"handle",handle:x,shape:v,name:"pointer_up",...getPointerInfo(g)})}}},[f,c,u])}var tj=f(26978);function useScreenBounds(){let c=(0,tt.j)();(0,K.useLayoutEffect)(()=>{let u=tj(()=>{c.updateViewportScreenBounds()},200,{trailing:!0});c.updateViewportScreenBounds();let f=setInterval(u,1e3);return window.addEventListener("resize",u),window.addEventListener("scroll",u),()=>{clearInterval(f),window.removeEventListener("resize",u),window.removeEventListener("scroll",u)}},[c])}var tO=f(60498);function useTick(c=!0){let[u,f]=(0,K.useState)(0),g=(0,tt.j)();(0,K.useEffect)(()=>{if(!c)return;let update=()=>f(c=>c+1);return g.on("tick",update),()=>{g.off("tick",update)}},[g,c])}let tR=(0,e5.j)(function({showStroke:c=!0,showVertices:u=!0,showClosestPointOnOutline:f=!0}){let g=(0,tt.j)();useTick(f);let{zoomLevel:b,renderingShapes:v,inputs:{currentPagePoint:x}}=g;return(0,V.jsx)("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:v.map(v=>{let w=g.getShape(v.id);if("group"===w.type)return null;let _=g.getShapeGeometry(w),k=g.getShapePageTransform(w),E=g.getPointInShapeSpace(w,x),T=_.nearestPoint(E),$=_.distanceToPoint(E,!0),I=Math.abs($)*b,{vertices:M}=_;return(0,V.jsxs)("g",{transform:k.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[c&&(0,V.jsx)("path",{stroke:"red",strokeWidth:"2",fill:"none",opacity:"1",d:_.toSimpleSvgPath()}),u&&M.map((c,u)=>(0,V.jsx)("circle",{cx:c.x,cy:c.y,r:"2",fill:`hsl(${(0,e4.vm)(u,[0,M.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${u}`)),f&&I<150&&(0,V.jsx)("line",{x1:T.x,y1:T.y,x2:E.x,y2:E.y,opacity:1-I/150,stroke:$<0?"goldenrod":"dodgerblue",strokeWidth:"2"})]},v.id+"_outline")})})});var tD=f(50528);function uniq(c){return tD(c)}function usePeerIds(){let c=(0,tt.j)(),u=(0,K.useMemo)(()=>c.store.query.records("instance_presence",()=>({userId:{neq:c.user.id}})),[c]),f=(0,e5.vc)("userIds",()=>tD(u.value.map(c=>c.userId)).sort(),{isEqual:(c,u)=>c.join(",")===u.join?.(",")},[u]);return(0,e5.Hg)(f)}function usePresence(c){let u=(0,tt.j)(),f=(0,K.useMemo)(()=>u.store.query.records("instance_presence",()=>({userId:{eq:c}})),[u,c]),g=(0,e5.Hg)(`latestPresence:${c}`,()=>f.value.slice().sort((c,u)=>u.lastActivityTimestamp-c.lastActivityTimestamp)[0],[]);return g??null}let tL=(0,e5.j)(function(){let c=usePeerIds();return(0,V.jsx)(V.Fragment,{children:c.map(c=>(0,V.jsx)(tN,{collaboratorId:c},c))})}),tN=(0,e5.j)(function({collaboratorId:c}){let u=(0,tt.j)(),f=usePresence(c),g=useCollaboratorState(f);if(!(f&&f.currentPageId===u.currentPageId))return null;switch(g){case"inactive":{let{followingUserId:c,highlightedUserIds:g}=u.instanceState;if(!(c===f.userId||g.includes(f.userId)))return null;break}case"idle":{let{highlightedUserIds:c}=u.instanceState;if(f.followingUserId===u.user.id&&!(f.chatMessage||c.includes(f.userId)))return null}}return(0,V.jsx)(tF,{latestPresence:f})}),tF=(0,e5.j)(function({latestPresence:c}){let u=(0,tt.j)(),{CollaboratorBrush:f,CollaboratorScribble:g,CollaboratorCursor:b,CollaboratorHint:v,CollaboratorShapeIndicator:x}=useEditorComponents(),{viewportPageBounds:w,zoomLevel:_}=u,{userId:k,chatMessage:E,brush:T,scribble:$,selectedShapeIds:I,userName:M,cursor:j,color:D}=c,L=!(j.x<w.minX-12/_||j.y<w.minY-16/_||j.x>w.maxX-12/_||j.y>w.maxY-16/_);return(0,V.jsxs)(V.Fragment,{children:[T&&f?(0,V.jsx)(f,{className:"tl-collaborator__brush",brush:T,color:D,opacity:.1},k+"_brush"):null,L&&b?(0,V.jsx)(b,{className:"tl-collaborator__cursor",point:j,color:D,zoom:_,name:"New User"!==M?M:null,chatMessage:E},k+"_cursor"):v?(0,V.jsx)(v,{className:"tl-collaborator__cursor-hint",point:j,color:D,zoom:_,viewport:w},k+"_cursor_hint"):null,$&&g?(0,V.jsx)(g,{className:"tl-collaborator__scribble",scribble:$,color:D,zoom:_,opacity:"laser"===$.color?.5:.1},k+"_scribble"):null,x&&I.map(c=>(0,V.jsx)(x,{className:"tl-collaborator__shape-indicator",id:c,color:D,opacity:.5},k+"_"+c))]})});function getStateFromElapsedTime(c){return c>td.RZ?"inactive":c>td.O8?"idle":"active"}function useCollaboratorState(c){let u=(0,K.useRef)(c?.lastActivityTimestamp??-1),[f,g]=(0,K.useState)(()=>getStateFromElapsedTime(Date.now()-u.current));return(0,K.useEffect)(()=>{let c=setInterval(()=>{g(getStateFromElapsedTime(Date.now()-u.current))},td.MN);return()=>clearInterval(c)},[]),c&&(u.current=c.lastActivityTimestamp),f}function gcd(c,u){return 0===u?c:gcd(u,c%u)}function nearestMultiple(c){let u=c.toString().split(".")[1];if(!u)return 1;let f=Math.pow(10,u.length),g=parseInt(u,10);return f/gcd(g,f)}function useDPRMultiple(){let c=(0,tt.j)(),u=useContainer();K.useEffect(()=>(0,e5.Ym)("useDPRMultiple",()=>{let f=c.instanceState.devicePixelRatio;u.style.setProperty("--tl-dpr-multiple",nearestMultiple(f).toString())}),[c,u])}let tB=(0,e5.j)(function({id:c,shape:u,util:f,index:g,backgroundIndex:b,opacity:v,isCulled:x}){let w=(0,tt.j)(),{ShapeErrorFallback:_}=useEditorComponents(),k=K.useRef(null),E=K.useRef(null),T=K.useCallback((c,u)=>{k.current?.style.setProperty(c,u),E.current?.style.setProperty(c,u)},[]);(0,e5.BK)("set shape container transform position",()=>{let u=w.getShape(c);if(!u)return;let f=w.getShapePageTransform(c),g=tO.y.toCssString(f);T("transform",g)},[w,T]),(0,e5.BK)("set shape container clip path",()=>{let u=w.getShape(c);if(!u)return null;let f=w.getShapeClipPath(c);T("clip-path",f??"none")},[w,T]),(0,e5.BK)("set shape height and width",()=>{let u=w.getShape(c);if(!u)return null;let f=w.getShapeGeometry(u).bounds,g=Math.floor(100*w.instanceState.devicePixelRatio)/100,b=nearestMultiple(g),v=f.w%b,x=0===v?f.w:f.w+(b-v),_=f.h%b,k=0===_?f.h:f.h+(b-_);T("width",Math.max(x,b)+"px"),T("height",Math.max(k,b)+"px")},[w]),K.useLayoutEffect(()=>{T("opacity",v+""),k.current?.style.setProperty("z-index",g+""),E.current?.style.setProperty("z-index",b+"")},[v,g,b,T]);let $=K.useCallback(c=>{w.annotateError(c,{origin:"react.shape",willCrashApp:!1})},[w]);return u?(0,V.jsxs)(V.Fragment,{children:[f.backgroundComponent&&(0,V.jsx)("div",{ref:E,className:"tl-shape tl-shape-background","data-shape-type":u.type,draggable:!1,children:!x&&(0,V.jsx)(OptionalErrorBoundary,{fallback:_,onError:$,children:(0,V.jsx)(tG,{shape:u,util:f})})}),(0,V.jsx)("div",{ref:k,className:"tl-shape","data-shape-type":u.type,draggable:!1,children:x?(0,V.jsx)(tU,{shape:u}):(0,V.jsx)(OptionalErrorBoundary,{fallback:_,onError:$,children:(0,V.jsx)(tz,{shape:u,util:f})})})]}):null}),tz=K.memo(function({shape:c,util:u}){return(0,e5.uC)("InnerShape:"+c.type,()=>u.component(c))},(c,u)=>c.shape.props===u.shape.props&&c.shape.meta===u.shape.meta),tG=K.memo(function({shape:c,util:u}){return(0,e5.uC)("InnerShape:"+c.type,()=>u.backgroundComponent?.(c))},(c,u)=>c.shape.props===u.shape.props&&c.shape.meta===u.shape.meta),tU=K.memo(function({shape:c}){let u=(0,tt.j)(),f=u.getShapeGeometry(c).bounds;return(0,V.jsx)("div",{className:"tl-shape__culled",style:{transform:`translate(${(0,ts.$Z)(f.minX)}px, ${(0,ts.$Z)(f.minY)}px)`,width:Math.max(1,(0,ts.$Z)(f.width)),height:Math.max(1,(0,ts.$Z)(f.height))}})},()=>!0);function Canvas({className:c}){let u=(0,tt.j)(),{Background:f,SvgDefs:g}=useEditorComponents(),b=K.useRef(null),v=K.useRef(null),x=K.useRef(null);useScreenBounds(),useDocumentEvents(),useCoarsePointer(),useGestureEvents(b),useFixSafariDoubleTapZoomPencilEvents(b),(0,e5.BK)("position layers",()=>{let c=v.current;if(!c)return;let f=x.current;if(!f)return;let{x:g,y:b,z:w}=u.camera,_=w>=1?(0,e4.vm)(w,[1,8],[.125,.5],!0):(0,e4.vm)(w,[.1,1],[-2,.125],!0),k=`scale(${(0,ts.$Z)(w)}) translate(${(0,ts.$Z)(g+_)}px,${(0,ts.$Z)(b+_)}px)`;c.style.setProperty("transform",k),f.style.setProperty("transform",k)},[u]);let w=useCanvasEvents(),_=(0,e5.Hg)("shapeSvgDefs",()=>{let c=new Map;for(let f of(0,e4.UM)(u.shapeUtils)){if(!f)return;let u=f.getCanvasSvgDefs();for(let{key:f,component:g}of u)c.has(f)||c.set(f,(0,V.jsx)(g,{},f))}return[...c.values()]},[u]),k=(0,e5.Hg)("debug_shapes",()=>te.hideShapes.value,[te]),E=(0,e5.Hg)("debug_svg",()=>te.debugSvg.value,[te]),T=(0,e5.Hg)("debug_geometry",()=>te.debugGeometry.value,[te]);return(0,V.jsxs)("div",{ref:b,draggable:!1,className:e2("tl-canvas",c),"data-testid":"canvas",...w,children:[f&&(0,V.jsx)(f,{}),(0,V.jsx)(GridWrapper,{}),(0,V.jsx)(UiLogger,{}),(0,V.jsx)("svg",{className:"tl-svg-context",children:(0,V.jsxs)("defs",{children:[_,Cursor&&(0,V.jsx)(Cursor,{}),(0,V.jsx)(CollaboratorHint,{}),(0,V.jsx)(ArrowheadDot,{}),(0,V.jsx)(ArrowheadCross,{}),g&&(0,V.jsx)(g,{})]})}),(0,V.jsxs)("div",{ref:v,className:"tl-html-layer tl-shapes",draggable:!1,children:[(0,V.jsx)(SelectionBackgroundWrapper,{}),k?null:E?(0,V.jsx)(ShapesWithSVGs,{}):(0,V.jsx)(ShapesToDisplay,{})]}),(0,V.jsx)("div",{className:"tl-fixed-layer tl-overlays",children:(0,V.jsxs)("div",{ref:x,className:"tl-html-layer",children:[T?(0,V.jsx)(tR,{}):null,(0,V.jsx)(HandlesWrapper,{}),(0,V.jsx)(BrushWrapper,{}),(0,V.jsx)(ScribbleWrapper,{}),(0,V.jsx)(ZoomBrushWrapper,{}),(0,V.jsx)(SelectedIdIndicators,{}),(0,V.jsx)(HoveredShapeIndicator,{}),(0,V.jsx)(tH,{}),(0,V.jsx)(SnapLinesWrapper,{}),(0,V.jsx)(SelectionForegroundWrapper,{}),(0,V.jsx)(tL,{})]})})]})}function GridWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("gridSize",()=>c.documentSettings.gridSize,[c]),{x:f,y:g,z:b}=(0,e5.Hg)("camera",()=>c.camera,[c]),v=(0,e5.Hg)("isGridMode",()=>c.instanceState.isGridMode,[c]),{Grid:x}=useEditorComponents();return x&&v?(0,V.jsx)(x,{x:f,y:g,z:b,size:u}):null}function ScribbleWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("scribble",()=>c.instanceState.scribble,[c]),f=(0,e5.Hg)("zoomLevel",()=>c.zoomLevel,[c]),{Scribble:g}=useEditorComponents();return g&&u?(0,V.jsx)(g,{className:"tl-user-scribble",scribble:u,zoom:f}):null}function BrushWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("brush",()=>c.instanceState.brush,[c]),{Brush:f}=useEditorComponents();return f&&u?(0,V.jsx)(f,{className:"tl-user-brush",brush:u}):null}function ZoomBrushWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("zoomBrush",()=>c.instanceState.zoomBrush,[c]),{ZoomBrush:f}=useEditorComponents();return f&&u?(0,V.jsx)(f,{className:"tl-user-brush",brush:u}):null}function SnapLinesWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("snapLines",()=>c.snaps.lines,[c]),f=(0,e5.Hg)("zoomLevel",()=>c.zoomLevel,[c]),{SnapLine:g}=useEditorComponents();return g&&u.length>0?(0,V.jsx)(V.Fragment,{children:u.map(c=>(0,V.jsx)(g,{className:"tl-user-snapline",line:c,zoom:f},c.id))}):null}function HandlesWrapper(){let c=(0,tt.j)(),{Handles:u}=useEditorComponents(),f=(0,e5.Hg)("zoomLevel",()=>c.zoomLevel,[c]),g=(0,e5.Hg)("coarse pointer",()=>c.instanceState.isCoarsePointer,[c]),b=(0,e5.Hg)("onlySelectedShape",()=>c.onlySelectedShape,[c]),v=(0,e5.Hg)("isChangingStyle",()=>c.instanceState.isChangingStyle,[c]),x=(0,e5.Hg)("isChangingStyle",()=>c.instanceState.isReadonly,[c]),w=(0,e5.Hg)("handles",()=>c.onlySelectedShape?c.getShapeHandles(c.onlySelectedShape):void 0,[c]),_=(0,e5.Hg)("transform",()=>c.onlySelectedShape?c.getShapePageTransform(c.onlySelectedShape):void 0,[c]);if(!u||!b||v||x||!w||!_)return null;let k=[];for(let c=0,u=w[c];c<w.length;u=w[++c]){if("vertex"!==u.type){let u=w[c-1],g=w[c+1];if(u&&g&&Math.hypot(u.y-g.y,u.x-g.x)<48/f)continue}k.push(u)}return k.sort(c=>"vertex"===c.type?1:-1),(0,V.jsx)(u,{children:(0,V.jsx)("g",{transform:tO.y.toCssString(_),children:k.map(c=>(0,V.jsx)(HandleWrapper,{shapeId:b.id,handle:c,zoom:f,isCoarse:g},c.id))})})}function HandleWrapper({shapeId:c,handle:u,zoom:f,isCoarse:g}){let b=useHandleEvents(c,u.id),{Handle:v}=useEditorComponents();return v?(0,V.jsx)("g",{"aria-label":"handle",transform:`translate(${u.x}, ${u.y})`,...b,children:(0,V.jsx)(v,{shapeId:c,handle:u,zoom:f,isCoarse:g})}):null}function ShapesWithSVGs(){let c=(0,tt.j)(),u=(0,e5.Hg)("rendering shapes",()=>c.renderingShapes,[c]);return(0,V.jsx)(V.Fragment,{children:u.map(c=>(0,V.jsxs)(K.Fragment,{children:[(0,V.jsx)(tB,{...c}),(0,V.jsx)(tV,{id:c.id})]},c.id+"_fragment"))})}function ShapesToDisplay(){let c=(0,tt.j)(),u=(0,e5.Hg)("rendering shapes",()=>c.renderingShapes,[c]);return(0,V.jsx)(V.Fragment,{children:u.map(c=>(0,V.jsx)(tB,{...c},c.id+"_shape"))})}function SelectedIdIndicators(){let c=(0,tt.j)(),u=(0,e5.Hg)("selectedShapeIds",()=>c.currentPageState.selectedShapeIds,[c]),f=(0,e5.Hg)("should display selected ids",()=>c.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!c.instanceState.isChangingStyle,[c]);return f?(0,V.jsx)(V.Fragment,{children:u.map(c=>(0,V.jsx)(ta,{className:"tl-user-indicator__selected",id:c},c+"_indicator"))}):null}let HoveredShapeIndicator=function(){let c=(0,tt.j)(),{HoveredShapeIndicator:u}=useEditorComponents(),f=(0,e5.Hg)("coarse pointer",()=>c.instanceState.isCoarsePointer,[c]),g=(0,e5.Hg)("hovering canvas",()=>c.instanceState.isHoveringCanvas,[c]),b=(0,e5.Hg)("hovered id",()=>c.currentPageState.hoveredShapeId,[c]);return!f&&g&&b&&u?(0,V.jsx)(u,{shapeId:b}):null},tH=(0,e5.j)(function(){let c=(0,tt.j)(),u=(0,e4.D8)(c.hintingShapeIds);return u.length?(0,V.jsx)(V.Fragment,{children:u.map(c=>(0,V.jsx)(ta,{className:"tl-user-indicator__hint",id:c},c+"_hinting"))}):null});function Cursor(){return(0,V.jsxs)("g",{id:"cursor",children:[(0,V.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,V.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,V.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,V.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,V.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,V.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,V.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,V.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,V.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function CollaboratorHint(){return(0,V.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function ArrowheadDot(){return(0,V.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,V.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function ArrowheadCross(){return(0,V.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,V.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,V.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}let tV=(0,e5.j)(function({id:c}){let u=(0,tt.j)(),f=u.getShape(c),[g,b]=K.useState(""),v=f?.parentId===u.currentPageId;return(K.useEffect(()=>{if(!v)return;let f=null,g=(0,e5.Ym)("shape to svg",async()=>{let g=Math.random();f=g;let v=u.getShapePageBounds(c),x=await u.getSvg([c],{padding:0});x&&v&&f===g&&(x.style.setProperty("overflow","visible"),x.setAttribute("preserveAspectRatio","xMidYMin slice"),x.style.setProperty("transform",`translate(${v.x}px, ${v.y+v.h+12}px)`),x.style.setProperty("border","1px solid black"),b(x?.outerHTML))});return()=>{f=null,g()}},[u,c,v]),v)?(0,V.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,V.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:g}})}):null});function UiLogger(){let c=(0,e5.Hg)("debugging ui log",()=>te.logMessages.value,[te]);return c.length?(0,V.jsx)("div",{className:"debug__ui-logger",children:c.map((c,u)=>{let f="string"==typeof c?c:JSON.stringify(c);return(0,V.jsx)("div",{className:"debug__ui-logger__line",children:f},u)})}):null}function SelectionForegroundWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("selection rotation",()=>c.selectionRotation,[c]),f=(0,e5.Hg)("selection bounds",()=>c.selectionRotatedPageBounds,[c]),{SelectionForeground:g}=useEditorComponents();return f&&g?(0,V.jsx)(g,{bounds:f,rotation:u}):null}function SelectionBackgroundWrapper(){let c=(0,tt.j)(),u=(0,e5.Hg)("selection rotation",()=>c.selectionRotation,[c]),f=(0,e5.Hg)("selection bounds",()=>c.selectionRotatedPageBounds,[c]),{SelectionBackground:g}=useEditorComponents();return f&&g?(0,V.jsx)(g,{bounds:f,rotation:u}):null}var tW=f(7217),tK=f(80418);function useIsDarkMode(){let c=(0,tt.j)();return(0,e5.Hg)("isDarkMode",()=>c.user.isDarkMode,[c])}let tZ="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",tY="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",tq='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function getCursorCss(c,u,f,g,b,v=16,x=16){let w=(-f-u)*(ts.PI/180),_=Math.sin(w),k=Math.cos(w);return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${b};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${1*k-1*_}' dy='${1*_+1*k}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${u+f} 16 16)${g?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+c.replaceAll('"',"'")+`</g></svg>") ${v} ${x}, pointer`}let tX={none:()=>"none",default:(c,u,f)=>getCursorCss('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',c,0,u,f,12,8),pointer:(c,u,f)=>getCursorCss('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',c,0,u,f,14,10),cross:(c,u,f)=>getCursorCss('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',c,0,u,f),move:(c,u,f)=>getCursorCss('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',c,0,u,f),grab:(c,u,f)=>getCursorCss('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',c,0,u,f),grabbing:(c,u,f)=>getCursorCss("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",c,0,u,f),text:(c,u,f)=>getCursorCss('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',c,0,u,f,4,10),"ew-resize":(c,u,f)=>getCursorCss(tY,c,0,u,f),"ns-resize":(c,u,f)=>getCursorCss(tY,c,90,u,f),"nesw-resize":(c,u,f)=>getCursorCss(tZ,c,0,u,f),"nwse-resize":(c,u,f)=>getCursorCss(tZ,c,90,u,f),"nwse-rotate":(c,u,f)=>getCursorCss(tq,c,0,u,f),"nesw-rotate":(c,u,f)=>getCursorCss(tq,c,90,u,f),"senw-rotate":(c,u,f)=>getCursorCss(tq,c,180,u,f),"swne-rotate":(c,u,f)=>getCursorCss(tq,c,270,u,f),"zoom-in":(c,u,f)=>getCursorCss('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',c,0,u,f),"zoom-out":(c,u,f)=>getCursorCss('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',c,0,u,f)};function getCursor(c,u=0,f="black"){return tX[c]((0,ts.vi)(u),!1,f)}let tJ=["default","pointer","cross","move","grab","grabbing","text"];function useCursor(){let c=(0,tt.j)(),u=useContainer(),f=useIsDarkMode();(0,e5.BK)("useCursor",()=>{let{type:g,rotation:b}=c.instanceState.cursor;if(tJ.includes(g)){u.style.setProperty("--tl-cursor",`var(--tl-cursor-${g})`);return}u.style.setProperty("--tl-cursor",getCursor(g,b,f?"white":"black"))},[c,u,f])}function useDarkMode(){let c=(0,tt.j)(),u=useContainer(),f=useIsDarkMode(),g=(0,e5.Hg)(te.forceSrgb);K.useEffect(()=>{f?(u.setAttribute("data-color-mode","dark"),u.classList.remove("tl-theme__light"),u.classList.add("tl-theme__dark")):(u.setAttribute("data-color-mode","light"),u.classList.remove("tl-theme__dark"),u.classList.add("tl-theme__light")),g?u.classList.add("tl-theme__force-sRGB"):u.classList.remove("tl-theme__force-sRGB")},[c,u,g,f])}function useEvent(c){let u=(0,K.useRef)();return(0,K.useLayoutEffect)(()=>{u.current=c}),(0,K.useDebugValue)(c),(0,K.useCallback)((...c)=>{let f=u.current;return(0,e4.hu)(f,"fn does not exist"),f(...c)},[])}function useFocusEvents(c){let u=(0,tt.j)(),f=useContainer();(0,K.useLayoutEffect)(()=>{c?(u.instanceState.isFocused||u.updateInstanceState({isFocused:!0}),u.getContainer().focus()):u.instanceState.isFocused&&u.updateInstanceState({isFocused:!1})},[u,f,c])}function useForceUpdate(){let[c,u]=(0,K.useState)(0);(0,K.useEffect)(()=>u(c=>c+1),[])}var tQ=f(65596);let t0="TLDRAW_TAB_ID_v2",t1=globalThis.window;function iOS(){return!!t1&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(t1.navigator.platform)||t1.navigator.userAgent.includes("Mac")&&"ontouchend"in document)}let t2=t1?.[t0]??t1?.sessionStorage[t0]??"TLDRAW_INSTANCE_STATE_V1_"+(0,tQ.E)();t1&&(t1[t0]=t2,iOS()?t1.sessionStorage[t0]=t2:delete t1.sessionStorage[t0]),t1?.addEventListener("beforeunload",()=>{t1.sessionStorage[t0]=t2});let t5=e6.T.object({version:e6.T.number,currentPageId:e8.CF,isFocusMode:e6.T.boolean,exportBackground:e6.T.boolean,isDebugMode:e6.T.boolean,isToolLocked:e6.T.boolean,isGridMode:e6.T.boolean,pageStates:e6.T.arrayOf(e6.T.object({pageId:e8.CF,camera:e6.T.object({x:e6.T.number,y:e6.T.number,z:e6.T.number}),selectedShapeIds:e6.T.arrayOf(e8.u5),focusedGroupId:e8.u5.nullable()}))}),t3=(0,e3.zn)({currentVersion:0});function migrateAndValidateSessionStateSnapshot(c){if(!c||"object"!=typeof c)return console.warn("Invalid instance state"),null;if(!("version"in c)||"number"!=typeof c.version)return console.warn("No version in instance state"),null;let u=(0,e3.Te)({value:c,fromVersion:c.version,toVersion:0,migrations:t3});if("error"===u.type)return console.warn(u.reason),null;let f={...u.value,version:0};try{t5.validate(f)}catch(c){return console.warn(c),null}return f}function createSessionStateSnapshotSignal(c){let u=c.query.ids("page");return(0,e5.Fl)("sessionStateSnapshot",()=>{let f=c.get(e8.PQ);if(!f)return null;let g=[...u.value];return{version:0,currentPageId:f.currentPageId,exportBackground:f.exportBackground,isFocusMode:f.isFocusMode,isDebugMode:f.isDebugMode,isToolLocked:f.isToolLocked,isGridMode:f.isGridMode,pageStates:g.map(u=>{let f=c.get(e8.iS.createId(u)),g=c.get(e8.AN.createId(u));return{pageId:u,camera:{x:g?.x??0,y:g?.y??0,z:g?.z??1},selectedShapeIds:f?.selectedShapeIds??[],focusedGroupId:f?.focusedGroupId??null}})}})}function loadSessionStateSnapshotIntoStore(c,u){let f=migrateAndValidateSessionStateSnapshot(u);if(!f)return;let g=c.allRecords().filter(c=>"instance_page_state"===c.typeName||"camera"===c.typeName),b={added:{},updated:{},removed:{...(0,e4.Ls)(g.map(c=>[c.id,c]))}};c.has(e8.PQ)&&(b.removed[e8.PQ]=c.get(e8.PQ));let v={removed:{},updated:{},added:{[e8.PQ]:c.schema.types.instance.create({id:e8.PQ,currentPageId:f.currentPageId,isDebugMode:f.isDebugMode,isFocusMode:f.isFocusMode,isToolLocked:f.isToolLocked,isGridMode:f.isGridMode,exportBackground:f.exportBackground})}};for(let c of f.pageStates){let u=e8.AN.createId(c.pageId),f=e8.iS.createId(c.pageId);v.added[u]=e8.AN.create({id:e8.AN.createId(c.pageId),x:c.camera.x,y:c.camera.y,z:c.camera.z}),v.added[f]=e8.iS.create({id:e8.iS.createId(c.pageId),pageId:c.pageId,selectedShapeIds:c.selectedShapeIds,focusedGroupId:c.focusedGroupId})}(0,e5.ay)(()=>{c.applyDiff((0,e3.bs)([b,v])),c.ensureStoreIsUsable()})}function extractSessionStateFromLegacySnapshot(c){let u=[];for(let f of Object.values(c))f.typeName?.match(/^(instance.*|pointer|camera)$/)&&u.push(f);let f=u.filter(c=>"instance"===c.typeName&&c.id!==e8.PQ)[0];if(!f)return null;let g={version:0,currentPageId:f.currentPageId,exportBackground:!!f.exportBackground,isFocusMode:!!f.isFocusMode,isDebugMode:!!f.isDebugMode,isToolLocked:!!f.isToolLocked,isGridMode:!1,pageStates:u.filter(c=>"instance_page_state"===c.typeName&&c.instanceId===f.id).map(u=>{let f=c[u.cameraId]??{x:0,y:0,z:1};return{pageId:u.pageId,camera:{x:f.x,y:f.y,z:f.z},selectedShapeIds:u.selectedShapeIds,focusedGroupId:u.focusedGroupId}})};try{return t5.validate(g),g}catch(c){return null}}function showCantWriteToIndexDbAlert(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
\u2022 If your hard disk is full, try clearing up some space and then reload the page.`)}function showCantReadFromIndexDbAlert(){window.alert(`Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}let instanceOfAny=(c,u)=>u.some(u=>c instanceof u);function getIdbProxyableTypes(){return b||(b=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return v||(v=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let t8=new WeakMap,t4=new WeakMap,t6=new WeakMap,t7=new WeakMap,t9=new WeakMap;function promisifyRequest(c){let u=new Promise((u,f)=>{let unlisten=()=>{c.removeEventListener("success",success),c.removeEventListener("error",error)},success=()=>{u(wrap(c.result)),unlisten()},error=()=>{f(c.error),unlisten()};c.addEventListener("success",success),c.addEventListener("error",error)});return u.then(u=>{u instanceof IDBCursor&&t8.set(u,c)}).catch(()=>{}),t9.set(u,c),u}function cacheDonePromiseForTransaction(c){if(t4.has(c))return;let u=new Promise((u,f)=>{let unlisten=()=>{c.removeEventListener("complete",complete),c.removeEventListener("error",error),c.removeEventListener("abort",error)},complete=()=>{u(),unlisten()},error=()=>{f(c.error||new DOMException("AbortError","AbortError")),unlisten()};c.addEventListener("complete",complete),c.addEventListener("error",error),c.addEventListener("abort",error)});t4.set(c,u)}let ne={get(c,u,f){if(c instanceof IDBTransaction){if("done"===u)return t4.get(c);if("objectStoreNames"===u)return c.objectStoreNames||t6.get(c);if("store"===u)return f.objectStoreNames[1]?void 0:f.objectStore(f.objectStoreNames[0])}return wrap(c[u])},set:(c,u,f)=>(c[u]=f,!0),has:(c,u)=>c instanceof IDBTransaction&&("done"===u||"store"===u)||u in c};function replaceTraps(c){ne=c(ne)}function wrapFunction(c){return c!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?getCursorAdvanceMethods().includes(c)?function(...u){return c.apply(unwrap(this),u),wrap(t8.get(this))}:function(...u){return wrap(c.apply(unwrap(this),u))}:function(u,...f){let g=c.call(unwrap(this),u,...f);return t6.set(g,u.sort?u.sort():[u]),wrap(g)}}function transformCachableValue(c){return"function"==typeof c?wrapFunction(c):(c instanceof IDBTransaction&&cacheDonePromiseForTransaction(c),instanceOfAny(c,getIdbProxyableTypes()))?new Proxy(c,ne):c}function wrap(c){if(c instanceof IDBRequest)return promisifyRequest(c);if(t7.has(c))return t7.get(c);let u=transformCachableValue(c);return u!==c&&(t7.set(c,u),t9.set(u,c)),u}let unwrap=c=>t9.get(c);function openDB(c,u,{blocked:f,upgrade:g,blocking:b,terminated:v}={}){let x=indexedDB.open(c,u),w=wrap(x);return g&&x.addEventListener("upgradeneeded",c=>{g(wrap(x.result),c.oldVersion,c.newVersion,wrap(x.transaction),c)}),f&&x.addEventListener("blocked",c=>f(c.oldVersion,c.newVersion,c)),w.then(c=>{v&&c.addEventListener("close",()=>v()),b&&c.addEventListener("versionchange",c=>b(c.oldVersion,c.newVersion,c))}).catch(()=>{}),w}function deleteDB(c,{blocked:u}={}){let f=indexedDB.deleteDatabase(c);return u&&f.addEventListener("blocked",c=>u(c.oldVersion,c)),wrap(f).then(()=>void 0)}let nt=["get","getKey","getAll","getAllKeys","count"],nn=["put","add","delete","clear"],nr=new Map;function getMethod(c,u){if(!(c instanceof IDBDatabase&&!(u in c)&&"string"==typeof u))return;if(nr.get(u))return nr.get(u);let f=u.replace(/FromIndex$/,""),g=u!==f,b=nn.includes(f);if(!(f in(g?IDBIndex:IDBObjectStore).prototype)||!(b||nt.includes(f)))return;let method=async function(c,...u){let v=this.transaction(c,b?"readwrite":"readonly"),x=v.store;return g&&(x=x.index(u.shift())),(await Promise.all([x[f](...u),b&&v.done]))[0]};return nr.set(u,method),method}replaceTraps(c=>({...c,get:(u,f,g)=>getMethod(u,f)||c.get(u,f,g),has:(u,f)=>!!getMethod(u,f)||c.has(u,f)}));let ni="TLDRAW_DOCUMENT_v2",no="TLDRAW_DB_NAME_INDEX_v2",na={Records:"records",Schema:"schema",SessionState:"session_state"};async function withDb(c,u){addDbName(c);let f=await openDB(c,3,{upgrade(c){c.objectStoreNames.contains(na.Records)||c.createObjectStore(na.Records),c.objectStoreNames.contains(na.Schema)||c.createObjectStore(na.Schema),c.objectStoreNames.contains(na.SessionState)||c.createObjectStore(na.SessionState)}});try{return await u(f)}finally{f.close()}}async function loadDataFromStore({persistenceKey:c,sessionId:u,didCancel:f}){let g=ni+c;if(getAllIndexDbNames().includes(g))return await pruneSessionState({persistenceKey:c,didCancel:f}),await withDb(g,async c=>{if(f?.())return;let g=c.transaction([na.Records,na.Schema,na.SessionState],"readonly"),b=g.objectStore(na.Records),v=g.objectStore(na.Schema),x=g.objectStore(na.SessionState),w=u?(await x.get(u))?.snapshot:null;if(!w){let c=await x.getAll();w=c.sort((c,u)=>c.updatedAt-u.updatedAt).pop()?.snapshot}let _={records:await b.getAll(),schema:await v.get(na.Schema),sessionStateSnapshot:w};if(f?.()){g.abort();return}return await g.done,_})}async function storeChangesInIndexedDb({persistenceKey:c,schema:u,changes:f,sessionId:g,sessionStateSnapshot:b,didCancel:v}){let x=ni+c;await withDb(x,async c=>{let x=c.transaction([na.Records,na.Schema,na.SessionState],"readwrite"),w=x.objectStore(na.Records),_=x.objectStore(na.Schema),k=x.objectStore(na.SessionState);for(let[c,u]of Object.entries(f.added))await w.put(u,c);for(let[c,u]of Object.values(f.updated))await w.put(u,u.id);for(let c of Object.keys(f.removed))await w.delete(c);if(_.put(u.serialize(),na.Schema),b&&g?k.put({snapshot:b,updatedAt:Date.now(),id:g},g):(b||g)&&console.error("sessionStateSnapshot and instanceId must be provided together"),v?.())return x.abort();await x.done})}async function storeSnapshotInIndexedDb({persistenceKey:c,schema:u,snapshot:f,sessionId:g,sessionStateSnapshot:b,didCancel:v}){let x=ni+c;await withDb(x,async c=>{let x=c.transaction([na.Records,na.Schema,na.SessionState],"readwrite"),w=x.objectStore(na.Records),_=x.objectStore(na.Schema),k=x.objectStore(na.SessionState);for(let[c,u]of(await w.clear(),Object.entries(f)))await w.put(u,c);if(_.put(u.serialize(),na.Schema),b&&g?k.put({snapshot:b,updatedAt:Date.now(),id:g},g):(b||g)&&console.error("sessionStateSnapshot and instanceId must be provided together"),v?.())return x.abort();await x.done})}async function pruneSessionState({persistenceKey:c,didCancel:u}){await withDb(ni+c,async c=>{let f=c.transaction([na.SessionState],"readwrite"),g=f.objectStore(na.SessionState),b=(await g.getAll()).sort((c,u)=>c.updatedAt-u.updatedAt);if(b.length<10){await f.done;return}let v=b.slice(0,b.length-10);for(let{id:c}of v)await g.delete(c);if(u?.())return f.abort();await f.done})}function getAllIndexDbNames(){let c=JSON.parse(window?.localStorage.getItem(no)||"[]")??[];return Array.isArray(c)?c:[]}function addDbName(c){let u=new Set(getAllIndexDbNames());u.add(c),window?.localStorage.setItem(no,JSON.stringify([...u]))}let ns=Symbol("UPDATE_INSTANCE_STATE"),msg=c=>c;let BroadcastChannelMock=class BroadcastChannelMock{onmessage;constructor(c){}postMessage(c){}close(){}};let nl="undefined"==typeof BroadcastChannel?BroadcastChannelMock:BroadcastChannel;let TLLocalSyncClient=class TLLocalSyncClient{constructor(c,{persistenceKey:u,sessionId:f=t2,onLoad:g,onLoadError:b},v=new nl(`tldraw-tab-sync-${u}`)){this.store=c,this.channel=v,"undefined"!=typeof window&&(window.tlsync=this),this.persistenceKey=u,this.sessionId=f,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=createSessionStateSnapshotSignal(this.store),this.disposables.add(c.listen(({changes:c})=>{this.diffQueue.push(c),this.channel.postMessage(msg({type:"diff",storeId:this.store.id,changes:c,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(c.listen(()=>{this.diffQueue.push(ns),this.schedulePersist()},{scope:"session"})),this.connect(g,b),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(c=>"document"===c.scope).map(c=>c.typeName))}disposables=new Set;diffQueue=[];didDispose=!1;shouldDoFullDBWrite=!0;isReloading=!1;persistenceKey;sessionId;serializedSchema;isDebugging=!1;documentTypes;$sessionStateSnapshot;initTime=Date.now();debug(...c){this.isDebugging&&console.debug(...c)}async connect(c,u){let f;this.debug("connecting");try{f=await loadDataFromStore({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(c){u(c),showCantReadFromIndexDbAlert(),"undefined"!=typeof window&&window.location.reload();return}if(this.debug("loaded data from store",f,"didDispose",this.didDispose),!this.didDispose)try{if(f){let c=Object.fromEntries(f.records.map(c=>[c.id,c])),g=f.sessionStateSnapshot??extractSessionStateFromLegacySnapshot(c),b=this.store.schema.migrateStoreSnapshot({store:c,schema:f.schema??this.store.schema.serializeEarliestVersion()});if("error"===b.type){console.error("failed to migrate store",b),u(Error(`Failed to migrate store: ${b.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(b.value).filter(c=>this.documentTypes.has(c.typeName)),"initialize")}),g&&loadSessionStateSnapshotIntoStore(this.store,g)}this.channel.onmessage=({data:c})=>{this.debug("got message",c);let f=(0,e3.$F)(this.serializedSchema,c.schema??this.store.schema.serializeEarliestVersion());if(-1===f){let c=Date.now()-this.initTime;if(c<5e3){u(Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,window?.location?.reload?.();return}if(1===f){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}"diff"===c.type&&(this.debug("applying diff"),(0,e5.ay)(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(c.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),c(this)}catch(c){if(this.debug("error loading data from store",c),this.didDispose)return;u(c);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(c=>c())}isPersisting=!1;didLastWriteError=!1;scheduledPersistTimeout=null;schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?1e4:350))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||!this.shouldDoFullDBWrite&&!(this.diffQueue.length>0)||this.doPersist()}async doPersist(){(0,e4.hu)(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");let c=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await storeSnapshotInIndexedDb({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});else{let u=(0,e3.bs)(c.filter(c=>c!==ns));await storeChangesInIndexedDb({persistenceKey:this.persistenceKey,changes:u,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value})}this.didLastWriteError=!1}catch(c){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",c),showCantWriteToIndexDbAlert(),"undefined"!=typeof window&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}};var nc=f(29968);function createTLStore({initialData:c,defaultName:u="",...f}){let g="schema"in f&&f.schema?f.schema:(0,e8.HH)({shapes:currentPageShapesToShapeMap((0,nc.m)("shapeUtils"in f&&f.shapeUtils?f.shapeUtils:[]))});return new e3.yh({schema:g,initialData:c,props:{defaultName:u}})}function currentPageShapesToShapeMap(c){return Object.fromEntries(c.map(c=>[c.type,{props:c.props,migrations:c.migrations}]))}function useTLStore(c){let[u,f]=(0,K.useState)(()=>{let u=createTLStore(c);return c.snapshot&&u.loadSnapshot(c.snapshot),u}),g=(0,K.useRef)(c);if((0,K.useEffect)(()=>void(g.current=c)),Object.keys(g.current).some(u=>g.current[u]!==c[u])){let u=createTLStore(c);return c.snapshot&&u.loadSnapshot(c.snapshot),f(u),u}return u}function useLocalStore({persistenceKey:c,sessionId:u,...f}){let[g,b]=(0,K.useState)(null),v=useTLStore(f);return(0,K.useEffect)(()=>{let f=(0,tQ.E)();if(!c){b({id:f,storeWithStatus:{status:"not-synced",store:v}});return}b({id:f,storeWithStatus:{status:"loading"}});let setStoreWithStatus=c=>{b(u=>u?.id===f?{id:f,storeWithStatus:c}:u)},g=new TLLocalSyncClient(v,{sessionId:u,persistenceKey:c,onLoad(){setStoreWithStatus({store:v,status:"synced-local"})},onLoadError(c){setStoreWithStatus({status:"error",error:c})}});return()=>{b(c=>c?.id===f?null:c),g.close()}},[c,v,u]),g?.storeWithStatus??{status:"loading"}}let nu=!1;if("undefined"!=typeof window){let c=window.navigator.userAgent,u=!!c.match(/iPad/i)||!!c.match(/iPhone/i),f=!!c.match(/WebKit/i);nu=u&&f&&!c.match(/CriOS/i)}function useSafariFocusOutFix(){let c=(0,tt.j)();K.useEffect(()=>{if(nu)return document.addEventListener("focusout",handleFocusOut),()=>document.removeEventListener("focusout",handleFocusOut);function handleFocusOut(u){(u.target instanceof HTMLInputElement&&"text"===u.target.type||u.target instanceof HTMLTextAreaElement)&&c.complete()}},[c])}function useZoomCss(){let c=(0,tt.j)(),u=useContainer();K.useEffect(()=>{let setScale=c=>u.style.setProperty("--tl-zoom",c.toString()),f=(0,e4.Ds)(setScale,100),g=new e5.R0("useZoomCss",()=>{let u=c.currentPageShapeIds.size;u<300?setScale(c.zoomLevel):f(c.zoomLevel)});return g.attach(),g.execute(),()=>{g.detach()}},[c,u])}let nd=[],nh=[],np=(0,K.memo)(function({store:c,components:u,className:f,user:g,...b}){let[v,x]=K.useState(null),w=(0,K.useMemo)(()=>g??(0,tW.L)(),[g]),_=u?.ErrorFallback===void 0?DefaultErrorFallback:u?.ErrorFallback,k={...b,shapeUtils:b.shapeUtils??nd,tools:b.tools??nh};return(0,V.jsx)("div",{ref:x,draggable:!1,className:e2("tl-container tl-theme__light",f),onPointerDown:stopEventPropagation,tabIndex:-1,children:(0,V.jsx)(OptionalErrorBoundary,{fallback:_,onError:c=>(0,e4.lw)(c,{tags:{origin:"react.tldraw-before-app"}}),children:v&&(0,V.jsx)(ContainerProvider,{container:v,children:(0,V.jsx)(EditorComponentsProvider,{overrides:u,children:c?c instanceof e3.yh?(0,V.jsx)(TldrawEditorWithReadyStore,{...k,store:c,user:w}):(0,V.jsx)(nf,{...k,store:c,user:w}):(0,V.jsx)(TldrawEditorWithOwnStore,{...k,store:c,user:w})})})})})});function TldrawEditorWithOwnStore(c){let{defaultName:u,snapshot:f,initialData:g,shapeUtils:b,persistenceKey:v,sessionId:x,user:w}=c,_=useLocalStore({shapeUtils:b,initialData:g,persistenceKey:v,sessionId:x,defaultName:u,snapshot:f});return(0,V.jsx)(nf,{...c,store:_,user:w})}let nf=(0,K.memo)(function({store:c,user:u,...f}){let g=useContainer();switch((0,K.useLayoutEffect)(()=>{u.userPreferences.value.isDarkMode&&(g.classList.remove("tl-theme__light"),g.classList.add("tl-theme__dark"))},[g,u.userPreferences.value.isDarkMode]),c.status){case"error":throw c.error;case"loading":return(0,V.jsx)(LoadingScreen,{children:"Connecting..."})}return(0,V.jsx)(TldrawEditorWithReadyStore,{...f,store:c.store,user:u})});function TldrawEditorWithReadyStore({onMount:c,children:u,store:f,tools:g,shapeUtils:b,user:v,initialState:x,autoFocus:w=!0,inferDarkMode:_}){let{ErrorFallback:k}=useEditorComponents(),E=useContainer(),[T,$]=(0,K.useState)(null);(0,K.useLayoutEffect)(()=>{let c=new tK.M({store:f,shapeUtils:b,tools:g,getContainer:()=>E,user:v,initialState:x,inferDarkMode:_});return window.app=c,window.editor=c,$(c),()=>{c.dispose()}},[E,b,g,f,v,x,_]);let I=(0,K.useSyncExternalStore)((0,K.useCallback)(c=>T?(T.on("crash",c),()=>T.off("crash",c)):()=>{},[T]),()=>T?.crashingError??null);return T?(0,V.jsx)(OptionalErrorBoundary,{fallback:k,onError:c=>T.annotateError(c,{origin:"react.tldraw",willCrashApp:!0}),children:I?(0,V.jsx)(Crash,{crashingError:I}):(0,V.jsx)(tt.r.Provider,{value:T,children:(0,V.jsx)(Layout,{autoFocus:w,onMount:c,children:u})})}):null}function Layout({children:c,onMount:u,autoFocus:f}){useZoomCss(),useCursor(),useDarkMode(),useSafariFocusOutFix(),useForceUpdate(),useFocusEvents(f),useOnMount(u),useDPRMultiple();let g=(0,tt.j)();return g.updateViewportScreenBounds(),c??(0,V.jsx)(Canvas,{})}function Crash({crashingError:c}){throw c}function LoadingScreen({children:c}){let{Spinner:u}=useEditorComponents();return(0,V.jsxs)("div",{className:"tl-loading",children:[u?(0,V.jsx)(u,{}):null,c]})}function ErrorScreen({children:c}){return(0,V.jsx)("div",{className:"tl-loading",children:c})}function useOnMount(c){let u=(0,tt.j)(),f=useEvent(u=>{let f=c?.(u);return u.emit("mount"),window.tldrawReady=!0,f});K.useLayoutEffect(()=>{if(u)return f?.(u)},[u,f])}function HTMLContainer({children:c,className:u="",...f}){return(0,V.jsx)("div",{...f,className:`tl-html-container ${u}`,children:c})}let ng=(0,e5.j)(function({x:c=0,y:u=0,rotation:f=0,...g}){let b=(0,tt.j)(),v=(0,K.useRef)(null);return(0,K.useLayoutEffect)(()=>{let{x:g,y:x,z:w}=b.camera,_=v.current;_&&void 0!==g&&(_.style.transform=`translate(${g}px, ${x}px) scale(${w}) rotate(${f}rad) translate(${c}px, ${u}px)`)},[b.camera,c,u,f]),(0,V.jsx)("div",{ref:v,...g,className:e2("tl-positioned",g.className)})});var nm=f(17295),ny=f(45894),nb=f(82278),nv=f(29234),nS=f(25859);function resizeBox(c,u,f={}){let{newPoint:g,handle:b,scaleX:v,scaleY:x}=u,{minWidth:w=1,maxWidth:_=1/0,minHeight:k=1,maxHeight:E=1/0}=f,T=c.props.w*v,$=c.props.h*x,I=new tl.G(0,0);if(T>0){if(T<w){switch(b){case"top_left":case"left":case"bottom_left":I.x=T-w;break;case"top":case"bottom":I.x=(T-w)/2;break;default:I.x=0}T=w}}else if(I.x=T,(T=-T)<w){switch(b){case"top_left":case"left":case"bottom_left":I.x=-T;break;default:I.x=-w}T=w}if($>0){if($<k){switch(b){case"top_left":case"top":case"top_right":I.y=$-k;break;case"right":case"left":I.y=($-k)/2;break;default:I.y=0}$=k}}else if(I.y=$,($=-$)<k){switch(b){case"top_left":case"top":case"top_right":I.y=-$;break;default:I.y=-k}$=k}let{x:M,y:j}=I.rot(c.rotation).add(g);return{x:M,y:j,props:{w:Math.min(_,T),h:Math.min(E,$)}}}let BaseBoxShapeUtil=class BaseBoxShapeUtil extends nS.E{getGeometry(c){return new nv.z({width:c.props.w,height:c.props.h,isFilled:!0})}onResize=(c,u)=>resizeBox(c,u)};var nx=f(82772),nw=f(30224);function getArrowPoints(c,u,f){let g;let b="end"===u?c.end.point:c.start.point,v="end"===u?c.start.point:c.end.point,x=c.isStraight?tl.G.Dist(v,b):Math.abs(c.bodyArc.length),w=Math.max(Math.min(x/5,3*f),f);if(c.isStraight)g=tl.G.Nudge(b,v,w);else{let f=(0,nw.bO)(b,w,c.handleArc.center,c.handleArc.radius);g="end"===u?c.handleArc.sweepFlag?f[0]:f[1]:c.handleArc.sweepFlag?f[1]:f[0]}return{point:b,int:g}}function getArrowhead({point:c,int:u}){let f=tl.G.RotWith(u,c,ts.PI/6),g=tl.G.RotWith(u,c,-ts.PI/6);return`M ${f.x} ${f.y} L ${c.x} ${c.y} L ${g.x} ${g.y}`}function getTriangleHead({point:c,int:u}){let f=tl.G.RotWith(u,c,ts.PI/6),g=tl.G.RotWith(u,c,-ts.PI/6);return`M ${f.x} ${f.y} L ${c.x} ${c.y} L ${g.x} ${g.y} Z`}function getInvertedTriangleHead({point:c,int:u}){let f=tl.G.Sub(u,c).div(2),g=tl.G.Add(c,tl.G.Rot(f,ts.gc)),b=tl.G.Sub(c,tl.G.Rot(f,ts.gc));return`M ${g.x} ${g.y} L ${u.x} ${u.y} L ${b.x} ${b.y} Z`}function getDotHead({point:c,int:u}){let f=tl.G.Lrp(c,u,.45),g=tl.G.Dist(f,c);return`M ${f.x-g},${f.y}
  a ${g},${g} 0 1,0 ${2*g},0
  a ${g},${g} 0 1,0 -${2*g},0 `}function getDiamondHead({point:c,int:u}){let f=tl.G.Lrp(c,u,.75),g=tl.G.RotWith(f,c,ts.PI/4),b=tl.G.RotWith(f,c,-ts.PI/4),v=tl.G.Lrp(g,b,.5);return v.add(tl.G.Sub(v,c)),`M ${v.x} ${v.y} L ${g.x} ${g.y} ${c.x} ${c.y} L ${b.x} ${b.y} Z`}function getSquareHead({int:c,point:u}){let f=tl.G.Lrp(u,c,.85),g=tl.G.Sub(f,u).div(2),b=tl.G.Add(u,tl.G.Rot(g,ts.gc)),v=tl.G.Sub(u,tl.G.Rot(g,ts.gc)),x=tl.G.Add(f,tl.G.Rot(g,ts.gc)),w=tl.G.Sub(f,tl.G.Rot(g,ts.gc));return`M ${b.x} ${b.y} L ${x.x} ${x.y} L ${w.x} ${w.y} L ${v.x} ${v.y} Z`}function getBarHead({int:c,point:u}){let f=tl.G.Sub(c,u).div(2),g=tl.G.Add(u,tl.G.Rot(f,ts.gc)),b=tl.G.Sub(u,tl.G.Rot(f,ts.gc));return`M ${g.x} ${g.y} L ${b.x} ${b.y}`}function getArrowheadPathForType(c,u,f){let g="end"===u?c.end.arrowhead:c.start.arrowhead;if("none"===g)return;let b=getArrowPoints(c,u,f);if(b){switch(g){case"bar":return getBarHead(b);case"square":return getSquareHead(b);case"diamond":return getDiamondHead(b);case"dot":return getDotHead(b);case"inverted":return getInvertedTriangleHead(b);case"arrow":return getArrowhead(b);case"triangle":return getTriangleHead(b)}return""}}var n_=f(14214),nk=f(57761),nC=f(3308),nE=f(22797);let Idle=class Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("pointing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let Pointing=class Pointing extends nE.n{static id="pointing";markId="";wasFocusedOnEnter=!1;onEnter=()=>{let{isMenuOpen:c}=this.editor;this.wasFocusedOnEnter=!c};onPointerMove=c=>{if(this.editor.inputs.isDragging){let{originPagePoint:u}=this.editor.inputs,f=this.parent.shapeType,g=(0,e8.F1)();this.markId=`creating:${g}`,this.editor.mark(this.markId),this.editor.createShapes([{id:g,type:f,x:u.x,y:u.y,props:{w:1,h:1}}]).select(g),this.editor.setCurrentTool("select.resizing",{...c,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:c}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);let u=this.parent.shapeType,f=(0,e8.F1)();this.editor.mark(this.markId),this.editor.createShapes([{id:f,type:u,x:c.x,y:c.y}]);let g=this.editor.getShape(f),{w:b,h:v}=this.editor.getShapeUtil(g).getDefaultProps(),x=new tl.G(b/2,v/2),w=this.editor.getShapeParentTransform(g);w&&x.rot(-w.rotation()),this.editor.updateShapes([{id:f,type:u,x:g.x-x.x,y:g.y-x.y}]),this.editor.setSelectedShapes([f]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle",{})}};let BaseBoxShapeTool=class BaseBoxShapeTool extends nE.n{static id="box";static initial="idle";static children=()=>[Idle,Pointing]};var nP=f(40521);function useIsCropping(c){let u=(0,tt.j)();return(0,e5.Hg)("isCropping",()=>u.croppingShapeId===c,[u,c])}function useIsEditing(c){let u=(0,tt.j)();return(0,e5.Hg)("isEditing",()=>u.editingShapeId===c,[u,c])}function useSelectionEvents(c){let u=(0,tt.j)(),f=(0,K.useMemo)(function(){let f,g;return{onPointerDown:f=>{if(f.isKilled)return;if(2===f.button){u.dispatch({type:"pointer",target:"selection",handle:c,name:"right_click",...getPointerInfo(f)});return}if(0!==f.button)return;let g=loopToHtmlElement(f.currentTarget);function releaseCapture(){g.removeEventListener("pointerup",releaseCapture),releasePointerCapture(g,f)}setPointerCapture(g,f),g.addEventListener("pointerup",releaseCapture),u.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:c,...getPointerInfo(f)}),stopEventPropagation(f)},onPointerMove:function(b){b.isKilled||0!==b.button||b.clientX===f&&b.clientY===g||(f=b.clientX,g=b.clientY,u.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:c,...getPointerInfo(b)}))},onPointerUp:f=>{f.isKilled||0!==f.button||u.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:c,...getPointerInfo(f)})}}},[u,c]);return f}var nT=f(99303),n$=f(31986),nI=f(74519);function getVerticesCountForLength(c,u=20){return Math.max(8,Math.ceil(c/u))}let Arc2d=class Arc2d extends nI.l{_center;radius;start;end;measure;length;angleStart;angleEnd;constructor(c){super({...c,isFilled:!1,isClosed:!1});let{center:u,radius:f,sweepFlag:g,largeArcFlag:b,start:v,end:x}=c;if(v.equals(x))throw Error("Arc must have different start and end points.");this.angleStart=tl.G.Angle(u,v),this.angleEnd=tl.G.Angle(u,x),this.measure=getArcMeasure(this.angleStart,this.angleEnd,g,b),this.length=this.measure*f,this.start=v,this.end=x,this._center=u,this.radius=f}nearestPoint(c){let u;let{_center:f,measure:g,radius:b,angleEnd:v,angleStart:x,start:w,end:_}=this,k=getPointInArcT(g,x,v,f.angle(c));if(k<=0)return w;if(k>=1)return _;let E=f.clone().add(c.clone().sub(f).uni().mul(b)),T=1/0;for(let f of[w,_,E])c.dist(f)<T&&(u=f,T=c.dist(f));if(!u)throw Error("nearest point not found");return u}hitTestLineSegment(c,u,f){let{_center:g,radius:b,measure:v,angleStart:x,angleEnd:w}=this,_=(0,nw.ZM)(c,u,g,b);return null!==_&&_.some(c=>{let u=getPointInArcT(v,x,w,g.angle(c));return u>=0&&u<=1})}getVertices(){let{_center:c,measure:u,length:f,radius:g,angleStart:b}=this,v=[];for(let x=0,w=getVerticesCountForLength(Math.abs(f));x<w+1;x++){let f=x/w*u,_=b+f;v.push(c.clone().add(new tl.G(Math.cos(_),Math.sin(_)).mul(g)))}return v}};function getPointInArcT(c,u,f,g){let b;if(!(Math.abs(c)>ts.PI))return(b=(0,ts.Z7)(u,g))/c;{b=(0,ts.Z7)(u,g);let v=(0,ts.Z7)(g,f);return Math.abs(b)<Math.abs(v)?b/c:(c-v)/c}}function getArcMeasure(c,u,f,g){let b=2*((u-c)%ts.yo)%ts.yo-(u-c)%ts.yo;return g?(ts.yo-Math.abs(b))*(f?1:-1):b}let Circle2d=class Circle2d extends nI.l{constructor(c){super({isClosed:!0,...c}),this.config=c;let{x:u=0,y:f=0,radius:g}=c;this.x=u,this.y=f,this._center=new tl.G(g+u,g+f),this.radius=g}_center;radius;x;y;getBounds(){return new nT.No(this.x,this.y,2*this.radius,2*this.radius)}getVertices(){let{_center:c,radius:u}=this,f=ts.yo*u,g=[];for(let b=0,v=getVerticesCountForLength(f);b<v;b++){let f=b/v*ts.yo;g.push(c.clone().add(tl.G.FromAngle(f).mul(u)))}return g}nearestPoint(c){let{_center:u,radius:f}=this;return u.equals(c)?tl.G.AddXY(u,f,0):u.clone().add(c.clone().sub(u).uni().mul(f))}hitTestLineSegment(c,u,f){let{_center:g,radius:b}=this;return null!==(0,nw.ZM)(c,u,g,b)}};var nA=f(86368);let CubicBezier2d=class CubicBezier2d extends nA.q{a;b;c;d;constructor(c){let{start:u,cp1:f,cp2:g,end:b}=c;super({...c,points:[u,b]}),this.a=u,this.b=f,this.c=g,this.d=b}getVertices(){let c=[],{a:u,b:f,c:g,d:b}=this;for(let v=0;v<=10;v++){let x=v/10;c.push(new tl.G((1-x)*(1-x)*(1-x)*u.x+3*((1-x)*(1-x))*x*f.x+3*(1-x)*(x*x)*g.x+x*x*x*b.x,(1-x)*(1-x)*(1-x)*u.y+3*((1-x)*(1-x))*x*f.y+3*(1-x)*(x*x)*g.y+x*x*x*b.y))}return c}midPoint(){return getAtT(this,.5)}nearestPoint(c){let u;let f=1/0;for(let g of this.segments){let b=g.nearestPoint(c),v=b.dist(c);v<f&&(u=b,f=v)}if(!u)throw Error("nearest point not found");return u}};function getAtT(c,u){let{a:f,b:g,c:b,d:v}=c;return new tl.G((1-u)*(1-u)*(1-u)*f.x+3*((1-u)*(1-u))*u*g.x+3*(1-u)*(u*u)*b.x+u*u*u*v.x,(1-u)*(1-u)*(1-u)*f.y+3*((1-u)*(1-u))*u*g.y+3*(1-u)*(u*u)*b.y+u*u*u*v.y)}let CubicSpline2d=class CubicSpline2d extends nI.l{points;constructor(c){super({...c,isClosed:!1,isFilled:!1});let{points:u}=c;this.points=u}_segments;get segments(){if(!this._segments){this._segments=[];let{points:c}=this,u=c.length,f=u-2;for(let g=0;g<u-1;g++){let u=0===g?c[0]:c[g-1],b=c[g],v=c[g+1],x=g===f?v:c[g+2],w=0===g?u:new tl.G(b.x+(v.x-u.x)/6*1.25,b.y+(v.y-u.y)/6*1.25),_=g===f?v:new tl.G(v.x-(x.x-b.x)/6*1.25,v.y-(x.y-b.y)/6*1.25);this._segments.push(new CubicBezier2d({start:b,cp1:w,cp2:_,end:v}))}}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce((c,u)=>c+u.length,0)),this._length}getVertices(){let c=this.segments.reduce((c,u)=>c.concat(u.vertices),[]);return c.push(this.points[this.points.length-1]),c}nearestPoint(c){let u;let f=1/0;for(let g of this.segments){let b=g.nearestPoint(c),v=b.dist(c);v<f&&(u=b,f=v)}if(!u)throw Error("nearest point not found");return u}hitTestLineSegment(c,u,f){return this.segments.some(g=>g.hitTestLineSegment(c,u,f))}};var nM=f(84137);let Ellipse2d=class Ellipse2d extends nI.l{constructor(c){super({...c,isClosed:!0}),this.config=c;let{width:u,height:f}=c;this.w=u,this.h=f}w;h;_edges;get edges(){if(!this._edges){let{vertices:c}=this;this._edges=[];for(let u=0,f=c.length;u<f;u++){let g=c[u],b=c[(u+1)%f];this._edges.push(new nM.W({start:g,end:b}))}}return this._edges}getVertices(){let c=Math.max(1,this.w),u=Math.max(1,this.h),f=c/2,g=u/2,b=Math.pow(f-g,2)/Math.pow(f+g,2),v=ts.PI*(f+g)*(1+3*b/(10+Math.sqrt(4-3*b))),x=getVerticesCountForLength(v),w=ts.yo/x,_=Math.cos(w),k=Math.sin(w),E=0,T=1,$=0,I=1,M=Array(x);for(let c=0;c<x;c++)M[c]=new tl.G(f+f*T,g+g*E),$=k*T+_*E,I=_*T-k*E,E=$,T=I;return M}nearestPoint(c){let u;let f=1/0;for(let g of this.edges){let b=g.nearestPoint(c),v=b.dist(c);v<f&&(u=b,f=v)}if(!u)throw Error("nearest point not found");return u}hitTestLineSegment(c,u,f){return this.edges.some(g=>g.hitTestLineSegment(c,u,f))}getBounds(){return new nT.No(0,0,this.w,this.h)}};var nj=f(87684),nO=f(92042);let Stadium2d=class Stadium2d extends Ellipse2d{constructor(c){super({...c}),this.config=c}getVertices(){let c=Math.max(1,this.w),u=Math.max(1,this.h),f=c/2,g=u/2,b=Array(18);if(u>c)for(let c=0;c<9;c++){let g=-ts.PI+ts.PI*c/8,v=ts.PI*c/8;b[c]=new tl.G(f+f*Math.cos(g),f+f*Math.sin(g)),b[c+9]=new tl.G(f+f*Math.cos(v),u-f+f*Math.sin(v))}else for(let f=0;f<9;f++){let v=-ts.gc+ts.PI*f/8,x=ts.gc+-(ts.PI*f)/8;b[f]=new tl.G(c-g+g*Math.cos(v),u-g+g*Math.sin(v)),b[f+9]=new tl.G(g-g*Math.cos(x),u-g+g*Math.sin(x))}return b}};var nR=f(9006),nD=f(91230),nL=f(50280),nN=f(41605),nF=f(64078),nB=f(17556);async function hardReset({shouldReload:c=!0}={}){sessionStorage.clear(),await Promise.all(getAllIndexDbNames().map(c=>deleteDB(c))),localStorage.clear(),c&&window.location.reload()}function openWindow(c,u="_blank"){tu.openWindow(c,u)}"undefined"!=typeof window&&(window.__tldraw__hardReset=hardReset),f(69645),f(64770),f(86930),f(92880),f(19304);let nz=(0,K.createContext)(null);function AssetUrlsProvider({assetUrls:c,children:u}){return(0,V.jsx)(nz.Provider,{value:c,children:u})}function useAssetUrls(){let c=(0,K.useContext)(nz);if(!c)throw Error("useAssetUrls must be used within an AssetUrlsProvider");return c}let nG={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},nU={locale:"en",label:"English",messages:nG};async function fetchTranslation(c,u){let f=await fetch(u.translations.en);if(!f.ok)return console.warn("No main translations found."),nU;if("en"===c)return nU;let g=e8.a2.find(u=>u.locale===c);if(!g)return console.warn(`No translation found for locale ${c}`),nU;let b=await fetch(u.translations[g.locale]),v=await b.json();if(!v)return console.warn(`No messages found for locale ${c}`),nU;let x=[];for(let c in nU.messages)v[c]||x.push(c);return x.length,{locale:c,label:g.label,messages:{...nU.messages,...v}}}let nH=K.createContext({}),useCurrentTranslation=()=>K.useContext(nH),nV=(0,e5.j)(function({overrides:c,children:u}){let f=(0,tt.j)(),g=f.user.locale,b=useAssetUrls(),[v,x]=K.useState(()=>c&&c.en?{locale:"en",label:"English",messages:{...nG,...c.en}}:{locale:"en",label:"English",messages:nG});return K.useEffect(()=>{let u=!1;return async function(){let f=await fetchTranslation(g,b);f&&!u&&(c&&c[g]?x({...f,messages:{...f.messages,...c[g]}}):x(f))}(),()=>{u=!0}},[b,g,c]),(0,V.jsx)(nH.Provider,{value:v,children:u})});function useTranslation(){let c=useCurrentTranslation();return K.useCallback(function(u){return c.messages[u]??u},[c])}function Spinner(c){return(0,V.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",...c,children:(0,V.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,V.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,V.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,V.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}let nW=(0,K.memo)(function({small:c,invertIcon:u,icon:f,color:g,className:b,...v}){let x=useAssetUrls(),w=x.icons[f],_=(0,K.useRef)(null);return(0,K.useLayoutEffect)(()=>{_?.current&&(_.current.style.webkitMask=`url(${w}) center 100% / 100% no-repeat`)},[_,w]),(0,V.jsx)("div",{...v,ref:_,className:e2("tlui-icon",{"tlui-icon__small":c},b),style:{color:g,mask:`url(${w}) center 100% / 100% no-repeat`,transform:u?"scale(-1, 1)":void 0}})}),nK="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,nZ=nK?"⌘":"Ctrl",nY=nK?"⌥":"Alt";function kbd(c){return c.split(",")[0].split("").map(c=>{let u=c.replace(/\$/g,nZ).replace(/\?/g,nY).replace(/!/g,"⇧");return u[0].toUpperCase()+u.slice(1)})}function kbdStr(c){return"— "+c.split(",")[0].split("").map(c=>{let u=c.replace(/\$/g,nZ).replace(/\?/g,nY).replace(/!/g,"⇧");return u[0].toUpperCase()+u.slice(1)}).join(" ")}function Kbd({children:c}){return(0,V.jsx)("kbd",{className:"tlui-kbd",children:kbd(c).map((c,u)=>(0,V.jsx)("span",{children:c},u))})}let nq=K.forwardRef(function({label:c,icon:u,invertIcon:f,iconLeft:g,smallIcon:b,kbd:v,isChecked:x=!1,type:w="normal",children:_,spinner:k,...E},T){let $=useTranslation(),I=c?$(c):"";return(0,V.jsxs)("button",{ref:T,draggable:!1,type:"button",...E,title:E.title??I,className:e2("tlui-button",`tlui-button__${w}`,E.className),children:[g&&(0,V.jsx)(nW,{icon:g,className:"tlui-icon-left",small:!0}),_,c&&(0,V.jsxs)("span",{draggable:!1,children:[I,x&&(0,V.jsx)(nW,{icon:"check"})]}),v&&(0,V.jsx)(Kbd,{children:v}),u&&!k&&(0,V.jsx)(nW,{icon:u,small:!!c||b,invertIcon:f}),k&&(0,V.jsx)(Spinner,{})]})});function Header({className:c,children:u}){return(0,V.jsx)("div",{className:e2("tlui-dialog__header",c),children:u})}function Title({className:c,children:u}){return(0,V.jsx)(eJ,{dir:"ltr",className:e2("tlui-dialog__header__title",c),children:u})}function CloseButton(){return(0,V.jsx)("div",{className:"tlui-dialog__header__close",children:(0,V.jsx)(eQ,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,V.jsx)(nq,{"aria-label":"Close",onTouchEnd:c=>c.target.click(),children:(0,V.jsx)(nW,{small:!0,icon:"cross-2"})})})})}function Body({className:c,children:u,style:f}){return(0,V.jsx)("div",{className:e2("tlui-dialog__body",c),style:f,children:u})}function Footer({className:c,children:u}){return(0,V.jsx)("div",{className:e2("tlui-dialog__footer",c),children:u})}function $e02a7d9cb1dc128c$export$c74125a8e3af6bb2(c){let u=c+"CollectionProvider",[f,g]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(u),[b,v]=f(u,{collectionRef:{current:null},itemMap:new Map}),x=c+"CollectionSlot",w=K.forwardRef((c,u)=>{let{scope:f,children:g}=c,b=v(x,f),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,b.collectionRef);return K.createElement(ee,{ref:w},g)}),_=c+"CollectionItemSlot",k="data-radix-collection-item",E=K.forwardRef((c,u)=>{let{scope:f,children:g,...b}=c,x=K.useRef(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,x),E=v(_,f);return K.useEffect(()=>(E.itemMap.set(x,{ref:x,...b}),()=>void E.itemMap.delete(x))),K.createElement(ee,{[k]:"",ref:w},g)});return[{Provider:c=>{let{scope:u,children:f}=c,g=K.useRef(null),v=K.useRef(new Map).current;return K.createElement(b,{scope:u,itemMap:v,collectionRef:g},f)},Slot:w,ItemSlot:E},function(u){let f=v(c+"CollectionConsumer",u),g=K.useCallback(()=>{let c=f.collectionRef.current;if(!c)return[];let u=Array.from(c.querySelectorAll(`[${k}]`)),g=Array.from(f.itemMap.values()),b=g.sort((c,f)=>u.indexOf(c.ref.current)-u.indexOf(f.ref.current));return b},[f.collectionRef,f.itemMap]);return g},g]}let nX=(0,K.createContext)(void 0);function $f631663db3294ace$export$b39126d51d94e6f3(c){let u=(0,K.useContext)(nX);return c||u||"ltr"}let nJ=["top","right","bottom","left"],nQ=Math.min,n0=Math.max,n1=Math.round,n2=Math.floor,createCoords=c=>({x:c,y:c}),n5={left:"right",right:"left",bottom:"top",top:"bottom"},n3={start:"end",end:"start"};function evaluate(c,u){return"function"==typeof c?c(u):c}function getSide(c){return c.split("-")[0]}function getAlignment(c){return c.split("-")[1]}function getOppositeAxis(c){return"x"===c?"y":"x"}function getAxisLength(c){return"y"===c?"height":"width"}function getSideAxis(c){return["top","bottom"].includes(getSide(c))?"y":"x"}function getAlignmentSides(c,u,f){void 0===f&&(f=!1);let g=getAlignment(c),b=getOppositeAxis(getSideAxis(c)),v=getAxisLength(b),x="x"===b?g===(f?"end":"start")?"right":"left":"start"===g?"bottom":"top";return u.reference[v]>u.floating[v]&&(x=getOppositePlacement(x)),[x,getOppositePlacement(x)]}function getExpandedPlacements(c){let u=getOppositePlacement(c);return[getOppositeAlignmentPlacement(c),u,getOppositeAlignmentPlacement(u)]}function getOppositeAlignmentPlacement(c){return c.replace(/start|end/g,c=>n3[c])}function getSideList(c,u,f){let g=["left","right"],b=["right","left"];switch(c){case"top":case"bottom":if(f)return u?b:g;return u?g:b;case"left":case"right":return u?["top","bottom"]:["bottom","top"];default:return[]}}function getOppositeAxisPlacements(c,u,f,g){let b=getAlignment(c),v=getSideList(getSide(c),"start"===f,g);return b&&(v=v.map(c=>c+"-"+b),u&&(v=v.concat(v.map(getOppositeAlignmentPlacement)))),v}function getOppositePlacement(c){return c.replace(/left|right|bottom|top/g,c=>n5[c])}function expandPaddingObject(c){return{top:0,right:0,bottom:0,left:0,...c}}function getPaddingObject(c){return"number"!=typeof c?expandPaddingObject(c):{top:c,right:c,bottom:c,left:c}}function rectToClientRect(c){return{...c,top:c.y,left:c.x,right:c.x+c.width,bottom:c.y+c.height}}function computeCoordsFromPlacement(c,u,f){let g,{reference:b,floating:v}=c,x=getSideAxis(u),w=getOppositeAxis(getSideAxis(u)),_=getAxisLength(w),k=getSide(u),E="y"===x,T=b.x+b.width/2-v.width/2,$=b.y+b.height/2-v.height/2,I=b[_]/2-v[_]/2;switch(k){case"top":g={x:T,y:b.y-v.height};break;case"bottom":g={x:T,y:b.y+b.height};break;case"right":g={x:b.x+b.width,y:$};break;case"left":g={x:b.x-v.width,y:$};break;default:g={x:b.x,y:b.y}}switch(getAlignment(u)){case"start":g[w]-=I*(f&&E?-1:1);break;case"end":g[w]+=I*(f&&E?-1:1)}return g}let computePosition=async(c,u,f)=>{let{placement:g="bottom",strategy:b="absolute",middleware:v=[],platform:x}=f,w=v.filter(Boolean),_=await (null==x.isRTL?void 0:x.isRTL(u)),k=await x.getElementRects({reference:c,floating:u,strategy:b}),{x:E,y:T}=computeCoordsFromPlacement(k,g,_),$=g,I={},M=0;for(let f=0;f<w.length;f++){let{name:v,fn:j}=w[f],{x:D,y:L,data:F,reset:B}=await j({x:E,y:T,initialPlacement:g,placement:$,strategy:b,middlewareData:I,rects:k,platform:x,elements:{reference:c,floating:u}});E=null!=D?D:E,T=null!=L?L:T,I={...I,[v]:{...I[v],...F}},B&&M<=50&&(M++,"object"==typeof B&&(B.placement&&($=B.placement),B.rects&&(k=!0===B.rects?await x.getElementRects({reference:c,floating:u,strategy:b}):B.rects),{x:E,y:T}=computeCoordsFromPlacement(k,$,_)),f=-1)}return{x:E,y:T,placement:$,strategy:b,middlewareData:I}};async function detectOverflow(c,u){var f;void 0===u&&(u={});let{x:g,y:b,platform:v,rects:x,elements:w,strategy:_}=c,{boundary:k="clippingAncestors",rootBoundary:E="viewport",elementContext:T="floating",altBoundary:$=!1,padding:I=0}=evaluate(u,c),M=getPaddingObject(I),j=w[$?"floating"===T?"reference":"floating":T],D=rectToClientRect(await v.getClippingRect({element:null==(f=await (null==v.isElement?void 0:v.isElement(j)))||f?j:j.contextElement||await (null==v.getDocumentElement?void 0:v.getDocumentElement(w.floating)),boundary:k,rootBoundary:E,strategy:_})),L="floating"===T?{...x.floating,x:g,y:b}:x.reference,F=await (null==v.getOffsetParent?void 0:v.getOffsetParent(w.floating)),B=await (null==v.isElement?void 0:v.isElement(F))&&await (null==v.getScale?void 0:v.getScale(F))||{x:1,y:1},G=rectToClientRect(v.convertOffsetParentRelativeRectToViewportRelativeRect?await v.convertOffsetParentRelativeRectToViewportRelativeRect({elements:w,rect:L,offsetParent:F,strategy:_}):L);return{top:(D.top-G.top+M.top)/B.y,bottom:(G.bottom-D.bottom+M.bottom)/B.y,left:(D.left-G.left+M.left)/B.x,right:(G.right-D.right+M.right)/B.x}}function getSideOffsets(c,u){return{top:c.top-u.height,right:c.right-u.width,bottom:c.bottom-u.height,left:c.left-u.width}}function isAnySideFullyClipped(c){return nJ.some(u=>c[u]>=0)}async function convertValueToCoords(c,u){let{placement:f,platform:g,elements:b}=c,v=await (null==g.isRTL?void 0:g.isRTL(b.floating)),x=getSide(f),w=getAlignment(f),_="y"===getSideAxis(f),k=["left","top"].includes(x)?-1:1,E=v&&_?-1:1,T=evaluate(u,c),{mainAxis:$,crossAxis:I,alignmentAxis:M}="number"==typeof T?{mainAxis:T,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...T};return w&&"number"==typeof M&&(I="end"===w?-1*M:M),_?{x:I*E,y:$*k}:{x:$*k,y:I*E}}function getNodeName(c){return isNode(c)?(c.nodeName||"").toLowerCase():"#document"}function getWindow(c){var u;return(null==c||null==(u=c.ownerDocument)?void 0:u.defaultView)||window}function getDocumentElement(c){var u;return null==(u=(isNode(c)?c.ownerDocument:c.document)||window.document)?void 0:u.documentElement}function isNode(c){return c instanceof Node||c instanceof getWindow(c).Node}function isElement(c){return c instanceof Element||c instanceof getWindow(c).Element}function isHTMLElement(c){return c instanceof HTMLElement||c instanceof getWindow(c).HTMLElement}function isShadowRoot(c){return"undefined"!=typeof ShadowRoot&&(c instanceof ShadowRoot||c instanceof getWindow(c).ShadowRoot)}function isOverflowElement(c){let{overflow:u,overflowX:f,overflowY:g,display:b}=floating_ui_utils_dom_getComputedStyle(c);return/auto|scroll|overlay|hidden|clip/.test(u+g+f)&&!["inline","contents"].includes(b)}function isTableElement(c){return["table","td","th"].includes(getNodeName(c))}function isContainingBlock(c){let u=isWebKit(),f=floating_ui_utils_dom_getComputedStyle(c);return"none"!==f.transform||"none"!==f.perspective||!!f.containerType&&"normal"!==f.containerType||!u&&!!f.backdropFilter&&"none"!==f.backdropFilter||!u&&!!f.filter&&"none"!==f.filter||["transform","perspective","filter"].some(c=>(f.willChange||"").includes(c))||["paint","layout","strict","content"].some(c=>(f.contain||"").includes(c))}function getContainingBlock(c){let u=getParentNode(c);for(;isHTMLElement(u)&&!isLastTraversableNode(u);){if(isContainingBlock(u))return u;u=getParentNode(u)}return null}function isWebKit(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(c){return["html","body","#document"].includes(getNodeName(c))}function floating_ui_utils_dom_getComputedStyle(c){return getWindow(c).getComputedStyle(c)}function getNodeScroll(c){return isElement(c)?{scrollLeft:c.scrollLeft,scrollTop:c.scrollTop}:{scrollLeft:c.pageXOffset,scrollTop:c.pageYOffset}}function getParentNode(c){if("html"===getNodeName(c))return c;let u=c.assignedSlot||c.parentNode||isShadowRoot(c)&&c.host||getDocumentElement(c);return isShadowRoot(u)?u.host:u}function getNearestOverflowAncestor(c){let u=getParentNode(c);return isLastTraversableNode(u)?c.ownerDocument?c.ownerDocument.body:c.body:isHTMLElement(u)&&isOverflowElement(u)?u:getNearestOverflowAncestor(u)}function getOverflowAncestors(c,u,f){var g;void 0===u&&(u=[]),void 0===f&&(f=!0);let b=getNearestOverflowAncestor(c),v=b===(null==(g=c.ownerDocument)?void 0:g.body),x=getWindow(b);return v?u.concat(x,x.visualViewport||[],isOverflowElement(b)?b:[],x.frameElement&&f?getOverflowAncestors(x.frameElement):[]):u.concat(b,getOverflowAncestors(b,[],f))}function getCssDimensions(c){let u=floating_ui_utils_dom_getComputedStyle(c),f=parseFloat(u.width)||0,g=parseFloat(u.height)||0,b=isHTMLElement(c),v=b?c.offsetWidth:f,x=b?c.offsetHeight:g,w=n1(f)!==v||n1(g)!==x;return w&&(f=v,g=x),{width:f,height:g,$:w}}function unwrapElement(c){return isElement(c)?c:c.contextElement}function getScale(c){let u=unwrapElement(c);if(!isHTMLElement(u))return createCoords(1);let f=u.getBoundingClientRect(),{width:g,height:b,$:v}=getCssDimensions(u),x=(v?n1(f.width):f.width)/g,w=(v?n1(f.height):f.height)/b;return x&&Number.isFinite(x)||(x=1),w&&Number.isFinite(w)||(w=1),{x,y:w}}let n8=createCoords(0);function getVisualOffsets(c){let u=getWindow(c);return isWebKit()&&u.visualViewport?{x:u.visualViewport.offsetLeft,y:u.visualViewport.offsetTop}:n8}function shouldAddVisualOffsets(c,u,f){return void 0===u&&(u=!1),!!f&&(!u||f===getWindow(c))&&u}function getBoundingClientRect(c,u,f,g){void 0===u&&(u=!1),void 0===f&&(f=!1);let b=c.getBoundingClientRect(),v=unwrapElement(c),x=createCoords(1);u&&(g?isElement(g)&&(x=getScale(g)):x=getScale(c));let w=shouldAddVisualOffsets(v,f,g)?getVisualOffsets(v):createCoords(0),_=(b.left+w.x)/x.x,k=(b.top+w.y)/x.y,E=b.width/x.x,T=b.height/x.y;if(v){let c=getWindow(v),u=g&&isElement(g)?getWindow(g):g,f=c,b=f.frameElement;for(;b&&g&&u!==f;){let c=getScale(b),u=b.getBoundingClientRect(),g=floating_ui_utils_dom_getComputedStyle(b),v=u.left+(b.clientLeft+parseFloat(g.paddingLeft))*c.x,x=u.top+(b.clientTop+parseFloat(g.paddingTop))*c.y;_*=c.x,k*=c.y,E*=c.x,T*=c.y,_+=v,k+=x,b=(f=getWindow(b)).frameElement}}return rectToClientRect({width:E,height:T,x:_,y:k})}let n4=[":popover-open",":modal"];function isTopLayer(c){return n4.some(u=>{try{return c.matches(u)}catch(c){return!1}})}function convertOffsetParentRelativeRectToViewportRelativeRect(c){let{elements:u,rect:f,offsetParent:g,strategy:b}=c,v="fixed"===b,x=getDocumentElement(g),w=!!u&&isTopLayer(u.floating);if(g===x||w&&v)return f;let _={scrollLeft:0,scrollTop:0},k=createCoords(1),E=createCoords(0),T=isHTMLElement(g);if((T||!T&&!v)&&(("body"!==getNodeName(g)||isOverflowElement(x))&&(_=getNodeScroll(g)),isHTMLElement(g))){let c=getBoundingClientRect(g);k=getScale(g),E.x=c.x+g.clientLeft,E.y=c.y+g.clientTop}return{width:f.width*k.x,height:f.height*k.y,x:f.x*k.x-_.scrollLeft*k.x+E.x,y:f.y*k.y-_.scrollTop*k.y+E.y}}function getClientRects(c){return Array.from(c.getClientRects())}function getWindowScrollBarX(c){return getBoundingClientRect(getDocumentElement(c)).left+getNodeScroll(c).scrollLeft}function getDocumentRect(c){let u=getDocumentElement(c),f=getNodeScroll(c),g=c.ownerDocument.body,b=n0(u.scrollWidth,u.clientWidth,g.scrollWidth,g.clientWidth),v=n0(u.scrollHeight,u.clientHeight,g.scrollHeight,g.clientHeight),x=-f.scrollLeft+getWindowScrollBarX(c),w=-f.scrollTop;return"rtl"===floating_ui_utils_dom_getComputedStyle(g).direction&&(x+=n0(u.clientWidth,g.clientWidth)-b),{width:b,height:v,x,y:w}}function getViewportRect(c,u){let f=getWindow(c),g=getDocumentElement(c),b=f.visualViewport,v=g.clientWidth,x=g.clientHeight,w=0,_=0;if(b){v=b.width,x=b.height;let c=isWebKit();(!c||c&&"fixed"===u)&&(w=b.offsetLeft,_=b.offsetTop)}return{width:v,height:x,x:w,y:_}}function getInnerBoundingClientRect(c,u){let f=getBoundingClientRect(c,!0,"fixed"===u),g=f.top+c.clientTop,b=f.left+c.clientLeft,v=isHTMLElement(c)?getScale(c):createCoords(1),x=c.clientWidth*v.x,w=c.clientHeight*v.y,_=b*v.x,k=g*v.y;return{width:x,height:w,x:_,y:k}}function getClientRectFromClippingAncestor(c,u,f){let g;if("viewport"===u)g=getViewportRect(c,f);else if("document"===u)g=getDocumentRect(getDocumentElement(c));else if(isElement(u))g=getInnerBoundingClientRect(u,f);else{let f=getVisualOffsets(c);g={...u,x:u.x-f.x,y:u.y-f.y}}return rectToClientRect(g)}function hasFixedPositionAncestor(c,u){let f=getParentNode(c);return!(f===u||!isElement(f)||isLastTraversableNode(f))&&("fixed"===floating_ui_utils_dom_getComputedStyle(f).position||hasFixedPositionAncestor(f,u))}function getClippingElementAncestors(c,u){let f=u.get(c);if(f)return f;let g=getOverflowAncestors(c,[],!1).filter(c=>isElement(c)&&"body"!==getNodeName(c)),b=null,v="fixed"===floating_ui_utils_dom_getComputedStyle(c).position,x=v?getParentNode(c):c;for(;isElement(x)&&!isLastTraversableNode(x);){let u=floating_ui_utils_dom_getComputedStyle(x),f=isContainingBlock(x);f||"fixed"!==u.position||(b=null);let w=v?!f&&!b:!f&&"static"===u.position&&!!b&&["absolute","fixed"].includes(b.position)||isOverflowElement(x)&&!f&&hasFixedPositionAncestor(c,x);w?g=g.filter(c=>c!==x):b=u,x=getParentNode(x)}return u.set(c,g),g}function getClippingRect(c){let{element:u,boundary:f,rootBoundary:g,strategy:b}=c,v="clippingAncestors"===f?getClippingElementAncestors(u,this._c):[].concat(f),x=[...v,g],w=x[0],_=x.reduce((c,f)=>{let g=getClientRectFromClippingAncestor(u,f,b);return c.top=n0(g.top,c.top),c.right=nQ(g.right,c.right),c.bottom=nQ(g.bottom,c.bottom),c.left=n0(g.left,c.left),c},getClientRectFromClippingAncestor(u,w,b));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function getDimensions(c){let{width:u,height:f}=getCssDimensions(c);return{width:u,height:f}}function getRectRelativeToOffsetParent(c,u,f){let g=isHTMLElement(u),b=getDocumentElement(u),v="fixed"===f,x=getBoundingClientRect(c,!0,v,u),w={scrollLeft:0,scrollTop:0},_=createCoords(0);if(g||!g&&!v){if(("body"!==getNodeName(u)||isOverflowElement(b))&&(w=getNodeScroll(u)),g){let c=getBoundingClientRect(u,!0,v,u);_.x=c.x+u.clientLeft,_.y=c.y+u.clientTop}else b&&(_.x=getWindowScrollBarX(b))}let k=x.left+w.scrollLeft-_.x,E=x.top+w.scrollTop-_.y;return{x:k,y:E,width:x.width,height:x.height}}function getTrueOffsetParent(c,u){return isHTMLElement(c)&&"fixed"!==floating_ui_utils_dom_getComputedStyle(c).position?u?u(c):c.offsetParent:null}function getOffsetParent(c,u){let f=getWindow(c);if(!isHTMLElement(c)||isTopLayer(c))return f;let g=getTrueOffsetParent(c,u);for(;g&&isTableElement(g)&&"static"===floating_ui_utils_dom_getComputedStyle(g).position;)g=getTrueOffsetParent(g,u);return g&&("html"===getNodeName(g)||"body"===getNodeName(g)&&"static"===floating_ui_utils_dom_getComputedStyle(g).position&&!isContainingBlock(g))?f:g||getContainingBlock(c)||f}let getElementRects=async function(c){let u=this.getOffsetParent||getOffsetParent,f=this.getDimensions;return{reference:getRectRelativeToOffsetParent(c.reference,await u(c.floating),c.strategy),floating:{x:0,y:0,...await f(c.floating)}}};function isRTL(c){return"rtl"===floating_ui_utils_dom_getComputedStyle(c).direction}let n6={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement:getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement:isElement,isRTL};function observeMove(c,u){let f,g=null,b=getDocumentElement(c);function cleanup(){var c;clearTimeout(f),null==(c=g)||c.disconnect(),g=null}function refresh(v,x){void 0===v&&(v=!1),void 0===x&&(x=1),cleanup();let{left:w,top:_,width:k,height:E}=c.getBoundingClientRect();if(v||u(),!k||!E)return;let T=n2(_),$=n2(b.clientWidth-(w+k)),I=n2(b.clientHeight-(_+E)),M=n2(w),j={rootMargin:-T+"px "+-$+"px "+-I+"px "+-M+"px",threshold:n0(0,nQ(1,x))||1},D=!0;function handleObserve(c){let u=c[0].intersectionRatio;if(u!==x){if(!D)return refresh();u?refresh(!1,u):f=setTimeout(()=>{refresh(!1,1e-7)},100)}D=!1}try{g=new IntersectionObserver(handleObserve,{...j,root:b.ownerDocument})}catch(c){g=new IntersectionObserver(handleObserve,j)}g.observe(c)}return refresh(!0),cleanup}function autoUpdate(c,u,f,g){let b;void 0===g&&(g={});let{ancestorScroll:v=!0,ancestorResize:x=!0,elementResize:w="function"==typeof ResizeObserver,layoutShift:_="function"==typeof IntersectionObserver,animationFrame:k=!1}=g,E=unwrapElement(c),T=v||x?[...E?getOverflowAncestors(E):[],...getOverflowAncestors(u)]:[];T.forEach(c=>{v&&c.addEventListener("scroll",f,{passive:!0}),x&&c.addEventListener("resize",f)});let $=E&&_?observeMove(E,f):null,I=-1,M=null;w&&(M=new ResizeObserver(c=>{let[g]=c;g&&g.target===E&&M&&(M.unobserve(u),cancelAnimationFrame(I),I=requestAnimationFrame(()=>{var c;null==(c=M)||c.observe(u)})),f()}),E&&!k&&M.observe(E),M.observe(u));let j=k?getBoundingClientRect(c):null;function frameLoop(){let u=getBoundingClientRect(c);j&&(u.x!==j.x||u.y!==j.y||u.width!==j.width||u.height!==j.height)&&f(),j=u,b=requestAnimationFrame(frameLoop)}return k&&frameLoop(),f(),()=>{var c;T.forEach(c=>{v&&c.removeEventListener("scroll",f),x&&c.removeEventListener("resize",f)}),null==$||$(),null==(c=M)||c.disconnect(),M=null,k&&cancelAnimationFrame(b)}}let floating_ui_dom_arrow=c=>({name:"arrow",options:c,async fn(u){let{x:f,y:g,placement:b,rects:v,platform:x,elements:w,middlewareData:_}=u,{element:k,padding:E=0}=evaluate(c,u)||{};if(null==k)return{};let T=getPaddingObject(E),$={x:f,y:g},I=getOppositeAxis(getSideAxis(b)),M=getAxisLength(I),j=await x.getDimensions(k),D="y"===I,L=D?"clientHeight":"clientWidth",F=v.reference[M]+v.reference[I]-$[I]-v.floating[M],B=$[I]-v.reference[I],G=await (null==x.getOffsetParent?void 0:x.getOffsetParent(k)),U=G?G[L]:0;U&&await (null==x.isElement?void 0:x.isElement(G))||(U=w.floating[L]||v.floating[M]);let V=U/2-j[M]/2-1,K=nQ(T[D?"top":"left"],V),Z=nQ(T[D?"bottom":"right"],V),Y=U-j[M]-Z,X=U/2-j[M]/2+(F/2-B/2),J=n0(K,nQ(X,Y)),Q=!_.arrow&&null!=getAlignment(b)&&X!==J&&v.reference[M]/2-(X<K?K:Z)-j[M]/2<0,ee=Q?X<K?X-K:X-Y:0;return{[I]:$[I]+ee,data:{[I]:J,centerOffset:X-J-ee,...Q&&{alignmentOffset:ee}},reset:Q}}}),floating_ui_dom_computePosition=(c,u,f)=>{let g=new Map,b={platform:n6,...f},v={...b.platform,_c:g};return computePosition(c,u,{...b,platform:v})},floating_ui_react_dom_arrow=c=>{function isRef(c){return({}).hasOwnProperty.call(c,"current")}return{name:"arrow",options:c,fn(u){let{element:f,padding:g}="function"==typeof c?c(u):c;return f&&isRef(f)?null!=f.current?floating_ui_dom_arrow({element:f.current,padding:g}).fn(u):{}:f?floating_ui_dom_arrow({element:f,padding:g}).fn(u):{}}}};var n7="undefined"!=typeof document?K.useLayoutEffect:K.useEffect;function deepEqual(c,u){let f,g,b;if(c===u)return!0;if(typeof c!=typeof u)return!1;if("function"==typeof c&&c.toString()===u.toString())return!0;if(c&&u&&"object"==typeof c){if(Array.isArray(c)){if((f=c.length)!==u.length)return!1;for(g=f;0!=g--;)if(!deepEqual(c[g],u[g]))return!1;return!0}if((f=(b=Object.keys(c)).length)!==Object.keys(u).length)return!1;for(g=f;0!=g--;)if(!({}).hasOwnProperty.call(u,b[g]))return!1;for(g=f;0!=g--;){let f=b[g];if(("_owner"!==f||!c.$$typeof)&&!deepEqual(c[f],u[f]))return!1}return!0}return c!=c&&u!=u}function getDPR(c){if("undefined"==typeof window)return 1;let u=c.ownerDocument.defaultView||window;return u.devicePixelRatio||1}function roundByDPR(c,u){let f=getDPR(c);return Math.round(u*f)/f}function useLatestRef(c){let u=K.useRef(c);return n7(()=>{u.current=c}),u}function useFloating(c){void 0===c&&(c={});let{placement:u="bottom",strategy:f="absolute",middleware:g=[],platform:b,elements:{reference:v,floating:x}={},transform:w=!0,whileElementsMounted:_,open:k}=c,[E,T]=K.useState({x:0,y:0,strategy:f,placement:u,middlewareData:{},isPositioned:!1}),[$,I]=K.useState(g);deepEqual($,g)||I(g);let[M,j]=K.useState(null),[D,L]=K.useState(null),F=K.useCallback(c=>{c!==V.current&&(V.current=c,j(c))},[]),B=K.useCallback(c=>{c!==Z.current&&(Z.current=c,L(c))},[]),G=v||M,U=x||D,V=K.useRef(null),Z=K.useRef(null),Y=K.useRef(E),X=null!=_,J=useLatestRef(_),ee=useLatestRef(b),et=K.useCallback(()=>{if(!V.current||!Z.current)return;let c={placement:u,strategy:f,middleware:$};ee.current&&(c.platform=ee.current),floating_ui_dom_computePosition(V.current,Z.current,c).then(c=>{let u={...c,isPositioned:!0};en.current&&!deepEqual(Y.current,u)&&(Y.current=u,Q.flushSync(()=>{T(u)}))})},[$,u,f,ee]);n7(()=>{!1===k&&Y.current.isPositioned&&(Y.current.isPositioned=!1,T(c=>({...c,isPositioned:!1})))},[k]);let en=K.useRef(!1);n7(()=>(en.current=!0,()=>{en.current=!1}),[]),n7(()=>{if(G&&(V.current=G),U&&(Z.current=U),G&&U){if(J.current)return J.current(G,U,et);et()}},[G,U,et,J,X]);let er=K.useMemo(()=>({reference:V,floating:Z,setReference:F,setFloating:B}),[F,B]),ei=K.useMemo(()=>({reference:G,floating:U}),[G,U]),eo=K.useMemo(()=>{let c={position:f,left:0,top:0};if(!ei.floating)return c;let u=roundByDPR(ei.floating,E.x),g=roundByDPR(ei.floating,E.y);return w?{...c,transform:"translate("+u+"px, "+g+"px)",...getDPR(ei.floating)>=1.5&&{willChange:"transform"}}:{position:f,left:u,top:g}},[f,w,ei.floating,E.x,E.y]);return K.useMemo(()=>({...E,update:et,refs:er,elements:ei,floatingStyles:eo}),[E,et,er,ei,eo])}let n9=(0,K.forwardRef)((c,u)=>{let{children:f,width:g=10,height:b=5,...v}=c;return(0,K.createElement)(en.svg,_extends({},v,{ref:u,width:g,height:b,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),c.asChild?f:(0,K.createElement)("polygon",{points:"0,0 30,0 15,10"}))});function $db6c3485150b8e66$export$1ab7ae714698c4b8(c){let[u,f]=(0,K.useState)(void 0);return Y(()=>{if(c){f({width:c.offsetWidth,height:c.offsetHeight});let u=new ResizeObserver(u=>{let g,b;if(!Array.isArray(u)||!u.length)return;let v=u[0];if("borderBoxSize"in v){let c=v.borderBoxSize,u=Array.isArray(c)?c[0]:c;g=u.inlineSize,b=u.blockSize}else g=c.offsetWidth,b=c.offsetHeight;f({width:g,height:b})});return u.observe(c,{box:"border-box"}),()=>u.unobserve(c)}f(void 0)},[c]),u}let re="Popper",[rt,rn]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(re),[rr,ri]=rt(re),ro=(0,K.forwardRef)((c,u)=>{let{__scopePopper:f,virtualRef:g,...b}=c,v=ri("PopperAnchor",f),x=(0,K.useRef)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,x);return(0,K.useEffect)(()=>{v.onAnchorChange((null==g?void 0:g.current)||x.current)}),g?null:(0,K.createElement)(en.div,_extends({},b,{ref:w}))}),ra="PopperContent",[rs,rl]=rt(ra),rc=(0,K.forwardRef)((c,u)=>{var f,g,b,v,x,w,_,k,E,T,$,I,M,j;let{__scopePopper:D,side:L="bottom",sideOffset:F=0,align:B="center",alignOffset:G=0,arrowPadding:U=0,avoidCollisions:V=!0,collisionBoundary:Z=[],collisionPadding:X=0,sticky:J="partial",hideWhenDetached:Q=!1,updatePositionStrategy:ee="optimized",onPlaced:et,...er}=c,ei=ri(ra,D),[eo,ea]=(0,K.useState)(null),es=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>ea(c)),[el,ec]=(0,K.useState)(null),eu=$db6c3485150b8e66$export$1ab7ae714698c4b8(el),ed=null!==(f=null==eu?void 0:eu.width)&&void 0!==f?f:0,eh=null!==(g=null==eu?void 0:eu.height)&&void 0!==g?g:0,ep="number"==typeof X?X:{top:0,right:0,bottom:0,left:0,...X},ef=Array.isArray(Z)?Z:[Z],eg=ef.length>0,em={padding:ep,boundary:ef.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:eg},{refs:ey,floatingStyles:eb,placement:ev,isPositioned:eS,middlewareData:ex}=useFloating({strategy:"fixed",placement:L+("center"!==B?"-"+B:""),whileElementsMounted:(...c)=>{let u=autoUpdate(...c,{animationFrame:"always"===ee});return u},elements:{reference:ei.anchor},middleware:[{name:"offset",options:E={mainAxis:F+eh,alignmentAxis:G},async fn(c){var u,f;let{x:g,y:b,placement:v,middlewareData:x}=c,w=await convertValueToCoords(c,E);return v===(null==(u=x.offset)?void 0:u.placement)&&null!=(f=x.arrow)&&f.alignmentOffset?{}:{x:g+w.x,y:b+w.y,data:{...w,placement:v}}}},V&&{name:"shift",options:$={mainAxis:!0,crossAxis:!1,limiter:"partial"===J?(void 0===T&&(T={}),{options:T,fn(c){let{x:u,y:f,placement:g,rects:b,middlewareData:v}=c,{offset:x=0,mainAxis:w=!0,crossAxis:_=!0}=evaluate(T,c),k={x:u,y:f},E=getSideAxis(g),$=getOppositeAxis(E),I=k[$],M=k[E],j=evaluate(x,c),D="number"==typeof j?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(w){let c="y"===$?"height":"width",u=b.reference[$]-b.floating[c]+D.mainAxis,f=b.reference[$]+b.reference[c]-D.mainAxis;I<u?I=u:I>f&&(I=f)}if(_){var L,F;let c="y"===$?"width":"height",u=["top","left"].includes(getSide(g)),f=b.reference[E]-b.floating[c]+(u&&(null==(L=v.offset)?void 0:L[E])||0)+(u?0:D.crossAxis),x=b.reference[E]+b.reference[c]+(u?0:(null==(F=v.offset)?void 0:F[E])||0)-(u?D.crossAxis:0);M<f?M=f:M>x&&(M=x)}return{[$]:I,[E]:M}}}):void 0,...em},async fn(c){let{x:u,y:f,placement:g}=c,{mainAxis:b=!0,crossAxis:v=!1,limiter:x={fn:c=>{let{x:u,y:f}=c;return{x:u,y:f}}},...w}=evaluate($,c),_={x:u,y:f},k=await detectOverflow(c,w),E=getSideAxis(getSide(g)),T=getOppositeAxis(E),I=_[T],M=_[E];if(b){let c=I+k["y"===T?"top":"left"],u=I-k["y"===T?"bottom":"right"];I=n0(c,nQ(I,u))}if(v){let c="y"===E?"top":"left",u="y"===E?"bottom":"right",f=M+k[c],g=M-k[u];M=n0(f,nQ(M,g))}let j=x.fn({...c,[T]:I,[E]:M});return{...j,data:{x:j.x-u,y:j.y-f}}}},V&&{name:"flip",options:I={...em},async fn(c){var u,f,g,b,v;let{placement:x,middlewareData:w,rects:_,initialPlacement:k,platform:E,elements:T}=c,{mainAxis:$=!0,crossAxis:M=!0,fallbackPlacements:j,fallbackStrategy:D="bestFit",fallbackAxisSideDirection:L="none",flipAlignment:F=!0,...B}=evaluate(I,c);if(null!=(u=w.arrow)&&u.alignmentOffset)return{};let G=getSide(x),U=getSide(k)===k,V=await (null==E.isRTL?void 0:E.isRTL(T.floating)),K=j||(U||!F?[getOppositePlacement(k)]:getExpandedPlacements(k));j||"none"===L||K.push(...getOppositeAxisPlacements(k,F,L,V));let Z=[k,...K],Y=await detectOverflow(c,B),X=[],J=(null==(f=w.flip)?void 0:f.overflows)||[];if($&&X.push(Y[G]),M){let c=getAlignmentSides(x,_,V);X.push(Y[c[0]],Y[c[1]])}if(J=[...J,{placement:x,overflows:X}],!X.every(c=>c<=0)){let c=((null==(g=w.flip)?void 0:g.index)||0)+1,u=Z[c];if(u)return{data:{index:c,overflows:J},reset:{placement:u}};let f=null==(b=J.filter(c=>c.overflows[0]<=0).sort((c,u)=>c.overflows[1]-u.overflows[1])[0])?void 0:b.placement;if(!f)switch(D){case"bestFit":{let c=null==(v=J.map(c=>[c.placement,c.overflows.filter(c=>c>0).reduce((c,u)=>c+u,0)]).sort((c,u)=>c[1]-u[1])[0])?void 0:v[0];c&&(f=c);break}case"initialPlacement":f=k}if(x!==f)return{reset:{placement:f}}}return{}}},{name:"size",options:M={...em,apply:({elements:c,rects:u,availableWidth:f,availableHeight:g})=>{let{width:b,height:v}=u.reference,x=c.floating.style;x.setProperty("--radix-popper-available-width",`${f}px`),x.setProperty("--radix-popper-available-height",`${g}px`),x.setProperty("--radix-popper-anchor-width",`${b}px`),x.setProperty("--radix-popper-anchor-height",`${v}px`)}},async fn(c){let u,f;let{placement:g,rects:b,platform:v,elements:x}=c,{apply:w=()=>{},..._}=evaluate(M,c),k=await detectOverflow(c,_),E=getSide(g),T=getAlignment(g),$="y"===getSideAxis(g),{width:I,height:j}=b.floating;"top"===E||"bottom"===E?(u=E,f=T===(await (null==v.isRTL?void 0:v.isRTL(x.floating))?"start":"end")?"left":"right"):(f=E,u="end"===T?"top":"bottom");let D=j-k[u],L=I-k[f],F=!c.middlewareData.shift,B=D,G=L;if($){let c=I-k.left-k.right;G=T||F?nQ(L,c):c}else{let c=j-k.top-k.bottom;B=T||F?nQ(D,c):c}if(F&&!T){let c=n0(k.left,0),u=n0(k.right,0),f=n0(k.top,0),g=n0(k.bottom,0);$?G=I-2*(0!==c||0!==u?c+u:n0(k.left,k.right)):B=j-2*(0!==f||0!==g?f+g:n0(k.top,k.bottom))}await w({...c,availableWidth:G,availableHeight:B});let U=await v.getDimensions(x.floating);return I!==U.width||j!==U.height?{reset:{rects:!0}}:{}}},el&&floating_ui_react_dom_arrow({element:el,padding:U}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:ed,arrowHeight:eh}),Q&&{name:"hide",options:j={strategy:"referenceHidden",...em},async fn(c){let{rects:u}=c,{strategy:f="referenceHidden",...g}=evaluate(j,c);switch(f){case"referenceHidden":{let f=await detectOverflow(c,{...g,elementContext:"reference"}),b=getSideOffsets(f,u.reference);return{data:{referenceHiddenOffsets:b,referenceHidden:isAnySideFullyClipped(b)}}}case"escaped":{let f=await detectOverflow(c,{...g,altBoundary:!0}),b=getSideOffsets(f,u.floating);return{data:{escapedOffsets:b,escaped:isAnySideFullyClipped(b)}}}default:return{}}}}]}),[ew,e_]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(ev),ek=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(et);Y(()=>{eS&&(null==ek||ek())},[eS,ek]);let eC=null===(b=ex.arrow)||void 0===b?void 0:b.x,eE=null===(v=ex.arrow)||void 0===v?void 0:v.y,eP=(null===(x=ex.arrow)||void 0===x?void 0:x.centerOffset)!==0,[eT,e$]=(0,K.useState)();return Y(()=>{eo&&e$(window.getComputedStyle(eo).zIndex)},[eo]),(0,K.createElement)("div",{ref:ey.setFloating,"data-radix-popper-content-wrapper":"",style:{...eb,transform:eS?eb.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:eT,"--radix-popper-transform-origin":[null===(w=ex.transformOrigin)||void 0===w?void 0:w.x,null===(_=ex.transformOrigin)||void 0===_?void 0:_.y].join(" ")},dir:c.dir},(0,K.createElement)(rs,{scope:D,placedSide:ew,onArrowChange:ec,arrowX:eC,arrowY:eE,shouldHideArrow:eP},(0,K.createElement)(en.div,_extends({"data-side":ew,"data-align":e_},er,{ref:es,style:{...er.style,animation:eS?void 0:"none",opacity:null!==(k=ex.hide)&&void 0!==k&&k.referenceHidden?0:void 0}}))))}),ru={top:"bottom",right:"left",bottom:"top",left:"right"},rd=(0,K.forwardRef)(function(c,u){let{__scopePopper:f,...g}=c,b=rl("PopperArrow",f),v=ru[b.placedSide];return(0,K.createElement)("span",{ref:b.onArrowChange,style:{position:"absolute",left:b.arrowX,top:b.arrowY,[v]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[b.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[b.placedSide],visibility:b.shouldHideArrow?"hidden":void 0}},(0,K.createElement)(n9,_extends({},g,{ref:u,style:{...g.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isNotNull(c){return null!==c}let $cf1ac5d9fe0e8206$var$transformOrigin=c=>({name:"transformOrigin",options:c,fn(u){var f,g,b,v,x;let{placement:w,rects:_,middlewareData:k}=u,E=(null===(f=k.arrow)||void 0===f?void 0:f.centerOffset)!==0,T=E?0:c.arrowWidth,$=E?0:c.arrowHeight,[I,M]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(w),j={start:"0%",center:"50%",end:"100%"}[M],D=(null!==(g=null===(b=k.arrow)||void 0===b?void 0:b.x)&&void 0!==g?g:0)+T/2,L=(null!==(v=null===(x=k.arrow)||void 0===x?void 0:x.y)&&void 0!==v?v:0)+$/2,F="",B="";return"bottom"===I?(F=E?j:`${D}px`,B=`${-$}px`):"top"===I?(F=E?j:`${D}px`,B=`${_.floating.height+$}px`):"right"===I?(F=`${-$}px`,B=E?j:`${L}px`):"left"===I&&(F=`${_.floating.width+$}px`,B=E?j:`${L}px`),{data:{x:F,y:B}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(c){let[u,f="center"]=c.split("-");return[u,f]}let $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=c=>{let{__scopePopper:u,children:f}=c,[g,b]=(0,K.useState)(null);return(0,K.createElement)(rr,{scope:u,anchor:g,onAnchorChange:b},f)},rh="rovingFocusGroup.onEntryFocus",rp={bubbles:!1,cancelable:!0},rf="RovingFocusGroup",[rg,rm,ry]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(rf),[rb,rv]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(rf,[ry]),[rS,rx]=rb(rf),rw=(0,K.forwardRef)((c,u)=>(0,K.createElement)(rg.Provider,{scope:c.__scopeRovingFocusGroup},(0,K.createElement)(rg.Slot,{scope:c.__scopeRovingFocusGroup},(0,K.createElement)(r_,_extends({},c,{ref:u}))))),r_=(0,K.forwardRef)((c,u)=>{let{__scopeRovingFocusGroup:f,orientation:g,loop:b=!1,dir:v,currentTabStopId:x,defaultCurrentTabStopId:w,onCurrentTabStopIdChange:_,onEntryFocus:k,...E}=c,T=(0,K.useRef)(null),$=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,T),I=$f631663db3294ace$export$b39126d51d94e6f3(v),[M=null,j]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:x,defaultProp:w,onChange:_}),[D,L]=(0,K.useState)(!1),F=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(k),B=rm(f),G=(0,K.useRef)(!1),[U,V]=(0,K.useState)(0);return(0,K.useEffect)(()=>{let c=T.current;if(c)return c.addEventListener(rh,F),()=>c.removeEventListener(rh,F)},[F]),(0,K.createElement)(rS,{scope:f,orientation:g,dir:I,loop:b,currentTabStopId:M,onItemFocus:(0,K.useCallback)(c=>j(c),[j]),onItemShiftTab:(0,K.useCallback)(()=>L(!0),[]),onFocusableItemAdd:(0,K.useCallback)(()=>V(c=>c+1),[]),onFocusableItemRemove:(0,K.useCallback)(()=>V(c=>c-1),[])},(0,K.createElement)(en.div,_extends({tabIndex:D||0===U?-1:0,"data-orientation":g},E,{ref:$,style:{outline:"none",...c.style},onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onMouseDown,()=>{G.current=!0}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocus,c=>{let u=!G.current;if(c.target===c.currentTarget&&u&&!D){let u=new CustomEvent(rh,rp);if(c.currentTarget.dispatchEvent(u),!u.defaultPrevented){let c=B().filter(c=>c.focusable),u=c.find(c=>c.active),f=c.find(c=>c.id===M),g=[u,f,...c].filter(Boolean),b=g.map(c=>c.ref.current);$d7bdfb9eb0fdf311$var$focusFirst(b)}}G.current=!1}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onBlur,()=>L(!1))})))}),rk=(0,K.forwardRef)((c,u)=>{let{__scopeRovingFocusGroup:f,focusable:g=!0,active:b=!1,tabStopId:v,...x}=c,w=$1746a345f3d73bb7$export$f680877a34711e37(),_=v||w,k=rx("RovingFocusGroupItem",f),E=k.currentTabStopId===_,T=rm(f),{onFocusableItemAdd:$,onFocusableItemRemove:I}=k;return(0,K.useEffect)(()=>{if(g)return $(),()=>I()},[g,$,I]),(0,K.createElement)(rg.ItemSlot,{scope:f,id:_,focusable:g,active:b},(0,K.createElement)(en.span,_extends({tabIndex:E?0:-1,"data-orientation":k.orientation},x,{ref:u,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onMouseDown,c=>{g?k.onItemFocus(_):c.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocus,()=>k.onItemFocus(_)),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{if("Tab"===c.key&&c.shiftKey){k.onItemShiftTab();return}if(c.target!==c.currentTarget)return;let u=$d7bdfb9eb0fdf311$var$getFocusIntent(c,k.orientation,k.dir);if(void 0!==u){c.preventDefault();let f=T().filter(c=>c.focusable),g=f.map(c=>c.ref.current);if("last"===u)g.reverse();else if("prev"===u||"next"===u){"prev"===u&&g.reverse();let f=g.indexOf(c.currentTarget);g=k.loop?$d7bdfb9eb0fdf311$var$wrapArray(g,f+1):g.slice(f+1)}setTimeout(()=>$d7bdfb9eb0fdf311$var$focusFirst(g))}})})))}),rC={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $d7bdfb9eb0fdf311$var$getDirectionAwareKey(c,u){return"rtl"!==u?c:"ArrowLeft"===c?"ArrowRight":"ArrowRight"===c?"ArrowLeft":c}function $d7bdfb9eb0fdf311$var$getFocusIntent(c,u,f){let g=$d7bdfb9eb0fdf311$var$getDirectionAwareKey(c.key,f);if(!("vertical"===u&&["ArrowLeft","ArrowRight"].includes(g))&&!("horizontal"===u&&["ArrowUp","ArrowDown"].includes(g)))return rC[g]}function $d7bdfb9eb0fdf311$var$focusFirst(c){let u=document.activeElement;for(let f of c)if(f===u||(f.focus(),document.activeElement!==u))return}function $d7bdfb9eb0fdf311$var$wrapArray(c,u){return c.map((f,g)=>c[(u+g)%c.length])}let rE=["Enter"," "],rP=["ArrowUp","PageDown","End"],rT=["ArrowDown","PageUp","Home",...rP],r$={ltr:[...rE,"ArrowRight"],rtl:[...rE,"ArrowLeft"]},rI={ltr:["ArrowLeft"],rtl:["ArrowRight"]},rA="Menu",[rM,rj,rO]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(rA),[rR,rD]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(rA,[rO,rn,rv]),rL=rn(),rN=rv(),[rF,rB]=rR(rA),[rz,rG]=rR(rA),rU=(0,K.forwardRef)((c,u)=>{let{__scopeMenu:f,...g}=c,b=rL(f);return(0,K.createElement)(ro,_extends({},b,g,{ref:u}))}),rH="MenuPortal",[rV,rW]=rR(rH,{forceMount:void 0}),rK="MenuContent",[rZ,rY]=rR(rK),rq=(0,K.forwardRef)((c,u)=>{let f=rW(rK,c.__scopeMenu),{forceMount:g=f.forceMount,...b}=c,v=rB(rK,c.__scopeMenu),x=rG(rK,c.__scopeMenu);return(0,K.createElement)(rM.Provider,{scope:c.__scopeMenu},(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||v.open},(0,K.createElement)(rM.Slot,{scope:c.__scopeMenu},x.modal?(0,K.createElement)(rX,_extends({},b,{ref:u})):(0,K.createElement)(rJ,_extends({},b,{ref:u})))))}),rX=(0,K.forwardRef)((c,u)=>{let f=rB(rK,c.__scopeMenu),g=(0,K.useRef)(null),b=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,g);return(0,K.useEffect)(()=>{let c=g.current;if(c)return hideOthers(c)},[]),(0,K.createElement)(rQ,_extends({},c,{ref:b,trapFocus:f.open,disableOutsidePointerEvents:f.open,disableOutsideScroll:!0,onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>f.onOpenChange(!1)}))}),rJ=(0,K.forwardRef)((c,u)=>{let f=rB(rK,c.__scopeMenu);return(0,K.createElement)(rQ,_extends({},c,{ref:u,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>f.onOpenChange(!1)}))}),rQ=(0,K.forwardRef)((c,u)=>{let{__scopeMenu:f,loop:g=!1,trapFocus:b,onOpenAutoFocus:v,onCloseAutoFocus:x,disableOutsidePointerEvents:w,onEntryFocus:_,onEscapeKeyDown:k,onPointerDownOutside:E,onFocusOutside:T,onInteractOutside:$,onDismiss:I,disableOutsideScroll:M,...j}=c,D=rB(rK,f),L=rG(rK,f),F=rL(f),B=rN(f),G=rj(f),[U,V]=(0,K.useState)(null),Z=(0,K.useRef)(null),Y=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,Z,D.onContentChange),X=(0,K.useRef)(0),J=(0,K.useRef)(""),Q=(0,K.useRef)(0),et=(0,K.useRef)(null),en=(0,K.useRef)("right"),er=(0,K.useRef)(0),ei=M?e$:K.Fragment,ea=M?{as:ee,allowPinchZoom:!0}:void 0,handleTypeaheadSearch=c=>{var u,f;let g=J.current+c,b=G().filter(c=>!c.disabled),v=document.activeElement,x=null===(u=b.find(c=>c.ref.current===v))||void 0===u?void 0:u.textValue,w=b.map(c=>c.textValue),_=$6cc32821e9371a1c$var$getNextMatch(w,g,x),k=null===(f=b.find(c=>c.textValue===_))||void 0===f?void 0:f.ref.current;!function updateSearch(c){J.current=c,window.clearTimeout(X.current),""!==c&&(X.current=window.setTimeout(()=>updateSearch(""),1e3))}(g),k&&setTimeout(()=>k.focus())};(0,K.useEffect)(()=>()=>window.clearTimeout(X.current),[]),$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c();let es=(0,K.useCallback)(c=>{var u,f;let g=en.current===(null===(u=et.current)||void 0===u?void 0:u.side);return g&&$6cc32821e9371a1c$var$isPointerInGraceArea(c,null===(f=et.current)||void 0===f?void 0:f.area)},[]);return(0,K.createElement)(rZ,{scope:f,searchRef:J,onItemEnter:(0,K.useCallback)(c=>{es(c)&&c.preventDefault()},[es]),onItemLeave:(0,K.useCallback)(c=>{var u;es(c)||(null===(u=Z.current)||void 0===u||u.focus(),V(null))},[es]),onTriggerLeave:(0,K.useCallback)(c=>{es(c)&&c.preventDefault()},[es]),pointerGraceTimerRef:Q,onPointerGraceIntentChange:(0,K.useCallback)(c=>{et.current=c},[])},(0,K.createElement)(ei,ea,(0,K.createElement)(eu,{asChild:!0,trapped:b,onMountAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(v,c=>{var u;c.preventDefault(),null===(u=Z.current)||void 0===u||u.focus()}),onUnmountAutoFocus:x},(0,K.createElement)(eo,{asChild:!0,disableOutsidePointerEvents:w,onEscapeKeyDown:k,onPointerDownOutside:E,onFocusOutside:T,onInteractOutside:$,onDismiss:I},(0,K.createElement)(rw,_extends({asChild:!0},B,{dir:L.dir,orientation:"vertical",loop:g,currentTabStopId:U,onCurrentTabStopIdChange:V,onEntryFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_,c=>{L.isUsingKeyboardRef.current||c.preventDefault()})}),(0,K.createElement)(rc,_extends({role:"menu","aria-orientation":"vertical","data-state":$6cc32821e9371a1c$var$getOpenState(D.open),"data-radix-menu-content":"",dir:L.dir},F,j,{ref:Y,style:{outline:"none",...j.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(j.onKeyDown,c=>{let u=c.target,f=u.closest("[data-radix-menu-content]")===c.currentTarget,g=c.ctrlKey||c.altKey||c.metaKey,b=1===c.key.length;f&&("Tab"===c.key&&c.preventDefault(),!g&&b&&handleTypeaheadSearch(c.key));let v=Z.current;if(c.target!==v||!rT.includes(c.key))return;c.preventDefault();let x=G().filter(c=>!c.disabled),w=x.map(c=>c.ref.current);rP.includes(c.key)&&w.reverse(),$6cc32821e9371a1c$var$focusFirst(w)}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onBlur,c=>{c.currentTarget.contains(c.target)||(window.clearTimeout(X.current),J.current="")}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,$6cc32821e9371a1c$var$whenMouse(c=>{let u=c.target,f=er.current!==c.clientX;if(c.currentTarget.contains(u)&&f){let u=c.clientX>er.current?"right":"left";en.current=u,er.current=c.clientX}}))})))))))}),r0=(0,K.forwardRef)((c,u)=>{let{__scopeMenu:f,...g}=c;return(0,K.createElement)(en.div,_extends({role:"group"},g,{ref:u}))}),r1=((c,u)=>{let{__scopeMenu:f,...g}=c;return(0,K.createElement)(en.div,_extends({},g,{ref:u}))},"MenuItem"),r2="menu.itemSelect",r5=(0,K.forwardRef)((c,u)=>{let{disabled:f=!1,onSelect:g,...b}=c,v=(0,K.useRef)(null),x=rG(r1,c.__scopeMenu),w=rY(r1,c.__scopeMenu),_=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,v),k=(0,K.useRef)(!1);return(0,K.createElement)(r3,_extends({},b,{ref:_,disabled:f,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onClick,()=>{let c=v.current;if(!f&&c){let u=new CustomEvent(r2,{bubbles:!0,cancelable:!0});c.addEventListener(r2,c=>null==g?void 0:g(c),{once:!0}),$8927f6f2acc4f386$export$6d1a0317bde7de7f(c,u),u.defaultPrevented?k.current=!1:x.onClose()}}),onPointerDown:u=>{var f;null===(f=c.onPointerDown)||void 0===f||f.call(c,u),k.current=!0},onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerUp,c=>{var u;k.current||null===(u=c.currentTarget)||void 0===u||u.click()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{let u=""!==w.searchRef.current;!f&&(!u||" "!==c.key)&&rE.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})}))}),r3=(0,K.forwardRef)((c,u)=>{let{__scopeMenu:f,disabled:g=!1,textValue:b,...v}=c,x=rY(r1,f),w=rN(f),_=(0,K.useRef)(null),k=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,_),[E,T]=(0,K.useState)(!1),[$,I]=(0,K.useState)("");return(0,K.useEffect)(()=>{let c=_.current;if(c){var u;I((null!==(u=c.textContent)&&void 0!==u?u:"").trim())}},[v.children]),(0,K.createElement)(rM.ItemSlot,{scope:f,disabled:g,textValue:null!=b?b:$},(0,K.createElement)(rk,_extends({asChild:!0},w,{focusable:!g}),(0,K.createElement)(en.div,_extends({role:"menuitem","data-highlighted":E?"":void 0,"aria-disabled":g||void 0,"data-disabled":g?"":void 0},v,{ref:k,onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,$6cc32821e9371a1c$var$whenMouse(c=>{if(g)x.onItemLeave(c);else if(x.onItemEnter(c),!c.defaultPrevented){let u=c.currentTarget;u.focus()}})),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerLeave,$6cc32821e9371a1c$var$whenMouse(c=>x.onItemLeave(c))),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocus,()=>T(!0)),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onBlur,()=>T(!1))}))))}),r8=(0,K.forwardRef)((c,u)=>{let{checked:f=!1,onCheckedChange:g,...b}=c;return(0,K.createElement)(r9,{scope:c.__scopeMenu,checked:f},(0,K.createElement)(r5,_extends({role:"menuitemcheckbox","aria-checked":$6cc32821e9371a1c$var$isIndeterminate(f)?"mixed":f},b,{ref:u,"data-state":$6cc32821e9371a1c$var$getCheckedState(f),onSelect:$e42e1063c40fb3ef$export$b9ecd428b558ff10(b.onSelect,()=>null==g?void 0:g(!!$6cc32821e9371a1c$var$isIndeterminate(f)||!f),{checkForDefaultPrevented:!1})})))}),[r4,r6]=rR("MenuRadioGroup",{value:void 0,onValueChange:()=>{}}),r7=((c,u)=>{let{value:f,onValueChange:g,...b}=c,v=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g);return(0,K.createElement)(r4,{scope:c.__scopeMenu,value:f,onValueChange:v},(0,K.createElement)(r0,_extends({},b,{ref:u})))},"MenuItemIndicator"),[r9,ie]=rR(r7,{checked:!1}),it=(0,K.forwardRef)((c,u)=>{let{__scopeMenu:f,forceMount:g,...b}=c,v=ie(r7,f);return(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||$6cc32821e9371a1c$var$isIndeterminate(v.checked)||!0===v.checked},(0,K.createElement)(en.span,_extends({},b,{ref:u,"data-state":$6cc32821e9371a1c$var$getCheckedState(v.checked)})))}),ir=((c,u)=>{let{__scopeMenu:f,...g}=c;return(0,K.createElement)(en.div,_extends({role:"separator","aria-orientation":"horizontal"},g,{ref:u}))},"MenuSub"),[ii,io]=rR(ir),ia="MenuSubTrigger",is=(0,K.forwardRef)((c,u)=>{let f=rB(ia,c.__scopeMenu),g=rG(ia,c.__scopeMenu),b=io(ia,c.__scopeMenu),v=rY(ia,c.__scopeMenu),x=(0,K.useRef)(null),{pointerGraceTimerRef:w,onPointerGraceIntentChange:_}=v,k={__scopeMenu:c.__scopeMenu},E=(0,K.useCallback)(()=>{x.current&&window.clearTimeout(x.current),x.current=null},[]);return(0,K.useEffect)(()=>E,[E]),(0,K.useEffect)(()=>{let c=w.current;return()=>{window.clearTimeout(c),_(null)}},[w,_]),(0,K.createElement)(rU,_extends({asChild:!0},k),(0,K.createElement)(r3,_extends({id:b.triggerId,"aria-haspopup":"menu","aria-expanded":f.open,"aria-controls":b.contentId,"data-state":$6cc32821e9371a1c$var$getOpenState(f.open)},c,{ref:$6ed0406888f73fc4$export$43e446d32b3d21af(u,b.onTriggerChange),onClick:u=>{var g;null===(g=c.onClick)||void 0===g||g.call(c,u),c.disabled||u.defaultPrevented||(u.currentTarget.focus(),f.open||f.onOpenChange(!0))},onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,$6cc32821e9371a1c$var$whenMouse(u=>{v.onItemEnter(u),u.defaultPrevented||c.disabled||f.open||x.current||(v.onPointerGraceIntentChange(null),x.current=window.setTimeout(()=>{f.onOpenChange(!0),E()},100))})),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerLeave,$6cc32821e9371a1c$var$whenMouse(c=>{var u,g;E();let b=null===(u=f.content)||void 0===u?void 0:u.getBoundingClientRect();if(b){let u=null===(g=f.content)||void 0===g?void 0:g.dataset.side,x="right"===u,_=b[x?"left":"right"],k=b[x?"right":"left"];v.onPointerGraceIntentChange({area:[{x:c.clientX+(x?-5:5),y:c.clientY},{x:_,y:b.top},{x:k,y:b.top},{x:k,y:b.bottom},{x:_,y:b.bottom}],side:u}),window.clearTimeout(w.current),w.current=window.setTimeout(()=>v.onPointerGraceIntentChange(null),300)}else{if(v.onTriggerLeave(c),c.defaultPrevented)return;v.onPointerGraceIntentChange(null)}})),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,u=>{let b=""!==v.searchRef.current;if(!c.disabled&&(!b||" "!==u.key)&&r$[g.dir].includes(u.key)){var x;f.onOpenChange(!0),null===(x=f.content)||void 0===x||x.focus(),u.preventDefault()}})})))}),il=(0,K.forwardRef)((c,u)=>{let f=rW(rK,c.__scopeMenu),{forceMount:g=f.forceMount,...b}=c,v=rB(rK,c.__scopeMenu),x=rG(rK,c.__scopeMenu),w=io("MenuSubContent",c.__scopeMenu),_=(0,K.useRef)(null),k=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,_);return(0,K.createElement)(rM.Provider,{scope:c.__scopeMenu},(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||v.open},(0,K.createElement)(rM.Slot,{scope:c.__scopeMenu},(0,K.createElement)(rQ,_extends({id:w.contentId,"aria-labelledby":w.triggerId},b,{ref:k,align:"start",side:"rtl"===x.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:c=>{var u;x.isUsingKeyboardRef.current&&(null===(u=_.current)||void 0===u||u.focus()),c.preventDefault()},onCloseAutoFocus:c=>c.preventDefault(),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusOutside,c=>{c.target!==w.trigger&&v.onOpenChange(!1)}),onEscapeKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onEscapeKeyDown,c=>{x.onClose(),c.preventDefault()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{let u=c.currentTarget.contains(c.target),f=rI[x.dir].includes(c.key);if(u&&f){var g;v.onOpenChange(!1),null===(g=w.trigger)||void 0===g||g.focus(),c.preventDefault()}})})))))});function $6cc32821e9371a1c$var$getOpenState(c){return c?"open":"closed"}function $6cc32821e9371a1c$var$isIndeterminate(c){return"indeterminate"===c}function $6cc32821e9371a1c$var$getCheckedState(c){return $6cc32821e9371a1c$var$isIndeterminate(c)?"indeterminate":c?"checked":"unchecked"}function $6cc32821e9371a1c$var$focusFirst(c){let u=document.activeElement;for(let f of c)if(f===u||(f.focus(),document.activeElement!==u))return}function $6cc32821e9371a1c$var$wrapArray(c,u){return c.map((f,g)=>c[(u+g)%c.length])}function $6cc32821e9371a1c$var$getNextMatch(c,u,f){let g=u.length>1&&Array.from(u).every(c=>c===u[0]),b=g?u[0]:u,v=f?c.indexOf(f):-1,x=$6cc32821e9371a1c$var$wrapArray(c,Math.max(v,0)),w=1===b.length;w&&(x=x.filter(c=>c!==f));let _=x.find(c=>c.toLowerCase().startsWith(b.toLowerCase()));return _!==f?_:void 0}function $6cc32821e9371a1c$var$isPointInPolygon(c,u){let{x:f,y:g}=c,b=!1;for(let c=0,v=u.length-1;c<u.length;v=c++){let x=u[c].x,w=u[c].y,_=u[v].x,k=u[v].y,E=w>g!=k>g&&f<(_-x)*(g-w)/(k-w)+x;E&&(b=!b)}return b}function $6cc32821e9371a1c$var$isPointerInGraceArea(c,u){if(!u)return!1;let f={x:c.clientX,y:c.clientY};return $6cc32821e9371a1c$var$isPointInPolygon(f,u)}function $6cc32821e9371a1c$var$whenMouse(c){return u=>"mouse"===u.pointerType?c(u):void 0}let $6cc32821e9371a1c$export$be92b6f5f03c0fe9=c=>{let{__scopeMenu:u,open:f=!1,children:g,dir:b,onOpenChange:v,modal:x=!0}=c,w=rL(u),[_,k]=(0,K.useState)(null),E=(0,K.useRef)(!1),T=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(v),$=$f631663db3294ace$export$b39126d51d94e6f3(b);return(0,K.useEffect)(()=>{let handleKeyDown=()=>{E.current=!0,document.addEventListener("pointerdown",handlePointer,{capture:!0,once:!0}),document.addEventListener("pointermove",handlePointer,{capture:!0,once:!0})},handlePointer=()=>E.current=!1;return document.addEventListener("keydown",handleKeyDown,{capture:!0}),()=>{document.removeEventListener("keydown",handleKeyDown,{capture:!0}),document.removeEventListener("pointerdown",handlePointer,{capture:!0}),document.removeEventListener("pointermove",handlePointer,{capture:!0})}},[]),(0,K.createElement)($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,w,(0,K.createElement)(rF,{scope:u,open:f,onOpenChange:T,content:_,onContentChange:k},(0,K.createElement)(rz,{scope:u,onClose:(0,K.useCallback)(()=>T(!1),[T]),isUsingKeyboardRef:E,dir:$,modal:x},g)))},$6cc32821e9371a1c$export$602eac185826482c=c=>{let{__scopeMenu:u,forceMount:f,children:g,container:b}=c,v=rB(rH,u);return(0,K.createElement)(rV,{scope:u,forceMount:f},(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:f||v.open},(0,K.createElement)(eh,{asChild:!0,container:b},g)))},$6cc32821e9371a1c$export$d7a01e11500dfb6f=c=>{let{__scopeMenu:u,children:f,open:g=!1,onOpenChange:b}=c,v=rB(ir,u),x=rL(u),[w,_]=(0,K.useState)(null),[k,E]=(0,K.useState)(null),T=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(b);return(0,K.useEffect)(()=>(!1===v.open&&T(!1),()=>T(!1)),[v.open,T]),(0,K.createElement)($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,x,(0,K.createElement)(rF,{scope:u,open:g,onOpenChange:T,content:k,onContentChange:E},(0,K.createElement)(ii,{scope:u,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerId:$1746a345f3d73bb7$export$f680877a34711e37(),trigger:w,onTriggerChange:_},f)))},ic="DropdownMenu",[iu,id]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(ic,[rD]),ih=rD(),[ip,ig]=iu(ic),im=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,disabled:g=!1,...b}=c,v=ig("DropdownMenuTrigger",f),x=ih(f);return(0,K.createElement)(rU,_extends({asChild:!0},x),(0,K.createElement)(en.button,_extends({type:"button",id:v.triggerId,"aria-haspopup":"menu","aria-expanded":v.open,"aria-controls":v.open?v.contentId:void 0,"data-state":v.open?"open":"closed","data-disabled":g?"":void 0,disabled:g},b,{ref:$6ed0406888f73fc4$export$43e446d32b3d21af(u,v.triggerRef),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDown,c=>{g||0!==c.button||!1!==c.ctrlKey||(v.onOpenToggle(),v.open||c.preventDefault())}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{!g&&(["Enter"," "].includes(c.key)&&v.onOpenToggle(),"ArrowDown"===c.key&&v.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})))}),iy=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ig("DropdownMenuContent",f),v=ih(f),x=(0,K.useRef)(!1);return(0,K.createElement)(rq,_extends({id:b.contentId,"aria-labelledby":b.triggerId},v,g,{ref:u,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onCloseAutoFocus,c=>{var u;x.current||null===(u=b.triggerRef.current)||void 0===u||u.focus(),x.current=!1,c.preventDefault()}),onInteractOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onInteractOutside,c=>{let u=c.detail.originalEvent,f=0===u.button&&!0===u.ctrlKey,g=2===u.button||f;(!b.modal||g)&&(x.current=!0)}),style:{...c.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),ib=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(r0,_extends({},b,g,{ref:u}))}),iv=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(r5,_extends({},b,g,{ref:u}))}),iS=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(r8,_extends({},b,g,{ref:u}))}),ix=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(it,_extends({},b,g,{ref:u}))}),iw=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(is,_extends({},b,g,{ref:u}))}),i_=(0,K.forwardRef)((c,u)=>{let{__scopeDropdownMenu:f,...g}=c,b=ih(f);return(0,K.createElement)(il,_extends({},b,g,{ref:u,style:{...c.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),$d08ef79370b62062$export$be92b6f5f03c0fe9=c=>{let{__scopeDropdownMenu:u,children:f,dir:g,open:b,defaultOpen:v,onOpenChange:x,modal:w=!0}=c,_=ih(u),k=(0,K.useRef)(null),[E=!1,T]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:b,defaultProp:v,onChange:x});return(0,K.createElement)(ip,{scope:u,triggerId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:k,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),open:E,onOpenChange:T,onOpenToggle:(0,K.useCallback)(()=>T(c=>!c),[T]),modal:w},(0,K.createElement)($6cc32821e9371a1c$export$be92b6f5f03c0fe9,_extends({},_,{open:E,onOpenChange:T,dir:g,modal:w}),f))},$d08ef79370b62062$export$602eac185826482c=c=>{let{__scopeDropdownMenu:u,...f}=c,g=ih(u);return(0,K.createElement)($6cc32821e9371a1c$export$602eac185826482c,_extends({},g,f))},$d08ef79370b62062$export$d7a01e11500dfb6f=c=>{let{__scopeDropdownMenu:u,children:f,open:g,onOpenChange:b,defaultOpen:v}=c,x=ih(u),[w=!1,_]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:g,defaultProp:v,onChange:b});return(0,K.createElement)($6cc32821e9371a1c$export$d7a01e11500dfb6f,_extends({},x,{open:w,onOpenChange:_}),f)},defaultEventHandler=()=>void 0,ik=K.createContext({});function UiEventsProvider({onEvent:c,children:u}){return(0,V.jsx)(ik.Provider,{value:c??defaultEventHandler,children:u})}function useUiEvents(){let c=K.useContext(ik);return c??defaultEventHandler}function useMenuIsOpen(c,u){let f=(0,tt.j)(),g=(0,K.useRef)(!1),b=useUiEvents(),v=(0,K.useCallback)(b=>{g.current=b,f.batch(()=>{b?(f.complete(),f.addOpenMenu(c)):f.updateInstanceState({openMenus:f.openMenus.filter(u=>!u.startsWith(c))}),u?.(b)})},[f,c,u]);(0,K.useEffect)(()=>(g.current&&(b("open-menu",{source:"unknown",id:c}),f.addOpenMenu(c)),()=>{g.current&&(f.deleteOpenMenu(c),f.openMenus.forEach(u=>{u.startsWith(c)&&(b("close-menu",{source:"unknown",id:c}),f.deleteOpenMenu(u))}),g.current=!1)}),[f,c,b]);let x=(0,e5.Hg)("is menu open",()=>f.openMenus.includes(c),[f,c]);return[x,v]}function Root({id:c,children:u,modal:f=!1}){let[g,b]=useMenuIsOpen(c);return(0,V.jsx)($d08ef79370b62062$export$be92b6f5f03c0fe9,{open:g,dir:"ltr",modal:f,onOpenChange:b,children:u})}function Trigger({children:c,"data-testid":u}){return(0,V.jsx)(im,{dir:"ltr","data-testid":u,asChild:!0,onTouchEnd:c=>preventDefault(c),children:c})}function Content({side:c="bottom",align:u="start",sideOffset:f=8,alignOffset:g=8,children:b}){let v=useContainer();return(0,V.jsx)($d08ef79370b62062$export$602eac185826482c,{dir:"ltr",container:v,children:(0,V.jsx)(iy,{className:"tlui-menu",align:u,sideOffset:f,side:c,alignOffset:g,collisionPadding:4,children:b})})}function Sub({id:c,children:u}){let[f,g]=useMenuIsOpen(c);return(0,V.jsx)($d08ef79370b62062$export$d7a01e11500dfb6f,{open:f,onOpenChange:g,children:u})}function SubTrigger({label:c,"data-testid":u,"data-direction":f}){return(0,V.jsx)(iw,{dir:"ltr","data-direction":f,"data-testid":u,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:c,icon:"chevron-right"})})}function SubContent({alignOffset:c=0,sideOffset:u=5,children:f}){let g=useContainer();return(0,V.jsx)($d08ef79370b62062$export$602eac185826482c,{container:g,dir:"ltr",children:(0,V.jsx)(i_,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:c,sideOffset:u,collisionPadding:4,children:f})})}function Group({children:c,size:u="medium"}){return(0,V.jsx)(ib,{dir:"ltr",className:"tlui-menu__group","data-size":u,children:c})}function Indicator(){return(0,V.jsx)(ix,{dir:"ltr",asChild:!0,children:(0,V.jsx)(nW,{icon:"check"})})}function Item({noClose:c,...u}){return(0,V.jsx)(iv,{dir:"ltr",asChild:!0,onClick:c||void 0!==u.isChecked?preventDefault:void 0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",...u})})}function CheckboxItem({children:c,onSelect:u,...f}){return(0,V.jsxs)(iS,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:c=>{u?.(c),preventDefault(c)},...f,children:[(0,V.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${f.checked?1:.5})`,opacity:f.checked?1:.5},children:(0,V.jsx)(nW,{small:!0,icon:f.checked?"check":"checkbox-empty"})}),c]})}function RadioItem({children:c,onSelect:u,...f}){return(0,V.jsxs)(iS,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:c=>{u?.(c),preventDefault(c)},...f,children:[(0,V.jsx)(ix,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:(0,V.jsx)(nW,{icon:"check"})}),c]})}let TldrawHandles=({children:c})=>{let u=(0,tt.j)(),f=(0,e5.Hg)("shouldDisplayHandles",()=>u.isInAny("select.idle","select.pointing_handle"),[u]);return f?(0,V.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:c}):null},TldrawHoveredShapeIndicator=({shapeId:c})=>{let u=(0,tt.j)(),f=(0,e5.Hg)("show hovered",()=>u.isIn("select.editing_shape")?u.hoveredShapeId!==u.editingShapeId:u.isInAny("select.idle"),[u]);return f?(0,V.jsx)(ta,{className:"tl-user-indicator__hovered",id:c}):null},{PI:iC}=Math,iE=iC+1e-4;function getStrokeOutlinePoints_getStrokeOutlinePoints(c,u={}){let f;let{size:g=16,smoothing:b=.5,start:v={},end:x={},last:w=!1}=u,{cap:_=!0}=v,{cap:k=!0}=x;if(0===c.length||g<=0)return[];let E=c[0],T=c[c.length-1],$=T.runningLength,I=!1===v.taper?0:!0===v.taper?Math.max(g,$):v.taper,M=!1===x.taper?0:!0===x.taper?Math.max(g,$):x.taper,j=Math.pow(g*b,2),D=[],L=[],F=c[0].vector,B=c[0].point,G=B,U=B,V=G,K=!1;for(let u=0;u<c.length;u++){f=c[u];let{point:g,vector:b}=c[u],v=f.vector.dpr(F),x=(u<c.length-1?c[u+1]:c[u]).vector,w=u<c.length-1?x.dpr(f.vector):1,_=v<0&&!K,k=null!==w&&w<.2;if(_||k){if(w>-.62&&$-f.runningLength>f.radius){let c=F.clone().mul(f.radius),u=F.clone().cpr(x);u<0?(U=tl.G.Add(g,c),V=tl.G.Sub(g,c)):(U=tl.G.Sub(g,c),V=tl.G.Add(g,c)),D.push(U),L.push(V)}else{let c=F.clone().mul(f.radius).per(),u=tl.G.Sub(f.input,c);for(let c=1/13,g=0;g<1;g+=c)U=tl.G.RotWith(u,f.input,iE*g),D.push(U),V=tl.G.RotWith(u,f.input,iE+-(iE*g)),L.push(V)}B=U,G=V,k&&(K=!0);continue}if(K=!1,f===E||f===T){let c=tl.G.Per(b).mul(f.radius);D.push(tl.G.Sub(g,c)),L.push(tl.G.Add(g,c));continue}let I=tl.G.Lrp(x,b,w).per().mul(f.radius);U=tl.G.Sub(g,I),(u<=1||tl.G.Dist2(B,U)>j)&&(D.push(U),B=U),V=tl.G.Add(g,I),(u<=1||tl.G.Dist2(G,V)>j)&&(L.push(V),G=V),F=b}let Z=E.point,Y=c.length>1?c[c.length-1].point:tl.G.AddXY(E.point,1,1);if(1===c.length&&(!(I||M)||w)){let c=tl.G.Add(Z,tl.G.Sub(Z,Y).uni().per().mul(-E.radius)),u=[];for(let f=1/13,g=f;g<=1;g+=f)u.push(tl.G.RotWith(c,Z,2*iE*g));return u}let X=[];if(I||M&&1===c.length);else if(_)for(let c=1/8,u=c;u<=1;u+=c){let c=tl.G.RotWith(L[0],Z,iE*u);X.push(c)}else{let c=tl.G.Sub(D[0],L[0]),u=tl.G.Mul(c,.5),f=tl.G.Mul(c,.51);X.push(tl.G.Sub(Z,u),tl.G.Sub(Z,f),tl.G.Add(Z,f),tl.G.Add(Z,u))}let J=[],Q=T.vector.clone().per().neg();if(M||I&&1===c.length)J.push(Y);else if(k){let c=tl.G.Add(Y,tl.G.Mul(Q,T.radius));for(let u=1/29,f=u;f<1;f+=u)J.push(tl.G.RotWith(c,Y,3*iE*f))}else J.push(tl.G.Add(Y,tl.G.Mul(Q,T.radius)),tl.G.Add(Y,tl.G.Mul(Q,.99*T.radius)),tl.G.Sub(Y,tl.G.Mul(Q,.99*T.radius)),tl.G.Sub(Y,tl.G.Mul(Q,T.radius)));return D.concat(J,L.reverse(),X)}function getStrokePoints(c,u={}){let f,g;let{streamline:b=.5,size:v=16,simulatePressure:x=!1}=u;if(0===c.length)return[];let w=.15+(1-b)*.85,_=c.map(tl.G.From),k=0;if(!x){let c=_[0];for(;c&&!(c.z>=.025);)_.shift(),c=_[0]}if(!x){let c=_[_.length-1];for(;c&&!(c.z>=.01);)_.pop(),c=_[_.length-1]}if(0===_.length)return[{point:tl.G.From(c[0]),input:tl.G.From(c[0]),pressure:x?.5:.15,vector:new tl.G(1,1),distance:0,runningLength:0,radius:1}];let E=_[1];for(;E&&!(tl.G.Dist(E,_[0])>v/3);)_[0].z=Math.max(_[0].z,E.z),_.splice(1,1),E=_[1];let T=_.pop();for(E=_[_.length-1];E&&!(tl.G.Dist(E,T)>v/3);)_.pop(),E=_[_.length-1],k++;_.push(T);let $=u.last||!u.simulatePressure||_.length>1&&tl.G.Dist(_[_.length-1],_[_.length-2])<v||k>0;if(2===_.length&&u.simulatePressure){let c=_[1];_=_.slice(0,-1);for(let u=1;u<5;u++){let f=tl.G.Lrp(_[0],c,u/4);f.z=(_[0].z+(c.z-_[0].z))*u/4,_.push(f)}}let I=[{point:_[0],input:_[0],pressure:x?.5:_[0].z,vector:new tl.G(1,1),distance:0,runningLength:0,radius:1}],M=0,j=I[0];$&&b>0&&_.push(_[_.length-1].clone());for(let c=1,b=_.length;c<b;c++)if(f=!w||u.last&&c===b-1?_[c].clone():_[c].clone().lrp(j.point,1-w),!j.point.equals(f)){if(M+=g=tl.G.Dist(f,j.point),c<4&&M<v)continue;j={input:_[c],point:f,pressure:x?.5:_[c].z,vector:tl.G.Sub(j.point,f).uni(),distance:g,runningLength:M,radius:1},I.push(j)}if(I[1]?.vector&&(I[0].vector=I[1].vector.clone()),M<1){let c=Math.max(.5,...I.map(c=>c.pressure));I.forEach(u=>u.pressure=c)}return I}let{min:iP}=Math;function setStrokePointRadii(c,u){let f,g;let{size:b=16,thinning:v=.5,simulatePressure:x=!0,easing:w=c=>c,start:_={},end:k={}}=u,{easing:E=n$.L.easeOutQuad}=_,{easing:T=n$.L.easeOutCubic}=k,$=c[c.length-1].runningLength,I=c[0].pressure;if(!x&&$<b){let u=c.reduce((c,u)=>Math.max(c,u.pressure),.5);return c.forEach(c=>{c.pressure=u,c.radius=b*w(.5-v*(.5-c.pressure))}),c}{let u;for(let f=0,v=c.length;f<v&&!((g=c[f]).runningLength>5*b);f++){let c=iP(1,g.distance/b);if(x){let f=iP(1,1-c);u=iP(1,I+(f-I)*(.275*c))}else u=iP(1,I+(g.pressure-I)*.5);I+=(u-I)*.5}for(let u=0;u<c.length;u++){if(g=c[u],v){let{pressure:c}=g,u=iP(1,g.distance/b);if(x){let f=iP(1,1-u);c=iP(1,I+(f-I)*(.275*u))}else c=iP(1,I+(c-I)*(.275*u));g.radius=b*w(.5-v*(.5-c)),I=c}else g.radius=b/2;void 0===f&&(f=g.radius)}}let M=!1===_.taper?0:!0===_.taper?Math.max(b,$):_.taper,j=!1===k.taper?0:!0===k.taper?Math.max(b,$):k.taper;if(M||j)for(let u=0;u<c.length;u++){g=c[u];let{runningLength:f}=g,b=f<M?E(f/M):1,v=$-f<j?T(($-f)/j):1;g.radius=Math.max(.01,g.radius*Math.min(b,v))}return c}function getStroke(c,u={}){return getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getStrokePoints(c,u),u),u)}let TldrawScribble=({scribble:c,zoom:u,color:f,opacity:g,className:b})=>{let v;if(!c.points.length)return null;let x=getStroke(c.points,{size:c.size/u,start:{taper:!0,easing:n$.L.linear},last:"stopping"===c.state,simulatePressure:!1,streamline:.32});if(x.length<4){let f=c.size/u/2,{x:g,y:b}=c.points[c.points.length-1];v=`M ${g-f},${b} a ${f},${f} 0 1,0 ${2*f},0 a ${f},${f} 0 1,0 ${-(2*f)},0`}else v=getSvgPathFromPoints_getSvgPathFromPoints(x);return(0,V.jsx)("svg",{className:b?e2("tl-overlays__item",b):b,children:(0,V.jsx)("path",{className:"tl-scribble",d:v,fill:f??`var(--color-${c.color})`,opacity:g??c.opacity})})},TldrawSelectionBackground=({bounds:c,rotation:u})=>{let f=(0,tt.j)(),g=(0,e5.Hg)("should display",()=>f.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[f]);return g?(0,V.jsx)(DefaultSelectionBackground,{bounds:c,rotation:u}):null};function useReadonly(){let c=(0,tt.j)();return(0,e5.Hg)("isReadonlyMode",()=>c.instanceState.isReadonly,[c])}function CropHandles({size:c,width:u,height:f,hideAlternateHandles:g}){let b=(0,ts.$Z)(c/3),v=b/2;return(0,V.jsxs)("svg",{className:"tl-overlays__item",children:[(0,V.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,ts.$Z)(0-v)},${(0,ts.$Z)(c)} 
						${(0,ts.$Z)(0-v)},${(0,ts.$Z)(0-v)} 
						${(0,ts.$Z)(c)},${(0,ts.$Z)(0-v)}`,strokeWidth:b,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,V.jsx)("line",{className:e2("tl-corner-crop-edge-handle",{"tl-hidden":g}),x1:(0,ts.$Z)(u/2-c),y1:(0,ts.$Z)(0-v),x2:(0,ts.$Z)(u/2+c),y2:(0,ts.$Z)(0-v),strokeWidth:b,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,V.jsx)("polyline",{className:e2("tl-corner-crop-handle",{"tl-hidden":g}),points:`
						${(0,ts.$Z)(u-c)},${(0,ts.$Z)(0-v)} 
						${(0,ts.$Z)(u+v)},${(0,ts.$Z)(0-v)} 
						${(0,ts.$Z)(u+v)},${(0,ts.$Z)(c)}`,strokeWidth:b,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,V.jsx)("line",{className:e2("tl-corner-crop-edge-handle",{"tl-hidden":g}),x1:(0,ts.$Z)(u+v),y1:(0,ts.$Z)(f/2-c),x2:(0,ts.$Z)(u+v),y2:(0,ts.$Z)(f/2+c),strokeWidth:b,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,V.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,ts.$Z)(u+v)},${(0,ts.$Z)(f-c)} 
						${(0,ts.$Z)(u+v)},${(0,ts.$Z)(f+v)}
						${(0,ts.$Z)(u-c)},${(0,ts.$Z)(f+v)}`,strokeWidth:b,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,V.jsx)("line",{className:e2("tl-corner-crop-edge-handle",{"tl-hidden":g}),x1:(0,ts.$Z)(u/2-c),y1:(0,ts.$Z)(f+v),x2:(0,ts.$Z)(u/2+c),y2:(0,ts.$Z)(f+v),strokeWidth:b,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,V.jsx)("polyline",{className:e2("tl-corner-crop-handle",{"tl-hidden":g}),points:`
						${(0,ts.$Z)(0+c)},${(0,ts.$Z)(f+v)} 
						${(0,ts.$Z)(0-v)},${(0,ts.$Z)(f+v)}
						${(0,ts.$Z)(0-v)},${(0,ts.$Z)(f-c)}`,strokeWidth:b,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,V.jsx)("line",{className:e2("tl-corner-crop-edge-handle",{"tl-hidden":g}),x1:(0,ts.$Z)(0-v),y1:(0,ts.$Z)(f/2-c),x2:(0,ts.$Z)(0-v),y2:(0,ts.$Z)(f/2+c),strokeWidth:b,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}let iT="undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,i$=(0,e5.j)(function({bounds:c,rotation:u}){let f=(0,tt.j)(),g=(0,K.useRef)(null),b=useReadonly(),v=useSelectionEvents("top"),x=useSelectionEvents("right"),w=useSelectionEvents("bottom"),_=useSelectionEvents("left"),k=useSelectionEvents("top_left"),E=useSelectionEvents("top_right"),T=useSelectionEvents("bottom_right"),$=useSelectionEvents("bottom_left"),I=!f.isMenuOpen&&"default"===f.instanceState.cursor.type,M=f.instanceState.isCoarsePointer,j=f.selectedShapes,D=f.onlySelectedShape,L=D&&f.isShapeOrAncestorLocked(D),F=D?f.getShapeUtil(D).expandSelectionOutlinePx(D):0;if(useTransform(g,c?.x,c?.y,1,f.selectionRotation,{x:-F,y:-F}),!c)return null;c=c.clone().expandBy(F).zeroFix();let B=f.zoomLevel,G=f.instanceState.isChangingStyle,U=c.width,Z=c.height,Y=8/B,X=U<2*Y,J=Z<2*Y,Q=U<4*Y,ee=Z<4*Y,et=U<5*Y,en=Z<5*Y,er=M?1.75:1,ei=6/B*er,eo=(Q?ei/2:ei)*(.75*er),ea=(ee?ei/2:ei)*(.75*er),es=(!D||!f.getShapeUtil(D).hideSelectionBoundsFg(D))&&!G,el=es&&f.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||es&&f.isIn("select.resizing")&&D&&f.isShapeOfType(D,"text");D&&el&&iT&&f.isShapeOfType(D,"embed")&&(el=!1);let ec=f.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!G&&!b,eu=f.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!G&&!b,ed=!M&&!(X||J)&&(eu||ec)&&(!D||!f.getShapeUtil(D).hideRotateHandle(D))&&!L,eh=M&&(!Q||!ee)&&(eu||ec)&&(!D||!f.getShapeUtil(D).hideRotateHandle(D))&&!L,ep=eu&&(!D||f.getShapeUtil(D).canResize(D)&&!f.getShapeUtil(D).hideResizeHandles(D))&&!ec&&!L,ef=X||J,eg=X&&J,em=et||en,ey=ep||ec,eb=!ed,ev=!eu||!ey,eS=!eu||!ey||ef,ex=!eu||!ey||ef,ew=!eu||!ey||eg&&!ec,e_=M;e_&&j.every(c=>f.getShapeUtil(c).isAspectRatioLocked(c))&&(e_=!1);let ek=!0;ec?ek=em:ep&&(ek=ef||eg||e_);let eC=Math.min(24/B,Z-3*ea),eE=eu&&M&&D&&f.isShapeOfType(D,"text")&&eC*B>=4;return(0,V.jsxs)("svg",{ref:g,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[el&&(0,V.jsx)("rect",{className:e2("tl-selection__fg__outline"),width:(0,ts.$Z)(U),height:(0,ts.$Z)(Z)}),(0,V.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:ei,corner:"top_left_rotate",cursor:I?getCursor("nwse-rotate",u):void 0,isHidden:eb}),(0,V.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.top-right",cx:U+3*ei,cy:0,targetSize:ei,corner:"top_right_rotate",cursor:I?getCursor("nesw-rotate",u):void 0,isHidden:eb}),(0,V.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:Z+3*ei,targetSize:ei,corner:"bottom_left_rotate",cursor:I?getCursor("swne-rotate",u):void 0,isHidden:eb}),(0,V.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.bottom-right",cx:U+3*ei,cy:Z+3*ei,targetSize:ei,corner:"bottom_right_rotate",cursor:I?getCursor("senw-rotate",u):void 0,isHidden:eb}),(0,V.jsx)(MobileRotateHandle,{"data-testid":"selection.rotate.mobile",cx:Q?-(1.5*ei):U/2,cy:Q?Z/2:-(1.5*ei),size:Y,isHidden:!eu||!eh}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ek}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:(0,ts.$Z)(0-(ee?2*ea:ea)),width:(0,ts.$Z)(U),height:(0,ts.$Z)(Math.max(1,2*ea)),style:I?{cursor:getCursor("ns-resize",u)}:void 0,...v}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ek}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:(0,ts.$Z)(U-(Q?0:eo)),y:0,height:(0,ts.$Z)(Z),width:(0,ts.$Z)(Math.max(1,2*eo)),style:I?{cursor:getCursor("ew-resize",u)}:void 0,...x}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ek}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:(0,ts.$Z)(Z-(ee?0:ea)),width:(0,ts.$Z)(U),height:(0,ts.$Z)(Math.max(1,2*ea)),style:I?{cursor:getCursor("ns-resize",u)}:void 0,...w}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ek}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:(0,ts.$Z)(0-(Q?2*eo:eo)),y:0,height:(0,ts.$Z)(Z),width:(0,ts.$Z)(Math.max(1,2*eo)),style:I?{cursor:getCursor("ew-resize",u)}:void 0,..._}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ev}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:(0,ts.$Z)(0-(Q?2*eo:1.5*eo)),y:(0,ts.$Z)(0-(ee?2*ea:1.5*ea)),width:(0,ts.$Z)(3*eo),height:(0,ts.$Z)(3*ea),style:I?{cursor:getCursor("nwse-resize",u)}:void 0,...k}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":eS}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:(0,ts.$Z)(U-(Q?0:1.5*eo)),y:(0,ts.$Z)(0-(ee?2*ea:1.5*ea)),width:(0,ts.$Z)(3*eo),height:(0,ts.$Z)(3*ea),style:I?{cursor:getCursor("nesw-resize",u)}:void 0,...E}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ew}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:(0,ts.$Z)(U-(Q?eo:1.5*eo)),y:(0,ts.$Z)(Z-(ee?ea:1.5*ea)),width:(0,ts.$Z)(3*eo),height:(0,ts.$Z)(3*ea),style:I?{cursor:getCursor("nwse-resize",u)}:void 0,...T}),(0,V.jsx)("rect",{className:e2("tl-transparent",{"tl-hidden":ex}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:(0,ts.$Z)(0-(Q?3*eo:1.5*eo)),y:(0,ts.$Z)(Z-(ee?0:1.5*ea)),width:(0,ts.$Z)(3*eo),height:(0,ts.$Z)(3*ea),style:I?{cursor:getCursor("nesw-resize",u)}:void 0,...$}),ep&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("rect",{"data-testid":"selection.resize.top-left",className:e2("tl-corner-handle",{"tl-hidden":ev}),"aria-label":"top_left handle",x:(0,ts.$Z)(0-Y/2),y:(0,ts.$Z)(0-Y/2),width:(0,ts.$Z)(Y),height:(0,ts.$Z)(Y)}),(0,V.jsx)("rect",{"data-testid":"selection.resize.top-right",className:e2("tl-corner-handle",{"tl-hidden":eS}),"aria-label":"top_right handle",x:(0,ts.$Z)(U-Y/2),y:(0,ts.$Z)(0-Y/2),width:(0,ts.$Z)(Y),height:(0,ts.$Z)(Y)}),(0,V.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:e2("tl-corner-handle",{"tl-hidden":ew}),"aria-label":"bottom_right handle",x:(0,ts.$Z)(U-Y/2),y:(0,ts.$Z)(Z-Y/2),width:(0,ts.$Z)(Y),height:(0,ts.$Z)(Y)}),(0,V.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:e2("tl-corner-handle",{"tl-hidden":ex}),"aria-label":"bottom_left handle",x:(0,ts.$Z)(0-Y/2),y:(0,ts.$Z)(Z-Y/2),width:(0,ts.$Z)(Y),height:(0,ts.$Z)(Y)})]}),eE&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:(0,ts.$Z)(0-Y/4),y:(0,ts.$Z)(Z/2-eC/2),rx:Y/4,width:(0,ts.$Z)(Y/2),height:(0,ts.$Z)(eC)}),(0,V.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:Y/4,x:(0,ts.$Z)(U-Y/4),y:(0,ts.$Z)(Z/2-eC/2),width:(0,ts.$Z)(Y/2),height:(0,ts.$Z)(eC)})]}),ec&&(0,V.jsx)(CropHandles,{size:Y,width:U,height:Z,hideAlternateHandles:em})]})}),RotateCornerHandle=function({cx:c,cy:u,targetSize:f,corner:g,cursor:b,isHidden:v,"data-testid":x}){let w=useSelectionEvents(g);return(0,V.jsx)("rect",{className:e2("tl-transparent","tl-rotate-corner",{"tl-hidden":v}),"data-testid":x,"aria-label":`${g} target`,pointerEvents:"all",x:(0,ts.$Z)(c-3*f),y:(0,ts.$Z)(u-3*f),width:(0,ts.$Z)(Math.max(1,3*f)),height:(0,ts.$Z)(Math.max(1,3*f)),cursor:b,...w})},iI=Math.sqrt(Math.PI),MobileRotateHandle=function({cx:c,cy:u,size:f,isHidden:g,"data-testid":b}){let v=useSelectionEvents("mobile_rotate"),x=(0,tt.j)(),w=(0,e5.Hg)("zoom level",()=>x.zoomLevel,[x]);return(0,V.jsxs)("g",{children:[(0,V.jsx)("circle",{"data-testid":b,pointerEvents:"all",className:e2("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":g}),cx:c,cy:u,r:Math.max(14*(1/w),20/Math.max(1,w)),...v}),(0,V.jsx)("circle",{className:e2("tl-mobile-rotate__fg",{"tl-hidden":g}),cx:c,cy:u,r:f/iI})]})},iA={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},iM={s:2,m:3.5,l:5,xl:10},ij={s:18,m:24,l:36,xl:44},iO={s:18,m:22,l:26,xl:32},iR={s:18,m:20,l:24,xl:28},iD={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};var iL=f(45965);let iN=null;function getBrowserCanvasMaxSize(){return iN||(iN=calculateBrowserCanvasMaxSize()),iN}async function calculateBrowserCanvasMaxSize(){let c=await iL.default.maxWidth({usePromise:!0}),u=await iL.default.maxHeight({usePromise:!0}),f=await iL.default.maxArea({usePromise:!0});return{maxWidth:c.width,maxHeight:u.height,maxArea:f.width*f.height}}function getDataBlocksLength(c,u){let f=0;for(;c[u+f];)f+=c[u+f]+1;return f+1}function isGIF(c){let u=new TextDecoder("ascii"),f=u.decode(c.slice(0,3));return"GIF"===f}function isAnimated(c){let u,f;let g=new Uint8Array(c),b=0,v=0;if(!isGIF(c))return!1;for(u=128&g[10],f=7&g[10],b+=13+(u?3*Math.pow(2,f+1):0);v<2&&b<g.length;)switch(g[b]){case 44:v+=1,u=128&g[b+9],f=7&g[b+9],b+=10+(u?3*Math.pow(2,f+1):0),b+=getDataBlocksLength(g,b+1)+1;break;case 33:b+=2,b+=getDataBlocksLength(g,b);break;default:b=g.length}return v>1}function containBoxSize(c,u){let f=c.w/u.w,g=c.h/u.h;return f<=1&&g<=1?c:f>g?{w:c.w/f,h:c.h/f}:{w:c.w/g,h:c.h/g}}async function getResizedImageDataUrl(c,u,f){return await new Promise(g=>{let b=new Image;b.onload=async()=>{let c=document.createElement("canvas"),v=c.getContext("2d");if(!v)return;let x=await getBrowserCanvasMaxSize(),w=2*u,_=2*f,k=b.width/b.height;if(w>x.maxWidth&&(_=(w=x.maxWidth)/k),_>x.maxHeight&&(w=(_=x.maxHeight)*k),w*_>x.maxArea){let c=Math.sqrt(x.maxArea/(w*_));w*=c,_*=c}c.width=w,c.height=_,v.drawImage(b,0,0,c.width,c.height);let E=c.toDataURL();g(E)},b.crossOrigin="anonymous",b.src=c})}let iF=["image/jpeg","image/png","image/gif","image/svg+xml"],iB=["video/mp4","video/quicktime"];async function isGifAnimated(c){return await new Promise((u,f)=>{let g=new FileReader;g.onerror=()=>f(g.error),g.onload=()=>{u(!!g.result&&isAnimated(g.result))},g.readAsArrayBuffer(c)})}function escapeStringRegexp(c){if("string"!=typeof c)throw TypeError("Expected a string");return c.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function matchEmbedUrl(c){let u=new URL(c).host.replace("www.","");for(let f of e8.Lu)if(checkHostnames(f.hostnames,u)){let u=f.fromEmbedUrl(c);if(u)return{definition:f,url:u,embedUrl:c}}}let globlikeRegExp=c=>c.split("*").map(c=>escapeStringRegexp(c)).join(".+"),checkHostnames=(c,u)=>!!c.find(c=>{let f=new RegExp(globlikeRegExp(c));return u.match(f)});function matchUrl(c){let u=new URL(c).host.replace("www.","");for(let f of e8.Lu)if(checkHostnames(f.hostnames,u)){let u=f.toEmbedUrl(c);if(u)return{definition:f,embedUrl:u,url:c}}}function getEmbedInfoUnsafely(c){let u=matchUrl(c)??matchEmbedUrl(c);return u}function getEmbedInfo(c){try{return getEmbedInfoUnsafely(c)}catch(c){console.error(c)}}let TextHelpers=class TextHelpers{static insertTextFirefox(c,u){c.setRangeText(u,c.selectionStart||0,c.selectionEnd||0,"end"),c.dispatchEvent(new InputEvent("input",{data:u,inputType:"insertText",isComposing:!1}))}static insert(c,u){let f=c.ownerDocument,g=f.activeElement;g!==c&&c.focus(),f.execCommand("insertText",!1,u)||TextHelpers.insertTextFirefox(c,u),g===f.body?c.blur():g instanceof HTMLElement&&g!==c&&g.focus()}static set(c,u){c.select(),TextHelpers.insert(c,u)}static getSelection(c){let{selectionStart:u,selectionEnd:f}=c;return c.value.slice(u||void 0,f||void 0)}static wrapSelection(c,u,f){let{selectionStart:g,selectionEnd:b}=c,v=TextHelpers.getSelection(c);TextHelpers.insert(c,u+v+(f??u)),c.selectionStart=(g||0)+u.length,c.selectionEnd=(b||0)+u.length}static replace(c,u,f){let g=0;c.value.replace(u,(...u)=>{let b=g+u[u.length-2],v=u[0].length;c.selectionStart=b,c.selectionEnd=b+v;let x="string"==typeof f?f:f(...u);return TextHelpers.insert(c,x),c.selectionStart=b,g+=x.length-v,x})}static findLineEnd(c,u){let f=c.lastIndexOf("\n",u-1)+1;return"	"!==c.charAt(f)?u:f+1}static indent(c){let{selectionStart:u,selectionEnd:f,value:g}=c,b=g.slice(u,f),v=/\n/g.exec(b)?.length;if(v&&v>0){let b=g.lastIndexOf("\n",u-1)+1,v=c.value.slice(b,f-1),x=v.replace(/^|\n/g,"$&  "),w=x.length-v.length;c.setSelectionRange(b,f-1),TextHelpers.insert(c,x),c.setSelectionRange(u+1,f+w)}else TextHelpers.insert(c,"  ")}static unindent(c){let{selectionStart:u,selectionEnd:f,value:g}=c,b=g.lastIndexOf("\n",u-1)+1,v=TextHelpers.findLineEnd(g,f),x=c.value.slice(b,v),w=x.replace(/(^|\n)(\t| {1,2})/g,"$1"),_=x.length-w.length;c.setSelectionRange(b,v),TextHelpers.insert(c,w);let k=/\t| {1,2}/.exec(g.slice(b,u)),E=k?k[0].length:0,T=u-E;c.setSelectionRange(u-E,Math.max(T,f-_))}static indentCE(c){let u=window.getSelection(),f=c.innerText,g=getCaretIndex(c)??0,b=getCaretIndex(c)??0,v=f.slice(g,b),x=/\n/g.exec(v)?.length;if(x&&x>0){let v=f.lastIndexOf("\n",g-1)+1,x=f.slice(v,b-1),w=x.replace(/^|\n/g,"$&  "),_=w.length-x.length;u&&u.setBaseAndExtent(c,g+1,c,b+_)}else{let u=window.getSelection();c.innerText=f.slice(0,g)+"  "+f.slice(g),u?.setBaseAndExtent(c,g+1,c,g+2)}}static unindentCE(c){let u=window.getSelection(),f=c.innerText,g=getCaretIndex(c)??0,b=getCaretIndex(c)??0,v=f.lastIndexOf("\n",g-1)+1,x=TextHelpers.findLineEnd(f,b),w=f.slice(v,x),_=w.replace(/(^|\n)(\t| {1,2})/g,"$1"),k=w.length-_.length;if(u){u.setBaseAndExtent(c,v,c,x);let w=/\t| {1,2}/.exec(f.slice(v,g)),_=w?w[0].length:0,E=g-_;u.setBaseAndExtent(c,g-_,c,Math.max(E,b-k))}}static fixNewLines=/\r?\n|\r/g;static normalizeText(c){return c.replace(TextHelpers.fixNewLines,"\n")}static normalizeTextForDom(c){return c.replace(TextHelpers.fixNewLines,"\n").split("\n").map(c=>c||" ").join("\n")}};function getCaretIndex(c){if(void 0===window.getSelection)return;let u=window.getSelection();if(!u)return;let f=0;if(0!==u.rangeCount){let g=u.getRangeAt(0),b=g.cloneRange();b.selectNodeContents(c),b.setEnd(g.endContainer,g.endOffset),f=b.toString().length}return f}let iz=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function isRightToLeftLanguage(c){return iz.test(c)}function replaceTabsWithSpaces(c){return c.replace(/\t/g,"  ")}function stripCommonMinimumIndentation(c){let u=c.split("\n");for(;0===u[0].trim().length;)u.shift();let f=1/0;for(let c of u)if(c.trim().length>0){let u=c.length-c.trimStart().length;f=Math.min(f,u)}return u.map(c=>c.slice(f)).join("\n")}function stripTrailingWhitespace(c){return c.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function cleanupText(c){return stripTrailingWhitespace(stripCommonMinimumIndentation(replaceTabsWithSpaces(c)))}let truncateStringWithEllipsis=(c,u)=>c.length<=u?c:c.substring(0,u-3)+"...";function registerDefaultExternalContentHandlers(c,{maxImageDimension:u,maxAssetSize:f,acceptedImageMimeTypes:g,acceptedVideoMimeTypes:b}){c.registerExternalAssetHandler("file",async({file:c})=>await new Promise((v,x)=>{g.includes(c.type)||b.includes(c.type)||(console.warn(`File type not allowed: ${c.type}`),x()),c.size>f&&(console.warn(`File size too big: ${(c.size/1024).toFixed()}kb > ${(f/1024).toFixed()}kb`),x());let w=new FileReader;w.onerror=()=>x(w.error),w.onload=async()=>{let f,b,x=w.result;"video/quicktime"===c.type&&x.includes("video/quicktime")&&(x=x.replace("video/quicktime","video/mp4"));let _=g.includes(c.type);if(_?(f=await e4.xe.getImageSizeFromSrc(x),b="image/gif"===c.type&&await isGifAnimated(c)):(b=!0,f=await e4.xe.getVideoSizeFromSrc(x)),isFinite(u)){let g=containBoxSize(f,{w:u,h:u});f!==g&&("image/jpeg"===c.type||"image/png"===c.type)&&(x=await getResizedImageDataUrl(x,f.w,f.h)),f=g}let k=e8.Yk.createId((0,e4.jK)(x)),E=e8.Yk.create({id:k,type:_?"image":"video",typeName:"asset",props:{name:c.name,src:x,w:f.w,h:f.h,mimeType:c.type,isAnimated:b}});v(E)},w.readAsDataURL(c)})),c.registerExternalAssetHandler("url",async({url:c})=>{let u;try{let f=await fetch(c,{method:"GET",mode:"no-cors"}),g=await f.text(),b=new DOMParser().parseFromString(g,"text/html");u={image:b.head.querySelector('meta[property="og:image"]')?.getAttribute("content")??"",title:b.head.querySelector('meta[property="og:title"]')?.getAttribute("content")??truncateStringWithEllipsis(c,32),description:b.head.querySelector('meta[property="og:description"]')?.getAttribute("content")??""}}catch(f){console.error(f),u={image:"",title:truncateStringWithEllipsis(c,32),description:""}}return{id:e8.Yk.createId((0,e4.jK)(c)),typeName:"asset",type:"bookmark",props:{src:c,description:u.description,image:u.image,title:u.title},meta:{}}}),c.registerExternalContentHandler("svg-text",async({point:u,text:f})=>{let g=u??(c.inputs.shiftKey?c.inputs.currentPagePoint:c.viewportPageCenter),b=new DOMParser().parseFromString(f,"image/svg+xml").querySelector("svg");if(!b)throw Error("No <svg/> element present");let v=parseFloat(b.getAttribute("width")||"0"),x=parseFloat(b.getAttribute("height")||"0");if(!(v&&x)){document.body.appendChild(b);let c=b.getBoundingClientRect();document.body.removeChild(b),v=c.width,x=c.height}let w=await c.getAssetForExternalContent({type:"file",file:new File([f],"asset.svg",{type:"image/svg+xml"})});if(!w)throw Error("Could not create an asset");createShapesForAssets(c,[w],g)}),c.registerExternalContentHandler("embed",({point:u,url:f,embed:g})=>{let b=u??(c.inputs.shiftKey?c.inputs.currentPagePoint:c.viewportPageCenter),{width:v,height:x}=g,w=(0,e8.F1)(),_={id:w,type:"embed",x:b.x-(v||450)/2,y:b.y-(x||450)/2,props:{w:v,h:x,url:f}};c.createShapes([_]).select(w)}),c.registerExternalContentHandler("files",async({point:u,files:v})=>{let x=u??(c.inputs.shiftKey?c.inputs.currentPagePoint:c.viewportPageCenter),w=new tl.G(x.x,x.y),_=[];await Promise.all(v.map(async(u,v)=>{if(u.size>f)return console.warn(`File size too big: ${(u.size/1024).toFixed()}kb > ${(f/1024).toFixed()}kb`),null;if(!u.type)throw Error("No mime type");if(!g.concat(b).includes(u.type))return console.warn(`${u.name} not loaded - Extension not allowed.`),null;try{let f=await c.getAssetForExternalContent({type:"file",file:u});if(!f)throw Error("Could not create an asset");_[v]=f}catch(c){return console.error(c),null}})),createShapesForAssets(c,(0,e4.oA)(_),w)}),c.registerExternalContentHandler("text",async({point:u,text:f})=>{let g,b,v;let x=u??(c.inputs.shiftKey?c.inputs.currentPagePoint:c.viewportPageCenter),w=c.getShapeUtil("text").getDefaultProps(),_=cleanupText(f),k="middle",E=_.split("\n").length>1,T=isRightToLeftLanguage(_);E&&(k=E?T?"end":"start":"middle");let $=c.textMeasure.measureText(_,{...iA,fontFamily:iD[w.font],fontSize:ij[w.size],maxWidth:null}),I=Math.min(E?.9*c.viewportPageBounds.width:920,Math.max(200,.9*c.viewportPageBounds.width));if($.w>I){let u=c.textMeasure.measureText(_,{...iA,fontFamily:iD[w.font],fontSize:ij[w.size],maxWidth:I});g=u.w,b=u.h,v=!1,k=T?"end":"start"}else g=$.w,b=$.h,v=!0;x.y-b/2<c.viewportPageBounds.minY+40&&(x.y=c.viewportPageBounds.minY+40+b/2),c.createShapes([{id:(0,e8.F1)(),type:"text",x:x.x-g/2,y:x.y-b/2,props:{text:_,align:k,autoSize:v,w:g}}])}),c.registerExternalContentHandler("url",async({point:u,url:f})=>{let g=getEmbedInfo(f);if(g)return c.putExternalContent({type:"embed",url:g.url,point:u,embed:g.definition});let b=u??(c.inputs.shiftKey?c.inputs.currentPagePoint:c.viewportPageCenter),v=e8.Yk.createId((0,e4.jK)(f)),x=c.getAsset(v),w=!1;if(!x){w=!0;let u=await c.getAssetForExternalContent({type:"url",url:f});if(!u)throw Error("Could not create an asset");x=u}c.batch(()=>{w&&c.createAssets([x]),createShapesForAssets(c,[x],b)})})}async function createShapesForAssets(c,u,f){if(!u.length)return;let g=tl.G.From(f),b=[];for(let c of u)switch(c.type){case"bookmark":b.push({id:(0,e8.F1)(),type:"bookmark",x:g.x-150,y:g.y-160,opacity:1,props:{assetId:c.id,url:c.props.src}}),g.x+=300;break;case"image":b.push({id:(0,e8.F1)(),type:"image",x:g.x-c.props.w/2,y:g.y-c.props.h/2,opacity:1,props:{assetId:c.id,w:c.props.w,h:c.props.h}}),g.x+=c.props.w;break;case"video":b.push({id:(0,e8.F1)(),type:"video",x:g.x-c.props.w/2,y:g.y-c.props.h/2,opacity:1,props:{assetId:c.id,w:c.props.w,h:c.props.h}}),g.x+=c.props.w}c.batch(()=>{let g=u.filter(u=>!c.getAsset(u.id));g.length&&c.createAssets(g),c.createShapes(b).select(...b.map(c=>c.id));let{viewportPageBounds:v}=c,{selectionPageBounds:x}=c;if(x){let u=x.center.sub(f);c.updateShapes(c.selectedShapes.map(f=>{let g=c.getShapeParentTransform(f).decompose().rotation,b=tl.G.Rot(u,-g);return{id:f.id,type:f.type,x:f.x-b.x,y:f.y-b.y}}))}(x=c.selectionPageBounds)&&!v.contains(x)&&c.zoomToSelection()})}let Idle_Idle=class Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("pointing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")};onKeyUp=c=>{if("Enter"===c.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:u}=this.editor;u&&this.editor.getShapeUtil(u).canEdit(u)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(u.id),this.editor.root.current.value.transition("editing_shape",{...c,target:"shape",shape:u}))}}};let Pointing_Pointing=class Pointing_Pointing extends nE.n{static id="pointing";shape;markId="";onEnter=()=>{this.didTimeout=!1;let c=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:c=>!c.isLocked&&this.editor.getShapeUtil(c).canBind(c),margin:0,hitInside:!0,renderingOnly:!0});c?this.editor.setHintingShapes([c.id]):this.createArrowShape(),this.startPreciseTimeout()};onExit=()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()};onPointerMove=()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find(c=>"end"===c.id),isCreating:!0,onInteractionEnd:"arrow"})}};onPointerUp=()=>{this.cancel()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle",{})}createArrowShape(){let{originPagePoint:c}=this.editor.inputs,u=(0,e8.F1)();this.markId=`creating:${u}`,this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:"arrow",x:c.x,y:c.y}]);let f=this.editor.getShape(u);if(!f)throw Error("expected shape");let g=this.editor.getShapeHandles(f);if(!g)throw Error("expected handles for arrow");let b=this.editor.getShapeUtil("arrow"),v=g.find(c=>"start"===c.id),x=b.onHandleChange?.(f,{handle:{...v,x:0,y:0},isPrecise:!0});if(x){let c=x.props?.start;c?.type==="binding"&&this.editor.setHintingShapes([c.boundShapeId]),this.editor.updateShapes([x],{squashing:!0})}this.shape=this.editor.getShape(u),this.editor.select(u)}updateArrowShapeEndHandle(){let c=this.shape;if(!c)throw Error("expected shape");let u=this.editor.getShapeHandles(c);if(!u)throw Error("expected handles for arrow");let f={...c,props:{...c.props,end:{...c.props.end,x:0,y:0}}};{let g=this.editor.getShapeUtil("arrow"),b=this.editor.getPointInShapeSpace(c,this.editor.inputs.currentPagePoint),v=u.find(c=>"end"===c.id),x=g.onHandleChange?.(f,{handle:{...v,x:b.x,y:b.y},isPrecise:!1});if(x){let c=x.props?.end;c?.type==="binding"&&this.editor.setHintingShapes([c.boundShapeId]),this.editor.updateShapes([x],{squashing:!0})}}{let c=this.editor.getShapeUtil("arrow"),g=u.find(c=>"start"===c.id),b=c.onHandleChange?.(f,{handle:{...g,x:0,y:0},isPrecise:this.didTimeout});b&&this.editor.updateShapes([b],{squashing:!0})}this.shape=this.editor.getShape(c.id)}preciseTimeout=-1;didTimeout=!1;startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}};let ArrowShapeTool=class ArrowShapeTool extends nE.n{static id="arrow";static initial="idle";static children=()=>[Idle_Idle,Pointing_Pointing];shapeType="arrow"};let Drawing=class Drawing extends nE.n{static id="drawing";info={};initialShape;shapeType="highlight"===this.parent.id?"highlight":"draw";util=this.editor.getShapeUtil(this.shapeType);isPen=!1;segmentMode="free";didJustShiftClickToExtendPreviousShapeLine=!1;pagePointWhereCurrentSegmentChanged={};pagePointWhereNextSegmentChanged=null;lastRecordedPoint={};mergeNextPoint=!1;currentLineLength=0;canDraw=!1;markId=null;onEnter=c=>{this.markId=null,this.info=c,this.canDraw=!this.editor.isMenuOpen,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()};onPointerMove=()=>{let{editor:{inputs:c}}=this;if(this.isPen!==c.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&c.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(c.isPen?tl.G.Dist(c.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.zoomLevel?(this.lastRecordedPoint=c.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())};onKeyDown=c=>{if("Shift"===c.key)switch(this.segmentMode){case"free":this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()};onKeyUp=c=>{if("Shift"===c.key)switch(this.editor.snaps.clear(),this.segmentMode){case"straight":this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_straight":this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free"}this.updateShapes()};onExit=()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()};canClose(){return"highlight"!==this.shapeType}getIsClosed(c,u){if(!this.canClose())return!1;let f=iM[u],g=c[0].points[0],b=c[c.length-1],v=b.points[b.points.length-1];return g!==v&&this.currentLineLength>4*f&&tl.G.Dist(g,v)<2*f}startShape(){let{inputs:{originPagePoint:c,isPen:u}}=this.editor;this.markId="draw start "+(0,tQ.E)(),this.editor.mark(this.markId),this.isPen=u;let f=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=c.clone(),this.initialShape){let u=this.editor.getShape(this.initialShape.id);if(u&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;let f=(0,e4.Z$)(u.props.segments);if(!f)throw Error("Expected a previous segment!");let g=(0,e4.Z$)(f.points);if(!g)throw Error("Expected a previous point!");let{x:b,y:v}=this.editor.getPointInShapeSpace(u,c).toFixed(),x=this.isPen?1.25*this.info.point.z:.5,w={type:this.segmentMode,points:[{x:g.x,y:g.y,z:+x.toFixed(2)},{x:b,y:v,z:+x.toFixed(2)}]},_=tO.y.applyToPoint(this.editor.getShapePageTransform(u.id),g);this.pagePointWhereCurrentSegmentChanged=_,this.pagePointWhereNextSegmentChanged=null;let k=[...u.props.segments,w];this.currentLineLength=this.getLineLength(k);let E={id:u.id,type:this.shapeType,props:{segments:k}};this.canClose()&&(E.props.isClosed=this.getIsClosed(k,u.props.size)),this.editor.updateShapes([E]);return}}this.pagePointWhereCurrentSegmentChanged=c.clone();let g=(0,e8.F1)();this.editor.createShapes([{id:g,type:this.shapeType,x:c.x,y:c.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+f.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(g)}updateShapes(){let{inputs:c}=this.editor,{initialShape:u}=this;if(!u)return;let{id:f,props:{size:g}}=u,b=this.editor.getShape(f);if(!b)return;let{segments:v}=b.props,{x,y:w,z:_}=this.editor.getPointInShapeSpace(b,c.currentPagePoint).toFixed(),k={x,y:w,z:this.isPen?+(1.25*_).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{let{pagePointWhereNextSegmentChanged:u}=this;if(null===u)throw Error("We should have a point where the segment changed");let x=tl.G.Dist(u,c.currentPagePoint)>td.Sk;if(x){let c;this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";let u=(0,e4.Z$)(v);if(!u)throw Error("Expected a previous segment!");let x=(0,e4.Z$)(u.points);if(!x)throw Error("Expected a previous last point!");let w=this.editor.getPointInShapeSpace(b,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===u.type){this.currentLineLength+=tl.G.Dist(x,w),c={type:"straight",points:[{...x},w]};let u=this.editor.getShapePageTransform(b);this.pagePointWhereCurrentSegmentChanged=tO.y.applyToPoint(u,x)}else c={type:"straight",points:[w,k]};let _={id:f,type:this.shapeType,props:{segments:[...v,c]}};this.canClose()&&(_.props.isClosed=this.getIsClosed(v,g)),this.editor.updateShapes([_],{squashing:!0})}break}case"starting_free":{let{pagePointWhereNextSegmentChanged:u}=this;if(null===u)throw Error("We should have a point where the segment changed");let b=tl.G.Dist(u,c.currentPagePoint)>td.Sk;if(b){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";let c=v.slice(),u=c[c.length-1],b=(0,e4.Z$)(u.points);if(!b)throw Error("No previous point!");let x={type:"free",points:[...tl.G.PointsBetween(b,k,6).map(c=>c.toFixed().toJson())]},w=[...c,x];this.currentLineLength=this.getLineLength(w);let _={id:f,type:this.shapeType,props:{segments:w}};this.canClose()&&(_.props.isClosed=this.getIsClosed(w,g)),this.editor.updateShapes([_],{squashing:!0})}break}case"straight":{let c,u;let x=v.slice(),w=x[x.length-1],{pagePointWhereCurrentSegmentChanged:_}=this,{currentPagePoint:k,ctrlKey:E}=this.editor.inputs;if(!_)throw Error("We should have a point where the segment changed");let T=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(T=!E,this.didJustShiftClickToExtendPreviousShapeLine=!1):T=!E;let $=this.editor.getPointInShapeSpace(b,k).toFixed().toJson(),I=!1,M=this.editor.user.isSnapMode?!E:E;if(M&&x.length>2){let c;let f=8/this.editor.zoomLevel;for(let g=0,b=v.length-2;g<b;g++){let b=v[g];if(!b)break;if("free"===b.type)continue;let x=b.points[0],w=(0,e4.Z$)(b.points);if(!(x&&w))continue;let _=tl.G.NearestPointOnLineSegment(x,w,$),k=tl.G.Dist(_,$);if(k<f){c=_.toFixed().toJson(),f=k,u=b;break}}c&&(I=!0,$=c)}if(I&&u){let c=this.editor.getShapePageTransform(b),f=u.points[0],g=(0,e4.Z$)(u.points);if(!g)throw Error("Expected a last point!");let v=tO.y.applyToPoint(c,f),x=tO.y.applyToPoint(c,g),w=tO.y.applyToPoint(c,$);this.editor.snaps.setLines([{id:(0,tQ.E)(),type:"points",points:[v,w,x]}])}else{if(this.editor.snaps.clear(),T){let u=tl.G.Angle(_,k),f=(0,ts.nD)(u,24),g=f-u;c=tl.G.RotWith(k,_,g)}else c=k;$=this.editor.getPointInShapeSpace(b,c).toFixed().toJson()}this.currentLineLength+=tl.G.Dist(w.points[0],$),x[x.length-1]={...w,type:"straight",points:[w.points[0],$]};let j={id:f,type:this.shapeType,props:{segments:x}};this.canClose()&&(j.props.isClosed=this.getIsClosed(v,g)),this.editor.updateShapes([j],{squashing:!0});break}case"free":{let c=v.slice(),u=c[c.length-1],b=[...u.points];if(b.length&&this.mergeNextPoint){let{z:c}=b[b.length-1];b[b.length-1]={x:k.x,y:k.y,z:c?Math.max(c,k.z):k.z}}else this.currentLineLength+=tl.G.Dist(b[b.length-1],k),b.push(k);c[c.length-1]={...u,points:b},this.currentLineLength=this.getLineLength(c);let x={id:f,type:this.shapeType,props:{segments:c}};if(this.canClose()&&(x.props.isClosed=this.getIsClosed(c,g)),this.editor.updateShapes([x],{squashing:!0}),b.length>500){this.editor.updateShapes([{id:f,type:this.shapeType,props:{isComplete:!0}}]);let{currentPagePoint:c}=this.editor.inputs,u=(0,e8.F1)();this.editor.createShapes([{id:u,type:this.shapeType,x:(0,ts.FH)(c.x),y:(0,ts.FH)(c.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*_).toFixed():.5}]}]}}]),this.initialShape=structuredClone(this.editor.getShape(u)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}}}}getLineLength(c){let u=0;for(let f of c)for(let c=0;c<f.points.length-1;c++){let g=f.points[c],b=f.points[c+1];u+=tl.G.Sub(b,g).len2()}return Math.sqrt(u)}onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())};complete(){if(!this.canDraw){this.cancel();return}let{initialShape:c}=this;c&&(this.editor.updateShapes([{id:c.id,type:c.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}};let toolStates_Idle_Idle=class toolStates_Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("drawing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let DrawShapeTool=class DrawShapeTool extends nE.n{static id="draw";static initial="idle";static children=()=>[toolStates_Idle_Idle,Drawing];shapeType="draw";onExit=()=>{let c=this.children.drawing;c.initialShape=void 0}};let FrameShapeTool=class FrameShapeTool extends BaseBoxShapeTool{static id="frame";static initial="idle";shapeType="frame"};let geo_toolStates_Idle_Idle=class geo_toolStates_Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("pointing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyUp=c=>{if("Enter"===c.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:u}=this.editor;u&&this.editor.getShapeUtil(u).canEdit(u)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(u.id),this.editor.root.current.value.transition("editing_shape",{...c,target:"shape",shape:u}))}};onCancel=()=>{this.editor.setCurrentTool("select")}};let toolStates_Pointing_Pointing=class toolStates_Pointing_Pointing extends nE.n{static id="pointing";markId="";onPointerUp=()=>{this.complete()};onPointerMove=c=>{if(this.editor.inputs.isDragging){let{originPagePoint:u}=this.editor.inputs,f=(0,e8.F1)();this.markId=`creating:${f}`,this.editor.mark(this.markId),this.editor.createShapes([{id:f,type:"geo",x:u.x,y:u.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(e8.Zu)}}]).select(f).setCurrentTool("select.resizing",{...c,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:c}=this.editor.inputs,u=(0,e8.F1)();this.markId=`creating:${u}`,this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:"geo",x:c.x,y:c.y,props:{geo:this.editor.getStyleForNextShape(e8.Zu),w:1,h:1}}]);let f=this.editor.getShape(u);if(!f)return;let g="star"===f.props.geo?(0,ts.LP)(5,200,200):"cloud"===f.props.geo?new nT.No(0,0,300,180):new nT.No(0,0,200,200),b=g.center,v=this.editor.getShapeParentTransform(f);v&&b.rot(-v.rotation()),this.editor.select(u),this.editor.updateShapes([{id:f.id,type:"geo",x:f.x-b.x,y:f.y-b.y,props:{geo:this.editor.getStyleForNextShape(e8.Zu),w:g.width,h:g.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle",{})}};let GeoShapeTool=class GeoShapeTool extends nE.n{static id="geo";static initial="idle";static children=()=>[geo_toolStates_Idle_Idle,toolStates_Pointing_Pointing];shapeType="geo"};let HighlightShapeTool=class HighlightShapeTool extends nE.n{static id="highlight";static initial="idle";static children=()=>[toolStates_Idle_Idle,Drawing];shapeType="highlight";onExit=()=>{let c=this.children.drawing;c.initialShape=void 0}};let line_toolStates_Idle_Idle=class line_toolStates_Idle_Idle extends nE.n{static id="idle";shapeId="";onEnter=c=>{this.shapeId=c.shapeId,this.editor.setCursor({type:"cross",rotation:0})};onPointerDown=()=>{this.parent.transition("pointing",{shapeId:this.shapeId})};onCancel=()=>{this.editor.setCurrentTool("select")}};let line_toolStates_Pointing_Pointing=class line_toolStates_Pointing_Pointing extends nE.n{static id="pointing";shape={};markId;onEnter=c=>{let{inputs:u}=this.editor,{currentPagePoint:f}=u;this.markId=void 0;let g=c.shapeId&&this.editor.getShape(c.shapeId);if(g&&u.shiftKey){let c,u;this.markId=`creating:${g.id}`,this.editor.mark(this.markId),this.shape=g;let b=this.editor.getShapeHandles(this.shape);if(!b)return;let v=b.filter(c=>"vertex"===c.type).sort(nF.hl),x=v[v.length-1],w=v[v.length-2],_=tO.y.applyToPoint(this.editor.getShapeParentTransform(this.shape),new tl.G(this.shape.x,this.shape.y)),k=tl.G.Sub(f,_);2>tl.G.Dist(x,w)||2>tl.G.Dist(k,x)?(c=x.index,x.id,u={...x,x:k.x+.1,y:k.y+.1}):u={id:"handle:"+(c=(0,nF._L)(x.index)),type:"vertex",index:c,x:k.x+.1,y:k.y+.1,canBind:!1};let E=(0,e4.v4)(this.shape.props.handles);E[u.id]=u,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:E}}])}else{let c=(0,e8.F1)();this.markId=`creating:${c}`,this.editor.mark(this.markId),this.editor.createShapes([{id:c,type:"line",x:f.x,y:f.y}]),this.editor.select(c),this.shape=this.editor.getShape(c)}};onPointerMove=()=>{if(this.shape&&this.editor.inputs.isDragging){let c=this.editor.getShapeHandles(this.shape);if(!c)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");let u=(0,e4.Z$)(c);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...u,x:u.x-.1,y:u.y-.1},onInteractionEnd:"line"})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{}),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clear()};complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}};let LineShapeTool=class LineShapeTool extends nE.n{static id="line";static initial="idle";static children=()=>[line_toolStates_Idle_Idle,line_toolStates_Pointing_Pointing];shapeType="line"};let note_toolStates_Idle_Idle=class note_toolStates_Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("pointing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let note_toolStates_Pointing_Pointing=class note_toolStates_Pointing_Pointing extends nE.n{static id="pointing";dragged=!1;info={};wasFocusedOnEnter=!1;markId="";shape={};onEnter=()=>{this.wasFocusedOnEnter=!this.editor.isMenuOpen,this.wasFocusedOnEnter&&(this.shape=this.createShape())};onPointerMove=c=>{this.editor.inputs.isDragging&&(this.wasFocusedOnEnter||(this.shape=this.createShape()),this.editor.setCurrentTool("select.translating",{...c,target:"shape",shape:this.shape,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"}))};onPointerUp=()=>{this.complete()};onInterrupt=()=>{this.cancel()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};complete(){this.wasFocusedOnEnter&&(this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}createShape(){let{inputs:{originPagePoint:c}}=this.editor,u=(0,e8.F1)();this.markId=`creating:${u}`,this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:"note",x:c.x,y:c.y}]).select(u);let f=this.editor.getShape(u),g=this.editor.getShapeGeometry(f).bounds;return this.editor.updateShapes([{id:u,type:"note",x:f.x-g.width/2,y:f.y-g.height/2}]),this.editor.getShape(u)}};let NoteShapeTool=class NoteShapeTool extends nE.n{static id="note";static initial="idle";static children=()=>[note_toolStates_Idle_Idle,note_toolStates_Pointing_Pointing];shapeType="note"};function updateHoveredId(c){let u;let f=c.getShapeAtPoint(c.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:td.wM/c.zoomLevel,renderingOnly:!0});if(!f)return c.setHoveredShape(null);let g=c.getOutermostSelectableShape(f);return u=g===f?f:g.id===c.focusedGroupId||c.selectedShapeIds.includes(g.id)?f:g,c.setHoveredShape(u.id)}let text_toolStates_Idle_Idle=class text_toolStates_Idle_Idle extends nE.n{static id="idle";onPointerMove=c=>{switch(c.target){case"shape":case"canvas":updateHoveredId(this.editor)}};onPointerDown=c=>{this.parent.transition("pointing",c)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyDown=c=>{if("Enter"===c.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:u}=this.editor;u&&this.editor.getShapeUtil(u).canEdit(u)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(u.id),this.editor.root.current.value.transition("editing_shape",{...c,target:"shape",shape:u}))}};onCancel=()=>{this.editor.setCurrentTool("select")}};let text_toolStates_Pointing_Pointing=class text_toolStates_Pointing_Pointing extends nE.n{static id="pointing";shape;markId="";onExit=()=>{this.editor.setHintingShapes([])};onPointerMove=c=>{if(this.editor.inputs.isDragging){let{inputs:{originPagePoint:u}}=this.editor,f=(0,e8.F1)();this.markId=`creating:${f}`,this.editor.mark(this.markId),this.editor.createShapes([{id:f,type:"text",x:u.x,y:u.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(f),this.shape=this.editor.getShape(f),this.shape&&this.editor.setCurrentTool("select.resizing",{...c,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}};onPointerUp=()=>{this.complete()};onComplete=()=>{this.cancel()};onCancel=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.editor.mark("creating text shape");let c=(0,e8.F1)(),{x:u,y:f}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:c,type:"text",x:u,y:f,props:{text:"",autoSize:!0}}]).select(c),this.editor.setEditingShape(c),this.editor.setCurrentTool("select"),this.editor.root.current.value?.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.editor.bailToMark(this.markId)}};let TextShapeTool=class TextShapeTool extends nE.n{static id="text";static initial="idle";static children=()=>[text_toolStates_Idle_Idle,text_toolStates_Pointing_Pointing];shapeType="text"};let iG=[TextShapeTool,DrawShapeTool,GeoShapeTool,NoteShapeTool,LineShapeTool,FrameShapeTool,ArrowShapeTool,HighlightShapeTool];function useDefaultColorTheme(){return(0,e8.y6)({isDarkMode:useIsDarkMode()})}let iU=K.memo(function({theme:c,d:u,color:f,fill:g}){switch(g){case"none":return null;case"solid":return(0,V.jsx)("path",{fill:c[f].semi,d:u});case"semi":return(0,V.jsx)("path",{fill:c.solid,d:u});case"pattern":return(0,V.jsx)(PatternFill,{theme:c,color:f,fill:g,d:u})}}),PatternFill=function({d:c,color:u,theme:f}){let g=(0,tt.j)(),b=(0,e5.Hg)("zoomLevel",()=>g.zoomLevel,[g]),v=g.zoomLevel<=.18;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("path",{fill:f[u].pattern,d:c}),(0,V.jsx)("path",{fill:v?f[u].semi:`url(#${td.iF[`${Math.ceil(b)}_${f.id}`]})`,d:c})]})};function getShapeFillSvg({d:c,color:u,fill:f,theme:g}){if("none"===f)return;if("pattern"===f){let f=document.createElementNS("http://www.w3.org/2000/svg","g"),b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",c),b.setAttribute("fill",g[u].pattern);let v=document.createElementNS("http://www.w3.org/2000/svg","path");return v.setAttribute("d",c),v.setAttribute("fill","url(#hash_pattern)"),f.appendChild(b),f.appendChild(v),f}let b=document.createElementNS("http://www.w3.org/2000/svg","path");switch(b.setAttribute("d",c),f){case"semi":b.setAttribute("fill",g.solid);break;case"solid":b.setAttribute("fill",g[u].semi)}return b}function getSvgWithShapeFill(c,u){if(!u)return c;{let f=document.createElementNS("http://www.w3.org/2000/svg","g");return f.appendChild(u),f.appendChild(c),f}}function correctSpacesToNbsp(c){return c.replace(/\s/g,"\xa0")}function createTextSvgElementFromSpans(c,u,f){let{padding:g=0}=f,b=document.createElementNS("http://www.w3.org/2000/svg","text");if(b.setAttribute("font-size",f.fontSize+"px"),b.setAttribute("font-family",f.fontFamily),b.setAttribute("font-style",f.fontStyle),b.setAttribute("font-weight",f.fontWeight),b.setAttribute("line-height",f.lineHeight*f.fontSize+"px"),b.setAttribute("dominant-baseline","mathematical"),b.setAttribute("alignment-baseline","mathematical"),0===u.length)return b;let v=nT.No.From(u[0].box);for(let{box:c}of u)v.union(c);let x=g+(f.offsetX??0),w=(f.offsetY??0)+f.fontSize/2+("start"===f.verticalTextAlign?g:"end"===f.verticalTextAlign?f.height-g-v.height:(Math.ceil(f.height)-v.height)/2),_=null;for(let{text:c,box:f}of u){let u=null!==_&&f.y>_;if(u){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttribute("alignment-baseline","mathematical"),c.setAttribute("x",x+"px"),c.setAttribute("y",f.y+w+"px"),c.textContent="\n",b.appendChild(c)}let g=document.createElementNS("http://www.w3.org/2000/svg","tspan");g.setAttribute("alignment-baseline","mathematical"),g.setAttribute("x",f.x+x+"px"),g.setAttribute("y",f.y+w+"px");let v=correctSpacesToNbsp(c);g.textContent=v,b.appendChild(g),_=f.y}return f.stroke&&f.strokeWidth&&(b.setAttribute("stroke",f.stroke),b.setAttribute("stroke-width",f.strokeWidth+"px")),f.fill&&b.setAttribute("fill",f.fill),b}function getFontDefForExport(c){return{key:`${e8.Y8.id}:${c}`,getElement:async()=>{let u=findFont(c);if(!u)return null;let f=u.$$_url,g=u.$$_fontface;if(!f||!g)return null;let b=await (await fetch(f)).blob(),v=await new Promise((c,u)=>{let f=new FileReader;f.onload=()=>c(f.result),f.onerror=u,f.readAsDataURL(b)}),x=g.replace(f,v),w=document.createElementNS("http://www.w3.org/2000/svg","style");return w.textContent=x,w}}}function findFont(c){let u=e8.p6[c];for(let c of document.fonts)if(u.includes(c.family))return c;return null}function getFillDefForExport(c,u){return{key:`${e8.Y8.id}:${c}`,getElement:async()=>{if("pattern"!==c)return null;let f=8/12,g=document.createElement("div");return g.innerHTML=`
				<svg>
					<defs>
						<mask id="hash_pattern_mask">
							<rect x="0" y="0" width="8" height="8" fill="white" />
							<g
								strokeLinecap="round"
								stroke="black"
							>
								<line x1="${1*f}" y1="${3*f}" x2="${3*f}" y2="${1*f}" />
								<line x1="${5*f}" y1="${7*f}" x2="${7*f}" y2="${5*f}" />
								<line x1="${9*f}" y1="${11*f}" x2="${11*f}" y2="${9*f}" />
							</g>
						</mask>
						<pattern
							id="hash_pattern"
							width="8"
							height="8"
							patternUnits="userSpaceOnUse"
						>
							<rect x="0" y="0" width="8" height="8" fill="${u.solid}" mask="url(#hash_pattern_mask)" />
						</pattern>
					</defs>
				</svg>
			`,Array.from(g.querySelectorAll("defs > *"))}}}function getFillDefForCanvas(){return{key:`${e8.Y8.id}:pattern`,component:PatternFillDefForCanvas}}let generateImage=(c,u,f)=>new Promise((g,b)=>{let v=8*u*c,x=document.createElement("canvas");x.width=v,x.height=v;let w=x.getContext("2d");if(!w)return;w.fillStyle=f?"#212529":"#f8f9fa",w.fillRect(0,0,v,v),w.globalCompositeOperation="destination-out",w.lineCap="round",w.lineWidth=1.25*u*c;let _=8/12,s=f=>f*u*c;w.beginPath(),w.moveTo(s(1*_),s(3*_)),w.lineTo(s(3*_),s(1*_)),w.moveTo(s(5*_),s(7*_)),w.lineTo(s(7*_),s(5*_)),w.moveTo(s(9*_),s(11*_)),w.lineTo(s(11*_),s(9*_)),w.stroke(),x.toBlob(c=>{!c||te.throwToBlob.value?b():g(c)})}),canvasBlob=(c,u)=>{let f=document.createElement("canvas");f.width=c[0],f.height=c[1];let g=f.getContext("2d");return g?(u(g),f.toDataURL()):""},getDefaultPatterns=()=>{let c=[];for(let u=1;u<=Math.ceil(td.sZ);u++){let f=canvasBlob([1,1],c=>{c.fillStyle=e8.qi.lightMode.black.semi,c.fillRect(0,0,1,1)}),g=canvasBlob([1,1],c=>{c.fillStyle=e8.qi.darkMode.black.semi,c.fillRect(0,0,1,1)});c.push({zoom:u,url:f,darkMode:!1}),c.push({zoom:u,url:g,darkMode:!0})}return c};function usePattern(){let c=(0,tt.j)(),u=c.instanceState.devicePixelRatio,[f,g]=(0,K.useState)(!1),b=(0,K.useMemo)(()=>getDefaultPatterns(),[]),[v,x]=(0,K.useState)(b);(0,K.useEffect)(()=>{let c=[];for(let f=1;f<=Math.ceil(td.sZ);f++)c.push(generateImage(u,f,!1).then(c=>({zoom:f,url:URL.createObjectURL(c),darkMode:!1}))),c.push(generateImage(u,f,!0).then(c=>({zoom:f,url:URL.createObjectURL(c),darkMode:!0})));let f=!1;return Promise.all(c).then(c=>{f||(x(c),g(!0))}),()=>{f=!0,g(!1)}},[u]);let w=(0,V.jsx)(V.Fragment,{children:v.map(c=>{let u=c.zoom+(c.darkMode?"_dark":"_light");return(0,V.jsx)("pattern",{id:td.iF[u],width:8,height:8,patternUnits:"userSpaceOnUse",children:(0,V.jsx)("image",{href:c.url,width:8,height:8})},u)})});return{defs:w,isReady:f}}function PatternFillDefForCanvas(){let c=(0,tt.j)(),u=(0,K.useRef)(null),{defs:f,isReady:g}=usePattern();return(0,K.useEffect)(()=>{if(g&&c.environment.isSafari){let c=findHtmlLayerParent(u.current);c&&requestAnimationFrame(()=>{c.style.display="none",requestAnimationFrame(()=>{c.style.display=""})})}},[c,g]),(0,V.jsx)("g",{ref:u,children:f})}function findHtmlLayerParent(c){return c.classList.contains("tl-html-layer")?c:c.parentElement?findHtmlLayerParent(c.parentElement):null}function getPerfectDashProps(c,u,f={}){let{closed:g=!1,snap:b=1,start:v="outset",end:x="outset",lengthRatio:w=2,style:_="dashed"}=f,k=0,E=0,T=1,$=0,I=0;switch(_){case"dashed":T=1,k=Math.min(u*w,c/4);break;case"dotted":k=u/(T=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return g||("outset"===v?(c+=k/2,I+=k/2):"skip"===v&&(c-=k,I-=k),"outset"===x?c+=k/2:"skip"!==x||(c-=k)),E=Math.floor(c/k/(2*T)),(E-=E%b)<3&&"dashed"===_?c/u<5?(k=c,E=1,$=0):(k=.333*c,$=.333*c):(k=c/(E=Math.max(E,3))/(2*T),g?(I=k/2,$=(c-E*k)/E):$=(c-E*k)/Math.max(1,E-1)),{strokeDasharray:[k,$].join(" "),strokeDashoffset:I.toString()}}function useEditableText(c,u,f){let g=(0,tt.j)(),b=(0,K.useRef)(null),v=(0,K.useRef)(!1),x=(0,K.useRef)(),w=(0,e5.Hg)("isEditing",()=>g.editingShapeId===c,[g,c]);(0,K.useEffect)(()=>{let c=b.current;c&&w&&document.activeElement!==c&&c.focus()},[w]);let _=(0,K.useCallback)(()=>{let u=v.current;v.current=!1,requestAnimationFrame(()=>{let f=b.current;if(!f)return;let v=g.getShape(c);v&&(f.value=v.props.text,f.value.length&&!u&&f.select())})},[g,c]),k=(0,K.useCallback)(()=>{let u=x.current;requestAnimationFrame(()=>{let f=b.current,{editingShapeId:x}=g;if(f&&x){if(x===c){if(u){if(u.length){v.current=!0,f.focus();let c=window.getSelection();c&&u.forEach(u=>c.addRange(u))}else f.focus()}else f.focus()}}else window.getSelection()?.removeAllRanges(),g.complete()})},[g,c]),E=(0,K.useCallback)(c=>{if(w)switch((c.ctrlKey||c.metaKey)&&stopEventPropagation(c),c.key){case"Enter":(c.ctrlKey||c.metaKey)&&g.complete();break;case"Tab":preventDefault(c),c.shiftKey?TextHelpers.unindent(c.currentTarget):TextHelpers.indent(c.currentTarget)}},[g,w]),T=(0,K.useCallback)(f=>{if(!w)return;let b=TextHelpers.normalizeText(f.currentTarget.value),v=b.replace(/\t/g,"  ");if(v!==b){let c=f.currentTarget.selectionStart;f.currentTarget.value=v,f.currentTarget.selectionStart=c+(v.length-b.length),f.currentTarget.selectionEnd=c+(v.length-b.length),b=v}g.updateShapes([{id:c,type:u,props:{text:b}}])},[g,c,u,w]),$=0===f.trim().length;(0,K.useEffect)(()=>{if(!w)return;let c=b.current;if(c){let updateSelection2=function(){let c=window.getSelection?.();if(c&&"None"!==c.type){let u=[];if(c)for(let f=0;f<c.rangeCount;f++)u.push(c.getRangeAt?.(f));x.current=u}};return document.addEventListener("selectionchange",updateSelection2),()=>{document.removeEventListener("selectionchange",updateSelection2)}}},[w]);let I=(0,K.useCallback)(u=>{g.dispatch({...getPointerInfo(u),type:"pointer",name:"pointer_down",target:"shape",shape:g.getShape(c)}),stopEventPropagation(u)},[g,c]);return{rInput:b,isEditing:w,handleFocus:_,handleBlur:k,handleKeyDown:E,handleChange:T,handleInputPointerDown:I,handleDoubleClick:stopEventPropagation,isEmpty:$}}let iH=K.memo(function({id:c,text:u,size:f,font:g,position:b,width:v,labelColor:x}){let{rInput:w,isEditing:_,handleFocus:k,handleBlur:E,handleKeyDown:T,handleChange:$,isEmpty:I,handleInputPointerDown:M,handleDoubleClick:j}=useEditableText(c,"arrow",u),D=TextHelpers.normalizeTextForDom(u),L=D.trim().length>0;return _||L?(0,V.jsx)("div",{className:"tl-arrow-label","data-font":g,"data-align":"center","data-hastext":!I,"data-isediting":_,style:{textAlign:"center",fontSize:iR[f],lineHeight:iR[f]*iA.lineHeight+"px",transform:`translate(${b.x}px, ${b.y}px)`,color:x},children:(0,V.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,V.jsx)("p",{style:{width:v||"9px"},children:u?TextHelpers.normalizeTextForDom(u):" "}),_&&(0,V.jsx)("textarea",{ref:w,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:u,onFocus:k,onChange:$,onKeyDown:T,onBlur:E,onContextMenu:stopEventPropagation,onPointerDown:M,onDoubleClick:j})]})}):null}),iV=0;let ArrowShapeUtil=class ArrowShapeUtil extends nS.E{static type="arrow";static props=e8.si;static migrations=e8.Vm;canEdit=()=>!0;canBind=()=>!1;canSnap=()=>!1;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getGeometry(c){let u;let f=this.editor.getArrowInfo(c),g=f.isStraight?new nM.W({start:tl.G.From(f.start.point),end:tl.G.From(f.end.point)}):new Arc2d({center:tl.G.Cast(f.handleArc.center),radius:f.handleArc.radius,start:tl.G.Cast(f.start.point),end:tl.G.Cast(f.end.point),sweepFlag:f.bodyArc.sweepFlag,largeArcFlag:f.bodyArc.largeArcFlag});if(c.props.text.trim()){let b=g.bounds,{w:v,h:x}=this.editor.textMeasure.measureText(c.props.text,{...iA,fontFamily:iD[c.props.font],fontSize:iR[c.props.size],maxWidth:null}),w=v,_=x;if(b.width>b.height){w=Math.max(Math.min(v,64),Math.min(b.width-64,v));let{w:u,h:f}=this.editor.textMeasure.measureText(c.props.text,{...iA,fontFamily:iD[c.props.font],fontSize:iR[c.props.size],maxWidth:w});w=u,_=f}if(w>16*iR[c.props.size]){w=16*iR[c.props.size];let{w:u,h:f}=this.editor.textMeasure.measureText(c.props.text,{...iA,fontFamily:iD[c.props.font],fontSize:iR[c.props.size],maxWidth:w});w=u,_=f}u=new nv.z({x:f.middle.x-w/2-4.25,y:f.middle.y-_/2-4.25,width:w+8.5,height:_+8.5,isFilled:!0,isLabel:!0})}return new nj.m({children:u?[g,u]:[g],isSnappable:!1})}getHandles(c){let u=this.editor.getArrowInfo(c);return[{id:"start",type:"vertex",index:"a0",x:u.start.handle.x,y:u.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:u.middle.x,y:u.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:u.end.handle.x,y:u.end.handle.y,canBind:!0}]}onHandleChange=(c,{handle:u,isPrecise:f})=>{let g=u.id;if("middle"===g){let{start:f,end:g}=(0,nk.Qs)(this.editor,c),b=tl.G.Sub(g,f),v=tl.G.Per(b),x=tl.G.Med(g,f),w=tl.G.Sub(x,v),_=tl.G.Add(x,v),k=tl.G.NearestPointOnLineSegment(w,_,u,!1),E=tl.G.Dist(k,x);return tl.G.Clockwise(k,g,x)&&(E*=-1),{id:c.id,type:c.type,props:{bend:E}}}let b=(0,e4.p$)(c),v=this.editor.getShapePageTransform(b.id),x=v.applyToPoint(u);if(this.editor.inputs.ctrlKey)return b.props[g]={type:"point",x:u.x,y:u.y},b;let w=this.editor.getShapePageTransform(c.id).applyToPoint(u),_=this.editor.getShapeAtPoint(w,{hitInside:!0,hitFrameInside:!0,margin:0,filter:c=>!c.isLocked&&this.editor.getShapeUtil(c).canBind(c)});if(!_)return b.props[g]={type:"point",x:u.x,y:u.y},b;let k=this.editor.getShapeGeometry(_),E=nT.No.ZeroFix(k.bounds),T=this.editor.getPointInShapeSpace(_,x),$=f;if(!$){let c=b.props[g];("point"===c.type||"binding"===c.type&&_.id!==c.boundShapeId)&&($=.5>this.editor.inputs.pointerVelocity.len())}if($&&($=tl.G.Dist(T,E.center)>Math.max(4,Math.min(.15*Math.min(E.width,E.height),16))/this.editor.zoomLevel),!f){k.isClosed||($=!0);let c=b.props["start"===g?"end":"start"];"binding"===c.type&&_.id===c.boundShapeId&&tl.G.Equals(c.normalizedAnchor,{x:.5,y:.5})&&($=!0)}return b.props[g]={type:"binding",boundShapeId:_.id,normalizedAnchor:$?{x:(T.x-E.minX)/E.width,y:(T.y-E.minY)/E.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey},"binding"===b.props.start.type&&"binding"===b.props.end.type&&b.props.start.boundShapeId===b.props.end.boundShapeId&&tl.G.Equals(b.props.start.normalizedAnchor,b.props.end.normalizedAnchor)&&(b.props.end.normalizedAnchor.x+=.05),b};onTranslateStart=c=>{let u="binding"===c.props.start.type?c.props.start.boundShapeId:null,f="binding"===c.props.end.type?c.props.end.boundShapeId:null,{selectedShapeIds:g}=this.editor;if(u&&(g.includes(u)||this.editor.isAncestorSelected(u))||f&&(g.includes(f)||this.editor.isAncestorSelected(f)))return;let{start:b,end:v}=(0,nk.Qs)(this.editor,c);return{id:c.id,type:c.type,props:{...c.props,start:{type:"point",x:b.x,y:b.y},end:{type:"point",x:v.x,y:v.y}}}};onResize=(c,u)=>{let{scaleX:f,scaleY:g}=u,b=(0,nk.Qs)(this.editor,c),{start:v,end:x}=(0,e4.p$)(c.props),{bend:w}=c.props;"point"===v.type&&(v.x=b.start.x*f,v.y=b.start.y*g),"point"===x.type&&(x.x=b.end.x*f,x.y=b.end.y*g);let _=Math.abs(f),k=Math.abs(g);f<0&&g>=0?(0!==w&&(w*=-1*Math.max(_,k)),"binding"===v.type&&(v.normalizedAnchor.x=1-v.normalizedAnchor.x),"binding"===x.type&&(x.normalizedAnchor.x=1-x.normalizedAnchor.x)):f>=0&&g<0?(0!==w&&(w*=-1*Math.max(_,k)),"binding"===v.type&&(v.normalizedAnchor.y=1-v.normalizedAnchor.y),"binding"===x.type&&(x.normalizedAnchor.y=1-x.normalizedAnchor.y)):f>=0&&g>=0?0!==w&&(w*=Math.max(_,k)):f<0&&g<0&&(0!==w&&(w*=Math.max(_,k)),"binding"===v.type&&(v.normalizedAnchor.x=1-v.normalizedAnchor.x,v.normalizedAnchor.y=1-v.normalizedAnchor.y),"binding"===x.type&&(x.normalizedAnchor.x=1-x.normalizedAnchor.x,x.normalizedAnchor.y=1-x.normalizedAnchor.y));let E={props:{start:v,end:x,bend:w}};return E};onDoubleClickHandle=(c,u)=>{switch(u.id){case"start":return{id:c.id,type:c.type,props:{...c.props,arrowheadStart:"none"===c.props.arrowheadStart?"arrow":"none"}};case"end":return{id:c.id,type:c.type,props:{...c.props,arrowheadEnd:"none"===c.props.arrowheadEnd?"arrow":"none"}}}};component(c){let u=useDefaultColorTheme(),f=this.editor.onlySelectedShape,g=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.instanceState.isReadonly,b=this.editor.getArrowInfo(c),v=nT.No.ZeroFix(this.editor.getShapeGeometry(c).bounds),x=K.useMemo(()=>this.editor.environment.isSafari?iV+=1:0,[c]);if(!b?.isValid)return null;let w=iM[c.props.size],_=b.start.arrowhead&&getArrowheadPathForType(b,"start",w),k=b.end.arrowhead&&getArrowheadPathForType(b,"end",w),E=b.isStraight?(0,nC.N7)(b):(0,n_.t9)(b),T=null;if(f===c&&g){let{strokeDasharray:u,strokeDashoffset:f}=getPerfectDashProps(b.isStraight?tl.G.Dist(b.start.handle,b.end.handle):Math.abs(b.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});T="binding"===c.props.start.type||"binding"===c.props.end.type?(0,V.jsx)("path",{className:"tl-arrow-hint",d:b.isStraight?(0,nC.$w)(b):(0,n_.dz)(b),strokeDasharray:u,strokeDashoffset:f,strokeWidth:2,markerStart:"binding"===c.props.start.type?c.props.start.isExact?"":isPrecise(c.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===c.props.end.type?c.props.end.isExact?"":isPrecise(c.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}let{strokeDasharray:$,strokeDashoffset:I}=getPerfectDashProps(b.isStraight?b.length:Math.abs(b.bodyArc.length),w,{style:c.props.dash}),M=c.props.text.trim()?this.editor.getShapeGeometry(c).children[1]:null,j=!("none"===b.start.arrowhead||"arrow"===b.start.arrowhead),D=!("none"===b.end.arrowhead||"arrow"===b.end.arrowhead),L=(c.id+"_clip_"+x).replace(":","_");return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(nm.g,{id:c.id,style:{minWidth:50,minHeight:50},children:[(0,V.jsx)("defs",{children:(0,V.jsxs)("mask",{id:L,children:[(0,V.jsx)("rect",{x:(0,ts.$Z)(-100+v.minX),y:(0,ts.$Z)(-100+v.minY),width:(0,ts.$Z)(v.width+200),height:(0,ts.$Z)(v.height+200),fill:"white"}),M&&(0,V.jsx)("rect",{x:M.x,y:M.y,width:M.w,height:M.h,fill:"black",rx:4,ry:4}),_&&j&&(0,V.jsx)("path",{d:_,fill:"arrow"===b.start.arrowhead?"none":"black",stroke:"none"}),k&&D&&(0,V.jsx)("path",{d:k,fill:"arrow"===b.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,V.jsxs)("g",{fill:"none",stroke:u[c.props.color].solid,strokeWidth:w,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[T,(0,V.jsxs)("g",{mask:`url(#${L})`,children:[(0,V.jsx)("rect",{x:(0,ts.$Z)(v.minX-100),y:(0,ts.$Z)(v.minY-100),width:(0,ts.$Z)(v.width+200),height:(0,ts.$Z)(v.height+200),opacity:0}),(0,V.jsx)("path",{d:E,strokeDasharray:$,strokeDashoffset:I})]}),_&&j&&"none"!==c.props.fill&&(0,V.jsx)(iU,{theme:u,d:_,color:c.props.color,fill:c.props.fill}),k&&D&&"none"!==c.props.fill&&(0,V.jsx)(iU,{theme:u,d:k,color:c.props.color,fill:c.props.fill}),_&&(0,V.jsx)("path",{d:_}),k&&(0,V.jsx)("path",{d:k})]})]}),(0,V.jsx)(iH,{id:c.id,text:c.props.text,font:c.props.font,size:c.props.size,position:b.middle,width:M?.w??0,labelColor:u[c.props.labelColor].solid})]})}indicator(c){let{start:u,end:f}=(0,nk.Qs)(this.editor,c),g=this.editor.getArrowInfo(c),b=this.editor.getShapeGeometry(c),v=b.bounds,x=c.props.text.trim()?b.children[1]:null,w=useIsEditing(c.id);if(!g||tl.G.Equals(u,f))return null;let _=iM[c.props.size],k=g.start.arrowhead&&getArrowheadPathForType(g,"start",_),E=g.end.arrowhead&&getArrowheadPathForType(g,"end",_),T=g.isStraight?(0,nC.N7)(g):(0,n_.t9)(g),$=k&&"arrow"!==g.start.arrowhead||E&&"arrow"!==g.end.arrowhead||!!x,I=(c.id+"_clip").replace(":","_");return w&&x?(0,V.jsx)("rect",{x:(0,ts.$Z)(x.x),y:(0,ts.$Z)(x.y),width:x.w,height:x.h,rx:3.5,ry:3.5}):(0,V.jsxs)("g",{children:[$&&(0,V.jsx)("defs",{children:(0,V.jsxs)("mask",{id:I,children:[(0,V.jsx)("rect",{x:v.minX-100,y:v.minY-100,width:v.w+200,height:v.h+200,fill:"white"}),x&&(0,V.jsx)("rect",{x:(0,ts.$Z)(x.x),y:(0,ts.$Z)(x.y),width:x.w,height:x.h,fill:"black",rx:3.5,ry:3.5}),k&&(0,V.jsx)("path",{d:k,fill:"arrow"===g.start.arrowhead?"none":"black",stroke:"none"}),E&&(0,V.jsx)("path",{d:E,fill:"arrow"===g.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,V.jsxs)("g",{...$?{mask:`url(#${I})`}:void 0,children:[$&&(0,V.jsx)("rect",{x:v.minX-100,y:v.minY-100,width:v.width+200,height:v.height+200,opacity:0}),(0,V.jsx)("path",{d:T})]}),k&&(0,V.jsx)("path",{d:k}),E&&(0,V.jsx)("path",{d:E}),x&&(0,V.jsx)("rect",{x:(0,ts.$Z)(x.x),y:(0,ts.$Z)(x.y),width:x.w,height:x.h,rx:3.5,ry:3.5})]})}onEditEnd=c=>{let{id:u,type:f,props:{text:g}}=c;g.trimEnd()!==c.props.text&&this.editor.updateShapes([{id:u,type:f,props:{text:g.trimEnd()}}])};toSvg(c,u){let f=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode});u.addExportDef(getFillDefForExport(c.props.fill,f));let g=f[c.props.color].solid,b=this.editor.getArrowInfo(c),v=iM[c.props.size],x=document.createElementNS("http://www.w3.org/2000/svg","g");if(!b)return x;let w=b.start.arrowhead&&getArrowheadPathForType(b,"start",v),_=b.end.arrowhead&&getArrowheadPathForType(b,"end",v),k=this.editor.getShapeGeometry(c),E=k.bounds,T=c.props.text.trim()?k.children[1]:null,$=(c.id+"_clip").replace(":","_");if(w||_||T){let c=document.createElementNS("http://www.w3.org/2000/svg","defs"),u=document.createElementNS("http://www.w3.org/2000/svg","mask");u.id=$;let f=document.createElementNS("http://www.w3.org/2000/svg","rect");if(f.setAttribute("x",E.minX-100+""),f.setAttribute("y",E.minY-100+""),f.setAttribute("width",E.width+200+""),f.setAttribute("height",E.height+200+""),f.setAttribute("fill","white"),u.appendChild(f),w&&u.appendChild(getArrowheadSvgMask(w,b.start.arrowhead)),_&&u.appendChild(getArrowheadSvgMask(_,b.end.arrowhead)),T){let c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x",T.x+""),c.setAttribute("y",T.y+""),c.setAttribute("width",T.w+""),c.setAttribute("height",T.h+""),c.setAttribute("fill","black"),u.appendChild(c)}c.appendChild(u),x.appendChild(c)}let I=document.createElementNS("http://www.w3.org/2000/svg","g");I.setAttribute("mask",`url(#${$})`),x.appendChild(I);let M=document.createElementNS("http://www.w3.org/2000/svg","rect");M.setAttribute("x","-100"),M.setAttribute("y","-100"),M.setAttribute("width",E.width+200+""),M.setAttribute("height",E.height+200+""),M.setAttribute("fill","transparent"),M.setAttribute("stroke","none"),I.appendChild(M);let j=getArrowSvgPath(b.isStraight?(0,nC.N7)(b):(0,n_.t9)(b),g,v),{strokeDasharray:D,strokeDashoffset:L}=getPerfectDashProps(b.isStraight?b.length:Math.abs(b.bodyArc.length),v,{style:c.props.dash});if(j.setAttribute("stroke-dasharray",D),j.setAttribute("stroke-dashoffset",L),I.appendChild(j),w&&x.appendChild(getArrowheadSvgPath(w,c.props.color,v,"arrow"===c.props.arrowheadStart?"none":c.props.fill,f)),_&&x.appendChild(getArrowheadSvgPath(_,c.props.color,v,"arrow"===c.props.arrowheadEnd?"none":c.props.fill,f)),T){u.addExportDef(getFontDefForExport(c.props.font));let g={fontSize:iR[c.props.size],lineHeight:iA.lineHeight,fontFamily:e8.p6[c.props.font],padding:0,textAlign:"middle",width:T.w-8,verticalTextAlign:"middle",height:T.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},b=createTextSvgElementFromSpans(this.editor,this.editor.textMeasure.measureTextSpans(c.props.text,g),g);b.setAttribute("fill",f[c.props.labelColor].solid);let v=Array.from(b.children);v.forEach(c=>{let u=parseFloat(c.getAttribute("x")||"0"),f=parseFloat(c.getAttribute("y")||"0");c.setAttribute("x",u+4+T.x+"px"),c.setAttribute("y",f+T.y+"px")});let w=b.cloneNode(!0);w.setAttribute("stroke-width","2"),w.setAttribute("fill",f.background),w.setAttribute("stroke",f.background),x.appendChild(w),x.appendChild(b)}return x}getCanvasSvgDefs(){return[getFillDefForCanvas()]}};function getArrowheadSvgMask(c,u){let f=document.createElementNS("http://www.w3.org/2000/svg","path");return f.setAttribute("d",c),f.setAttribute("fill","arrow"===u?"none":"black"),f.setAttribute("stroke","none"),f}function getArrowSvgPath(c,u,f){let g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("d",c),g.setAttribute("fill","none"),g.setAttribute("stroke",u),g.setAttribute("stroke-width",f+""),g}function getArrowheadSvgPath(c,u,f,g,b){let v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",c),v.setAttribute("fill","none"),v.setAttribute("stroke",b[u].solid),v.setAttribute("stroke-width",f+"");let x=getShapeFillSvg({d:c,fill:g,color:u,theme:b});if(!x)return v;{let c=document.createElementNS("http://www.w3.org/2000/svg","g");return c.appendChild(x),c.appendChild(v),c}}function isPrecise(c){return .5!==c.x||.5!==c.y}let iW=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function getRotatedBoxShadow(c){let u=iW.map(u=>{let{offsetX:f,offsetY:g,blur:b,spread:v,color:x}=u,w=new tl.G(f,g),{x:_,y:k}=w.rot(-c);return`${_}px ${k}px ${b}px ${v}px ${x}`});return u.join(", ")}let iK="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function HyperlinkButton({url:c,zoomLevel:u}){return(0,V.jsx)("a",{className:e2("tl-hyperlink-button",{"tl-hyperlink-button__hidden":u<.32}),href:c,target:"_blank",rel:"noopener noreferrer",onPointerDown:stopEventPropagation,onPointerUp:stopEventPropagation,title:c,draggable:!1,children:(0,V.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${iK}") center 100% / 100% no-repeat`,WebkitMask:`url("${iK}") center 100% / 100% no-repeat`}})})}let BookmarkShapeUtil=class BookmarkShapeUtil extends BaseBoxShapeUtil{static type="bookmark";static props=e8.qU;static migrations=e8.h9;canResize=()=>!1;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(c){let u=c.props.assetId?this.editor.getAsset(c.props.assetId):null,f=this.editor.getShapePageTransform(c).rotation(),g=getHumanReadableAddress(c);return(0,V.jsx)(HTMLContainer,{children:(0,V.jsxs)("div",{className:"tl-bookmark__container",style:{boxShadow:getRotatedBoxShadow(f)},children:[(0,V.jsxs)("div",{className:"tl-bookmark__image_container",children:[u?.props.image?(0,V.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:u?.props.image,alt:u?.props.title||""}):(0,V.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,V.jsx)(HyperlinkButton,{url:c.props.url,zoomLevel:this.editor.zoomLevel})]}),(0,V.jsxs)("div",{className:"tl-bookmark__copy_container",children:[u?.props.title&&(0,V.jsx)("h2",{className:"tl-bookmark__heading",children:truncateStringWithEllipsis(u?.props.title||"",54)}),u?.props.description&&(0,V.jsx)("p",{className:"tl-bookmark__description",children:truncateStringWithEllipsis(u?.props.description||"",128)}),(0,V.jsx)("a",{className:"tl-bookmark__link",href:c.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:stopEventPropagation,onPointerUp:stopEventPropagation,onClick:stopEventPropagation,children:truncateStringWithEllipsis(g,45)})]})]})})}indicator(c){return(0,V.jsx)("rect",{width:(0,ts.$Z)(c.props.w),height:(0,ts.$Z)(c.props.h),rx:"8",ry:"8"})}onBeforeCreate=c=>{updateBookmarkAssetOnUrlChange(this.editor,c)};onBeforeUpdate=(c,u)=>{if(c.props.url!==u.props.url){if(!(0,e4.jv)(u.props.url))return{...u,props:{...u.props,url:c.props.url}};updateBookmarkAssetOnUrlChange(this.editor,u)}}};let getHumanReadableAddress=c=>{try{let u=new URL(c.props.url),f=u.pathname.replace(/\/*$/,"");return`${u.hostname}${f}`}catch(u){return c.props.url}};function updateBookmarkAssetOnUrlChange(c,u){let{url:f}=u.props,g=e8.Yk.createId((0,e4.jK)(f));c.getAsset(g)?u.props.assetId!==g&&c.updateShapes([{id:u.id,type:u.type,props:{assetId:g}}]):(c.updateShapes([{id:u.id,type:u.type,props:{assetId:null}}]),iZ(c,u))}let iZ=(0,e4.Ds)(async(c,u)=>{let{url:f}=u.props,g=await c.getAssetForExternalContent({type:"url",url:f});g&&c.batch(()=>{c.createAssets([g]),c.updateShapes([{id:u.id,type:u.type,props:{assetId:g.id}}])})},500);function getSvgPathFromStrokePoints(c,u=!1){let f=c.length;if(f<2)return"";let g=c[0].point,b=c[1].point;if(2===f)return`M${(0,ts.Yk)(g)}L${(0,ts.Yk)(b)}`;let v="";for(let u=2,x=f-1;u<x;u++)g=c[u].point,b=c[u+1].point,v+=(0,ts.Y8)(g,b);return u?`M${(0,ts.Y8)(c[0].point,c[1].point)}Q${(0,ts.Yk)(c[1].point)}${(0,ts.Y8)(c[1].point,c[2].point)}T${v}${(0,ts.Y8)(c[f-1].point,c[0].point)}${(0,ts.Y8)(c[0].point,c[1].point)}Z`:`M${(0,ts.Yk)(c[0].point)}Q${(0,ts.Yk)(c[1].point)}${(0,ts.Y8)(c[1].point,c[2].point)}${c.length>3?"T":""}${v}L${(0,ts.Yk)(c[f-1].point)}`}function useForceSolid(){let c=(0,tt.j)();return(0,e5.Hg)("zoom",()=>c.zoomLevel<.35,[c])}let PEN_EASING=c=>.65*c+.35*(0,ts.dv)(c*ts.PI/2),simulatePressureSettings=c=>({size:1+c,thinning:.5,streamline:.62+(1+c)/8*.06,smoothing:.62,easing:n$.L.easeOutSine,simulatePressure:!0}),realPressureSettings=c=>({size:1+1.2*c,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:PEN_EASING}),solidSettings=c=>({size:1+c,thinning:0,streamline:.62+(1+c)/8*.06,smoothing:.62,simulatePressure:!1,easing:n$.L.linear});function getHighlightFreehandSettings({strokeWidth:c,showAsComplete:u}){return{size:1+c,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:n$.L.easeOutSine,last:u}}function getFreehandOptions(c,u,f,g){return{...g?solidSettings(u):"draw"===c.dash?c.isPen?realPressureSettings(u):simulatePressureSettings(u):solidSettings(u),last:c.isComplete||f}}function getPointsFromSegments(c){let u=[];for(let f of c)if("free"===f.type||f.points.length<2)u.push(...f.points.map(tl.G.Cast));else{let c=Math.max(4,Math.floor(tl.G.Dist(f.points[0],f.points[1])/16));u.push(...tl.G.PointsBetween(f.points[0],f.points[1],c))}return u}function getDrawShapeStrokeDashArray(c,u){return({draw:"none",solid:"none",dotted:`0.1 ${2*u}`,dashed:`${2*u} ${2*u}`})[c.props.dash]}let DrawShapeUtil=class DrawShapeUtil extends nS.E{static type="draw";static props=e8.wu;static migrations=e8._l;hideResizeHandles=c=>getIsDot(c);hideRotateHandle=c=>getIsDot(c);hideSelectionBoundsFg=c=>getIsDot(c);getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(c){let u=getPointsFromSegments(c.props.segments),f=iM[c.props.size];if(1===c.props.segments.length){let c=nT.No.FromPoints(u);if(c.width<2*f&&c.height<2*f)return new Circle2d({x:-f,y:-f,radius:f,isFilled:!0})}let g=getStrokePoints(u,getFreehandOptions(c.props,f,!0,!0)).map(c=>c.point);return c.props.isClosed?new nO.w({points:g,isFilled:"none"!==c.props.fill}):new nA.q({points:g})}component(c){let u=useDefaultColorTheme(),f=useForceSolid(),g=iM[c.props.size],b=getPointsFromSegments(c.props.segments),v=c.props.isComplete||e4.Z$(c.props.segments)?.type==="straight",x=g;f||c.props.isPen||"draw"!==c.props.dash||1!==b.length||(x+=(0,e4.Vk)(c.id)()*(g/6));let w=getFreehandOptions(c.props,x,v,f),_=getStrokePoints(b,w),k=_.length>1?getSvgPathFromStrokePoints(_,c.props.isClosed):getDot(b[0],x);if(!f&&"draw"===c.props.dash||_.length<2){setStrokePointRadii(_,w);let f=getStrokeOutlinePoints_getStrokeOutlinePoints(_,w);return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{theme:u,fill:c.props.isClosed?c.props.fill:"none",color:c.props.color,d:k}),(0,V.jsx)("path",{d:getSvgPathFromPoints_getSvgPathFromPoints(f,!0),strokeLinecap:"round",fill:u[c.props.color].solid})]})}return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{theme:u,color:c.props.color,fill:c.props.isClosed?c.props.fill:"none",d:k}),(0,V.jsx)("path",{d:k,strokeLinecap:"round",fill:"none",stroke:u[c.props.color].solid,strokeWidth:g,strokeDasharray:getDrawShapeStrokeDashArray(c,g),strokeDashoffset:"0"})]})}indicator(c){let u=useForceSolid(),f=iM[c.props.size],g=getPointsFromSegments(c.props.segments),b=f;u||c.props.isPen||"draw"!==c.props.dash||1!==g.length||(b+=(0,e4.Vk)(c.id)()*(f/6));let v=c.props.isComplete||e4.Z$(c.props.segments)?.type==="straight",x=getFreehandOptions(c.props,b,v,!0),w=getStrokePoints(g,x),_=w.length>1?getSvgPathFromStrokePoints(w,c.props.isClosed):getDot(g[0],b);return(0,V.jsx)("path",{d:_})}toSvg(c,u){let f;let g=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode});u.addExportDef(getFillDefForExport(c.props.fill,g));let{color:b}=c.props,v=iM[c.props.size],x=getPointsFromSegments(c.props.segments),w=c.props.isComplete||e4.Z$(c.props.segments)?.type==="straight",_=v;c.props.isPen||"draw"!==c.props.dash||1!==x.length||(_+=(0,e4.Vk)(c.id)()*(v/6));let k=getFreehandOptions(c.props,_,w,!1),E=getStrokePoints(x,k),T=E.length>1?getSvgPathFromStrokePoints(E,c.props.isClosed):getDot(x[0],_);if("draw"===c.props.dash||E.length<2){setStrokePointRadii(E,k);let c=getStrokeOutlinePoints_getStrokeOutlinePoints(E,k),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",getSvgPathFromPoints_getSvgPathFromPoints(c,!0)),u.setAttribute("fill",g[b].solid),u.setAttribute("stroke-linecap","round"),f=u}else{let u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",T),u.setAttribute("stroke",g[b].solid),u.setAttribute("fill","none"),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-width",v.toString()),u.setAttribute("stroke-dasharray",getDrawShapeStrokeDashArray(c,v)),u.setAttribute("stroke-dashoffset","0"),f=u}let $=getShapeFillSvg({fill:c.props.isClosed?c.props.fill:"none",d:T,color:c.props.color,theme:g});if($){let c=document.createElementNS("http://www.w3.org/2000/svg","g");return c.appendChild($),c.appendChild(f),c}return f}getCanvasSvgDefs(){return[getFillDefForCanvas()]}onResize=(c,u)=>{let{scaleX:f,scaleY:g}=u,b=[];for(let u of c.props.segments)b.push({...u,points:u.points.map(({x:c,y:u,z:b})=>({x:(0,ts.FH)(f*c),y:(0,ts.FH)(g*u),z:b}))});return{props:{segments:b}}};expandSelectionOutlinePx(c){let u="draw"===c.props.dash?1.6:1;return iM[c.props.size]*u/2}};function getDot(c,u){let f=(u+1)*.5;return`M ${c.x} ${c.y} m -${f}, 0 a ${f},${f} 0 1,0 ${2*f},0 a ${f},${f} 0 1,0 -${2*f},0`}function getIsDot(c){return 1===c.props.segments.length&&c.props.segments[0].points.length<2}function resizeBox_resizeBox(c,u,f={}){let{newPoint:g,handle:b,scaleX:v,scaleY:x}=u,{minWidth:w=1,maxWidth:_=1/0,minHeight:k=1,maxHeight:E=1/0}=f,T=c.props.w*v,$=c.props.h*x,I=new tl.G(0,0);if(T>0){if(T<w){switch(b){case"top_left":case"left":case"bottom_left":I.x=T-w;break;case"top":case"bottom":I.x=(T-w)/2;break;default:I.x=0}T=w}}else if(I.x=T,(T=-T)<w){switch(b){case"top_left":case"left":case"bottom_left":I.x=-T;break;default:I.x=-w}T=w}if($>0){if($<k){switch(b){case"top_left":case"top":case"top_right":I.y=$-k;break;case"right":case"left":I.y=($-k)/2;break;default:I.y=0}$=k}}else if(I.y=$,($=-$)<k){switch(b){case"top_left":case"top":case"top_right":I.y=-$;break;default:I.y=-k}$=k}let{x:M,y:j}=I.rot(c.rotation).add(g);return{x:M,y:j,props:{w:Math.min(_,T),h:Math.min(E,$)}}}let getSandboxPermissions=c=>Object.entries(c).filter(([c,u])=>u).map(([c])=>c).join(" ");let EmbedShapeUtil=class EmbedShapeUtil extends BaseBoxShapeUtil{static type="embed";static props=e8.DW;static migrations=e8.BF;hideSelectionBoundsFg=c=>!this.canResize(c);canEdit=()=>!0;canUnmount=c=>!!getEmbedInfo(c.props.url)?.definition?.canUnmount;canResize=c=>!!getEmbedInfo(c.props.url)?.definition?.doesResize;canEditInReadOnly=()=>!0;getDefaultProps(){return{w:300,h:300,url:""}}isAspectRatioLocked=c=>{let u=getEmbedInfo(c.props.url);return u?.definition.isAspectRatioLocked??!1};onResize=(c,u)=>{let f=this.isAspectRatioLocked(c),g=getEmbedInfo(c.props.url),b=g?.definition.minWidth??200,v=g?.definition.minHeight??200;if(f){let u=c.props.w/c.props.h;u>1?b*=u:v/=u}return resizeBox_resizeBox(c,u,{minWidth:b,minHeight:v})};component(c){let{w:u,h:f,url:g}=c.props,b=useIsEditing(c.id),v=(0,K.useMemo)(()=>getEmbedInfoUnsafely(g),[g]),x=(0,e5.Hg)("is hovering",()=>{let{editingShapeId:c,hoveredShapeId:u}=this.editor.currentPageState;if(c&&u!==c){let u=this.editor.getShape(c);if(u&&this.editor.isShapeOfType(u,"embed"))return!0}return!1},[]),w=this.editor.getShapePageTransform(c).rotation(),_=b||x;if(v?.definition.type==="github_gist"){let g=v.url.split("/").pop();if(!g)throw Error("No gist id!");return(0,V.jsx)(HTMLContainer,{className:"tl-embed-container",id:c.id,children:(0,V.jsx)(Gist,{id:g,width:(0,ts.$Z)(u),height:(0,ts.$Z)(f),isInteractive:_,pageRotation:w})})}let k=getSandboxPermissions({...e8.gB,...v?.definition.overridePermissions??{}});return(0,V.jsx)(HTMLContainer,{className:"tl-embed-container",id:c.id,children:v?.definition?(0,V.jsx)("iframe",{className:"tl-embed",sandbox:k,src:v.embedUrl,width:(0,ts.$Z)(u),height:(0,ts.$Z)(f),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:_?"auto":"none",zIndex:_?"":"-1",boxShadow:getRotatedBoxShadow(w),borderRadius:v?.definition.overrideOutlineRadius??8,background:v?.definition.backgroundColor}}):null})}indicator(c){let u=(0,K.useMemo)(()=>getEmbedInfo(c.props.url),[c.props.url]);return(0,V.jsx)("rect",{width:(0,ts.$Z)(c.props.w),height:(0,ts.$Z)(c.props.h),rx:u?.definition.overrideOutlineRadius??8,ry:u?.definition.overrideOutlineRadius??8})}};function Gist({id:c,file:u,isInteractive:f,width:g,height:b,style:v,pageRotation:x}){return(0,V.jsx)("iframe",{className:"tl-embed",draggable:!1,width:(0,ts.$Z)(g),height:(0,ts.$Z)(b),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...v,pointerEvents:f?"all":"none",zIndex:f?"":"-1",boxShadow:getRotatedBoxShadow(x)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=https://gist.github.com/${c}.js${u?`?file=${u}`:""}></script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}let iY=(0,K.forwardRef)(({id:c,name:u,isEditing:f},g)=>{let b=(0,tt.j)(),v=(0,K.useCallback)(c=>{"Enter"!==c.key||c.nativeEvent.isComposing||(stopEventPropagation(c),c.currentTarget.blur(),b.setEditingShape(null))},[b]),x=(0,K.useCallback)(u=>{let f=b.getShape(c);if(!f)return;let g=f.props.name,v=u.currentTarget.value.trim();g!==v&&b.updateShapes([{id:c,type:"frame",props:{name:v}}],{squashing:!0})},[c,b]),w=(0,K.useCallback)(u=>{let f=b.getShape(c);if(!f)return;let g=f.props.name,v=u.currentTarget.value;g!==v&&b.updateShapes([{id:c,type:"frame",props:{name:v}}],{squashing:!0})},[c,b]);return(0,V.jsxs)("div",{className:`tl-frame-label ${f?"tl-frame-label__editing":""}`,children:[(0,V.jsx)("input",{className:"tl-frame-name-input",ref:g,style:{display:f?void 0:"none"},value:u,autoFocus:!0,onKeyDown:v,onBlur:x,onChange:w}),defaultEmptyAs(u,"Frame")+String.fromCharCode(8203)]})}),FrameHeading=function({id:c,name:u,width:f,height:g}){let b;let v=(0,tt.j)(),x=(0,ts.f5)(v.getShapePageTransform(c).rotation()),w=useIsEditing(c),_=(0,K.useRef)(null),k=(0,K.useCallback)(u=>{let f=getPointerInfo(u);v.editingShapeId!==c&&(v.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:v.getShape(c),...f}),u.preventDefault())},[v,c]);(0,K.useEffect)(()=>{let c=_.current;c&&w&&(c.focus(),c.select(),requestAnimationFrame(()=>{document.activeElement!==c&&(c.focus(),c.select())}))},[_,w]);let E=["top","left","bottom","right"][Math.floor(((x+Math.PI/4)*(2/Math.PI)+4)%4)];switch(E){case"top":b="";break;case"right":b=`translate(${(0,ts.$Z)(f)}px, 0px) rotate(90deg)`;break;case"bottom":b=`translate(${(0,ts.$Z)(f)}px, ${(0,ts.$Z)(g)}px) rotate(180deg)`;break;case"left":b=`translate(0px, ${(0,ts.$Z)(g)}px) rotate(270deg)`}return(0,V.jsx)("div",{className:"tl-frame-heading",style:{overflow:w?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${"top"===E||"bottom"===E?Math.ceil(f):Math.ceil(g)}px + var(--space-5))`,bottom:"100%",transform:`${b} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:k,children:(0,V.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,V.jsx)(iY,{ref:_,id:c,name:u,isEditing:w})})})};function defaultEmptyAs(c,u){return c.match(/^\s*$/)?u:c}let FrameShapeUtil=class FrameShapeUtil extends BaseBoxShapeUtil{static type="frame";static props=e8.k7;static migrations=e8.gR;canBind=()=>!0;canEdit=()=>!0;getDefaultProps(){return{w:320,h:180,name:""}}getGeometry(c){return new nv.z({width:c.props.w,height:c.props.h,isFilled:!1})}component(c){let u=this.editor.getShapeGeometry(c).bounds,f=useDefaultColorTheme();return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(nm.g,{children:(0,V.jsx)("rect",{className:"tl-frame__body",width:u.width,height:u.height,fill:f.solid,stroke:f.text})}),(0,V.jsx)(FrameHeading,{id:c.id,name:c.props.name,width:u.width,height:u.height})]})}toSvg(c){let u;let f=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode}),g=document.createElementNS("http://www.w3.org/2000/svg","g"),b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("width",c.props.w.toString()),b.setAttribute("height",c.props.h.toString()),b.setAttribute("fill",f.solid),b.setAttribute("stroke",f.black.solid),b.setAttribute("stroke-width","1"),b.setAttribute("rx","1"),b.setAttribute("ry","1"),g.appendChild(b);let v=(0,ts.f5)(this.editor.getShapePageTransform(c.id).rotation()),x=["top","left","bottom","right"][Math.floor(((v+Math.PI/4)*(2/Math.PI)+4)%4)];switch(x){case"top":default:u="";break;case"right":u=`translate(${(0,ts.$Z)(c.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":u=`translate(${(0,ts.$Z)(c.props.w)}px, ${(0,ts.$Z)(c.props.h)}px) rotate(180deg)`;break;case"left":u=`translate(0px, ${(0,ts.$Z)(c.props.h)}px) rotate(270deg)`}let w={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:c.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},_=this.editor.textMeasure.measureTextSpans(defaultEmptyAs(c.props.name,"Frame")+String.fromCharCode(8203),w),k=_[0],E=(0,e4.Z$)(_),T=E.box.w+E.box.x-k.box.x,$=createTextSvgElementFromSpans(this.editor,_,{offsetY:-w.height-2,...w});$.style.setProperty("transform",u);let I=document.createElementNS("http://www.w3.org/2000/svg","rect");return I.setAttribute("x","-8px"),I.setAttribute("y",-w.height-4+"px"),I.setAttribute("width",T+16+"px"),I.setAttribute("height",`${w.height}px`),I.setAttribute("rx","4px"),I.setAttribute("ry","4px"),I.setAttribute("fill",f.background),g.appendChild(I),g.appendChild($),g}indicator(c){let u=this.editor.getShapeGeometry(c).bounds;return(0,V.jsx)("rect",{width:(0,ts.$Z)(u.width),height:(0,ts.$Z)(u.height),className:"tl-frame-indicator"})}canReceiveNewChildrenOfType=(c,u)=>!c.isLocked;providesBackgroundForChildren(){return!0}canDropShapes=(c,u)=>!c.isLocked;onDragShapesOver=(c,u)=>u.every(u=>u.parentId===c.id)?{shouldHint:!1}:(this.editor.reparentShapes(u.map(c=>c.id),c.id),{shouldHint:!0});onDragShapesOut=(c,u)=>{let f=this.editor.getShape(c.parentId),g=f&&this.editor.isShapeOfType(f,"group");g?this.editor.reparentShapes(u,f.id):this.editor.reparentShapes(u,this.editor.currentPageId)};onResizeEnd=c=>{let u=this.editor.getShapePageBounds(c),f=this.editor.getSortedChildIdsForParent(c.id),g=[];for(let c of f){let f=this.editor.getShapePageBounds(c);u.includes(f)||g.push(c)}g.length>0&&this.editor.reparentShapes(g,this.editor.currentPageId)}};function getLegacyOffsetX(c,u,f,g){if(("start-legacy"===c||"end-legacy"===c)&&0!==f.length){let b=nT.No.From(f[0].box);for(let{box:c}of f)b.union(c);if("start-legacy"===c)return(g-2*u-b.width)/2;if("end-legacy"===c)return-(g-2*u-b.width)/2}}function isLegacyAlign(c){return"start-legacy"===c||"middle-legacy"===c||"end-legacy"===c}let iq=K.memo(function({id:c,type:u,text:f,size:g,labelColor:b,font:v,align:x,verticalAlign:w,wrap:_,bounds:k}){let{rInput:E,isEmpty:T,isEditing:$,handleFocus:I,handleChange:M,handleKeyDown:j,handleBlur:D,handleInputPointerDown:L,handleDoubleClick:F}=useEditableText(c,u,f),B=TextHelpers.normalizeTextForDom(f),G=B.length>0,U=isLegacyAlign(x),K=useDefaultColorTheme();return $||G?(0,V.jsx)("div",{className:"tl-text-label","data-font":v,"data-align":x,"data-hastext":!T,"data-isediting":$,"data-textwrap":!!_,style:{justifyContent:"middle"===x||U?"center":x,alignItems:"middle"===w?"center":w,...k?{top:k.minY,left:k.minX,width:k.width,height:k.height,position:"absolute"}:{}},children:(0,V.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:iO[g],lineHeight:iO[g]*iA.lineHeight+"px",minHeight:iA.lineHeight+32,minWidth:0,color:K[b].solid},children:[(0,V.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:B}),$&&(0,V.jsx)("textarea",{ref:E,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:f,onFocus:I,onChange:M,onKeyDown:j,onBlur:D,onContextMenu:stopEventPropagation,onPointerDown:L,onDoubleClick:F})]})}):null});function getTextLabelSvgElement({bounds:c,editor:u,font:f,shape:g}){let b={fontSize:iO[g.props.size],fontFamily:f,textAlign:g.props.align,verticalTextAlign:g.props.verticalAlign,width:Math.ceil(c.width),height:Math.ceil(c.height),padding:16,lineHeight:iA.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},v=u.textMeasure.measureTextSpans(g.props.text,b),x=getLegacyOffsetX(g.props.align,16,v,c.width);x&&(b.offsetX=x);let w=createTextSvgElementFromSpans(u,v,b);return w}function precise(c){return`${(0,ts.$Z)(c.x)},${(0,ts.$Z)(c.y)} `}function rng(c=""){let u=0,f=0,g=0,b=0;function next(){let c=u^u<<11;return u=f,f=g,g=b,(b^=(b>>>19^c^c>>>8)>>>0)/4294967296*2}for(let f=0;f<c.length+64;f++)u^=0|c.charCodeAt(f),next();return next}function getRoundedInkyPolygonPath(c){let u,f,g,b="M",v=c.length;for(let x=0;x<v;x+=3)u=c[x],f=c[x+1],g=c[x+2],b+=`${precise(u)}L${precise(f)}Q${precise(g)}`;return b+`${precise(c[0])}`}function getRoundedPolygonPoints(c,u,f,g,b){let v;let x=[],w=rng(c),_=u[0],k=u.length;for(let c=0,E=k*b;c<E;c++){v=tl.G.AddXY(u[(c+1)%k],w()*f,w()*f);let b=tl.G.Sub(v,_),E=tl.G.Len(b),T=tl.G.Div(b,E).mul(Math.min(E/4,g));x.push(tl.G.Add(_,T),tl.G.Add(v,T.neg()),v),_=v}return x}function getDrawLinePathData(c,u,f){let g,b,v=`M ${precise(u[0])}L`,x=`M ${precise(u[0])}L`,w=f/3,_=2*f,k=rng(c),E=u[0],T=u[0],$=u.length;for(let c=0,f=$-1;c<f;c++){g=u[c+1],b=tl.G.AddXY(u[c+1],k()*w,k()*w);let $=tl.G.Sub(g,E),I=tl.G.Len($),M=tl.G.Div($,I).mul(Math.min(I/4,_)),j=tl.G.Add(E,M),D=tl.G.Add(g,M.neg()),L=tl.G.Sub(b,T),F=tl.G.Len(L),B=tl.G.Div(L,F).mul(Math.min(F/4,_)),G=tl.G.Add(T,B),U=tl.G.Add(b,B.neg());c===f-1?(v+=`${precise(j)}L ${precise(g)}`,x+=`${precise(G)}L ${precise(b)}`):(v+=`${precise(j)}L ${precise(D)}Q ${precise(g)}`,x+=`${precise(G)}L ${precise(U)}Q ${precise(b)}`,E=g,T=b)}return[v,v+x]}function getPillCircumference(c,u){let f=Math.min(c,u)/2;return Math.PI*(2*f)+2*(Math.max(c,u)-2*f)}function getPillPoints(c,u,f){let g=Math.min(c,u)/2,b=Math.max(c,u)-2*g,v=Math.PI*(2*g)+2*b,x=v/f,w=c>u?[{type:"straight",start:new tl.G(g,0),delta:new tl.G(1,0)},{type:"arc",center:new tl.G(c-g,g),startAngle:-ts.PI/2},{type:"straight",start:new tl.G(c-g,u),delta:new tl.G(-1,0)},{type:"arc",center:new tl.G(g,g),startAngle:ts.PI/2}]:[{type:"straight",start:new tl.G(c,g),delta:new tl.G(0,1)},{type:"arc",center:new tl.G(g,u-g),startAngle:0},{type:"straight",start:new tl.G(0,u-g),delta:new tl.G(0,-1)},{type:"arc",center:new tl.G(g,g),startAngle:ts.PI}],_=0,k=[];for(let c=0;c<f;c++){let c=w[0];"straight"===c.type?k.push(tl.G.Add(c.start,tl.G.Mul(c.delta,_))):k.push((0,ts.XD)(c.center.x,c.center.y,g,c.startAngle+_/g)),_+=x;let u="straight"===c.type?b:ts.PI*g;for(;_>u;)_-=u,w.push(w.shift()),u="straight"===w[0].type?b:ts.PI*g}return k}let switchSize=(c,u,f,g,b)=>{switch(c){case"s":return u;case"m":return f;case"l":return g;case"xl":return b}};function getCloudArcs(c,u,f,g){let b=(0,e4.Vk)(f),v=getPillCircumference(c,u),x=Math.max(Math.ceil(v/switchSize(g,50,70,100,130)),6,Math.ceil(v/Math.min(c,u))),w=v/x*.2,_=Math.max(c-2*w,1),k=Math.max(u-2*w,1),E=(c-_)/2,T=(u-k)/2,$=getPillCircumference(_,k)/x,I=getPillPoints(_,k,x).map(c=>c.addXY(E,T)),M=c<20?0:.3*w,j=u<20?0:.3*w,D=I.slice(0);for(let c=0;c<Math.floor(x/2);c++)D[c]=tl.G.AddXY(D[c],b()*M,b()*j),D[x-c-1]=tl.G.AddXY(D[x-c-1],b()*M,b()*j);let L=[];for(let f=0;f<D.length;f++){let g=f===D.length-1?0:f+1,b=D[f],v=D[g],x=I[f],w=I[g],_=tl.G.Average([x,w]),k=tl.G.Angle(x,w)-Math.PI/2,M=tl.G.Dist(x,w),j=$-M,F=tl.G.Dist(b,v),B=F/M,G=(Math.max(E,T)+j)*B,U=tl.G.Add(_,tl.G.FromAngle(k,G));U.x<0?U.x=0:U.x>c&&(U.x=c),U.y<0?U.y=0:U.y>u&&(U.y=u);let V=getCenterOfCircleGivenThreePoints(b,v,U),K=tl.G.Dist(V||tl.G.Average([b,v]),b);L.push({leftPoint:b,rightPoint:v,arcPoint:U,center:V,radius:K})}return L}function getCenterOfCircleGivenThreePoints(c,u,f){let g=c.x*(u.y-f.y)-c.y*(u.x-f.x)+u.x*f.y-f.x*u.y,b=(c.x*c.x+c.y*c.y)*(f.y-u.y)+(u.x*u.x+u.y*u.y)*(c.y-f.y)+(f.x*f.x+f.y*f.y)*(u.y-c.y),v=(c.x*c.x+c.y*c.y)*(u.x-f.x)+(u.x*u.x+u.y*u.y)*(f.x-c.x)+(f.x*f.x+f.y*f.y)*(c.x-u.x),x=-b/(2*g),w=-v/(2*g);return Number.isFinite(x)&&Number.isFinite(w)?new tl.G(x,w):null}function cloudOutline(c,u,f,g){let b=[],v=getCloudArcs(c,u,f,g);for(let{center:c,radius:u,leftPoint:f,rightPoint:g}of v)b.push(...pointsOnArc(f,g,c,u,10));return b}function cloudSvgPath(c,u,f,g){let b=getCloudArcs(c,u,f,g),v=`M${(0,ts.$Z)(b[0].leftPoint.x)},${(0,ts.$Z)(b[0].leftPoint.y)}`;for(let{leftPoint:c,rightPoint:u,radius:f,center:g}of b){if(null===g){v+=` L${(0,ts.$Z)(u.x)},${(0,ts.$Z)(u.y)}`;continue}let b=isLeft(c,u,g)?"0":"1";v+=` A${(0,ts.$Z)(f)},${(0,ts.$Z)(f)} 0 ${b},1 ${(0,ts.$Z)(u.x)},${(0,ts.$Z)(u.y)}`}return v+" Z"}function inkyCloudSvgPath(c,u,f,g){let b=(0,e4.Vk)(f),v="s"===g?.5:"m"===g?.7:"l"===g?.9:1.6,mut=c=>c+b()*v*2,x=getCloudArcs(c,u,f,g),w=x.reduce((c,u)=>c+tl.G.Dist(u.leftPoint,u.rightPoint),0)/x.length,_=w>15*v?c=>new tl.G(mut(c.x),mut(c.y)):c=>c,k=`M${(0,ts.$Z)(x[0].leftPoint.x)},${(0,ts.$Z)(x[0].leftPoint.y)}`,E=_(x[0].leftPoint),T=`M${(0,ts.$Z)(E.x)},${(0,ts.$Z)(E.y)}`;for(let{leftPoint:c,center:u,rightPoint:f,radius:g,arcPoint:b}of x){if(null===u){k+=` L${(0,ts.$Z)(f.x)},${(0,ts.$Z)(f.y)}`;let c=_(f);T+=` L${(0,ts.$Z)(c.x)},${(0,ts.$Z)(c.y)}`,E=c;continue}let v=isLeft(c,f,u)?"0":"1";k+=` A${(0,ts.$Z)(g)},${(0,ts.$Z)(g)} 0 ${v},1 ${(0,ts.$Z)(f.x)},${(0,ts.$Z)(f.y)}`;let x=_(f),w=_(b),$=getCenterOfCircleGivenThreePoints(E,x,w);if(!$){T+=` L${(0,ts.$Z)(x.x)},${(0,ts.$Z)(x.y)}`,E=x;continue}let I=Math.abs(tl.G.Dist($,E));T+=` A${(0,ts.$Z)(I)},${(0,ts.$Z)(I)} 0 ${v},1 ${(0,ts.$Z)(x.x)},${(0,ts.$Z)(x.y)}`,E=x}return k+T+" Z"}function pointsOnArc(c,u,f,g,b){if(null===f)return[tl.G.From(c),tl.G.From(u)];let v=[],x=tl.G.Angle(f,c),w=tl.G.Angle(f,u),_=(0,ts.VK)(x,w);for(let c=0;c<b;c++){let u=c/(b-1),w=x+_*u,k=(0,ts.XD)(f.x,f.y,g,w);v.push(k)}return v}function isLeft(c,u,f){return(u.x-c.x)*(f.y-c.y)-(u.y-c.y)*(f.x-c.x)>0}let iX=K.memo(function({dash:c,fill:u,color:f,strokeWidth:g,w:b,h:v,id:x,size:w}){let _=useDefaultColorTheme(),k=cloudSvgPath(b,v,x,w),E=getCloudArcs(b,v,x,w);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:_,d:k,fill:u,color:f}),(0,V.jsx)("g",{strokeWidth:g,stroke:_[f].solid,fill:"none",pointerEvents:"all",children:E.map(({leftPoint:u,rightPoint:f,center:b,radius:v},x)=>{let w=b?v*(0,ts.f5)((0,ts.f5)(tl.G.Angle(b,f))-(0,ts.f5)(tl.G.Angle(b,u))):tl.G.Dist(u,f),{strokeDasharray:_,strokeDashoffset:k}=getPerfectDashProps(w,g,{style:c,start:"outset",end:"outset"});return(0,V.jsx)("path",{d:b?`M${u.x},${u.y}A${v},${v},0,0,1,${f.x},${f.y}`:`M${u.x},${u.y}L${f.x},${f.y}`,strokeDasharray:_,strokeDashoffset:k},x)})})]})});function DashStyleCloudSvg({dash:c,fill:u,color:f,theme:g,strokeWidth:b,w:v,h:x,id:w,size:_}){let k=cloudSvgPath(v,x,w,_),E=getCloudArcs(v,x,w,_),T=document.createElementNS("http://www.w3.org/2000/svg","g");for(let{leftPoint:u,rightPoint:v,center:x,radius:w}of(T.setAttribute("stroke-width",b.toString()),T.setAttribute("stroke",g[f].solid),T.setAttribute("fill","none"),E)){let f=x?w*(0,ts.f5)((0,ts.f5)(tl.G.Angle(x,v))-(0,ts.f5)(tl.G.Angle(x,u))):tl.G.Dist(u,v),{strokeDasharray:g,strokeDashoffset:_}=getPerfectDashProps(f,b,{style:c,start:"outset",end:"outset"}),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",x?`M${u.x},${u.y}A${w},${w},0,0,1,${v.x},${v.y}`:`M${u.x},${u.y}L${v.x},${v.y}`),k.setAttribute("stroke-dasharray",g.toString()),k.setAttribute("stroke-dashoffset",_.toString()),T.appendChild(k)}let $=getShapeFillSvg({d:k,fill:u,color:f,theme:g});return getSvgWithShapeFill(T,$)}let iJ=K.memo(function({w:c,h:u,strokeWidth:f,dash:g,color:b,fill:v}){let x=useDefaultColorTheme(),w=c/2,_=u/2,k=Math.max(0,w),E=Math.max(0,_),T=(0,ts.Rp)(k,E),{strokeDasharray:$,strokeDashoffset:I}=getPerfectDashProps(T<64?2*T:T,f,{style:g,snap:4,closed:!0}),M=`M${w-k},${_}a${k},${E},0,1,1,${2*k},0a${k},${E},0,1,1,-${2*k},0`;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:x,d:M,color:b,fill:v}),(0,V.jsx)("path",{d:M,strokeWidth:f,width:(0,ts.$Z)(c),height:(0,ts.$Z)(u),fill:"none",stroke:x[b].solid,strokeDasharray:$,strokeDashoffset:I,pointerEvents:"all"})]})});function DashStyleEllipseSvg({w:c,h:u,strokeWidth:f,dash:g,color:b,theme:v,fill:x}){let w=c/2,_=u/2,k=Math.max(0,w-f/2),E=Math.max(0,_-f/2),T=(0,ts.Rp)(k,E),{strokeDasharray:$,strokeDashoffset:I}=getPerfectDashProps(T<64?2*T:T,f,{style:g,snap:4,closed:!0}),M=`M${w-k},${_}a${k},${E},0,1,1,${2*k},0a${k},${E},0,1,1,-${2*k},0`,j=document.createElementNS("http://www.w3.org/2000/svg","path");j.setAttribute("d",M),j.setAttribute("stroke-width",f.toString()),j.setAttribute("width",c.toString()),j.setAttribute("height",u.toString()),j.setAttribute("fill","none"),j.setAttribute("stroke",v[b].solid),j.setAttribute("stroke-dasharray",$),j.setAttribute("stroke-dashoffset",I);let D=getShapeFillSvg({d:M,fill:x,color:b,theme:v});return getSvgWithShapeFill(j,D)}function getOvalSolidPath(c,u){if(u>c){let f=c/2;return`
    M0,${f}
    a${f},${f},0,1,1,${2*f},0
    L${c},${u-f}
    a${f},${f},0,1,1,-${2*f},0
    Z`}let f=u/2;return`
    M${f},0
    L${c-f},0
    a${f},${f},0,1,1,0,${2*f}
    L${f},${u}
    a${f},${f},0,1,1,0,${-(2*f)}
    Z`}function getOvalPerimeter(c,u){if(c>u){let f=u/2;return(0,ts.Rp)(f,f)+(c-2*f)*2}let f=c/2;return(0,ts.Rp)(f,f)+(u-2*f)*2}let iQ=K.memo(function({w:c,h:u,strokeWidth:f,dash:g,color:b,fill:v}){let x=useDefaultColorTheme(),w=getOvalSolidPath(c,u),_=getOvalPerimeter(c,u),{strokeDasharray:k,strokeDashoffset:E}=getPerfectDashProps(_<64?2*_:_,f,{style:g,snap:4,start:"outset",end:"outset",closed:!0});return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:x,d:w,color:b,fill:v}),(0,V.jsx)("path",{d:w,strokeWidth:f,width:(0,ts.$Z)(c),height:(0,ts.$Z)(u),fill:"none",stroke:x[b].solid,strokeDasharray:k,strokeDashoffset:E,pointerEvents:"all"})]})});function DashStyleOvalSvg({w:c,h:u,strokeWidth:f,dash:g,color:b,theme:v,fill:x}){let w=getOvalSolidPath(c,u),_=getOvalPerimeter(c,u),{strokeDasharray:k,strokeDashoffset:E}=getPerfectDashProps(_<64?2*_:_,f,{style:g,snap:4,closed:!0}),T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("d",w),T.setAttribute("stroke-width",f.toString()),T.setAttribute("width",c.toString()),T.setAttribute("height",u.toString()),T.setAttribute("fill","none"),T.setAttribute("stroke",v[b].solid),T.setAttribute("stroke-dasharray",k),T.setAttribute("stroke-dashoffset",E);let $=getShapeFillSvg({d:w,fill:x,color:b,theme:v});return getSvgWithShapeFill(T,$)}let i0=K.memo(function({dash:c,fill:u,color:f,strokeWidth:g,outline:b,lines:v}){let x=useDefaultColorTheme(),w="M"+b[0]+"L"+b.slice(1)+"Z";return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:x,d:w,fill:u,color:f}),(0,V.jsxs)("g",{strokeWidth:g,stroke:x[f].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(b.length)).map((u,f)=>{let v=b[f],x=b[(f+1)%b.length],w=tl.G.Dist(v,x),{strokeDasharray:_,strokeDashoffset:k}=getPerfectDashProps(w,g,{style:c,start:"outset",end:"outset"});return(0,V.jsx)("line",{x1:v.x,y1:v.y,x2:x.x,y2:x.y,strokeDasharray:_,strokeDashoffset:k},f)}),v&&v.map(([u,b],v)=>{let w=tl.G.Dist(u,b),{strokeDasharray:_,strokeDashoffset:k}=getPerfectDashProps(w,g,{style:c,start:"skip",end:"outset",snap:"dotted"===c?4:void 0});return(0,V.jsx)("path",{d:`M${u.x},${u.y}L${b.x},${b.y}`,stroke:x[f].solid,strokeWidth:g,fill:"none",strokeDasharray:_,strokeDashoffset:k},`line_fg_${v}`)})]})]})});function DashStylePolygonSvg({dash:c,fill:u,color:f,theme:g,strokeWidth:b,outline:v,lines:x}){let w=document.createElementNS("http://www.w3.org/2000/svg","g");if(w.setAttribute("stroke-width",b.toString()),w.setAttribute("stroke",g[f].solid),w.setAttribute("fill","none"),Array.from(Array(v.length)).forEach((u,f)=>{let g=v[f],x=v[(f+1)%v.length],_=tl.G.Dist(g,x),{strokeDasharray:k,strokeDashoffset:E}=getPerfectDashProps(_,b,{style:c}),T=document.createElementNS("http://www.w3.org/2000/svg","line");T.setAttribute("x1",g.x.toString()),T.setAttribute("y1",g.y.toString()),T.setAttribute("x2",x.x.toString()),T.setAttribute("y2",x.y.toString()),T.setAttribute("stroke-dasharray",k.toString()),T.setAttribute("stroke-dashoffset",E.toString()),w.appendChild(T)}),x)for(let[u,f]of x){let g=tl.G.Dist(u,f),{strokeDasharray:v,strokeDashoffset:x}=getPerfectDashProps(g,b,{style:c,start:"skip",end:"skip",snap:"dotted"===c?4:2}),_=document.createElementNS("http://www.w3.org/2000/svg","line");_.setAttribute("x1",u.x.toString()),_.setAttribute("y1",u.y.toString()),_.setAttribute("x2",f.x.toString()),_.setAttribute("y2",f.y.toString()),_.setAttribute("stroke-dasharray",v.toString()),_.setAttribute("stroke-dashoffset",x.toString()),w.appendChild(_)}let _=getShapeFillSvg({d:"M"+v[0]+"L"+v.slice(1)+"Z",fill:u,color:f,theme:g});return getSvgWithShapeFill(w,_)}let i1=K.memo(function({fill:c,color:u,strokeWidth:f,w:g,h:b,id:v,size:x}){let w=useDefaultColorTheme(),_=inkyCloudSvgPath(g,b,v,x);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:w,d:_,fill:c,color:u}),(0,V.jsx)("path",{d:_,stroke:w[u].solid,strokeWidth:f,fill:"none"})]})});function DrawStyleCloudSvg({fill:c,color:u,strokeWidth:f,theme:g,w:b,h:v,id:x,size:w}){let _=inkyCloudSvgPath(b,v,x,w),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",_),k.setAttribute("stroke-width",f.toString()),k.setAttribute("stroke",g[u].solid),k.setAttribute("fill","none");let E=getShapeFillSvg({d:_,fill:c,color:u,theme:g});return getSvgWithShapeFill(k,E)}function DrawStyleEllipseSvg({id:c,w:u,h:f,strokeWidth:g,fill:b,color:v,theme:x}){let w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",getEllipsePath(c,u,f,g)),w.setAttribute("fill",x[v].solid);let _=getShapeFillSvg({d:getSvgPathFromStrokePoints(getEllipseStrokePoints(c,u,f,g)),fill:b,color:v,theme:x});return getSvgWithShapeFill(w,_)}function getEllipseStrokeOptions(c){return{size:1+c,thinning:.25,end:{taper:c},start:{taper:c},streamline:0,smoothing:1,simulatePressure:!1}}function getEllipseStrokePoints(c,u,f,g){let b=(0,e4.Vk)(c),v=u/2,x=f/2,w=(0,ts.Rp)(v,x),_=[],k=ts.yo*b(),E=ts.yo+ts.gc/2+Math.abs(b())*ts.gc,T=Math.max(16,w/10);for(let c=0;c<T;c++){let g=c/(T-1),w=k+g*E,$=Math.cos(w),I=Math.sin(w);_.push(new tl.G(v*$+.5*u+.05*b(),x*I+f/2+.05*b(),Math.min(1,.5+Math.abs(.5-(b()>0?n$.L.easeInOutSine(g):n$.L.easeInExpo(g)))/2)))}return getStrokePoints(_,getEllipseStrokeOptions(g))}function getEllipsePath(c,u,f,g){let b=getEllipseStrokeOptions(g);return getSvgPathFromPoints_getSvgPathFromPoints(getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getEllipseStrokePoints(c,u,f,g),b),b))}K.memo(function({id:c,w:u,h:f,strokeWidth:g,fill:b,color:v}){let x=useDefaultColorTheme(),w=getSvgPathFromStrokePoints(getEllipseStrokePoints(c,u,f,g)),_=getEllipsePath(c,u,f,g);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:x,d:w,color:v,fill:b}),(0,V.jsx)("path",{d:_,fill:x[v].solid,strokeWidth:0,pointerEvents:"all"})]})});let i2=K.memo(function({id:c,outline:u,lines:f,fill:g,color:b,strokeWidth:v}){let x=useDefaultColorTheme(),w=getRoundedPolygonPoints(c,u,v/3,2*v,2),_=getRoundedInkyPolygonPath(w);if(f)for(let[c,u]of f)_+=`M${c.x},${c.y}L${u.x},${u.y}`;let k=getRoundedPolygonPoints(c,u,0,2*v,1),E=getRoundedInkyPolygonPath(k);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{d:E,fill:g,color:b,theme:x}),(0,V.jsx)("path",{d:_,stroke:x[b].solid,strokeWidth:v,fill:"none"})]})});function DrawStylePolygonSvg({id:c,outline:u,lines:f,fill:g,color:b,theme:v,strokeWidth:x}){let w=getRoundedPolygonPoints(c,u,x/3,2*x,2),_=getRoundedInkyPolygonPath(w);if(f)for(let[c,u]of f)_+=`M${c.x},${c.y}L${u.x},${u.y}`;let k=getRoundedPolygonPoints(c,u,0,2*x,1),E=getRoundedInkyPolygonPath(k),T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("d",_),T.setAttribute("fill","none"),T.setAttribute("stroke",v[b].solid),T.setAttribute("stroke-width",x.toString());let $=getShapeFillSvg({d:E,fill:g,color:b,theme:v});return getSvgWithShapeFill(T,$)}let i5=K.memo(function({fill:c,color:u,strokeWidth:f,w:g,h:b,id:v,size:x}){let w=useDefaultColorTheme(),_=cloudSvgPath(g,b,v,x);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{theme:w,d:_,fill:c,color:u}),(0,V.jsx)("path",{d:_,stroke:w[u].solid,strokeWidth:f,fill:"none"})]})});function SolidStyleCloudSvg({fill:c,color:u,strokeWidth:f,theme:g,w:b,h:v,id:x,size:w}){let _=cloudSvgPath(b,v,x,w),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",_),k.setAttribute("stroke-width",f.toString()),k.setAttribute("stroke",g[u].solid),k.setAttribute("fill","none");let E=getShapeFillSvg({d:_,fill:c,color:u,theme:g});return getSvgWithShapeFill(k,E)}let i3=K.memo(function({w:c,h:u,strokeWidth:f,fill:g,color:b}){let v=useDefaultColorTheme(),x=c/2,w=u/2,_=Math.max(0,x),k=Math.max(0,w),E=`M${x-_},${w}a${_},${k},0,1,1,${2*_},0a${_},${k},0,1,1,-${2*_},0`;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{d:E,color:b,fill:g,theme:v}),(0,V.jsx)("path",{d:E,stroke:v[b].solid,strokeWidth:f,fill:"none"})]})});function SolidStyleEllipseSvg({w:c,h:u,strokeWidth:f,fill:g,color:b,theme:v}){let x=c/2,w=u/2,_=Math.max(0,x),k=Math.max(0,w),E=`M${x-_},${w}a${_},${k},0,1,1,${2*_},0a${_},${k},0,1,1,-${2*_},0`,T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("d",E),T.setAttribute("stroke-width",f.toString()),T.setAttribute("width",c.toString()),T.setAttribute("height",u.toString()),T.setAttribute("fill","none"),T.setAttribute("stroke",v[b].solid);let $=getShapeFillSvg({d:E,fill:g,color:b,theme:v});return getSvgWithShapeFill(T,$)}let i8=K.memo(function({w:c,h:u,strokeWidth:f,fill:g,color:b}){let v=useDefaultColorTheme(),x=getOvalIndicatorPath(c,u);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{d:x,color:b,fill:g,theme:v}),(0,V.jsx)("path",{d:x,stroke:v[b].solid,strokeWidth:f,fill:"none"})]})});function SolidStyleOvalSvg({w:c,h:u,strokeWidth:f,fill:g,color:b,theme:v}){let x=getOvalIndicatorPath(c,u),w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",x),w.setAttribute("stroke-width",f.toString()),w.setAttribute("width",c.toString()),w.setAttribute("height",u.toString()),w.setAttribute("fill","none"),w.setAttribute("stroke",v[b].solid);let _=getShapeFillSvg({d:x,fill:g,color:b,theme:v});return getSvgWithShapeFill(w,_)}function getOvalIndicatorPath(c,u){let f;if(u>c){let g=c/2;f=`
    M0,${g}
    a${g},${g},0,1,1,${2*g},0
    L${c},${u-g}
    a${g},${g},0,1,1,-${2*g},0
    Z`}else{let g=u/2;f=`
    M${g},0
    L${c-g},0
    a${g},${g},0,1,1,0,${2*g}
    L${g},${u}
    a${g},${g},0,1,1,0,${-(2*g)}
    Z`}return f}let i4=K.memo(function({outline:c,lines:u,fill:f,color:g,strokeWidth:b}){let v=useDefaultColorTheme(),x="M"+c[0]+"L"+c.slice(1)+"Z";if(u)for(let[c,f]of u)x+=`M${c.x},${c.y}L${f.x},${f.y}`;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(iU,{d:x,fill:f,color:g,theme:v}),(0,V.jsx)("path",{d:x,stroke:v[g].solid,strokeWidth:b,fill:"none"})]})});function SolidStylePolygonSvg({outline:c,lines:u,fill:f,color:g,strokeWidth:b,theme:v}){let x="M"+c[0]+"L"+c.slice(1)+"Z",w=x;if(u)for(let[c,f]of u)w+=`M${c.x},${c.y}L${f.x},${f.y}`;let _=document.createElementNS("http://www.w3.org/2000/svg","path");_.setAttribute("d",w),_.setAttribute("stroke-width",b.toString()),_.setAttribute("stroke",v[g].solid),_.setAttribute("fill","none");let k=getShapeFillSvg({d:x,fill:f,color:g,theme:v});return getSvgWithShapeFill(_,k)}let GeoShapeUtil=class GeoShapeUtil extends BaseBoxShapeUtil{static type="geo";static props=e8.eG;static migrations=e8.P3;canEdit=()=>!0;getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(c){let u;let f=Math.max(1,c.props.w),g=Math.max(1,c.props.h+c.props.growY),b=f/2,v=g/2,x=iM[c.props.size],w="none"!==c.props.fill;switch(c.props.geo){case"cloud":u=new nO.w({points:cloudOutline(f,g,c.id,c.props.size),isFilled:w});break;case"triangle":u=new nO.w({points:[new tl.G(b,0),new tl.G(f,g),new tl.G(0,g)],isFilled:w});break;case"diamond":u=new nO.w({points:[new tl.G(b,0),new tl.G(f,v),new tl.G(b,g),new tl.G(0,v)],isFilled:w});break;case"pentagon":u=new nO.w({points:(0,ts.Oe)(f,g,5),isFilled:w});break;case"hexagon":u=new nO.w({points:(0,ts.Oe)(f,g,6),isFilled:w});break;case"octagon":u=new nO.w({points:(0,ts.Oe)(f,g,8),isFilled:w});break;case"ellipse":u=new Ellipse2d({width:f,height:g,isFilled:w});break;case"oval":u=new Stadium2d({width:f,height:g,isFilled:w});break;case"star":{let c=ts.yo/5/2,b=2*Math.floor(5/4),v=Math.cos(-ts.gc+b*c)*f/2,x=Math.cos(-ts.gc+(10-b)*c)*f/2,_=Math.sin(-ts.gc+0*c)*g/2,k=Math.sin(-ts.gc+2*Math.floor(2.5)*c)*g/2,E=f-Math.abs(v-x),T=g-Math.abs(k-_),$=f/2+x-(f/2-v),I=g/2+_-(g/2-k),M=(f-$)/2,j=(g-I)/2,D=(f+E)/2,L=(g+T)/2,F=1*D/2,B=1*L/2;u=new nO.w({points:Array.from(Array(10)).map((u,f)=>{let g=-ts.gc+f*c;return new tl.G(M+(f%2?F:D)*Math.cos(g),j+(f%2?B:L)*Math.sin(g))}),isFilled:w});break}case"rhombus":{let c=Math.min(.38*f,.38*g);u=new nO.w({points:[new tl.G(c,0),new tl.G(f,0),new tl.G(f-c,g),new tl.G(0,g)],isFilled:w});break}case"rhombus-2":{let c=Math.min(.38*f,.38*g);u=new nO.w({points:[new tl.G(0,0),new tl.G(f-c,0),new tl.G(f,g),new tl.G(c,g)],isFilled:w});break}case"trapezoid":{let c=Math.min(.38*f,.38*g);u=new nO.w({points:[new tl.G(c,0),new tl.G(f-c,0),new tl.G(f,g),new tl.G(0,g)],isFilled:w});break}case"arrow-right":{let c=.38*Math.min(f,g),b=.16*g;u=new nO.w({points:[new tl.G(0,b),new tl.G(f-c,b),new tl.G(f-c,0),new tl.G(f,g/2),new tl.G(f-c,g),new tl.G(f-c,g-b),new tl.G(0,g-b)],isFilled:w});break}case"arrow-left":{let c=.38*Math.min(f,g),b=.16*g;u=new nO.w({points:[new tl.G(c,0),new tl.G(c,b),new tl.G(f,b),new tl.G(f,g-b),new tl.G(c,g-b),new tl.G(c,g),new tl.G(0,g/2)],isFilled:w});break}case"arrow-up":{let c=.16*f,b=.38*Math.min(f,g);u=new nO.w({points:[new tl.G(f/2,0),new tl.G(f,b),new tl.G(f-c,b),new tl.G(f-c,g),new tl.G(c,g),new tl.G(c,b),new tl.G(0,b)],isFilled:w});break}case"arrow-down":{let c=.16*f,b=.38*Math.min(f,g);u=new nO.w({points:[new tl.G(c,0),new tl.G(f-c,0),new tl.G(f-c,g-b),new tl.G(f,g-b),new tl.G(f/2,g),new tl.G(0,g-b),new tl.G(c,g-b)],isFilled:w});break}case"check-box":case"x-box":case"rectangle":u=new nv.z({width:f,height:g,isFilled:w,isSnappable:!0})}let _=getLabelSize(this.editor,c),k=Math.min(f,Math.max(_.w,Math.min(32,Math.max(1,f-8)))),E=Math.min(g,Math.max(_.h,Math.min(32,Math.max(1,f-8)))),T=getLines(c.props,x),$=T?T.map(c=>new nA.q({points:c})):[];return new nj.m({children:[u,new nv.z({x:"start"===c.props.align?0:"end"===c.props.align?f-k:(f-k)/2,y:"start"===c.props.verticalAlign?0:"end"===c.props.verticalAlign?g-E:(g-E)/2,width:k,height:E,isFilled:!0,isSnappable:!1,isLabel:!0}),...$],isSnappable:!1})}onEditEnd=c=>{let{id:u,type:f,props:{text:g}}=c;g.trimEnd()!==c.props.text&&this.editor.updateShapes([{id:u,type:f,props:{text:g.trimEnd()}}])};component(c){let{id:u,type:f,props:g}=c,b=iM[g.size],{w:v,color:x,labelColor:w,fill:_,dash:k,growY:E,font:T,align:$,verticalAlign:I,size:M,text:j}=g;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(nm.g,{id:u,children:(()=>{let f=g.h+E;switch(g.geo){case"cloud":if("solid"===k)return(0,V.jsx)(i5,{color:x,fill:_,strokeWidth:b,w:v,h:f,id:u,size:M});if("dashed"===k||"dotted"===k)return(0,V.jsx)(iX,{color:x,fill:_,strokeWidth:b,w:v,h:f,id:u,size:M,dash:k});if("draw"===k)return(0,V.jsx)(i1,{color:x,fill:_,strokeWidth:b,w:v,h:f,id:u,size:M});break;case"ellipse":if("solid"===k)return(0,V.jsx)(i3,{strokeWidth:b,w:v,h:f,color:x,fill:_});if("dashed"===k||"dotted"===k)return(0,V.jsx)(iJ,{id:u,strokeWidth:b,w:v,h:f,dash:k,color:x,fill:_});if("draw"===k)return(0,V.jsx)(i3,{strokeWidth:b,w:v,h:f,color:x,fill:_});break;case"oval":if("solid"===k)return(0,V.jsx)(i8,{strokeWidth:b,w:v,h:f,color:x,fill:_});if("dashed"===k||"dotted"===k)return(0,V.jsx)(iQ,{id:u,strokeWidth:b,w:v,h:f,dash:k,color:x,fill:_});if("draw"===k)return(0,V.jsx)(i8,{strokeWidth:b,w:v,h:f,color:x,fill:_});break;default:{let f=this.editor.getShapeGeometry(c),g=f instanceof nj.m?f.children[0].vertices:f.vertices,v=getLines(c.props,b);if("solid"===k)return(0,V.jsx)(i4,{fill:_,color:x,strokeWidth:b,outline:g,lines:v});if("dashed"===k||"dotted"===k)return(0,V.jsx)(i0,{dash:k,fill:_,color:x,strokeWidth:b,outline:g,lines:v});if("draw"===k)return(0,V.jsx)(i2,{id:u,fill:_,color:x,strokeWidth:b,outline:g,lines:v})}}})()}),(0,V.jsx)(iq,{id:u,type:f,font:T,fill:_,size:M,align:$,verticalAlign:I,text:j,labelColor:w,wrap:!0,bounds:"cloud"===g.geo?this.getGeometry(c).bounds:void 0}),c.props.url&&(0,V.jsx)(HyperlinkButton,{url:c.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(c){let{id:u,props:f}=c,{w:g,size:b}=f,v=f.h+f.growY,x=iM[b];switch(f.geo){case"ellipse":if("draw"===f.dash)return(0,V.jsx)("path",{d:getSvgPathFromStrokePoints(getEllipseStrokePoints(u,g,v,x))});return(0,V.jsx)("ellipse",{cx:g/2,cy:v/2,rx:g/2,ry:v/2});case"oval":return(0,V.jsx)("path",{d:getOvalIndicatorPath(g,v)});case"cloud":return(0,V.jsx)("path",{d:cloudSvgPath(g,v,u,b)});default:{let g;let b=this.editor.getShapeGeometry(c),v=b instanceof nj.m?b.children[0].vertices:b.vertices;if("draw"===f.dash){let c=getRoundedPolygonPoints(u,v,0,2*x,1);g=getRoundedInkyPolygonPath(c)}else g="M"+v[0]+"L"+v.slice(1)+"Z";let w=getLines(c.props,x);if(w)for(let[c,u]of w)g+=`M${c.x},${c.y}L${u.x},${u.y}`;return(0,V.jsx)("path",{d:g})}}}toSvg(c,u){let f;let{id:g,props:b}=c,v=iM[b.size],x=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode});switch(u.addExportDef(getFillDefForExport(c.props.fill,x)),b.geo){case"ellipse":switch(b.dash){case"draw":f=DrawStyleEllipseSvg({id:g,w:b.w,h:b.h,color:b.color,fill:b.fill,strokeWidth:v,theme:x});break;case"solid":f=SolidStyleEllipseSvg({strokeWidth:v,w:b.w,h:b.h,color:b.color,fill:b.fill,theme:x});break;default:f=DashStyleEllipseSvg({id:g,strokeWidth:v,w:b.w,h:b.h,dash:b.dash,color:b.color,fill:b.fill,theme:x})}break;case"oval":switch(b.dash){case"draw":default:f=DashStyleOvalSvg({id:g,strokeWidth:v,w:b.w,h:b.h,dash:b.dash,color:b.color,fill:b.fill,theme:x});break;case"solid":f=SolidStyleOvalSvg({strokeWidth:v,w:b.w,h:b.h,color:b.color,fill:b.fill,theme:x})}break;case"cloud":switch(b.dash){case"draw":f=DrawStyleCloudSvg({id:g,strokeWidth:v,w:b.w,h:b.h,color:b.color,fill:b.fill,size:b.size,theme:x});break;case"solid":f=SolidStyleCloudSvg({strokeWidth:v,w:b.w,h:b.h,color:b.color,fill:b.fill,size:b.size,id:g,theme:x});break;default:f=DashStyleCloudSvg({id:g,strokeWidth:v,w:b.w,h:b.h,dash:b.dash,color:b.color,fill:b.fill,theme:x,size:b.size})}break;default:{let u=this.editor.getShapeGeometry(c),w=u instanceof nj.m?u.children[0].vertices:u.vertices,_=getLines(c.props,v);switch(b.dash){case"draw":f=DrawStylePolygonSvg({id:g,fill:b.fill,color:b.color,strokeWidth:v,outline:w,lines:_,theme:x});break;case"solid":f=SolidStylePolygonSvg({fill:b.fill,color:b.color,strokeWidth:v,outline:w,lines:_,theme:x});break;default:f=DashStylePolygonSvg({dash:b.dash,fill:b.fill,color:b.color,strokeWidth:v,outline:w,lines:_,theme:x})}}}if(b.text){let g=this.editor.getShapeGeometry(c).bounds;u.addExportDef(getFontDefForExport(c.props.font));let b=getTextLabelSvgElement({editor:this.editor,shape:c,font:e8.p6[c.props.font],bounds:g}),v=b.cloneNode(!0);v.setAttribute("fill",x[c.props.labelColor].solid),v.setAttribute("stroke","none");let w=b.cloneNode(!0);w.setAttribute("stroke-width","2"),w.setAttribute("fill",x.background),w.setAttribute("stroke",x.background);let _=document.createElementNS("http://www.w3.org/2000/svg","g");if(_.append(w),_.append(v),"g"===f.nodeName)f.appendChild(_);else{let c=document.createElementNS("http://www.w3.org/2000/svg","g");return c.appendChild(f),c.appendChild(_),c}}return f}getCanvasSvgDefs(){return[getFillDefForCanvas()]}onResize=(c,{handle:u,newPoint:f,scaleX:g,scaleY:b,initialShape:v})=>{let x=v.props.w*g,w=(v.props.h+v.props.growY)*b,_=0,k=0;if(c.props.text.trim()){let u=Math.max(Math.abs(x),51),f=Math.max(Math.abs(w),51);u<51&&51===f&&(u=51),51===u&&f<51&&(f=51);let g=getLabelSize(this.editor,{...c,props:{...c.props,w:u,h:f}}),b=Math.max(Math.abs(x),g.w)*Math.sign(x),v=Math.max(Math.abs(w),g.h)*Math.sign(w);_=Math.abs(b)-Math.abs(x),k=Math.abs(v)-Math.abs(w),x=b,w=v}let E=new tl.G(0,0);g<0&&(E.x+=x),("left"===u||"top_left"===u||"bottom_left"===u)&&(E.x+=g<0?_:-_),b<0&&(E.y+=w),("top"===u||"top_left"===u||"top_right"===u)&&(E.y+=b<0?k:-k);let{x:T,y:$}=E.rot(c.rotation).add(f);return{x:T,y:$,props:{w:Math.max(Math.abs(x),1),h:Math.max(Math.abs(w),1),growY:0}}};onBeforeCreate=c=>{if(!c.props.text)return c.props.growY?{...c,props:{...c.props,growY:0}}:void 0;let u=c.props.h,f=getLabelSize(this.editor,c).h,g=null;if(f>u?g=f-u:c.props.growY&&(g=0),null!==g)return{...c,props:{...c.props,growY:g}}};onBeforeUpdate=(c,u)=>{let f=c.props.text,g=u.props.text;if(f===g&&c.props.font===u.props.font&&c.props.size===u.props.size)return;if(f&&!g)return{...u,props:{...u.props,growY:0}};let b=c.props.w,v=c.props.h,x=getLabelSize(this.editor,u),w=x.w,_=x.h;if(!f&&g&&1===g.length){let f=Math.max(b,w),g=Math.max(v,_);return c.props.w<51&&c.props.h<51&&(g=Math.max(f=Math.max(f=Math.max(f,51),g=Math.max(g,51)),g)),{...u,props:{...u.props,w:f,h:g,growY:0}}}let k=null;return(_>v?k=_-v:c.props.growY&&(k=0),null!==k)?{...u,props:{...u.props,growY:k,w:Math.max(u.props.w,w)}}:w>c.props.w?{...u,props:{...u.props,w:w}}:void 0};onDoubleClick=c=>{if(this.editor.inputs.altKey)switch(c.props.geo){case"rectangle":return{...c,props:{geo:"check-box"}};case"check-box":return{...c,props:{geo:"rectangle"}}}}};function getLabelSize(c,u){let f=u.props.text;if(!f)return{w:0,h:0};let g=c.textMeasure.measureText("w",{...iA,fontFamily:iD[u.props.font],fontSize:iO[u.props.size],maxWidth:100}),b=c.textMeasure.measureText(f,{...iA,fontFamily:iD[u.props.font],fontSize:iO[u.props.size],minWidth:g.w+"px",maxWidth:Math.max(0,Math.ceil(g.w+({s:2,m:3.5,l:5,xl:10})[u.props.size]),Math.ceil(u.props.w-32))});return{w:b.w+32,h:b.h+32}}function getLines(c,u){switch(c.geo){case"x-box":return getXBoxLines(c.w,c.h,u,c.dash);case"check-box":return getCheckBoxLines(c.w,c.h);default:return}}function getXBoxLines(c,u,f,g){let b="draw"===g?.62:0;if("dashed"===g)return[[new tl.G(0,0),new tl.G(c/2,u/2)],[new tl.G(c,u),new tl.G(c/2,u/2)],[new tl.G(0,u),new tl.G(c/2,u/2)],[new tl.G(c,0),new tl.G(c/2,u/2)]];let clampX=u=>Math.max(0,Math.min(c,u)),clampY=c=>Math.max(0,Math.min(u,c));return[[new tl.G(clampX(f*b),clampY(f*b)),new tl.G(clampX(c-f*b),clampY(u-f*b))],[new tl.G(clampX(f*b),clampY(u-f*b)),new tl.G(clampX(c-f*b),clampY(f*b))]]}function getCheckBoxLines(c,u){let f=.82*Math.min(c,u),g=(c-f)/2,b=(u-f)/2,clampX=u=>Math.max(0,Math.min(c,u)),clampY=c=>Math.max(0,Math.min(u,c));return[[new tl.G(clampX(g+.25*f),clampY(b+.52*f)),new tl.G(clampX(g+.45*f),clampY(b+.82*f))],[new tl.G(clampX(g+.45*f),clampY(b+.82*f)),new tl.G(clampX(g+.82*f),clampY(b+.22*f))]]}function useColorSpace(){let[c,u]=(0,K.useState)(!1);(0,K.useEffect)(()=>{let c=CSS.supports("color","color(display-p3 1 1 1)"),f=matchMedia("(color-gamut: p3)");u(c&&f.matches);let onChange=()=>u(c&&f.matches);return f.addEventListener("change",onChange),()=>f.removeEventListener("change",onChange)},[]);let f=(0,e5.Hg)(te.forceSrgb);return f||!c?"srgb":"p3"}let HighlightShapeUtil=class HighlightShapeUtil extends nS.E{static type="highlight";static props=e8.VW;static migrations=e8.J1;hideResizeHandles=c=>HighlightShapeUtil_getIsDot(c);hideRotateHandle=c=>HighlightShapeUtil_getIsDot(c);hideSelectionBoundsFg=c=>HighlightShapeUtil_getIsDot(c);getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(c){let u=getStrokeWidth(c);if(HighlightShapeUtil_getIsDot(c))return new Circle2d({x:-u/2,y:-u/2,radius:u/2,isFilled:!0});let{strokePoints:f,sw:g}=getHighlightStrokePoints(c,u,!0),b=getHighlightFreehandSettings({strokeWidth:g,showAsComplete:!0});return setStrokePointRadii(f,b),new nO.w({points:getStrokeOutlinePoints_getStrokeOutlinePoints(f,b),isFilled:!0})}component(c){return(0,V.jsx)(HighlightRenderer,{strokeWidth:getStrokeWidth(c),shape:c,opacity:.35})}backgroundComponent(c){return(0,V.jsx)(HighlightRenderer,{strokeWidth:getStrokeWidth(c),shape:c,opacity:.82})}indicator(c){let u;let f=useForceSolid(),g=getStrokeWidth(c),b=getPointsFromSegments(c.props.segments),v=g;f||c.props.isPen||1!==b.length||(v+=(0,e4.Vk)(c.id)()*(g/6));let x=c.props.isComplete||e4.Z$(c.props.segments)?.type==="straight",w=getHighlightFreehandSettings({strokeWidth:g,showAsComplete:x}),_=getStrokePoints(b,w);return u=_.length<2?getIndicatorDot(b[0],v):getSvgPathFromStrokePoints(_,!1),(0,V.jsx)("path",{d:u})}toSvg(c){let u=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode});return highlighterToSvg(getStrokeWidth(c),c,.35,u)}toBackgroundSvg(c){let u=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode});return highlighterToSvg(getStrokeWidth(c),c,.82,u)}onResize=(c,u)=>{let{scaleX:f,scaleY:g}=u,b=[];for(let u of c.props.segments)b.push({...u,points:u.points.map(({x:c,y:u,z:b})=>({x:f*c,y:g*u,z:b}))});return{props:{segments:b}}}};function getShapeDot(c){return`M ${c.x} ${c.y} m -0.1, 0 a 0.1,0.1 0 1,0 0.2,0 a 0.1,0.1 0 1,0 -0.2,0`}function getIndicatorDot(c,u){let f=u/2;return`M ${c.x} ${c.y} m -${f}, 0 a ${f},${f} 0 1,0 ${2*f},0 a ${f},${f} 0 1,0 -${2*f},0`}function getHighlightStrokePoints(c,u,f){let g=getPointsFromSegments(c.props.segments),b=c.props.isComplete||e4.Z$(c.props.segments)?.type==="straight",v=u;f||c.props.isPen||1!==g.length||(v+=(0,e4.Vk)(c.id)()*(u/6));let x=getHighlightFreehandSettings({strokeWidth:v,showAsComplete:b}),w=getStrokePoints(g,x);return{strokePoints:w,sw:v}}function getHighlightSvgPath(c,u,f){let{strokePoints:g,sw:b}=getHighlightStrokePoints(c,u,f),v=g.length>1?getSvgPathFromStrokePoints(g,!1):getShapeDot(c.props.segments[0].points[0]);return{solidStrokePath:v,sw:b}}function HighlightRenderer({strokeWidth:c,shape:u,opacity:f}){let g=useDefaultColorTheme(),b=useForceSolid(),{solidStrokePath:v,sw:x}=getHighlightSvgPath(u,c,b),w=useColorSpace(),_=g[u.props.color].highlight[w];return(0,V.jsx)(nm.g,{id:u.id,style:{opacity:f},children:(0,V.jsx)("path",{d:v,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:_,strokeWidth:x})})}function highlighterToSvg(c,u,f,g){let{solidStrokePath:b,sw:v}=getHighlightSvgPath(u,c,!1),x=document.createElementNS("http://www.w3.org/2000/svg","path");return x.setAttribute("d",b),x.setAttribute("fill","none"),x.setAttribute("stroke",g[u.props.color].highlight.srgb),x.setAttribute("stroke-width",`${v}`),x.setAttribute("opacity",`${f}`),x}function getStrokeWidth(c){return 1.12*ij[c.props.size]}function HighlightShapeUtil_getIsDot(c){return 1===c.props.segments.length&&c.props.segments[0].points.length<2}function usePrefersReducedMotion(){let[c,u]=(0,K.useState)(!1);return(0,K.useEffect)(()=>{let c=window.matchMedia("(prefers-reduced-motion: reduce)"),handler=()=>{u(c.matches)};return handler(),c.addEventListener("change",handler),()=>c.removeEventListener("change",handler)},[]),c}let loadImage=async c=>new Promise((u,f)=>{let g=new Image;g.onload=()=>u(g),g.onerror=()=>f(Error("Failed to load image")),g.crossOrigin="anonymous",g.src=c}),getStateFrame=async c=>{let u=await loadImage(c),f=document.createElement("canvas");f.width=u.width,f.height=u.height;let g=f.getContext("2d");if(g)return g.drawImage(u,0,0),f.toDataURL()};async function getDataURIFromURL(c){let u=await fetch(c),f=await u.blob();return new Promise((c,u)=>{let g=new FileReader;g.onloadend=()=>c(g.result),g.onerror=u,g.readAsDataURL(f)})}let ImageShapeUtil=class ImageShapeUtil extends BaseBoxShapeUtil{static type="image";static props=e8.Fc;static migrations=e8.y5;isAspectRatioLocked=()=>!0;canCrop=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(c){let u=getContainerStyle(c),f=useIsCropping(c.id),g=usePrefersReducedMotion(),[b,v]=(0,K.useState)(""),x=c.props.assetId?this.editor.getAsset(c.props.assetId):void 0;if(x?.type==="bookmark")throw Error("Bookmark assets can't be rendered as images");let w=(0,e5.Hg)("onlySelectedShape",()=>c.id===this.editor.onlySelectedShape?.id,[this.editor]),_=w&&f&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),k=g&&(x?.props.mimeType?.includes("video")||x?.props.mimeType?.includes("gif"));return(0,K.useEffect)(()=>{if(x?.props.src&&"mimeType"in x.props&&x?.props.mimeType==="image/gif"){let c=!1,run=async()=>{let u=await getStateFrame(x.props.src);!c&&u&&v(u)};return run(),()=>{c=!0}}},[g,x?.props]),(0,V.jsxs)(V.Fragment,{children:[x?.props.src&&_&&(0,V.jsx)("div",{style:u,children:(0,V.jsx)("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!c.props.playing||k?b:x.props.src})`},draggable:!1})}),(0,V.jsx)(HTMLContainer,{id:c.id,style:{overflow:"hidden",width:c.props.w,height:c.props.h},children:(0,V.jsxs)("div",{className:"tl-image-container",style:u,children:[x?.props.src?(0,V.jsx)("div",{className:"tl-image",style:{backgroundImage:`url(${!c.props.playing||k?b:x.props.src})`},draggable:!1}):null,x?.props.isAnimated&&!c.props.playing&&(0,V.jsx)("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in c.props&&c.props.url&&(0,V.jsx)(HyperlinkButton,{url:c.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(c){let u=useIsCropping(c.id);return u?null:(0,V.jsx)("rect",{width:(0,ts.$Z)(c.props.w),height:(0,ts.$Z)(c.props.h)})}async toSvg(c){let u=document.createElementNS("http://www.w3.org/2000/svg","g"),f=c.props.assetId?this.editor.getAsset(c.props.assetId):null,g=f?.props.src||"";g&&g.startsWith("http")&&(g=await getDataURIFromURL(g)||"");let b=document.createElementNS("http://www.w3.org/2000/svg","image");b.setAttributeNS("http://www.w3.org/1999/xlink","href",g);let v=getContainerStyle(c),x=c.props.crop;if(v.transform&&x){let{transform:c,width:f,height:g}=v,w=[new tl.G(x.topLeft.x*f,x.topLeft.y*g),new tl.G(x.bottomRight.x*f,x.topLeft.y*g),new tl.G(x.bottomRight.x*f,x.bottomRight.y*g),new tl.G(x.topLeft.x*f,x.bottomRight.y*g)],_=document.createElementNS("http://www.w3.org/2000/svg","g");_.style.clipPath=`polygon(${w.map(c=>`${c.x}px ${c.y}px`).join(",")})`,b.setAttribute("width",f.toString()),b.setAttribute("height",g.toString()),b.style.transform=c,_.appendChild(b),u.appendChild(_)}else b.setAttribute("width",c.props.w.toString()),b.setAttribute("height",c.props.h.toString()),u.appendChild(b);return u}onDoubleClick=c=>{let u=c.props.assetId?this.editor.getAsset(c.props.assetId):void 0;if(!u)return;let f=u.props.src&&"mimeType"in u.props&&"image/gif"===u.props.mimeType;f&&this.editor.updateShapes([{type:"image",id:c.id,props:{playing:!c.props.playing}}])};onDoubleClickEdge=c=>{let u=c.props;if(!u||this.editor.croppingShapeId!==c.id)return;let f=(0,e4.p$)(u.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},g=1/(f.bottomRight.x-f.topLeft.x)*c.props.w,b=1/(f.bottomRight.y-f.topLeft.y)*c.props.h,v=new tl.G(f.topLeft.x*g,f.topLeft.y*b).rot(c.rotation),x={id:c.id,type:c.type,x:c.x-v.x,y:c.y-v.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:g,h:b}};this.editor.updateShapes([x])}};function getContainerStyle(c){let u=c.props.crop,f=u?.topLeft;if(!f)return{width:c.props.w,height:c.props.h};let g=1/(u.bottomRight.x-u.topLeft.x)*c.props.w,b=1/(u.bottomRight.y-u.topLeft.y)*c.props.h,v=-f.x*g,x=-f.y*b;return{transform:`translate(${v}px, ${x}px)`,width:g,height:b}}function getSvgPathForEdge(c,u){let{start:f,end:g}=c;return u?`M${(0,ts.$Z)(f.x)},${(0,ts.$Z)(f.y)} L${(0,ts.$Z)(g.x)},${(0,ts.$Z)(g.y)} `:`${(0,ts.$Z)(g.x)},${(0,ts.$Z)(g.y)} `}function getSvgPathForBezierCurve(c,u){let{a:f,b:g,c:b,d:v}=c;return tl.G.Equals(f,v)?"":`${u?`M${(0,ts.$Z)(f.x)},${(0,ts.$Z)(f.y)}`:""}C${(0,ts.$Z)(g.x)},${(0,ts.$Z)(g.y)} ${(0,ts.$Z)(b.x)},${(0,ts.$Z)(b.y)} ${(0,ts.$Z)(v.x)},${(0,ts.$Z)(v.y)}`}function getSvgPathForCubicSpline(c,u){let f=c.segments.reduce((c,u,f)=>c+getSvgPathForBezierCurve(u,0===f),"");return u&&(f+="Z"),f}function getSvgPathForPolylineSpline(c,u){let f=c.segments.reduce((c,u,f)=>c+getSvgPathForEdge(u,0===f),"");return u&&(f+="Z"),f}function getSvgPathForLineGeometry(c,u=!1){return c instanceof nA.q?getSvgPathForPolylineSpline(c,u):getSvgPathForCubicSpline(c,u)}function getLineDrawFreehandOptions(c){return{size:c,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function getLineStrokePoints(c,u,f){let g=u.vertices,b=getLineDrawFreehandOptions(f);return getStrokePoints(g,b)}function getLineDrawStrokeOutlinePoints(c,u,f){let g=getLineDrawFreehandOptions(f);return getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getLineStrokePoints(c,u,f),g),g)}function getLineDrawPath(c,u,f){let g=getLineDrawStrokeOutlinePoints(c,u,f);return getSvgPathFromPoints_getSvgPathFromPoints(g)}function getLineIndicatorPath(c,u,f){if("draw"===c.props.dash){let g=getLineStrokePoints(c,u,f);return getSvgPathFromStrokePoints(g)}return getSvgPathForLineGeometry(u)}let i6=new nD._;let LineShapeUtil=class LineShapeUtil extends nS.E{static type="line";static props=e8.BG;static migrations=e8.FH;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsFg=()=>!0;hideSelectionBoundsBg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,canSnap:!0,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,canSnap:!0,index:"a2",x:.1,y:.1}}}}getGeometry(c){return getGeometryForLineShape(c)}getHandles(c){return i6.get(c.props,()=>{let u=c.props.handles,f=getGeometryForLineShape(c),g=Object.values(u).sort(nF.hl),b=g.slice();for(let c=0;c<f.segments.length;c++){let u=f.segments[c],v=u.midPoint(),x=(0,nF.eI)(g[c].index,g[c+1].index);b.push({id:`mid-${c}`,type:"create",index:x,x:v.x,y:v.y})}return b.sort(nF.hl)})}getOutlineSegments(c){let u=this.editor.getShapeGeometry(c);return u.segments.map(c=>c.vertices)}onResize=(c,u)=>{let{scaleX:f,scaleY:g}=u,b=(0,e4.p$)(c.props.handles);return Object.values(c.props.handles).forEach(({id:c,x:u,y:v})=>{b[c].x=u*f,b[c].y=v*g}),{props:{handles:b}}};onHandleChange=(c,{handle:u})=>{let f=(0,e4.p$)(c);switch(u.id){case"start":case"end":f.props.handles[u.id]={...f.props.handles[u.id],x:u.x,y:u.y};break;default:{let g="handle:"+u.index,b=c.props.handles[g];b?f.props.handles[g]={...b,x:u.x,y:u.y}:f.props.handles[g]={id:g,type:"vertex",canBind:!1,index:u.index,x:u.x,y:u.y}}}return f};component(c){let u=useDefaultColorTheme(),f=getGeometryForLineShape(c),g=iM[c.props.size],{dash:b,color:v}=c.props;if("line"===c.props.spline){if("solid"===b){let b=f.points,x="M"+b[0]+"L"+b.slice(1);return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:x,fill:"none",color:v,theme:u}),(0,V.jsx)("path",{d:x,stroke:u[v].solid,strokeWidth:g,fill:"none"})]})}if("dashed"===b||"dotted"===b){let x=f.points,w="M"+x[0]+"L"+x.slice(1);return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:w,fill:"none",color:v,theme:u}),(0,V.jsx)("g",{stroke:u[v].solid,strokeWidth:g,children:f.segments.map((c,u)=>{let{strokeDasharray:v,strokeDashoffset:x}=getPerfectDashProps(c.length,g,{style:b,start:u>0?"outset":"none",end:u<f.segments.length-1?"outset":"none"});return(0,V.jsx)("path",{strokeDasharray:v,strokeDashoffset:x,d:getSvgPathForEdge(c,!0),fill:"none"},u)})})]})}if("draw"===b){let b=f.points,[x,w]=getDrawLinePathData(c.id,b,g);return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:x,fill:"none",color:v,theme:u}),(0,V.jsx)("path",{d:w,stroke:u[v].solid,strokeWidth:g,fill:"none"})]})}}if("cubic"===c.props.spline){let x=getSvgPathForLineGeometry(f);if("solid"===b)return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:x,fill:"none",color:v,theme:u}),(0,V.jsx)("path",{strokeWidth:g,stroke:u[v].solid,fill:"none",d:x})]});if("dashed"===b||"dotted"===b)return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:x,fill:"none",color:v,theme:u}),(0,V.jsx)("g",{stroke:u[v].solid,strokeWidth:g,children:f.segments.map((c,u)=>{let{strokeDasharray:v,strokeDashoffset:x}=getPerfectDashProps(c.length,g,{style:b,start:u>0?"outset":"none",end:u<f.segments.length-1?"outset":"none"});return(0,V.jsx)("path",{strokeDasharray:v,strokeDashoffset:x,d:getSvgPathForBezierCurve(c,!0),fill:"none"},u)})})]});if("draw"===b)return(0,V.jsxs)(nm.g,{id:c.id,children:[(0,V.jsx)(iU,{d:x,fill:"none",color:v,theme:u}),(0,V.jsx)("path",{d:getLineDrawPath(c,f,g),strokeWidth:1,stroke:u[v].solid,fill:u[v].solid})]})}}indicator(c){let u;let f=iM[c.props.size],g=getGeometryForLineShape(c),{dash:b}=c.props;if("line"===c.props.spline){let v=g.points;if("solid"===b||"dotted"===b||"dashed"===b)u="M"+v[0]+"L"+v.slice(1);else{let[g]=getDrawLinePathData(c.id,v,f);u=g}}else u=getLineIndicatorPath(c,g,f);return(0,V.jsx)("path",{d:u})}toSvg(c){let u=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode}),f=u[c.props.color].solid,g=getGeometryForLineShape(c),b=iM[c.props.size];switch(c.props.dash){case"draw":{let u;if(g instanceof CubicSpline2d)u=getLineDrawPath(c,g,b);else{let[f,v]=getDrawLinePathData(c.id,g.points,b);u=v}let v=document.createElementNS("http://www.w3.org/2000/svg","path");return v.setAttribute("stroke-width",b+"px"),v.setAttribute("stroke",f),v.setAttribute("fill","none"),v.setAttribute("d",u),v}case"solid":{let c;if(g instanceof CubicSpline2d)c=getSvgPathForCubicSpline(g,!1);else{let u=g.points;c="M"+u[0]+"L"+u.slice(1)}let u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("stroke-width",b+"px"),u.setAttribute("stroke",f),u.setAttribute("fill","none"),u.setAttribute("d",c),u}default:{let{segments:u}=g,v=document.createElementNS("http://www.w3.org/2000/svg","g");v.setAttribute("stroke",f),v.setAttribute("stroke-width",b.toString());let x=g instanceof CubicSpline2d?getSvgPathForBezierCurve:getSvgPathForEdge;return u.forEach((f,g)=>{let w=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:_,strokeDashoffset:k}=getPerfectDashProps(f.length,b,{style:c.props.dash,start:g>0?"outset":"none",end:g<u.length-1?"outset":"none"});w.setAttribute("stroke-dasharray",_.toString()),w.setAttribute("stroke-dashoffset",k.toString()),w.setAttribute("d",x(f,!0)),w.setAttribute("fill","none"),v.appendChild(w)}),v}}}};function getGeometryForLineShape(c){let{spline:u,handles:f}=c.props,g=Object.values(f).sort(nF.hl).map(tl.G.From);switch(u){case"cubic":return new CubicSpline2d({points:g});case"line":return new nA.q({points:g})}}let NoteShapeUtil=class NoteShapeUtil extends nS.E{static type="note";static props=e8.m0;static migrations=e8.C_;canEdit=()=>!0;hideResizeHandles=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(c){return 200+c.props.growY}getGeometry(c){let u=this.getHeight(c);return new nv.z({width:200,height:u,isFilled:!0})}component(c){let{id:u,type:f,props:{color:g,font:b,size:v,align:x,text:w,verticalAlign:_}}=c,k=useDefaultColorTheme(),E="black"===g?"yellow":g;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{style:{position:"absolute",width:200,height:this.getHeight(c)},children:(0,V.jsxs)("div",{className:"tl-note__container",style:{color:k[E].solid,backgroundColor:k[E].solid},children:[(0,V.jsx)("div",{className:"tl-note__scrim"}),(0,V.jsx)(iq,{id:u,type:f,font:b,size:v,align:x,verticalAlign:_,text:w,labelColor:"black",wrap:!0})]})}),"url"in c.props&&c.props.url&&(0,V.jsx)(HyperlinkButton,{url:c.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(c){return(0,V.jsx)("rect",{rx:"7",width:(0,ts.$Z)(200),height:(0,ts.$Z)(this.getHeight(c))})}toSvg(c,u){u.addExportDef(getFontDefForExport(c.props.font));let f=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode}),g=this.editor.getShapeGeometry(c).bounds,b=document.createElementNS("http://www.w3.org/2000/svg","g"),v="black"===c.props.color?"yellow":c.props.color,x=document.createElementNS("http://www.w3.org/2000/svg","rect");x.setAttribute("rx","10"),x.setAttribute("width","200"),x.setAttribute("height",g.height.toString()),x.setAttribute("fill",f[v].solid),x.setAttribute("stroke",f[v].solid),x.setAttribute("stroke-width","1"),b.appendChild(x);let w=document.createElementNS("http://www.w3.org/2000/svg","rect");w.setAttribute("rx","10"),w.setAttribute("width","200"),w.setAttribute("height",g.height.toString()),w.setAttribute("fill",f.background),w.setAttribute("opacity",".28"),b.appendChild(w);let _=getTextLabelSvgElement({editor:this.editor,shape:c,font:e8.p6[c.props.font],bounds:g});return _.setAttribute("fill",f.text),_.setAttribute("stroke","none"),b.appendChild(_),b}onBeforeCreate=c=>getGrowY(this.editor,c,c.props.growY);onBeforeUpdate=(c,u)=>{if(c.props.text!==u.props.text||c.props.font!==u.props.font||c.props.size!==u.props.size)return getGrowY(this.editor,u,c.props.growY)};onEditEnd=c=>{let{id:u,type:f,props:{text:g}}=c;g.trimEnd()!==c.props.text&&this.editor.updateShapes([{id:u,type:f,props:{text:g.trimEnd()}}])}};function getGrowY(c,u,f=0){let g=c.textMeasure.measureText(u.props.text,{...iA,fontFamily:iD[u.props.font],fontSize:iO[u.props.size],maxWidth:166}),b=g.h+34,v=null;if(b>200?v=b-200:f&&(v=0),null!==v)return{...u,props:{...u.props,growY:v}}}function resizeScaled(c,{initialBounds:u,scaleX:f,scaleY:g,newPoint:b}){let v=Math.max(.01,Math.min(Math.abs(f),Math.abs(g))),x=new tl.G(0,0);f<0&&(x.x=-(u.width*v)),g<0&&(x.y=-(u.height*v));let{x:w,y:_}=tl.G.Add(b,x.rot(c.rotation));return{x:w,y:_,props:{scale:v*c.props.scale}}}let i7=new nD._;let TextShapeUtil=class TextShapeUtil extends nS.E{static type="text";static props=e8.XB;static migrations=e8.pL;getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(c){return i7.get(c.props,c=>getTextSize(this.editor,c))}getGeometry(c){let{scale:u}=c.props,{width:f,height:g}=this.getMinDimensions(c);return new nv.z({width:f*u,height:g*u,isFilled:!0})}canEdit=()=>!0;isAspectRatioLocked=()=>!0;component(c){let{id:u,type:f,props:{text:g,color:b}}=c,v=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode}),{width:x,height:w}=this.getMinDimensions(c),{rInput:_,isEmpty:k,isEditing:E,handleFocus:T,handleChange:$,handleKeyDown:I,handleBlur:M,handleInputPointerDown:j,handleDoubleClick:D}=useEditableText(u,f,g);return(0,V.jsx)(HTMLContainer,{id:c.id,children:(0,V.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":c.props.font,"data-align":c.props.align,"data-hastext":!k,"data-isediting":E,"data-textwrap":!0,style:{fontSize:ij[c.props.size],lineHeight:ij[c.props.size]*iA.lineHeight+"px",transform:`scale(${c.props.scale})`,transformOrigin:"top left",width:Math.max(1,x),height:Math.max(ij[c.props.size]*iA.lineHeight,w),color:v[b].solid},children:[(0,V.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:g}),E?(0,V.jsx)("textarea",{ref:_,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:E,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:g,onFocus:T,onChange:$,onKeyDown:I,onBlur:M,onTouchEnd:stopEventPropagation,onContextMenu:stopEventPropagation,onPointerDown:j,onDoubleClick:D}):null]})})}indicator(c){let u=this.editor.getShapeGeometry(c).bounds;return(0,V.jsx)("rect",{width:(0,ts.$Z)(u.width),height:(0,ts.$Z)(u.height)})}toSvg(c,u){u.addExportDef(getFontDefForExport(c.props.font));let f=(0,e8.y6)({isDarkMode:this.editor.user.isDarkMode}),g=this.editor.getShapeGeometry(c).bounds,b=c.props.text,v=g.width/(c.props.scale??1),x=g.height/(c.props.scale??1),w={fontSize:ij[c.props.size],fontFamily:e8.p6[c.props.font],textAlign:c.props.align,verticalTextAlign:"middle",width:v,height:x,padding:0,lineHeight:iA.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},_=f[c.props.color].solid,k=document.createElementNS("http://www.w3.org/2000/svg","g"),E=createTextSvgElementFromSpans(this.editor,this.editor.textMeasure.measureTextSpans(b,w),{...w,stroke:f.background,strokeWidth:2,fill:f.background,padding:0}),T=E.cloneNode(!0);return T.setAttribute("fill",_),T.setAttribute("stroke","none"),k.append(E),k.append(T),k}onResize=(c,u)=>{let{initialBounds:f,initialShape:g,scaleX:b,handle:v}=u;if("scale_shape"===u.mode||"right"!==v&&"left"!==v)return{id:c.id,type:c.type,...resizeScaled(c,u)};{let u=f.width,x=u*b,w=new tl.G(0,0);x=Math.max(1,Math.abs(x)),"left"===v?(w.x=u-x,b<0&&(w.x+=x)):b<0&&(w.x-=x);let{x:_,y:k}=w.rot(c.rotation).add(g);return{id:c.id,type:c.type,x:_,y:k,props:{w:x/g.props.scale,autoSize:!1}}}};onBeforeCreate=c=>{if(!c.props.autoSize||c.props.text.trim())return;let u=this.getMinDimensions(c);return{...c,x:c.x-u.width/2,y:c.y-u.height/2}};onEditEnd=c=>{let{id:u,type:f,props:{text:g}}=c,b=c.props.text.trimEnd();0===b.length?this.editor.deleteShapes([c.id]):b!==c.props.text&&this.editor.updateShapes([{id:u,type:f,props:{text:g.trimEnd()}}])};onBeforeUpdate=(c,u)=>{let f;if(!u.props.autoSize)return;let g=c.props.size!==u.props.size||c.props.align!==u.props.align||c.props.font!==u.props.font||1!==c.props.scale&&1===u.props.scale,b=c.props.text!==u.props.text;if(!g&&!b)return;let v=this.getMinDimensions(c),x=getTextSize(this.editor,u.props),w=v.width*c.props.scale,_=v.height*c.props.scale,k=x.width*u.props.scale,E=x.height*u.props.scale;switch(u.props.align){case"middle":f=new tl.G((k-w)/2,b?0:(E-_)/2);break;case"end":f=new tl.G(k-w,b?0:(E-_)/2);break;default:if(b)break;f=new tl.G(0,(E-_)/2)}if(!f)return{...u,props:{...u.props,w:k}};{f.rot(u.rotation);let{x:c,y:g}=u;return{...u,x:c-f.x,y:g-f.y,props:{...u.props,w:k}}}};onDoubleClickEdge=c=>c.props.autoSize?1!==c.props.scale?{id:c.id,type:c.type,props:{scale:1}}:void 0:{id:c.id,type:c.type,props:{autoSize:!0}}};function getTextSize(c,u){let{font:f,text:g,autoSize:b,size:v,w:x}=u,w=b?16:Math.max(16,x),_=ij[v],k=c.textMeasure.measureText(g,{...iA,fontFamily:iD[f],fontSize:_,maxWidth:b?null:Math.floor(Math.max(w,x))});return b&&(k.w+=1),{width:Math.max(w,k.w),height:Math.max(_,k.h)}}let VideoShapeUtil=class VideoShapeUtil extends BaseBoxShapeUtil{static type="video";static props=e8.p$;static migrations=e8.lY;canEdit=()=>!0;isAspectRatioLocked=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(c){return(0,V.jsx)(i9,{shape:c,videoUtil:this})}indicator(c){return(0,V.jsx)("rect",{width:(0,ts.$Z)(c.props.w),height:(0,ts.$Z)(c.props.h)})}toSvg(c){let u=document.createElementNS("http://www.w3.org/2000/svg","g"),f=document.createElementNS("http://www.w3.org/2000/svg","image");return f.setAttributeNS("http://www.w3.org/1999/xlink","href",serializeVideo(c.id)),f.setAttribute("width",c.props.w.toString()),f.setAttribute("height",c.props.h.toString()),u.appendChild(f),u}};function serializeVideo(c){let u=c.split(":")[1],f=document.querySelector(`.tl-video-shape-${u}`);if(f){let c=document.createElement("canvas");return c.width=f.videoWidth,c.height=f.videoHeight,c.getContext("2d").drawImage(f,0,0),c.toDataURL("image/png")}throw Error("Video with id "+u+" not found")}let i9=(0,e5.j)(function(c){let{shape:u,videoUtil:f}=c,g=f.editor.getShapeGeometry(u).bounds.w*f.editor.zoomLevel>=110,b=u.props.assetId?f.editor.getAsset(u.props.assetId):null,{time:v,playing:x}=u.props,w=useIsEditing(u.id),_=usePrefersReducedMotion(),k=K.useRef(null),E=K.useCallback(c=>{let g=c.currentTarget;f.editor.updateShapes([{type:"video",id:u.id,props:{playing:!0,time:g.currentTime}}])},[u.id,f.editor]),T=K.useCallback(c=>{let g=c.currentTarget;f.editor.updateShapes([{type:"video",id:u.id,props:{playing:!1,time:g.currentTime}}])},[u.id,f.editor]),$=K.useCallback(c=>{let g=c.currentTarget;w&&f.editor.updateShapes([{type:"video",id:u.id,props:{time:g.currentTime}}])},[w,u.id,f.editor]),[I,M]=K.useState(!1),j=K.useCallback(c=>{let u=c.currentTarget;v!==u.currentTime&&(u.currentTime=v),x||u.pause(),M(!0)},[x,v]);return K.useEffect(()=>{let c=k.current;c&&(I&&!w&&v!==c.currentTime&&(c.currentTime=v),w&&document.activeElement!==c&&c.focus())},[w,I,v]),K.useEffect(()=>{if(_){let c=k.current;c.pause(),c.currentTime=0}},[k,_]),(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(HTMLContainer,{id:u.id,children:(0,V.jsx)("div",{className:"tl-counter-scaled",children:b?.props.src?(0,V.jsx)("video",{ref:k,style:w?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${u.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:w&&g,onPlay:E,onPause:T,onTimeUpdate:$,onLoadedData:j,hidden:!I,children:(0,V.jsx)("source",{src:b.props.src})}):null})}),"url"in u.props&&u.props.url&&(0,V.jsx)(HyperlinkButton,{url:u.props.url,zoomLevel:f.editor.zoomLevel})]})}),oe=[TextShapeUtil,BookmarkShapeUtil,DrawShapeUtil,GeoShapeUtil,NoteShapeUtil,LineShapeUtil,FrameShapeUtil,ArrowShapeUtil,HighlightShapeUtil,EmbedShapeUtil,ImageShapeUtil,VideoShapeUtil];function registerDefaultSideEffects(c){return[c.sideEffects.registerAfterChangeHandler("instance",(u,f)=>{u.isFocused!==f.isFocused&&(f.isFocused?c.getContainer().focus():(c.complete(),c.getContainer().blur()),c.updateViewportScreenBounds())}),c.sideEffects.registerAfterChangeHandler("instance_page_state",(u,f)=>{if(u.croppingShapeId!==f.croppingShapeId){let g=c.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!u.croppingShapeId&&f.croppingShapeId?g||c.setCurrentTool("select.crop.idle"):u.croppingShapeId&&!f.croppingShapeId&&g&&c.setCurrentTool("select.idle")}u.editingShapeId!==f.editingShapeId&&(!u.editingShapeId&&f.editingShapeId?c.isIn("select.editing_shape")||c.setCurrentTool("select.editing_shape"):u.editingShapeId&&!f.editingShapeId&&c.isIn("select.editing_shape")&&c.setCurrentTool("select.idle"))})]}let ScribbleManager=class ScribbleManager{state;points;size;color;opacity;delay;timeoutMs=0;delayRemaining=0;onUpdate;onComplete;prev=null;next=null;constructor(c){let{size:u=20,color:f="accent",opacity:g=.8,delay:b=0,onComplete:v,onUpdate:x}=c;this.onUpdate=x,this.onComplete=v,this.size=u,this.color=f,this.delay=b,this.opacity=g,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}resume=()=>{this.state="active"};pause=()=>{this.state="starting"};stop=()=>{this.delayRemaining=Math.min(this.delayRemaining,200),this.state="stopping"};addPoint=(c,u)=>{let{prev:f}=this,g={x:c,y:u,z:.5};f&&1>tl.G.Dist(f,g)||(this.next=g)};getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}tick=c=>{this.timeoutMs+=c,this.delayRemaining>0&&(this.delayRemaining=Math.max(0,this.delayRemaining-c)),this.timeoutMs>=16&&(this.timeoutMs=0);let{timeoutMs:u,state:f,prev:g,next:b,points:v}=this;switch(f){case"active":b&&b!==g?(this.prev=b,v.push(b),0===this.delayRemaining&&v.length>8&&v.shift(),this.updateScribble()):0===u&&(v.length>1?(v.shift(),this.updateScribble()):this.delayRemaining=this.delay);break;case"stopping":if(0===this.delayRemaining&&0===u){if(1===v.length){this.state="paused",this.onComplete();return}this.size*=.9,v.shift(),this.updateScribble()}}}};let Erasing=class Erasing extends nE.n{static id="erasing";info={};scribble={};markId="";excludedShapeIds=new Set;onEnter=c=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=c;let{originPagePoint:u}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.currentPageShapes.filter(c=>{if(this.editor.isShapeOrAncestorLocked(c))return!0;if(this.editor.isShapeOfType(c,"group")||this.editor.isShapeOfType(c,"frame")){let f=this.editor.getPointInShapeSpace(c,u),g=this.editor.getShapeGeometry(c);return g.bounds.containsPoint(f)}return!1}).map(c=>c.id)),this.startScribble(),this.update()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:c,y:u}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(c,u)};onScribbleUpdate=c=>{this.editor.updateInstanceState({scribble:c})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};update(){let{zoomLevel:c,currentPageShapes:u,erasingShapeIds:f,inputs:{currentPagePoint:g,previousPagePoint:b}}=this.editor,{excludedShapeIds:v}=this;this.pushPointToScribble();let x=new Set(f);for(let f of u){if(this.editor.isShapeOfType(f,"group"))continue;let u=this.editor.getShapeMask(f.id);if(u&&!(0,ts.Of)(g,u))continue;let v=this.editor.getShapeGeometry(f),w=this.editor.getPointInShapeSpace(f,b),_=this.editor.getPointInShapeSpace(f,g);v.hitTestLineSegment(w,_,td.wM/c)&&x.add(this.editor.getOutermostSelectableShape(f).id)}this.editor.setErasingShapes([...x].filter(c=>!v.has(c)))}complete(){this.editor.deleteShapes(this.editor.currentPageState.erasingShapeIds),this.editor.setErasingShapes([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingShapes([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}};let children_Idle_Idle=class children_Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("pointing",c)};onCancel=()=>{this.editor.setCurrentTool("select")}};let children_Pointing_Pointing=class children_Pointing_Pointing extends nE.n{static id="pointing";onEnter=()=>{let{inputs:{currentPagePoint:c},currentPageShapesSorted:u,zoomLevel:f}=this.editor,g=new Set,b=g.size;for(let v=u.length,x=v-1;x>=0;x--){let v=u[x];if(!(this.editor.isShapeOrAncestorLocked(v)||this.editor.isShapeOfType(v,"group"))&&this.editor.isPointInShape(v,c,{hitInside:!1,margin:td.wM/f})){let c=this.editor.getOutermostSelectableShape(v);if(this.editor.isShapeOfType(c,"frame")&&g.size>b)break;g.add(c.id)}}this.editor.setErasingShapes([...g])};onPointerMove=c=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",c)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{erasingShapeIds:c}=this.editor;c.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(c)),this.editor.setErasingShapes([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle",{})}};let EraserTool=class EraserTool extends nE.n{static id="eraser";static initial="idle";static children=()=>[children_Idle_Idle,children_Pointing_Pointing,Erasing];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}};let Dragging=class Dragging extends nE.n{static id="dragging";onEnter=()=>{this.update()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};update(){let{currentScreenPoint:c,previousScreenPoint:u}=this.editor.inputs,f=tl.G.Sub(c,u);(Math.abs(f.x)>0||Math.abs(f.y)>0)&&this.editor.pan(f)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:td.$G}),this.parent.transition("idle",{})}};let HandTool_children_Idle_Idle=class HandTool_children_Idle_Idle extends nE.n{static id="idle";onEnter=()=>{this.editor.setCursor({type:"grab",rotation:0})};onPointerDown=c=>{this.parent.transition("pointing",c)};onCancel=()=>{this.editor.setCurrentTool("select")}};let HandTool_children_Pointing_Pointing=class HandTool_children_Pointing_Pointing extends nE.n{static id="pointing";onEnter=()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onPointerMove=c=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",c)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.complete()};complete(){this.parent.transition("idle",{})}};let HandTool=class HandTool extends nE.n{static id="hand";static initial="idle";static children=()=>[HandTool_children_Idle_Idle,HandTool_children_Pointing_Pointing,Dragging];onDoubleClick=c=>{if("settle"===c.phase){let{currentScreenPoint:c}=this.editor.inputs;this.editor.zoomIn(c,{duration:220,easing:n$.L.easeOutQuint})}};onTripleClick=c=>{if("settle"===c.phase){let{currentScreenPoint:c}=this.editor.inputs;this.editor.zoomOut(c,{duration:320,easing:n$.L.easeOutQuint})}};onQuadrupleClick=c=>{if("settle"===c.phase){let{zoomLevel:c,inputs:{currentScreenPoint:u}}=this.editor;1===c?this.editor.zoomToFit({duration:400,easing:n$.L.easeOutQuint}):this.editor.resetZoom(u,{duration:320,easing:n$.L.easeOutQuint})}}};let LaserTool_children_Idle_Idle=class LaserTool_children_Idle_Idle extends nE.n{static id="idle";onPointerDown=c=>{this.parent.transition("lasering",c)}};let Lasering=class Lasering extends nE.n{static id="lasering";scribble={};onEnter=()=>{this.startScribble(),this.pushPointToScribble()};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.pushPointToScribble()};onPointerUp=()=>{this.complete()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:c,y:u}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(c,u)};onScribbleUpdate=c=>{this.editor.updateInstanceState({scribble:c})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};complete(){this.parent.transition("idle",{})}cancel(){this.parent.transition("idle",{})}};let LaserTool=class LaserTool extends nE.n{static id="laser";static initial="idle";static children=()=>[LaserTool_children_Idle_Idle,Lasering];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}};let Brushing=class Brushing extends nE.n{static id="brushing";info={};brush=new nT.No;initialSelectedShapeIds=[];excludedShapeIds=new Set;initialStartShape=null;onEnter=c=>{let{altKey:u,currentPagePoint:f}=this.editor.inputs;if(u){this.parent.transition("scribble_brushing",c);return}this.excludedShapeIds=new Set(this.editor.currentPageShapes.filter(c=>this.editor.isShapeOfType(c,"group")||this.editor.isShapeOrAncestorLocked(c)).map(c=>c.id)),this.info=c,this.initialSelectedShapeIds=this.editor.selectedShapeIds.slice(),this.initialStartShape=this.editor.getShapesAtPoint(f)[0],this.onPointerMove()};onExit=()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})};onPointerMove=()=>{this.hitTestShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=c=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",c)};onKeyDown=c=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",c):this.hitTestShapes()};onKeyUp=()=>{this.hitTestShapes()};complete(){this.parent.transition("idle",{})}hitTestShapes(){let c,u,f,g,b,v;let{zoomLevel:x,currentPageId:w,currentPageShapes:_,inputs:{originPagePoint:k,currentPagePoint:E,shiftKey:T,ctrlKey:$}}=this.editor;this.brush.setTo(nT.No.FromPoints([k,E]));let I=new Set(T?this.initialSelectedShapeIds:[]),{corners:M}=this.brush,{excludedShapeIds:j}=this;for(let k=0,T=_.length;k<T;k++)if(f=_[k],!(j.has(f.id)||I.has(f.id))&&(g=this.editor.getShapePageBounds(f))){if(this.brush.contains(g)){this.handleHit(f,E,w,I,M);continue}if(!($||this.editor.isShapeOfType(f,"frame"))&&this.brush.collides(g)){let g=this.editor.getShapeGeometry(f);if(!(b=this.editor.getShapePageTransform(f)))continue;v=b.clone().invert().applyToPoints(M);for(let b=0;b<v.length;b++)if(c=v[b],u=v[(b+1)%v.length],g.hitTestLineSegment(c,u,td.wM/x)){this.handleHit(f,E,w,I,M);break}}}this.editor.updateInstanceState({brush:{...this.brush.toJson()}}),this.editor.setSelectedShapes(Array.from(I),{squashing:!0})}onInterrupt=()=>{this.editor.updateInstanceState({brush:null})};handleHit(c,u,f,g,b){if(c.parentId===f){g.add(c.id);return}let v=this.editor.getOutermostSelectableShape(c),x=this.editor.getShapeMask(v.id);(!x||(0,nw.UQ)(x,b)||(0,ts.Of)(u,x))&&g.add(v.id)}};function getHitShapeOnCanvasPointerDown(c){let{zoomLevel:u,inputs:{currentPagePoint:f}}=c;return c.getShapeAtPoint(f,{hitInside:!1,hitLabels:!1,margin:td.wM/u,renderingOnly:!0})??c.getSelectedShapeAtPoint(f)}function getTranslateCroppedImageChange(c,u,f){if(!u)throw Error("Needs to translate a cropped shape!");let{crop:g}=u.props;if(!g)return;let b=c.inputs.shiftKey?Math.abs(f.x)<Math.abs(f.y)?"x":"y":null;"x"===b?f.x=0:"y"===b&&(f.y=0),f.rot(-u.rotation);let v=1/(g.bottomRight.x-g.topLeft.x)*u.props.w,x=1/(g.bottomRight.y-g.topLeft.y)*u.props.h,w=g.bottomRight.y-g.topLeft.y,_=g.bottomRight.x-g.topLeft.x,k=(0,e4.p$)(g);k.topLeft.x=Math.min(1-_,Math.max(0,k.topLeft.x-f.x/v)),k.topLeft.y=Math.min(1-w,Math.max(0,k.topLeft.y-f.y/x)),k.bottomRight.x=k.topLeft.x+_,k.bottomRight.y=k.topLeft.y+w;let E={id:u.id,type:u.type,props:{crop:k}};return E}let Crop_children_Idle_Idle=class Crop_children_Idle_Idle extends nE.n{static id="idle";onEnter=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});let{onlySelectedShape:c}=this.editor;this.editor.on("change-history",this.cleanupCroppingState),c&&(this.editor.mark("crop"),this.editor.setCroppingShape(c.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)};onCancel=()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})};onPointerDown=c=>{if(!this.editor.isMenuOpen){if(c.ctrlKey){this.cancel(),this.editor.root.handleEvent(c);return}switch(c.target){case"canvas":{let u=getHitShapeOnCanvasPointerDown(this.editor);if(u&&!this.editor.isShapeOfType(u,"group")){this.onPointerDown({...c,shape:u,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(c);break}case"shape":if(c.shape.id===this.editor.croppingShapeId){this.editor.setCurrentTool("select.crop.pointing_crop",c);return}this.editor.getShapeUtil(c.shape)?.canCrop(c.shape)?(this.editor.setCroppingShape(c.shape.id),this.editor.setSelectedShapes([c.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",c)):(this.cancel(),this.editor.root.handleEvent(c));break;case"selection":switch(c.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.editor.setCurrentTool("select.pointing_rotate_handle",{...c,onInteractionEnd:"select.crop"});break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":this.editor.setCurrentTool("select.pointing_crop_handle",{...c,onInteractionEnd:"select.crop"});break;default:this.cancel()}}}};onDoubleClick=c=>{if(this.editor.inputs.shiftKey||"up"!==c.phase||!this.editor.croppingShapeId)return;let u=this.editor.getShape(this.editor.croppingShapeId);if(!u)return;let f=this.editor.getShapeUtil(u);f&&"selection"===c.target&&f.onDoubleClickEdge?.(u)};onKeyDown=()=>{this.nudgeCroppingImage(!1)};onKeyRepeat=()=>{this.nudgeCroppingImage(!0)};onKeyUp=c=>{"Enter"===c.code&&(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{}))};cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}cleanupCroppingState=()=>{this.editor.croppingShapeId||this.editor.setCurrentTool("select.idle",{})};nudgeCroppingImage(c=!1){let{editor:{inputs:{keys:u}}}=this,f=u.has("ShiftLeft"),g=new tl.G(0,0);if(u.has("ArrowLeft")&&(g.x+=1),u.has("ArrowRight")&&(g.x-=1),u.has("ArrowUp")&&(g.y+=1),u.has("ArrowDown")&&(g.y-=1),g.equals(new tl.G(0,0)))return;f&&g.mul(10);let b=this.editor.getShape(this.editor.croppingShapeId);if(!b)return;let v=getTranslateCroppedImageChange(this.editor,b,g);v&&(c||this.editor.mark("translate crop"),this.editor.updateShapes([v]))}};let PointingCrop=class PointingCrop extends nE.n{static id="pointing_crop";onCancel=()=>{this.editor.setCurrentTool("select.crop.idle",{})};onPointerMove=c=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",c)};onPointerUp=c=>{this.editor.setCurrentTool("select.crop.idle",c)}};let TranslatingCrop=class TranslatingCrop extends nE.n{static id="translating_crop";info={};markId="translating crop";snapshot={};onEnter=c=>{this.info=c,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onKeyDown=c=>{switch(c.key){case"Alt":case"Shift":this.updateShapes();return}};onKeyUp=c=>{switch(c.key){case"Enter":this.complete();return;case"Alt":case"Shift":this.updateShapes()}};complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){let c=this.editor.onlySelectedShape;return{shape:c}}updateShapes(){let c=this.snapshot.shape;if(!c)return;let{originPagePoint:u,currentPagePoint:f}=this.editor.inputs,g=f.clone().sub(u),b=getTranslateCroppedImageChange(this.editor,c,g);b&&this.editor.updateShapes([b],{squashing:!0})}};let Crop=class Crop extends nE.n{static id="crop";static initial="idle";static children=()=>[Crop_children_Idle_Idle,TranslatingCrop,PointingCrop]};let ot={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};let PointingResizeHandle=class PointingResizeHandle extends nE.n{static id="pointing_resize_handle";info={};updateCursor(){let c=this.editor.selectedShapes,u=ot[this.info.handle];this.editor.updateInstanceState({cursor:{type:u,rotation:1===c.length?c[0].rotation:0}})}onEnter=c=>{this.info=c,this.updateCursor()};onPointerMove=()=>{let c=this.editor.inputs.isDragging;c&&this.parent.transition("resizing",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}};let Cropping=class Cropping extends nE.n{static id="cropping";info={};markId="";snapshot={};onEnter=c=>{this.info=c,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};updateCursor(){let c=this.editor.selectedShapes[0];if(!c)return;let u=ot[this.info.handle];this.editor.updateInstanceState({cursor:{type:u,rotation:c.rotation}})}getDefaultCrop=()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}});updateShapes(){let{shape:c,cursorHandleOffset:u}=this.snapshot;if(!c)return;let f=this.editor.getShapeUtil("image");if(!f)return;let g=c.props,b=this.editor.inputs.currentPagePoint.clone().sub(u),v=this.editor.inputs.originPagePoint.clone().sub(u),x=b.clone().sub(v).rot(-c.rotation),w=g.crop??this.getDefaultCrop(),_=(0,e4.p$)(w),k=new tl.G(c.x,c.y),E=new tl.G(0,0),T=1/(w.bottomRight.x-w.topLeft.x)*g.w,$=1/(w.bottomRight.y-w.topLeft.y)*g.h,I=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if($<8)break;I=!0,_.topLeft.y=_.topLeft.y+x.y/$;let c=$*(_.bottomRight.y-_.topLeft.y);c<8?(_.topLeft.y=_.bottomRight.y-8/$,E.y=(_.topLeft.y-w.topLeft.y)*$):_.topLeft.y<=0?(_.topLeft.y=0,E.y=(_.topLeft.y-w.topLeft.y)*$):E.y=x.y;break}case"bottom":case"bottom_left":case"bottom_right":{if($<8)break;I=!0,_.bottomRight.y=Math.min(1,_.bottomRight.y+x.y/$);let c=$*(_.bottomRight.y-_.topLeft.y);c<8&&(_.bottomRight.y=_.topLeft.y+8/$)}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(T<8)break;I=!0,_.topLeft.x=_.topLeft.x+x.x/T;let c=T*(_.bottomRight.x-_.topLeft.x);c<8?(_.topLeft.x=_.bottomRight.x-8/T,E.x=(_.topLeft.x-w.topLeft.x)*T):_.topLeft.x<=0?(_.topLeft.x=0,E.x=(_.topLeft.x-w.topLeft.x)*T):E.x=x.x;break}case"right":case"top_right":case"bottom_right":{if(T<8)break;I=!0,_.bottomRight.x=Math.min(1,_.bottomRight.x+x.x/T);let c=T*(_.bottomRight.x-_.topLeft.x);c<8&&(_.bottomRight.x=_.topLeft.x+8/T)}}if(!I)return;k.add(E.rot(c.rotation));let M={id:c.id,type:c.type,x:k.x,y:k.y,props:{crop:_,w:(_.bottomRight.x-_.topLeft.x)*T,h:(_.bottomRight.y-_.topLeft.y)*$}};this.editor.updateShapes([M],{squashing:!0}),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}createSnapshot(){let{selectionRotation:c,inputs:{originPagePoint:u}}=this.editor,f=this.editor.onlySelectedShape,g=this.editor.selectionRotatedPageBounds,b=tl.G.RotWith(g.getHandlePoint(this.info.handle),g.point,c),v=tl.G.Sub(u,b);return{shape:f,cursorHandleOffset:v}}};let DraggingHandle=class DraggingHandle extends nE.n{static id="dragging_handle";shapeId="";initialHandle={};initialAdjacentHandle=null;initialPagePoint={};markId="";initialPageTransform;initialPageRotation;info={};isPrecise=!1;isPreciseId=null;pointingId=null;onEnter=c=>{let{shape:u,isCreating:f,handle:g}=c;this.info=c,this.parent.currentToolIdMask=c.onInteractionEnd,this.shapeId=u.id,this.markId=f?`creating:${u.id}`:"dragging handle",f||this.editor.mark(this.markId),this.initialHandle=(0,e4.p$)(g),this.initialPageTransform=this.editor.getShapePageTransform(u),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:f?"cross":"grabbing",rotation:0}},{ephemeral:!0});let b=this.editor.getShapeHandles(u).sort(nF.hl),v=b.findIndex(u=>u.id===c.handle.id);this.initialAdjacentHandle=null;for(let u=v+1;u<b.length;u++){let f=b[u];if("vertex"===f.type&&"middle"!==f.id&&f.id!==c.handle.id){this.initialAdjacentHandle=f;break}}if(!this.initialAdjacentHandle)for(let u=b.length-1;u>=0;u--){let f=b[u];if("vertex"===f.type&&"middle"!==f.id&&f.id!==c.handle.id){this.initialAdjacentHandle=f;break}}let x=u.props[c.handle.id];this.isPrecise=!1,x?.type==="binding"?(this.editor.setHintingShapes([x.boundShapeId]),this.isPrecise=!tl.G.Equals(x.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=x.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([]),this.update(),this.editor.select(this.shapeId)};exactTimeout=-1;resetExactTimeout(){-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.setHintingShapes([]),this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};complete(){this.editor.snaps.clear();let{onInteractionEnd:c}=this.info;if(this.editor.instanceState.isToolLocked&&c){this.editor.setCurrentTool(c,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();let{onInteractionEnd:c}=this.info;if(c){this.editor.setCurrentTool(c,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){let{editor:c,shapeId:u,initialPagePoint:f}=this,{initialHandle:g,initialPageRotation:b,initialAdjacentHandle:v}=this,{user:{isSnapMode:x},hintingShapeIds:w,snaps:_,inputs:{currentPagePoint:k,shiftKey:E,ctrlKey:T,altKey:$,pointerVelocity:I}}=c,M=c.getShape(u);if(!M)return;let j=c.getShapeUtil(M),D=k.clone().sub(f).rot(-b).add(g);if(E&&v&&"middle"!==g.id){let c=tl.G.Angle(v,D),u=(0,ts.nD)(c,24),f=u-c;D=tl.G.RotWith(D,v,f)}if(c.snaps.clear(),g.canSnap&&(x?!T:T)){let u=c.getShapePageTransform(M.id);if(!u)throw Error("Expected a page transform");let f=c.getShapeHandles(M).filter(({type:c})=>"vertex"===c).sort(nF.hl).findIndex(({index:c})=>g.index===c),b=j.getOutlineSegments(M).map(c=>tO.y.applyToPoints(u,c)).filter((c,u)=>u!==f-1&&u!==f),v=_.getSnappingHandleDelta({additionalSegments:b,handlePoint:tO.y.applyToPoint(u,D)});v&&(v.rot(-c.getShapeParentTransform(M).rotation()),D.add(v))}let L=j.onHandleChange?.(M,{handle:{...g,x:D.x,y:D.y},isPrecise:this.isPrecise||$}),F={...M,...L};if(g.canBind){let u=F.props[g.id];u?.type==="binding"?w[0]!==u.boundShapeId&&(c.setHintingShapes([u.boundShapeId]),this.pointingId=u.boundShapeId,this.isPrecise=.5>I.len()||$,this.isPreciseId=this.isPrecise?u.boundShapeId:null,this.resetExactTimeout()):w.length>0&&(c.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}L&&c.updateShapes([F],{squashing:!0})}};let EditingShape=class EditingShape extends nE.n{static id="editing_shape";onEnter=()=>{let{editingShape:c}=this.editor;if(!c)throw Error("Entered editing state without an editing shape");updateHoveredId(this.editor),this.editor.select(c)};onExit=()=>{let{editingShapeId:c}=this.editor.currentPageState;if(!c)return;this.editor.setEditingShape(null);let u=this.editor.getShape(c),f=this.editor.getShapeUtil(u);f.onEditEnd?.(u),setTimeout(()=>{this.editor.updateViewportScreenBounds()},500)};onPointerMove=c=>{switch(c.target){case"shape":case"canvas":updateHoveredId(this.editor);return}};onPointerDown=c=>{switch(c.target){case"canvas":{let u=getHitShapeOnCanvasPointerDown(this.editor);if(u){this.onPointerDown({...c,shape:u,target:"shape"});return}break}case"shape":{let{shape:u}=c,{editingShape:f}=this.editor;if(!f)throw Error("Expected an editing shape!");if(u.type===f.type){if(this.editor.isShapeOfType(u,"geo")||this.editor.isShapeOfType(u,"arrow")){let g=this.editor.getShapeUtil(u).getGeometry(u),b=g.children[1];if(b){let g=this.editor.getPointInShapeSpace(u,this.editor.inputs.currentPagePoint);if(b.bounds.containsPoint(g)){if(u.id===f.id)return;this.parent.transition("pointing_shape",c);return}}}else{u.id===f.id?this.editor.isShapeOfType(u,"frame")&&this.editor.setEditingShape(null):this.parent.transition("pointing_shape",c);return}}}}this.parent.transition("idle",c),this.editor.root.handleEvent(c)};onComplete=c=>{this.parent.transition("idle",c)};onCancel=c=>{this.parent.transition("idle",c)}};function getShouldEnterCropMode(c){let{onlySelectedShape:u}=c;return!!(u&&!c.isShapeOrAncestorLocked(u)&&c.getShapeUtil(u).canCrop(u))}function selectOnCanvasPointerUp(c){let{selectedShapeIds:u}=c,{shiftKey:f,altKey:g,currentPagePoint:b}=c.inputs,v=c.getShapeAtPoint(b,{hitInside:!1,margin:td.wM/c.zoomLevel,hitLabels:!0,renderingOnly:!0,filter:c=>!c.isLocked});if(v){let b=c.getOutermostSelectableShape(v);if(f&&!g)c.cancelDoubleClick(),u.includes(b.id)?(c.mark("deselecting shape"),c.deselect(b)):(c.mark("shift selecting shape"),c.setSelectedShapes([...u,b.id]));else{let f;(f=b===v?v:b.id===c.focusedGroupId||u.includes(b.id)?v:b)&&!u.includes(f.id)&&(c.mark("selecting shape"),c.select(f.id))}}else{if(f)return;{u.length>0&&(c.mark("selecting none"),c.selectNone());let{focusedGroupId:f}=c;if((0,e8.YT)(f)){let u=c.getShape(f);c.isPointInShape(u,b,{margin:0,hitInside:!0})||c.setFocusedGroup(null)}}}}let SelectTool_children_Idle_Idle=class SelectTool_children_Idle_Idle extends nE.n{static id="idle";onEnter=()=>{this.parent.currentToolIdMask=void 0,updateHoveredId(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{updateHoveredId(this.editor)};onPointerDown=c=>{if(this.editor.isMenuOpen)return;let u=c.ctrlKey&&getShouldEnterCropMode(this.editor);if(c.ctrlKey&&!u){if("shape"===c.target&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(c.shape)){this.parent.transition("pointing_shape",c);return}this.parent.transition("brushing",c);return}switch(c.target){case"canvas":{let u=getHitShapeOnCanvasPointerDown(this.editor);if(u){this.onPointerDown({...c,shape:u,target:"shape"});return}let{onlySelectedShape:f,selectedShapeIds:g,inputs:{currentPagePoint:b}}=this.editor;if((g.length>1||f&&!this.editor.getShapeUtil(f).hideSelectionBoundsBg(f))&&isPointInRotatedSelectionBounds(this.editor,b)){this.onPointerDown({...c,target:"selection"});return}this.parent.transition("pointing_canvas",c);break}case"shape":if(this.editor.isShapeOrAncestorLocked(c.shape))break;this.parent.transition("pointing_shape",c);break;case"handle":if(this.editor.instanceState.isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",c):this.parent.transition("pointing_handle",c);break;case"selection":switch(c.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.parent.transition("pointing_rotate_handle",c);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":u?this.parent.transition("pointing_crop_handle",c):this.parent.transition("pointing_resize_handle",c);break;default:{let{hoveredShape:u}=this.editor;if(u&&!this.editor.selectedShapeIds.includes(u.id)){this.onPointerDown({...c,shape:u,target:"shape"});return}this.parent.transition("pointing_selection",c)}}}};onDoubleClick=c=>{if(!this.editor.inputs.shiftKey&&"up"===c.phase)switch(c.target){case"canvas":{let{hoveredShape:u}=this.editor,f=u&&!this.editor.isShapeOfType(u,"group")?u:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:td.wM/this.editor.zoomLevel,hitInside:!1}),{focusedGroupId:g}=this.editor;if(f){if(this.editor.isShapeOfType(f,"group")){selectOnCanvasPointerUp(this.editor);return}{let c=this.editor.getShape(f.parentId);if(c&&this.editor.isShapeOfType(c,"group")){if(g&&c.id===g);else{selectOnCanvasPointerUp(this.editor);return}}}this.onDoubleClick({...c,shape:f,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(c);break}case"selection":{if(this.editor.instanceState.isReadonly)break;let{onlySelectedShape:u}=this.editor;if(u){let f=this.editor.getShapeUtil(u);if(!this.canInteractWithShapeInReadOnly(u))return;if("right"===c.handle||"left"===c.handle||"top"===c.handle||"bottom"===c.handle){let c=f.onDoubleClickEdge?.(u);if(c){this.editor.mark("double click edge"),this.editor.updateShapes([c]);return}}if(f.canCrop(u)&&!this.editor.isShapeOrAncestorLocked(u)){this.parent.transition("crop",c);return}this.shouldStartEditingShape(u)&&this.startEditingShape(u,c)}break}case"shape":{let{shape:u}=c,f=this.editor.getShapeUtil(u);if("video"!==u.type&&"embed"!==u.type&&this.editor.instanceState.isReadonly)break;if(f.onDoubleClick){let g=f.onDoubleClick?.(u);if(g){this.editor.updateShapes([g]);return}if(f.canCrop(u)&&!this.editor.isShapeOrAncestorLocked(u)){this.editor.mark("select and crop"),this.editor.select(c.shape?.id),this.parent.transition("crop",c);return}}this.shouldStartEditingShape(u)?this.startEditingShape(u,c):this.handleDoubleClickOnCanvas(c);break}case"handle":{if(this.editor.instanceState.isReadonly)break;let{shape:u,handle:f}=c,g=this.editor.getShapeUtil(u),b=g.onDoubleClickHandle?.(u,f);b?this.editor.updateShapes([b]):this.shouldStartEditingShape(u)&&this.startEditingShape(u,c)}}};onRightClick=c=>{switch(c.target){case"canvas":{let{hoveredShape:u}=this.editor,f=u&&!this.editor.isShapeOfType(u,"group")?u:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:td.wM/this.editor.zoomLevel,hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(f){this.onRightClick({...c,shape:f,target:"shape"});return}let{onlySelectedShape:g,selectedShapeIds:b,inputs:{currentPagePoint:v}}=this.editor;if((b.length>1||g&&!this.editor.getShapeUtil(g).hideSelectionBoundsBg(g))&&isPointInRotatedSelectionBounds(this.editor,v)){this.onRightClick({...c,target:"selection"});return}this.editor.selectNone();break}case"shape":{let{selectedShapeIds:u}=this.editor.currentPageState,{shape:f}=c,g=this.editor.getOutermostSelectableShape(f,c=>!u.includes(c.id));u.includes(g.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([g.id]))}}};onCancel=()=>{this.editor.focusedGroupId!==this.editor.currentPageId&&this.editor.selectedShapeIds.length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())};onKeyDown=c=>{switch(c.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!1)}};onKeyRepeat=c=>{switch(c.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!0)}};onKeyUp=c=>{if("Enter"===c.code){let{selectedShapes:u}=this.editor;if(u.every(c=>this.editor.isShapeOfType(c,"group"))){this.editor.setSelectedShapes(u.flatMap(c=>this.editor.getSortedChildIdsForParent(c.id)));return}let{onlySelectedShape:f}=this.editor;if(f&&this.shouldStartEditingShape(f)){this.startEditingShape(f,{...c,target:"shape",shape:f});return}getShouldEnterCropMode(this.editor)&&this.parent.transition("crop",c)}};shouldStartEditingShape(c=this.editor.onlySelectedShape){return!(!c||this.editor.isShapeOrAncestorLocked(c)&&"embed"!==c.type)&&!!this.canInteractWithShapeInReadOnly(c)&&this.editor.getShapeUtil(c).canEdit(c)}startEditingShape(c,u){this.editor.isShapeOrAncestorLocked(c)&&"embed"!==c.type||(this.editor.mark("editing shape"),this.editor.setEditingShape(c.id),this.parent.transition("editing_shape",u))}isDarwin=window.navigator.userAgent.toLowerCase().indexOf("mac")>-1;handleDoubleClickOnCanvas(c){if(this.editor.instanceState.isReadonly)return;this.editor.mark("creating text shape");let u=(0,e8.F1)(),{x:f,y:g}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:u,type:"text",x:f,y:g,props:{text:"",autoSize:!0}}]);let b=this.editor.getShape(u);if(!b)return;let v=this.editor.getShapeUtil(b);(!this.editor.instanceState.isReadonly||v.canEditInReadOnly(b))&&(this.editor.setEditingShape(u),this.editor.select(u),this.parent.transition("editing_shape",c))}nudgeSelectedShapes(c=!1){let{editor:{inputs:{keys:u}}}=this,f=u.has("ShiftLeft"),g=new tl.G(0,0);if(u.has("ArrowLeft")&&(g.x-=1),u.has("ArrowRight")&&(g.x+=1),u.has("ArrowUp")&&(g.y-=1),u.has("ArrowDown")&&(g.y+=1),g.equals(new tl.G(0,0)))return;c||this.editor.mark("nudge shapes");let{gridSize:b}=this.editor.documentSettings,v=this.editor.instanceState.isGridMode?f?b*oi:b:f?on:or;this.editor.nudgeShapes(this.editor.selectedShapeIds,g.mul(v))}canInteractWithShapeInReadOnly(c){if(!this.editor.instanceState.isReadonly)return!0;let u=this.editor.getShapeUtil(c);return!!u.canEditInReadOnly(c)}};let on=10,or=1,oi=5;function isPointInRotatedSelectionBounds(c,u){let{selectionRotatedPageBounds:f}=c;if(!f)return!1;let{selectionRotation:g}=c;return g?(0,ts.Of)(u,f.corners.map(c=>tl.G.RotWith(c,f.point,g))):f.containsPoint(u)}let PointingCanvas=class PointingCanvas extends nE.n{static id="pointing_canvas";onEnter=()=>{let{inputs:c}=this.editor;!c.shiftKey&&this.editor.selectedShapeIds.length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())};onPointerMove=c=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",c)};onPointerUp=()=>{selectOnCanvasPointerUp(this.editor),this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{})};complete(){this.parent.transition("idle",{})}};let PointingCropHandle=class PointingCropHandle extends nE.n{static id="pointing_crop_handle";info={};updateCursor(c){let u=ot[this.info.handle];this.editor.updateInstanceState({cursor:{type:u,rotation:c.rotation}})}onEnter=c=>{this.info=c,this.parent.currentToolIdMask=c.onInteractionEnd;let u=this.editor.selectedShapes[0];u&&(this.updateCursor(u),this.editor.setCroppingShape(u.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.currentToolIdMask=void 0};onPointerMove=()=>{let c=this.editor.inputs.isDragging;c&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})};onPointerUp=()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}};let PointingHandle=class PointingHandle extends nE.n{static id="pointing_handle";info={};onEnter=c=>{this.info=c;let u=c.shape.props[c.handle.id];u?.type==="binding"&&this.editor.setHintingShapes([u.boundShapeId]),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onExit=()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerUp=()=>{this.parent.transition("idle",this.info)};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let PointingRotateHandle=class PointingRotateHandle extends nE.n{static id="pointing_rotate_handle";info={};updateCursor(){let{selectionRotation:c}=this.editor;this.editor.updateInstanceState({cursor:{type:ot[this.info.handle],rotation:c}})}onEnter=c=>{this.parent.currentToolIdMask=c.onInteractionEnd,this.info=c,this.updateCursor()};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{let{isDragging:c}=this.editor.inputs;c&&this.parent.transition("rotating",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}};let PointingSelection=class PointingSelection extends nE.n{static id="pointing_selection";info={};onEnter=c=>{this.info=c};onPointerUp=c=>{selectOnCanvasPointerUp(this.editor),this.parent.transition("idle",c)};onPointerMove=c=>{this.editor.inputs.isDragging&&!this.editor.instanceState.isReadonly&&this.parent.transition("translating",c)};onDoubleClick=c=>{let{hoveredShape:u}=this.editor,f=u&&!this.editor.isShapeOfType(u,"group")?u:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(f){this.parent.transition("idle",{}),this.parent.onDoubleClick?.({...c,target:"shape",shape:this.editor.getShape(f)});return}};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let PointingShape=class PointingShape extends nE.n{static id="pointing_shape";hitShape={};hitShapeForPointerUp={};didSelectOnEnter=!1;onEnter=c=>{let{selectedShapeIds:u,focusedGroupId:f,selectionRotatedPageBounds:g,inputs:{currentPagePoint:b,shiftKey:v,altKey:x}}=this.editor;this.hitShape=c.shape;let w=this.editor.getOutermostSelectableShape(c.shape);if(this.editor.getShapeUtil(c.shape).onClick||w.id===f||u.includes(w.id)||this.editor.isAncestorSelected(w.id)||u.length>1&&g?.containsPoint(b)){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=w;return}this.didSelectOnEnter=!0,v&&!x?(this.editor.cancelDoubleClick(),u.includes(w.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...u,w.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([w.id]))};onPointerUp=c=>{let{zoomLevel:u,focusedGroupId:f,selectedShapeIds:g,inputs:{currentPagePoint:b,shiftKey:v}}=this.editor,x=this.editor.getShapeAtPoint(b,{margin:td.wM/u,hitInside:!0,renderingOnly:!0})??this.hitShape,w=x?this.editor.getOutermostSelectableShape(x):this.hitShapeForPointerUp;if(w){let u=this.editor.getShapeUtil(w);if(u.onClick){let f=u.onClick?.(w);if(f){this.editor.mark("shape on click"),this.editor.updateShapes([f]),this.parent.transition("idle",c);return}}if(w.id===f){g.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",c);return}}if(!this.didSelectOnEnter){let c=this.editor.getOutermostSelectableShape(x,c=>!g.includes(c.id));if(g.includes(c.id)){if(v)this.editor.mark("deselecting on pointer up"),this.editor.deselect(w);else if(g.includes(w.id)){if(1===g.length&&(this.editor.isShapeOfType(w,"geo")||this.editor.isShapeOfType(w,"arrow"))){let c=this.editor.getShapeGeometry(w),u=c.children[1];if(u){let c=this.editor.getPointInShapeSpace(w,b);if(u.bounds.containsPoint(c,0)&&u.hitTestPoint(c)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(w.id);let c=this.editor.getShapeUtil(w);(!this.editor.instanceState.isReadonly||c.canEditInReadOnly(w))&&(this.editor.setEditingShape(w.id),this.editor.setCurrentTool("select.editing_shape"))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(w.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(w)}else if(v){let u=this.editor.getShapeAncestors(c);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.selectedShapeIds.filter(c=>!u.find(u=>u.id===c)),c.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([c.id])}this.parent.transition("idle",c)};onPointerMove=c=>{this.editor.inputs.isDragging&&!this.editor.instanceState.isReadonly&&this.parent.transition("translating",c)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let Resizing=class Resizing extends nE.n{static id="resizing";info={};markId="";creationCursorOffset={x:0,y:0};editAfterComplete=!1;snapshot={};onEnter=c=>{let{isCreating:u=!1,editAfterComplete:f=!1,creationCursorOffset:g={x:0,y:0}}=c;this.info=c,this.parent.currentToolIdMask=c.onInteractionEnd,this.editAfterComplete=f,this.creationCursorOffset=g,c.isCreating&&this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0}),this.snapshot=this._createSnapshot(),this.markId=u?`creating:${this.editor.onlySelectedShape.id}`:"starting resizing",u||this.editor.mark(this.markId),this.handleResizeStart(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{this.updateShapes()};onKeyUp=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape){this.editor.setEditingShape(this.editor.onlySelectedShape.id),this.editor.setCurrentTool("select.editing_shape");return}if(this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){let{shapeSnapshots:c}=this.snapshot,u=[];c.forEach(({shape:c})=>{let f=this.editor.getShapeUtil(c),g=f.onResizeStart?.(c);g&&u.push(g)}),u.length>0&&this.editor.updateShapes(u)}handleResizeEnd(){let{shapeSnapshots:c}=this.snapshot,u=[];c.forEach(({shape:c})=>{let f=this.editor.getShape(c.id),g=this.editor.getShapeUtil(c),b=g.onResizeEnd?.(c,f);b&&u.push(b)}),u.length>0&&this.editor.updateShapes(u)}updateShapes(){let{altKey:c,shiftKey:u}=this.editor.inputs,{shapeSnapshots:f,selectionBounds:g,cursorHandleOffset:b,selectedShapeIds:v,selectionRotation:x,canShapesDeform:w}=this.snapshot,_=u||!w,{ctrlKey:k}=this.editor.inputs,E=this.editor.inputs.currentPagePoint.clone().sub(b).sub(this.creationCursorOffset),T=this.editor.inputs.originPagePoint.clone().sub(b);if(this.editor.instanceState.isGridMode&&!k){let{gridSize:c}=this.editor.documentSettings;E.snapToGrid(c)}let $=this.info.handle,I=rotateSelectionHandle($,Math.PI);this.editor.snaps.clear();let M=this.editor.user.isSnapMode?!k:k;if(M&&x%ts.gc==0){let{nudge:u}=this.editor.snaps.snapResize({dragDelta:tl.G.Sub(E,T),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:rotateSelectionHandle($,x),isAspectRatioLocked:_,isResizingFromCenter:c});E.add(u)}let j=tl.G.RotWith(c?g.center:g.getHandlePoint(I),g.point,x),D=tl.G.Sub(E,j).rot(-x),L=tl.G.Sub(T,j).rot(-x),F=tl.G.DivV(D,L);Number.isFinite(F.x)||(F.x=1),Number.isFinite(F.y)||(F.y=1);let B="top"===$||"bottom"===$,G="left"===$||"right"===$;for(let c of(_?G?F.y=Math.abs(F.x):B?F.x=Math.abs(F.y):Math.abs(F.x)>Math.abs(F.y)?F.y=Math.abs(F.x)*(F.y<0?-1:1):F.x=Math.abs(F.y)*(F.x<0?-1:1):(B&&(F.x=1),G&&(F.y=1)),this.info.isCreating||this.updateCursor({dragHandle:$,isFlippedX:F.x<0,isFlippedY:F.y<0,rotation:x}),f.keys())){let u=f.get(c);this.editor.resizeShape(c,F,{initialShape:u.shape,initialBounds:u.bounds,initialPageTransform:u.pageTransform,dragHandle:$,mode:1===v.length&&c===v[0]?"resize_bounds":"scale_shape",scaleOrigin:j,scaleAxisRotation:x})}}updateCursor({dragHandle:c,isFlippedX:u,isFlippedY:f,rotation:g}){let b={...this.editor.instanceState.cursor};switch(c){case"top_left":case"bottom_right":b.type="nwse-resize",u!==f&&(b.type="nesw-resize");break;case"top_right":case"bottom_left":b.type="nesw-resize",u!==f&&(b.type="nwse-resize")}b.rotation=g,this.editor.setCursor(b)}onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clear()};_createSnapshot=()=>{let{selectedShapeIds:c,selectionRotation:u,inputs:{originPagePoint:f}}=this.editor,g=this.editor.selectionRotatedPageBounds,b=tl.G.RotWith(g.getHandlePoint(this.info.handle),g.point,u),v=tl.G.Sub(f,b),x=new Map;c.forEach(u=>{let f=this.editor.getShape(u);if(f){if(x.set(f.id,this._createShapeSnapshot(f)),this.editor.isShapeOfType(f,"frame")&&1===c.length)return;this.editor.visitDescendants(f.id,c=>{let u=this.editor.getShape(c);if(u&&(x.set(u.id,this._createShapeSnapshot(u)),this.editor.isShapeOfType(u,"frame")))return!1})}});let w=![...x.values()].some(c=>!(0,ts._G)(c.pageRotation,u)||c.isAspectRatioLocked);return{shapeSnapshots:x,selectionBounds:g,cursorHandleOffset:v,selectionRotation:u,selectedShapeIds:c,canShapesDeform:w,initialSelectionPageBounds:this.editor.selectionPageBounds}};_createShapeSnapshot=c=>{let u=this.editor.getShapePageTransform(c),f=this.editor.getShapeUtil(c);return{shape:c,bounds:this.editor.getShapeGeometry(c).bounds,pageTransform:u,pageRotation:tO.y.Decompose(u).rotation,isAspectRatioLocked:f.isAspectRatioLocked(c)}}};let oo=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function rotateSelectionHandle(c,u){u%=ts.yo;let f=Math.round(u/(ts.PI/4)),g=oo.indexOf(c);return oo[(g+f)%oo.length]}let Rotating=class Rotating extends nE.n{static id="rotating";snapshot={};info={};markId="";onEnter=c=>{this.info=c,this.parent.currentToolIdMask=c.onInteractionEnd,this.markId="rotate start",this.editor.mark(this.markId);let u=(0,nB.o)({editor:this.editor});if(!u)return this.parent.transition("idle",this.info);this.snapshot=u,this.handleStart()};onExit=()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.currentToolIdMask=void 0,this.snapshot={}};onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};update=()=>{let c=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,nB.Z)({editor:this.editor,delta:c,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:ot[this.info.handle],rotation:c+this.snapshot.initialSelectionRotation}})};cancel=()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};complete=()=>{(0,nB.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};handleStart(){let c=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,nB.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:ot[this.info.handle],rotation:c+this.snapshot.initialSelectionRotation}})}_getRotationFromPointerPosition({snapToNearestDegree:c}){let{selectionRotatedPageBounds:u,selectionRotation:f,inputs:{shiftKey:g,currentPagePoint:b}}=this.editor,{initialCursorAngle:v,initialSelectionRotation:x}=this.snapshot;if(!u)return x;let w=u.center.clone().rotWith(u.point,f),_=w.angle(b)-v,k=x+_;if(g)k=(0,ts.nD)(k,24);else if(c&&(k=Math.round(k/ts.Ib)*ts.Ib,this.editor.instanceState.isCoarsePointer)){let c=(0,ts.nD)(k,4),u=(0,ts.Cc)(k,c);Math.abs(u)<(0,ts.Ht)(5)&&(k=c)}return k-x}};let ScribbleBrushing=class ScribbleBrushing extends nE.n{static id="scribble_brushing";hits=new Set;size=0;scribble={};initialSelectedShapeIds=new Set;newlySelectedShapeIds=new Set;onEnter=()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.selectedShapeIds:[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateScribbleSelection(!0),requestAnimationFrame(()=>{this.editor.updateInstanceState({brush:null})})};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.updateScribbleSelection(!0)};onPointerUp=()=>{this.complete()};onKeyDown=()=>{this.updateScribbleSelection(!1)};onKeyUp=()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing",{})};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:c,y:u}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(c,u)};onScribbleUpdate=c=>{this.editor.updateInstanceState({scribble:c})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};updateScribbleSelection(c){let u,f,g,b;let{zoomLevel:v,currentPageShapes:x,inputs:{shiftKey:w,originPagePoint:_,previousPagePoint:k,currentPagePoint:E}}=this.editor,{newlySelectedShapeIds:T,initialSelectedShapeIds:$}=this;c&&this.pushPointToScribble();for(let c=0,w=x.length;c<w;c++)if(u=x[c],f=this.editor.getShapeGeometry(u),!(this.editor.isShapeOfType(u,"group")||T.has(u.id)||this.editor.isShapeOrAncestorLocked(u))){if(this.editor.isShapeOfType(u,"frame")){let c=this.editor.getPointInShapeSpace(u,_);if(f.bounds.containsPoint(c))continue}if(g=this.editor.getPointInShapeSpace(u,k),b=this.editor.getPointInShapeSpace(u,E),f.hitTestLineSegment(g,b,td.wM/v)){let c=this.editor.getOutermostSelectableShape(u),f=this.editor.getShapeMask(c.id);if(f){let c=(0,nw.Gc)(k,E,f);if(null!==c){let c=(0,ts.Of)(E,f);if(!c)continue}}T.add(c.id)}}this.editor.setSelectedShapes([...new Set(w?[...T,...$]:[...T])],{squashing:!0})}complete(){this.parent.transition("idle",{})}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle",{})}};let DragAndDropManager=class DragAndDropManager{constructor(c){this.editor=c,c.disposables.add(this.dispose)}prevDroppingShapeId=null;droppingNodeTimer=null;first=!0;updateDroppingNode(c,u){this.first&&(this.prevDroppingShapeId=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,c)?.id??null,this.first=!1),null===this.droppingNodeTimer?this.setDragTimer(c,1e3,u):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(c,100,u))}setDragTimer(c,u,f){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,c,f)}),this.droppingNodeTimer=null},u)}handleDrag(c,u,f){u=(0,e4.oA)(u.map(c=>this.editor.getShape(c.id)));let g=this.editor.getDroppingOverShape(c,u)?.id??null;if(g===this.prevDroppingShapeId)return;let{prevDroppingShapeId:b}=this,v=b&&this.editor.getShape(b),x=g&&this.editor.getShape(g);if(v&&this.editor.getShapeUtil(v).onDragShapesOut?.(v,u),x){let c=this.editor.getShapeUtil(x).onDragShapesOver?.(x,u);c&&c.shouldHint&&this.editor.setHintingShapes([x.id])}else this.editor.setHintingShapes([]);f?.(),this.prevDroppingShapeId=g}dropShapes(c){let{prevDroppingShapeId:u}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,c),u){let f=this.editor.getShape(u);if(!f)return;this.editor.getShapeUtil(f).onDropShapesOver?.(f,c)}}clear(){this.prevDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}dispose=()=>{this.clear()}};let Translating=class Translating extends nE.n{static id="translating";info={};selectionSnapshot={};snapshot={};markId="";isCloning=!1;isCreating=!1;editAfterComplete=!1;dragAndDropManager=new DragAndDropManager(this.editor);onEnter=c=>{let{isCreating:u=!1,editAfterComplete:f=!1}=c;if(this.info=c,this.parent.currentToolIdMask=c.onInteractionEnd,this.isCreating=u,this.editAfterComplete=f,this.markId=u?`creating:${this.editor.onlySelectedShape.id}`:"translating",this.editor.mark(this.markId),this.isCloning=!1,this.info=c,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=getTranslatingSnapshot(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes(),this.editor.on("tick",this.updateParent)};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.dragAndDropManager.clear()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()};onKeyUp=()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.selectedShapeIds)),this.snapshot=getTranslatingSnapshot(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}updateParent=()=>{let{snapshot:c}=this;this.dragAndDropManager.updateDroppingNode(c.movingShapes,this.updateParentTransforms)};reset(){this.editor.bailToMark(this.markId)}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setCurrentTool(this.info.onInteractionEnd);else if(this.editAfterComplete){let c=this.editor.onlySelectedShape;c&&(this.editor.setEditingShape(c.id),this.editor.setCurrentTool("select.editing_shape"))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){let{movingShapes:c}=this.snapshot,u=[];c.forEach(c=>{let f=this.editor.getShapeUtil(c),g=f.onTranslateStart?.(c);g&&u.push(g)}),u.length>0&&this.editor.updateShapes(u),this.editor.setHoveredShape(null)}handleEnd(){let{movingShapes:c}=this.snapshot,u=[];c.forEach(c=>{let f=this.editor.getShape(c.id),g=this.editor.getShapeUtil(c),b=g.onTranslateEnd?.(c,f);b&&u.push(b)}),u.length>0&&this.editor.updateShapes(u)}handleChange(){let{movingShapes:c}=this.snapshot,u=[];c.forEach(c=>{let f=this.editor.getShape(c.id),g=this.editor.getShapeUtil(c),b=g.onTranslate?.(c,f);b&&u.push(b)}),u.length>0&&this.editor.updateShapes(u)}updateShapes(){let{snapshot:c}=this;this.dragAndDropManager.updateDroppingNode(c.movingShapes,this.updateParentTransforms),moveShapesToPoint({editor:this.editor,shapeSnapshots:c.shapeSnapshots,averagePagePoint:c.averagePagePoint,initialSelectionPageBounds:c.initialPageBounds,initialSelectionSnapPoints:c.initialSnapPoints}),this.handleChange()}updateParentTransforms=()=>{let{editor:c,snapshot:{shapeSnapshots:u}}=this,f=[];u.forEach(u=>{let g=c.getShape(u.shape.id);if(!g)return null;f.push(g);let b=(0,e8.r5)(g.parentId)?null:tO.y.Inverse(c.getShapePageTransform(g.parentId));u.parentTransform=b})}};function getTranslatingSnapshot(c){let u=[],f=[],g=(0,e4.oA)(c.selectedShapeIds.map(g=>{let b=c.getShape(g);if(!b)return null;u.push(b);let v=c.getShapePageTransform(g).point();if(!v)return null;f.push(v);let x=e8.ez.isId(b.parentId)?null:tO.y.Inverse(c.getShapePageTransform(b.parentId));return{shape:b,pagePoint:v,parentTransform:x}}));return{averagePagePoint:tl.G.Average(f),movingShapes:u,shapeSnapshots:g,initialPageBounds:c.selectionPageBounds,initialSnapPoints:1===c.selectedShapeIds.length?c.snaps.snapPointsCache.get(c.selectedShapeIds[0]):c.selectionPageBounds?c.selectionPageBounds.snapPoints.map((c,u)=>({id:"selection:"+u,x:c.x,y:c.y})):[]}}function moveShapesToPoint({editor:c,shapeSnapshots:u,averagePagePoint:f,initialSelectionPageBounds:g,initialSelectionSnapPoints:b}){let{inputs:v,instanceState:{isGridMode:x},documentSettings:{gridSize:w}}=c,_=tl.G.Sub(v.currentPagePoint,v.originPagePoint),k=c.inputs.shiftKey?Math.abs(_.x)<Math.abs(_.y)?"x":"y":null;"x"===k?_.x=0:"y"===k&&(_.y=0),c.snaps.clear();let E=(c.user.isSnapMode?!v.ctrlKey:v.ctrlKey)&&.5>c.inputs.pointerVelocity.len();if(E){let{nudge:u}=c.snaps.snapTranslate({dragDelta:_,initialSelectionPageBounds:g,lockedAxis:k,initialSelectionSnapPoints:b});_.add(u)}let T=tl.G.Add(f,_);x&&!v.ctrlKey&&T.snapToGrid(w);let $=tl.G.Sub(T,f);c.updateShapes((0,e4.oA)(u.map(({shape:c,pagePoint:u,parentTransform:f})=>{let g=tl.G.Add(u,$),b=f?tO.y.applyToPoint(f,g):g;return{id:c.id,type:c.type,x:b.x,y:b.y}})),{squashing:!0})}let SelectTool=class SelectTool extends nE.n{static id="select";static initial="idle";static children=()=>[Crop,Cropping,SelectTool_children_Idle_Idle,PointingCanvas,PointingShape,Translating,Brushing,ScribbleBrushing,PointingCropHandle,PointingSelection,PointingResizeHandle,EditingShape,Resizing,Rotating,PointingRotateHandle,PointingHandle,DraggingHandle];onExit=()=>{this.editor.currentPageState.editingShapeId&&this.editor.setEditingShape(null)}};let ZoomTool_children_Idle_Idle=class ZoomTool_children_Idle_Idle extends nE.n{static id="idle";info={};onEnter=c=>{this.info=c};onPointerDown=()=>{this.parent.transition("pointing",this.info)}};let ZoomTool_children_Pointing_Pointing=class ZoomTool_children_Pointing_Pointing extends nE.n{static id="pointing";info={};onEnter=c=>{this.info=c};onPointerUp=()=>{this.complete()};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)};onCancel=()=>{this.cancel()};complete(){let{currentScreenPoint:c}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(c,{duration:220}):this.editor.zoomIn(c,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}};let ZoomBrushing=class ZoomBrushing extends nE.n{static id="zoom_brushing";info={};zoomBrush=new nT.No;onEnter=c=>{this.info=c,this.update()};onExit=()=>{this.editor.updateInstanceState({zoomBrush:null})};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};update(){let{inputs:{originPagePoint:c,currentPagePoint:u}}=this.editor;this.zoomBrush.setTo(nT.No.FromPoints([c,u])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){let{zoomBrush:c}=this,u=8/this.editor.zoomLevel;if(c.width<u&&c.height<u){let c=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(c,{duration:220}):this.editor.zoomIn(c,{duration:220})}else{let u=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(c,u,{duration:220})}this.parent.transition("idle",this.info)}};let ZoomTool=class ZoomTool extends nE.n{static id="zoom";static initial="idle";static children=()=>[ZoomTool_children_Idle_Idle,ZoomBrushing,ZoomTool_children_Pointing_Pointing];info={};onEnter=c=>{this.info=c,this.currentToolIdMask=c.onInteractionEnd,this.updateCursor()};onExit=()=>{this.currentToolIdMask=void 0,this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.currentToolIdMask=void 0};onKeyDown=()=>{this.updateCursor()};onKeyUp=c=>{this.updateCursor(),"KeyZ"===c.code&&this.complete()};onInterrupt=()=>{this.complete()};complete(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}};let oa=[EraserTool,HandTool,LaserTool,ZoomTool,SelectTool],os=(0,K.forwardRef)((c,u)=>(0,K.createElement)(en.span,_extends({},c,{ref:u,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...c.style}}))),ol="ToastProvider",[oc,ou,od]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2("Toast"),[oh,op]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Toast",[od]),[of,og]=oh(ol),$054eb8030ebde76e$export$f5d03d415824e0e=c=>{let{__scopeToast:u,label:f="Notification",duration:g=5e3,swipeDirection:b="right",swipeThreshold:v=50,children:x}=c,[w,_]=(0,K.useState)(null),[k,E]=(0,K.useState)(0),T=(0,K.useRef)(!1),$=(0,K.useRef)(!1);return(0,K.createElement)(oc.Provider,{scope:u},(0,K.createElement)(of,{scope:u,label:f,duration:g,swipeDirection:b,swipeThreshold:v,toastCount:k,viewport:w,onViewportChange:_,onToastAdd:(0,K.useCallback)(()=>E(c=>c+1),[]),onToastRemove:(0,K.useCallback)(()=>E(c=>c-1),[]),isFocusedToastEscapeKeyDownRef:T,isClosePausedRef:$},x))};$054eb8030ebde76e$export$f5d03d415824e0e.propTypes={label(c){if(c.label&&"string"==typeof c.label&&!c.label.trim()){let c=`Invalid prop \`label\` supplied to \`${ol}\`. Expected non-empty \`string\`.`;return Error(c)}return null}};let om=["F8"],oy="toast.viewportPause",ob="toast.viewportResume",ov=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,hotkey:g=om,label:b="Notifications ({hotkey})",...v}=c,x=og("ToastViewport",f),w=ou(f),_=(0,K.useRef)(null),k=(0,K.useRef)(null),E=(0,K.useRef)(null),T=(0,K.useRef)(null),$=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,T,x.onViewportChange),I=g.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=x.toastCount>0;(0,K.useEffect)(()=>{let handleKeyDown=c=>{var u;let f=g.every(u=>c[u]||c.code===u);f&&(null===(u=T.current)||void 0===u||u.focus())};return document.addEventListener("keydown",handleKeyDown),()=>document.removeEventListener("keydown",handleKeyDown)},[g]),(0,K.useEffect)(()=>{let c=_.current,u=T.current;if(M&&c&&u){let handlePause=()=>{if(!x.isClosePausedRef.current){let c=new CustomEvent(oy);u.dispatchEvent(c),x.isClosePausedRef.current=!0}},handleResume=()=>{if(x.isClosePausedRef.current){let c=new CustomEvent(ob);u.dispatchEvent(c),x.isClosePausedRef.current=!1}},handleFocusOutResume=u=>{let f=!c.contains(u.relatedTarget);f&&handleResume()},handlePointerLeaveResume=()=>{let u=c.contains(document.activeElement);u||handleResume()};return c.addEventListener("focusin",handlePause),c.addEventListener("focusout",handleFocusOutResume),c.addEventListener("pointermove",handlePause),c.addEventListener("pointerleave",handlePointerLeaveResume),window.addEventListener("blur",handlePause),window.addEventListener("focus",handleResume),()=>{c.removeEventListener("focusin",handlePause),c.removeEventListener("focusout",handleFocusOutResume),c.removeEventListener("pointermove",handlePause),c.removeEventListener("pointerleave",handlePointerLeaveResume),window.removeEventListener("blur",handlePause),window.removeEventListener("focus",handleResume)}}},[M,x.isClosePausedRef]);let j=(0,K.useCallback)(({tabbingDirection:c})=>{let u=w(),f=u.map(u=>{let f=u.ref.current,g=[f,...$054eb8030ebde76e$var$getTabbableCandidates(f)];return"forwards"===c?g:g.reverse()});return("forwards"===c?f.reverse():f).flat()},[w]);return(0,K.useEffect)(()=>{let c=T.current;if(c){let handleKeyDown=u=>{let f=u.altKey||u.ctrlKey||u.metaKey,g="Tab"===u.key&&!f;if(g){var b,v,x;let f=document.activeElement,g=u.shiftKey,w=u.target===c;if(w&&g){null===(b=k.current)||void 0===b||b.focus();return}let _=j({tabbingDirection:g?"backwards":"forwards"}),T=_.findIndex(c=>c===f);$054eb8030ebde76e$var$focusFirst(_.slice(T+1))?u.preventDefault():g?null===(v=k.current)||void 0===v||v.focus():null===(x=E.current)||void 0===x||x.focus()}};return c.addEventListener("keydown",handleKeyDown),()=>c.removeEventListener("keydown",handleKeyDown)}},[w,j]),(0,K.createElement)(ea,{ref:_,role:"region","aria-label":b.replace("{hotkey}",I),tabIndex:-1,style:{pointerEvents:M?void 0:"none"}},M&&(0,K.createElement)(oS,{ref:k,onFocusFromOutsideViewport:()=>{let c=j({tabbingDirection:"forwards"});$054eb8030ebde76e$var$focusFirst(c)}}),(0,K.createElement)(oc.Slot,{scope:f},(0,K.createElement)(en.ol,_extends({tabIndex:-1},v,{ref:$}))),M&&(0,K.createElement)(oS,{ref:E,onFocusFromOutsideViewport:()=>{let c=j({tabbingDirection:"backwards"});$054eb8030ebde76e$var$focusFirst(c)}}))}),oS=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,onFocusFromOutsideViewport:g,...b}=c,v=og("ToastFocusProxy",f);return(0,K.createElement)(os,_extends({"aria-hidden":!0,tabIndex:0},b,{ref:u,style:{position:"fixed"},onFocus:c=>{var u;let f=c.relatedTarget,b=!(null!==(u=v.viewport)&&void 0!==u&&u.contains(f));b&&g()}}))}),ox="Toast",ow=(0,K.forwardRef)((c,u)=>{let{forceMount:f,open:g,defaultOpen:b,onOpenChange:v,...x}=c,[w=!0,_]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:g,defaultProp:b,onChange:v});return(0,K.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:f||w},(0,K.createElement)(oC,_extends({open:w},x,{ref:u,onClose:()=>_(!1),onPause:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c.onPause),onResume:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c.onResume),onSwipeStart:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onSwipeMove,c=>{let{x:u,y:f}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onSwipeEnd,c=>{let{x:u,y:f}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),_(!1)})})))}),[o_,ok]=oh(ox,{onClose(){}}),oC=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,type:g="foreground",duration:b,open:v,onClose:x,onEscapeKeyDown:w,onPause:_,onResume:k,onSwipeStart:E,onSwipeMove:T,onSwipeCancel:$,onSwipeEnd:I,...M}=c,j=og(ox,f),[D,L]=(0,K.useState)(null),F=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>L(c)),B=(0,K.useRef)(null),G=(0,K.useRef)(null),U=b||j.duration,V=(0,K.useRef)(0),Z=(0,K.useRef)(U),Y=(0,K.useRef)(0),{onToastAdd:X,onToastRemove:J}=j,ee=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(()=>{var c;let u=null==D?void 0:D.contains(document.activeElement);u&&(null===(c=j.viewport)||void 0===c||c.focus()),x()}),et=(0,K.useCallback)(c=>{c&&c!==1/0&&(window.clearTimeout(Y.current),V.current=new Date().getTime(),Y.current=window.setTimeout(ee,c))},[ee]);(0,K.useEffect)(()=>{let c=j.viewport;if(c){let handleResume=()=>{et(Z.current),null==k||k()},handlePause=()=>{let c=new Date().getTime()-V.current;Z.current=Z.current-c,window.clearTimeout(Y.current),null==_||_()};return c.addEventListener(oy,handlePause),c.addEventListener(ob,handleResume),()=>{c.removeEventListener(oy,handlePause),c.removeEventListener(ob,handleResume)}}},[j.viewport,U,_,k,et]),(0,K.useEffect)(()=>{v&&!j.isClosePausedRef.current&&et(U)},[v,U,j.isClosePausedRef,et]),(0,K.useEffect)(()=>(X(),()=>J()),[X,J]);let er=(0,K.useMemo)(()=>D?$054eb8030ebde76e$var$getAnnounceTextContent(D):null,[D]);return j.viewport?(0,K.createElement)(K.Fragment,null,er&&(0,K.createElement)($054eb8030ebde76e$var$ToastAnnounce,{__scopeToast:f,role:"status","aria-live":"foreground"===g?"assertive":"polite","aria-atomic":!0},er),(0,K.createElement)(o_,{scope:f,onClose:ee},(0,Q.createPortal)((0,K.createElement)(oc.ItemSlot,{scope:f},(0,K.createElement)(eo,{asChild:!0,onEscapeKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(w,()=>{j.isFocusedToastEscapeKeyDownRef.current||ee(),j.isFocusedToastEscapeKeyDownRef.current=!1})},(0,K.createElement)(en.li,_extends({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":v?"open":"closed","data-swipe-direction":j.swipeDirection},M,{ref:F,style:{userSelect:"none",touchAction:"none",...c.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{"Escape"!==c.key||(null==w||w(c.nativeEvent),c.nativeEvent.defaultPrevented||(j.isFocusedToastEscapeKeyDownRef.current=!0,ee()))}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDown,c=>{0===c.button&&(B.current={x:c.clientX,y:c.clientY})}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,c=>{if(!B.current)return;let u=c.clientX-B.current.x,f=c.clientY-B.current.y,g=!!G.current,b=["left","right"].includes(j.swipeDirection),v=["left","up"].includes(j.swipeDirection)?Math.min:Math.max,x=b?v(0,u):0,w=b?0:v(0,f),_="touch"===c.pointerType?10:2,k={x:x,y:w},$={originalEvent:c,delta:k};g?(G.current=k,$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeMove",T,$,{discrete:!1})):$054eb8030ebde76e$var$isDeltaInDirection(k,j.swipeDirection,_)?(G.current=k,$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeStart",E,$,{discrete:!1}),c.target.setPointerCapture(c.pointerId)):(Math.abs(u)>_||Math.abs(f)>_)&&(B.current=null)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerUp,c=>{let u=G.current,f=c.target;if(f.hasPointerCapture(c.pointerId)&&f.releasePointerCapture(c.pointerId),G.current=null,B.current=null,u){let f=c.currentTarget,g={originalEvent:c,delta:u};$054eb8030ebde76e$var$isDeltaInDirection(u,j.swipeDirection,j.swipeThreshold)?$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeEnd",I,g,{discrete:!0}):$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeCancel",$,g,{discrete:!0}),f.addEventListener("click",c=>c.preventDefault(),{once:!0})}})})))),j.viewport))):null});oC.propTypes={type(c){if(c.type&&!["foreground","background"].includes(c.type)){let c=`Invalid prop \`type\` supplied to \`${ox}\`. Expected \`foreground | background\`.`;return Error(c)}return null}};let $054eb8030ebde76e$var$ToastAnnounce=c=>{let{__scopeToast:u,children:f,...g}=c,b=og(ox,u),[v,x]=(0,K.useState)(!1),[w,_]=(0,K.useState)(!1);return $054eb8030ebde76e$var$useNextFrame(()=>x(!0)),(0,K.useEffect)(()=>{let c=window.setTimeout(()=>_(!0),1e3);return()=>window.clearTimeout(c)},[]),w?null:(0,K.createElement)(eh,{asChild:!0},(0,K.createElement)(os,g,v&&(0,K.createElement)(K.Fragment,null,b.label," ",f)))},oE=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,...g}=c;return(0,K.createElement)(en.div,_extends({},g,{ref:u}))}),oP=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,...g}=c;return(0,K.createElement)(en.div,_extends({},g,{ref:u}))}),oT=(0,K.forwardRef)((c,u)=>{let{altText:f,...g}=c;return f?(0,K.createElement)(oI,{altText:f,asChild:!0},(0,K.createElement)(o$,_extends({},g,{ref:u}))):null});oT.propTypes={altText:c=>c.altText?null:Error("Missing prop `altText` expected on `ToastAction`")};let o$=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,...g}=c,b=ok("ToastClose",f);return(0,K.createElement)(oI,{asChild:!0},(0,K.createElement)(en.button,_extends({type:"button"},g,{ref:u,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onClick,b.onClose)})))}),oI=(0,K.forwardRef)((c,u)=>{let{__scopeToast:f,altText:g,...b}=c;return(0,K.createElement)(en.div,_extends({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":g||void 0},b,{ref:u}))});function $054eb8030ebde76e$var$getAnnounceTextContent(c){let u=[],f=Array.from(c.childNodes);return f.forEach(c=>{if(c.nodeType===c.TEXT_NODE&&c.textContent&&u.push(c.textContent),$054eb8030ebde76e$var$isHTMLElement(c)){let f=c.ariaHidden||c.hidden||"none"===c.style.display,g=""===c.dataset.radixToastAnnounceExclude;if(!f){if(g){let f=c.dataset.radixToastAnnounceAlt;f&&u.push(f)}else u.push(...$054eb8030ebde76e$var$getAnnounceTextContent(c))}}}),u}function $054eb8030ebde76e$var$handleAndDispatchCustomEvent(c,u,f,{discrete:g}){let b=f.originalEvent.currentTarget,v=new CustomEvent(c,{bubbles:!0,cancelable:!0,detail:f});u&&b.addEventListener(c,u,{once:!0}),g?$8927f6f2acc4f386$export$6d1a0317bde7de7f(b,v):b.dispatchEvent(v)}let $054eb8030ebde76e$var$isDeltaInDirection=(c,u,f=0)=>{let g=Math.abs(c.x),b=Math.abs(c.y),v=g>b;return"left"===u||"right"===u?v&&g>f:!v&&b>f};function $054eb8030ebde76e$var$useNextFrame(c=()=>{}){let u=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c);Y(()=>{let c=0,f=0;return c=window.requestAnimationFrame(()=>f=window.requestAnimationFrame(u)),()=>{window.cancelAnimationFrame(c),window.cancelAnimationFrame(f)}},[u])}function $054eb8030ebde76e$var$isHTMLElement(c){return c.nodeType===c.ELEMENT_NODE}function $054eb8030ebde76e$var$getTabbableCandidates(c){let u=[],f=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{let u="INPUT"===c.tagName&&"hidden"===c.type;return c.disabled||c.hidden||u?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;f.nextNode();)u.push(f.currentNode);return u}function $054eb8030ebde76e$var$focusFirst(c){let u=document.activeElement;return c.some(c=>c===u||(c.focus(),document.activeElement!==u))}let oA="2.0.0-alpha.17",oM={fonts:{draw:`https://unpkg.com/@tldraw/assets@${oA}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${oA}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${oA}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${oA}/fonts/IBMPlexMono-Medium.woff2`}};function setDefaultEditorAssetUrls(c){oM=c}function useDefaultEditorAssetsWithOverrides(c){return(0,K.useMemo)(()=>c?{fonts:{...oM.fonts,...c?.fonts}}:oM,[c])}let oj={...oM,icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map(c=>[c,`https://unpkg.com/@tldraw/assets@${oA}/icons/icon/${c}.svg`])),translations:Object.fromEntries(e8.a2.map(c=>[c.locale,`https://unpkg.com/@tldraw/assets@${oA}/translations/${c.locale}.json`])),embedIcons:Object.fromEntries(e8.Lu.map(c=>[c.type,`https://unpkg.com/@tldraw/assets@${oA}/embed-icons/${c.type}.png`]))};function setDefaultUiAssetUrls(c){oj=c}function useDefaultUiAssetUrlsWithOverrides(c){return c?{fonts:Object.assign({...oj.fonts},{...c?.fonts}),icons:Object.assign({...oj.icons},{...c?.icons}),embedIcons:Object.assign({...oj.embedIcons},{...c?.embedIcons}),translations:Object.assign({...oj.translations},{...c?.translations})}:oj}let oO=K.forwardRef(function({className:c,label:u,icon:f,iconLeft:g,autoselect:b=!1,autofocus:v=!1,defaultValue:x,placeholder:w,onComplete:_,onValueChange:k,onCancel:E,onBlur:T,shouldManuallyMaintainScrollPositionWhenFocused:$=!1,children:I,value:M},j){let D=(0,tt.j)(),L=K.useRef(null);K.useImperativeHandle(j,()=>L.current);let F=useTranslation(),B=K.useRef(x??""),G=K.useRef(x??""),[U,Z]=K.useState(!1),Y=K.useCallback(c=>{Z(!0);let u=c.currentTarget;G.current=u.value,requestAnimationFrame(()=>{b&&u.select()})},[b]),X=K.useCallback(c=>{let u=c.currentTarget.value;G.current=u,k?.(u)},[k]),J=K.useCallback(c=>{switch(c.key){case"Enter":c.currentTarget.blur(),stopEventPropagation(c),_?.(c.currentTarget.value);break;case"Escape":c.currentTarget.value=B.current,c.currentTarget.blur(),stopEventPropagation(c),E?.(c.currentTarget.value)}},[_,E]),Q=K.useCallback(c=>{Z(!1);let u=c.currentTarget.value;T?.(u)},[T]);return K.useEffect(()=>{if(!D.environment.isIos)return;let c=window.visualViewport;if(U&&$&&c){let onViewportChange=()=>{L.current?.scrollIntoView({block:"center"})};return c.addEventListener("resize",onViewportChange),c.addEventListener("scroll",onViewportChange),requestAnimationFrame(()=>{L.current?.scrollIntoView({block:"center"})}),()=>{c.removeEventListener("resize",onViewportChange),c.removeEventListener("scroll",onViewportChange)}}},[D,U,$]),(0,V.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[I,u&&(0,V.jsx)("label",{children:F(u)}),g&&(0,V.jsx)(nW,{icon:g,className:"tlui-icon-left",small:!0}),(0,V.jsx)("input",{ref:L,className:e2("tlui-input",c),type:"text",defaultValue:x,onKeyUp:J,onChange:X,onFocus:Y,onBlur:Q,autoFocus:v,placeholder:w,value:M}),f&&(0,V.jsx)(nW,{icon:f,small:!!u})]})});function validateUrl(c){return(0,e4.jv)(c)?{isValid:!0,hasProtocol:!0}:(0,e4.jv)("https://"+c)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}let oR=(0,e5.j)(function({onClose:c}){let u=(0,tt.j)(),f=u.onlySelectedShape;return f&&"url"in f.props&&"string"==typeof f.props.url?(0,V.jsx)(oD,{onClose:c,selectedShape:f}):null}),oD=(0,e5.j)(function({onClose:c,selectedShape:u}){let f=(0,tt.j)(),g=useTranslation(),b=(0,K.useRef)(null);(0,K.useEffect)(()=>{requestAnimationFrame(()=>b.current?.focus())},[]);let v=(0,K.useRef)(u.props.url),[x,w]=(0,K.useState)(()=>{let c=validateUrl(u.props.url),f=!0===c.isValid?c.hasProtocol?u.props.url:"https://"+u.props.url:"https://";return{actual:f,safe:f,valid:!0}}),_=(0,K.useCallback)(c=>{let u=c.replace(/https?:\/\/(https?:\/\/)/,(c,u)=>u),f=validateUrl(u),g=!0===f.isValid?f.hasProtocol?u:"https://"+u:"https://";w({actual:u,safe:g,valid:f.isValid})},[]),k=(0,K.useCallback)(()=>{let{onlySelectedShape:u}=f;u&&(f.updateShapes([{id:u.id,type:u.type,props:{url:""}}]),c())},[f,c]),E=(0,K.useCallback)(()=>{let{onlySelectedShape:u}=f;u&&(u&&"url"in u.props&&u.props.url!==x.safe&&f.updateShapes([{id:u.id,type:u.type,props:{url:x.safe}}]),c())},[f,c,x]),T=(0,K.useCallback)(()=>{c()},[c]);if(!u)return c(),null;let $=v.current&&!x.valid;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Header,{children:[(0,V.jsx)(Title,{children:g("edit-link-dialog.title")}),(0,V.jsx)(CloseButton,{})]}),(0,V.jsx)(Body,{children:(0,V.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,V.jsx)(oO,{ref:b,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:x.actual,onValueChange:_,onComplete:E,onCancel:T}),(0,V.jsx)("div",{children:g(x.valid?"edit-link-dialog.detail":"edit-link-dialog.invalid-url")})]})}),(0,V.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[(0,V.jsx)(nq,{onClick:T,onTouchEnd:T,children:g("edit-link-dialog.cancel")}),$?(0,V.jsx)(nq,{type:"danger",onTouchEnd:k,onClick:k,children:g("edit-link-dialog.clear")}):(0,V.jsx)(nq,{type:"primary",disabled:!x.valid,onTouchEnd:E,onClick:E,children:g("edit-link-dialog.save")})]})]})}),oL=(0,e5.j)(function({onClose:c}){let u=(0,tt.j)(),f=useTranslation(),g=useAssetUrls(),[b,v]=(0,K.useState)(null),[x,w]=(0,K.useState)(""),[_,k]=(0,K.useState)(null),[E,T]=(0,K.useState)(!1),$=(0,K.useRef)(-1);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Header,{children:[(0,V.jsx)(Title,{children:b?`${f("embed-dialog.title")} \u2014 ${b.title}`:f("embed-dialog.title")}),(0,V.jsx)(CloseButton,{})]}),b?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Body,{className:"tlui-embed-dialog__enter",children:[(0,V.jsx)(oO,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:c=>{w(c);let u=getEmbedInfo(c);k(u&&u.definition.type===b.type?u:null),T(!1),clearTimeout($.current),$.current=setTimeout(()=>T(!u),320)}}),""===x?(0,V.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,V.jsx)("span",{children:f("embed-dialog.instruction")})," ",b.instructionLink&&(0,V.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:b.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,V.jsx)(nW,{icon:"external-link",small:!0})]})]}):(0,V.jsx)("div",{className:"tlui-embed-dialog__warning",children:E?f("embed-dialog.invalid-url"):"\xa0"})]}),(0,V.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[(0,V.jsx)(nq,{onClick:()=>{v(null),k(null),w("")},label:"embed-dialog.back"}),(0,V.jsx)("div",{className:"tlui-embed__spacer"}),(0,V.jsx)(nq,{label:"embed-dialog.cancel",onClick:c}),(0,V.jsx)(nq,{type:"primary",disabled:!_,label:"embed-dialog.create",onClick:()=>{_&&(u.putExternalContent({type:"embed",url:x,point:u.viewportPageCenter,embed:_.definition}),c())}})]})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(Body,{className:"tlui-embed-dialog__list",children:e8.Lu.map(c=>(0,V.jsxs)("button",{className:"tlui-embed-dialog__item",onClick:()=>v(c),children:[(0,V.jsx)("div",{className:"tlui-embed-dialog__item__image",children:(0,V.jsx)("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${g.embedIcons[c.type]})`}})}),(0,V.jsx)("div",{className:"tlui-embed-dialog__item__title",children:c.title})]},c.type))}),(0,V.jsx)("div",{className:"tlui-dialog__scrim"})]})]})});var oN=f(80352);async function pasteExcalidrawContent(c,u,f){let{elements:g,files:b}=u,v={shapes:[],rootShapeIds:[],assets:[],schema:c.store.schema.serialize()},x=new Map,w=new Map,{currentPageId:_}=c,k=new Map,E=[],T=new Set;g.forEach(c=>{if(k.set(c.id,(0,e8.F1)()),null!==c.boundElements)for(let u of c.boundElements)"text"===u.type&&T.add(u.id)});let $="a1";for(let c of g){if(T.has(c.id))continue;let u=k.get(c.id),f={id:u,typeName:"shape",parentId:_,index:$,x:c.x,y:c.y,rotation:0,isLocked:c.locked,opacity:getOpacity(c.opacity),meta:{}};switch(0!==c.angle&&w.set(u,c.angle),c.groupIds&&c.groupIds.length>0?x.has(c.groupIds[0])?x.get(c.groupIds[0])?.push(u):x.set(c.groupIds[0],[u]):E.push(u),c.type){case"rectangle":case"ellipse":case"diamond":{let u="",b="middle";if(null!==c.boundElements){for(let f of c.boundElements)if("text"===f.type){let c=g.find(c=>c.id===f.id);c&&(u=c.text,b=oV[c.textAlign])}}let x="transparent"===c.backgroundColor?c.strokeColor:c.backgroundColor;v.shapes.push({...f,type:"geo",props:{geo:c.type,url:c.link??"",w:c.width,h:c.height,size:oF[c.strokeWidth]??"draw",color:oG[x]??"black",text:u,align:b,dash:getDash(c),fill:getFill(c)}});break}case"freedraw":v.shapes.push({...f,type:"draw",props:{dash:getDash(c),size:oF[c.strokeWidth],color:oG[c.strokeColor]??"black",segments:[{type:"free",points:c.points.map(([c,u,f=.5])=>({x:c,y:u,z:f}))}]}});break;case"line":{let u=c.points[0],g=c.points[c.points.length-1],b=(0,nF.H$)(c.points.length);v.shapes.push({...f,type:"line",props:{dash:getDash(c),size:oF[c.strokeWidth],color:oG[c.strokeColor]??"black",spline:c.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:b[0],x:u[0],y:u[1]},end:{id:"end",type:"vertex",index:b[b.length-1],x:g[0],y:g[1]},...Object.fromEntries(c.points.slice(1,-1).map(([c,u],f)=>{let g=(0,tQ.E)();return[g,{id:g,type:"vertex",index:b[f+1],x:c,y:u}]}))}}});break}case"arrow":{let u="";if(null!==c.boundElements){for(let f of c.boundElements)if("text"===f.type){let c=g.find(c=>c.id===f.id);c&&(u=c.text)}}let b=c.points[0],x=c.points[c.points.length-1],w=k.get(c.startBinding?.elementId),_=k.get(c.endBinding?.elementId);v.shapes.push({...f,type:"arrow",props:{text:u,bend:getBend(c,b,x),dash:getDash(c),size:oF[c.strokeWidth]??"m",color:oG[c.strokeColor]??"black",start:w?{type:"binding",boundShapeId:w,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:b[0],y:b[1]},end:_?{type:"binding",boundShapeId:_,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:x[0],y:x[1]},arrowheadEnd:oW[c.endArrowhead]??"none",arrowheadStart:oW[c.startArrowhead]??"none"}});break}case"text":{let{size:u,scale:g}=getFontSizeAndScale(c.fontSize);v.shapes.push({...f,type:"text",props:{size:u,scale:g,font:oz[c.fontFamily]??"draw",color:oG[c.strokeColor]??"black",text:c.text,align:oV[c.textAlign]}});break}case"image":{let u=b[c.fileId];if(!u)break;let g=e8.Yk.createId();v.assets.push({id:g,typeName:"asset",type:"image",props:{w:c.width,h:c.height,name:c.id??"Untitled",isAnimated:!1,mimeType:u.mimeType,src:u.dataURL},meta:{}}),v.shapes.push({...f,type:"image",props:{w:c.width,h:c.height,assetId:g}})}}$=(0,nF._L)($)}let I=f??(c.inputs.shiftKey?c.inputs.currentPagePoint:void 0);for(let u of(c.mark("paste"),c.putContentOntoCurrentPage(v,{point:I,select:!1,preserveIds:!0}),x.values()))if(u.length>1){c.groupShapes(u);let f=c.getShape(u[0]);f?.parentId&&(0,e8.YT)(f.parentId)&&E.push(f.parentId)}for(let[u,f]of w)c.select(u),c.rotateShapesBy([u],f);let M=(0,e4.oA)(E.map(u=>c.getShape(u))),j=nT.No.Common(M.map(u=>c.getShapePageBounds(u))),D=c.viewportPageBounds.center;c.updateShapes(M.map(c=>{let u={x:(c.x??0)-(j.x+j.w/2),y:(c.y??0)-(j.y+j.h/2)};return{id:c.id,type:c.type,x:D.x+u.x,y:D.y+u.y}})),c.setSelectedShapes(E)}let getOpacity=c=>{let u=c/100;return u<.2?.1:u<.4?.25:u<.6?.5:u<.8?.75:1},oF={1:"s",2:"m",3:"l",4:"xl"},oB={16:"s",20:"m",28:"l",36:"xl"};function getFontSizeAndScale(c){let u=oB[c];return u?{size:u,scale:1}:c<16?{size:"s",scale:c/16}:c>36?{size:"xl",scale:c/36}:{size:"m",scale:1}}let oz={1:"draw",2:"sans",3:"mono"},oG={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},oU={solid:"draw",dashed:"dashed",dotted:"dotted"},oH={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},oV={left:"start",center:"middle",right:"end"},oW={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function getBend(c,u,f){let g=0;if(c.points.length>2){let b=new tl.G(u[0],u[1]),v=new tl.G(f[0],f[1]),x=new tl.G(c.points[1][0],c.points[1][1]),w=tl.G.Sub(v,b),_=tl.G.Per(w),k=tl.G.Med(v,b),E=tl.G.Sub(k,_),T=tl.G.Add(k,_),$=tl.G.NearestPointOnLineSegment(E,T,x,!1);g=tl.G.Dist($,k),tl.G.Clockwise($,v,k)&&(g*=-1)}return g}let getDash=c=>{let u=oU[c.strokeStyle]??"draw";return"draw"===u&&0===c.roughness&&(u="solid"),u},getFill=c=>"transparent"===c.backgroundColor?"none":oH[c.fillStyle]??"solid";async function pasteFiles(c,u,f,g){let b=await Promise.all(u.map(async c=>await (await fetch(c)).blob())),v=b.map(c=>new File([c],"tldrawFile",{type:c.type}));c.mark("paste"),await c.putExternalContent({type:"files",files:v,point:f,ignoreParent:!1,sources:g}),u.forEach(c=>URL.revokeObjectURL(c))}function pasteTldrawContent(c,u,f){let g=f??(c.inputs.shiftKey?c.inputs.currentPagePoint:void 0);c.mark("paste"),c.putContentOntoCurrentPage(u,{point:g,select:!0})}async function pasteUrl(c,u,f,g){try{let f=await fetch(u);if(f.headers.get("content-type")?.match(/^image\//)){c.mark("paste"),pasteFiles(c,[u]);return}}catch(c){"Failed to fetch"!==c.message&&console.error(c)}return c.mark("paste"),await c.putExternalContent({type:"url",point:f,url:u,sources:g})}function stripHtml(c){let u=document.implementation.createHTMLDocument("");return u.documentElement.innerHTML=c.trim(),u.body.textContent||u.body.innerText||""}let isValidHttpURL=c=>{try{let u=new URL(c);return"http:"===u.protocol||"https:"===u.protocol}catch(c){return!1}},getValidHttpURLList=c=>{let u=c.split(/[\n\s]/);for(let c of u)try{let u=new URL(c);if(!("http:"===u.protocol||"https:"===u.protocol))return}catch(c){return}return tD(u)},isSvgText=c=>/^<svg/.test(c),oK=["input","select","textarea"];function disallowClipboardEvents(c){let{activeElement:u}=document;return c.isMenuOpen||u&&(u.getAttribute("contenteditable")||oK.indexOf(u.tagName.toLowerCase())>-1)}async function blobAsString(c){return new Promise((u,f)=>{let g=new FileReader;g.addEventListener("loadend",()=>{let c=g.result;u(c)}),g.addEventListener("error",()=>{f(g.error)}),g.readAsText(c)})}let isFile=c=>c.types.find(c=>c.match(/^image\//)),handleText=(c,u,f,g)=>{let b=getValidHttpURLList(u);if(b)for(let u of b)pasteUrl(c,u,f);else isValidHttpURL(u)?pasteUrl(c,u,f):isSvgText(u)?(c.mark("paste"),c.putExternalContent({type:"svg-text",text:u,point:f,sources:g})):(c.mark("paste"),c.putExternalContent({type:"text",text:u,point:f,sources:g}))},handlePasteFromEventClipboardData=async(c,u,f)=>{if(null!==c.editingShapeId)return;if(!u)throw Error("No clipboard data");let g=[];for(let c of Object.values(u.items))switch(c.kind){case"file":g.push({type:"file",source:new Promise(u=>u(c.getAsFile()))});break;case"string":"text/html"===c.type?g.push({type:"html",source:new Promise(u=>c.getAsString(u))}):"text/plain"===c.type?g.push({type:"text",source:new Promise(u=>c.getAsString(u))}):g.push({type:c.type,source:new Promise(u=>c.getAsString(u))})}handleClipboardThings(c,g,f)},handlePasteFromClipboardApi=async(c,u,f)=>{let g=[];for(let c of u){if(isFile(c))for(let u of c.types)u.match(/^image\//)&&g.push({type:"blob",source:c.getType(u)});c.types.includes("text/html")&&g.push({type:"html",source:new Promise(u=>c.getType("text/html").then(c=>blobAsString(c).then(u)))}),c.types.includes("text/uri-list")&&g.push({type:"url",source:new Promise(u=>c.getType("text/uri-list").then(c=>blobAsString(c).then(u)))}),c.types.includes("text/plain")&&g.push({type:"text",source:new Promise(u=>c.getType("text/plain").then(c=>blobAsString(c).then(u)))})}return await handleClipboardThings(c,g,f)};async function handleClipboardThings(c,u,f){let g=u.filter(c=>("file"===c.type||"blob"===c.type)&&null!==c.source);if(g.length){let u=await Promise.all(g.map(c=>c.source)),b=u.filter(Boolean).map(c=>URL.createObjectURL(c));return await pasteFiles(c,b,f)}let b=await Promise.all(u.filter(c=>"file"!==c.type).map(c=>new Promise(u=>{if("file"===c.type){u({type:"error",data:null,reason:"unexpected file"});return}c.source.then(f=>{let g=f.match(/<tldraw[^>]*>(.*)<\/tldraw>/)?.[1];if(g)try{let c=(0,oN.decompressFromBase64)(g);if(null===c){u({type:"error",data:c,reason:"found tldraw data comment but could not parse base64"});return}{let f=JSON.parse(c);if("application/tldraw"!==f.type&&u({type:"error",data:f,reason:`found tldraw data comment but JSON was of a different type: ${f.type}`}),"string"==typeof f.data){u({type:"error",data:f,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}u({type:"tldraw",data:f.data});return}}catch(c){u({type:"error",data:g,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if("html"===c.type){u({type:"text",data:f,subtype:"html"});return}if("url"===c.type){u({type:"text",data:f,subtype:"url"});return}try{let c=JSON.parse(f);if("excalidraw/clipboard"===c.type){u({type:"excalidraw",data:c});return}u({type:"text",data:f,subtype:"json"});return}catch(c){u({type:"text",data:f,subtype:"text"});return}}u({type:"error",data:f,reason:"unhandled case"})})})));for(let u of b)if("tldraw"===u.type){pasteTldrawContent(c,u.data,f);return}for(let u of b)if("excalidraw"===u.type){pasteExcalidrawContent(c,u.data,f);return}for(let u of b)if("text"===u.type&&"html"===u.subtype){let g=new DOMParser().parseFromString(u.data,"text/html"),v=g.querySelector("body"),x=v&&1===Array.from(v.children).filter(c=>1===c.nodeType).length&&v.firstElementChild&&"A"===v.firstElementChild.tagName&&v.firstElementChild.hasAttribute("href")&&""!==v.firstElementChild.getAttribute("href");if(x){let u=v.firstElementChild.getAttribute("href");handleText(c,u,f,b);return}if(!b.some(c=>"text"===c.type&&"html"!==c.subtype)&&u.data.trim()){handleText(c,stripHtml(u.data),f,b);return}}for(let u of b)if("text"===u.type&&"url"===u.subtype){pasteUrl(c,u.data,f,b);return}for(let u of b)if("text"===u.type&&"text"===u.subtype&&u.data.trim()){handleText(c,u.data,f,b);return}}let handleNativeOrMenuCopy=c=>{let u=c.getContentFromCurrentPage(c.selectedShapeIds);if(!u){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}let f=(0,oN.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:u}));if("undefined"!=typeof navigator){let g=u.shapes.map(u=>c.isShapeOfType(u,"text")||c.isShapeOfType(u,"geo")||c.isShapeOfType(u,"arrow")?u.props.text:c.isShapeOfType(u,"bookmark")||c.isShapeOfType(u,"embed")?u.props.url:null).filter(e4.GT);if(navigator.clipboard?.write){let c=new Blob([`<tldraw>${f}</tldraw>`],{type:"text/html"}),u=g.join(" ");""===u&&(u=" "),navigator.clipboard.write([new ClipboardItem({"text/html":c,"text/plain":new Blob([u],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${f}</tldraw>`)}};function useMenuClipboardEvents(){let c=(0,tt.j)(),u=useUiEvents(),f=(0,K.useCallback)(function(f){0!==c.selectedShapeIds.length&&(handleNativeOrMenuCopy(c),u("copy",{source:f}))},[c,u]),g=(0,K.useCallback)(function(f){0!==c.selectedShapeIds.length&&(handleNativeOrMenuCopy(c),c.deleteShapes(c.selectedShapeIds),u("cut",{source:f}))},[c,u]),b=(0,K.useCallback)(async function(f,g,v){null!==c.editingShapeId||disallowClipboardEvents(c)||(Array.isArray(f)&&f[0]instanceof ClipboardItem?(handlePasteFromClipboardApi(c,f,v),u("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{b(c,g,v)}))},[c,u]);return{copy:f,cut:g,paste:b}}function useNativeClipboardEvents(){let c=(0,tt.j)(),u=useUiEvents(),f=(0,e5.Hg)("editor.isFocused",()=>c.instanceState.isFocused,[c]);(0,K.useEffect)(()=>{if(!f)return;let copy=()=>{0===c.selectedShapeIds.length||null!==c.editingShapeId||disallowClipboardEvents(c)||(handleNativeOrMenuCopy(c),u("copy",{source:"kbd"}))};function cut(){0===c.selectedShapeIds.length||null!==c.editingShapeId||disallowClipboardEvents(c)||(handleNativeOrMenuCopy(c),c.deleteShapes(c.selectedShapeIds),u("cut",{source:"kbd"}))}let g=!1,pointerUpHandler=c=>{1===c.button&&(g=!0,requestAnimationFrame(()=>{g=!1}))},paste=f=>{if(g){f.stopPropagation();return}null!==c.editingShapeId||disallowClipboardEvents(c)||(f.clipboardData&&!c.inputs.shiftKey?handlePasteFromEventClipboardData(c,f.clipboardData):navigator.clipboard.read().then(u=>{Array.isArray(u)&&u[0]instanceof ClipboardItem&&handlePasteFromClipboardApi(c,u,c.inputs.currentPagePoint)}),u("paste",{source:"kbd"}))};return document.addEventListener("copy",copy),document.addEventListener("cut",cut),document.addEventListener("paste",paste),document.addEventListener("pointerup",pointerUpHandler),()=>{document.removeEventListener("copy",copy),document.removeEventListener("cut",cut),document.removeEventListener("paste",paste),document.removeEventListener("pointerup",pointerUpHandler)}},[c,u,f])}function getSvgAsString(c){let u=c.cloneNode(!0);c.setAttribute("width",+c.getAttribute("width")+""),c.setAttribute("height",+c.getAttribute("height")+"");let f=new XMLSerializer().serializeToString(u).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1");return f}async function getSvgAsImage(c,u){let{type:f,quality:g,scale:b}=u,v=+c.getAttribute("width"),x=+c.getAttribute("height"),w=v*b,_=x*b,k=await getSvgAsDataUrl(c),E=await getBrowserCanvasMaxSize();if(v>E.maxWidth&&(_=(w=E.maxWidth)/v*x),x>E.maxHeight&&(w=(_=E.maxHeight)/x*v),w*_>E.maxArea){let c=Math.sqrt(E.maxArea/(w*_));w*=c,_*=c}w=Math.floor(w),_=Math.floor(_);let T=w/v,$=await new Promise(c=>{let u=new Image;u.crossOrigin="anonymous",u.onload=async()=>{await new Promise(c=>setTimeout(c,250));let f=document.createElement("canvas"),g=f.getContext("2d");f.width=w,f.height=_,g.imageSmoothingEnabled=!0,g.imageSmoothingQuality="high",g.drawImage(u,0,0,w,_),URL.revokeObjectURL(k),c(f)},u.onerror=()=>{c(null)},u.src=k});if(!$)return null;let I=await new Promise(c=>$.toBlob(u=>{(!u||te.throwToBlob.value)&&c(null),c(u)},"image/"+f,g));if(!I)return null;let M=new DataView(await I.arrayBuffer());return e4.bM.setPhysChunk(M,T,{type:"image/"+f})}async function getSvgAsDataUrl(c){let u=c.cloneNode(!0);u.setAttribute("encoding",'UTF-8"');let f=new FileReader,g=Array.from(u.querySelectorAll("image"));for(let c of g){let u=c.getAttribute("xlink:href");if(u&&!u.startsWith("data:")){let g=await (await fetch(u)).blob(),b=await new Promise((c,u)=>{f.onload=()=>c(f.result),f.onerror=()=>u(f.error),f.readAsDataURL(g)});c.setAttribute("xlink:href",b)}}return getSvgAsDataUrlSync(u)}function getSvgAsDataUrlSync(c){let u=new XMLSerializer().serializeToString(c),f=window.btoa(unescape(encodeURIComponent(u)));return`data:image/svg+xml;base64,${f}`}function downloadDataURLAsFile(c,u){let f=document.createElement("a");f.href=c,f.download=u,f.click()}let oZ=(0,K.createContext)({});function ToastsProvider({children:c}){let[u,f]=(0,K.useState)([]),g=(0,K.useCallback)(c=>{let u=c.id??(0,tQ.E)();return f(f=>[...f.filter(u=>u.id!==c.id),{...c,id:u}]),u},[]),b=(0,K.useCallback)(c=>(f(u=>u.filter(u=>u.id!==c)),c),[]),v=(0,K.useCallback)(()=>{f(()=>[])},[]);return(0,V.jsx)(oZ.Provider,{value:{toasts:u,addToast:g,removeToast:b,clearToasts:v},children:c})}function useToasts(){let c=(0,K.useContext)(oZ);if(!c)throw Error("useToasts must be used within a ToastsProvider");return c}function useCopyAs(){let c=(0,tt.j)(),{addToast:u}=useToasts(),f=useTranslation();return(0,K.useCallback)(function(g=c.selectedShapeIds,b="svg"){if(0===g.length&&(g=[...c.currentPageShapeIds]),0!==g.length)switch(b){case"svg":window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":getExportedSvgBlob(c,g)})]):fallbackWriteTextAsync(async()=>getSvgAsString(await getExportSvgElement(c,g))));break;case"jpeg":case"png":{let v="jpeg"===b?"image/jpeg":"image/png",x=getExportedImageBlob(c,g,b).then(c=>{if(c){if(window.navigator.clipboard)return c;throw Error("Copy not supported")}throw u({id:"copy-fail",icon:"warning-triangle",title:f("toast.error.copy-fail.title"),description:f("toast.error.copy-fail.desc")}),Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[v]:x})]).catch(c=>{c.toString().match(/^TypeError: DOMString not supported/)||console.error(c),x.then(c=>{window.navigator.clipboard.write([new ClipboardItem({[v]:c})])})});break}case"json":{let u=c.getContentFromCurrentPage(g);if(window.navigator.clipboard){let c=JSON.stringify(u);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"})})]):fallbackWriteTextAsync(async()=>c)}break}default:throw Error(`Copy type ${b} not supported.`)}},[c,u,f])}async function getExportSvgElement(c,u){let f=await c.getSvg(u,{scale:1,background:c.instanceState.exportBackground});if(!f)throw Error("Could not construct SVG.");return f}async function getExportedSvgBlob(c,u){return new Blob([getSvgAsString(await getExportSvgElement(c,u))],{type:"text/plain"})}async function getExportedImageBlob(c,u,f){return await getSvgAsImage(await getExportSvgElement(c,u),{type:f,quality:1,scale:2})}async function fallbackWriteTextAsync(c){navigator&&navigator.clipboard&&navigator.clipboard.writeText(await c())}let oY=(0,K.createContext)({});function DialogsProvider({children:c}){let u=(0,tt.j)(),f=useUiEvents(),[g,b]=(0,K.useState)([]),v=(0,K.useCallback)(c=>{let g=c.id??(0,tQ.E)();return b(u=>[...u.filter(u=>u.id!==c.id),{...c,id:g}]),f("open-menu",{source:"dialog",id:g}),u.addOpenMenu(g),g},[u,f]),x=(0,K.useCallback)((c,g)=>(b(u=>u.map(u=>u.id===c?{...u,...g}:u)),f("open-menu",{source:"dialog",id:c}),u.addOpenMenu(c),c),[u,f]),w=(0,K.useCallback)(c=>(b(u=>u.filter(u=>u.id!==c||(u.onClose?.(),!1))),f("close-menu",{source:"dialog",id:c}),u.deleteOpenMenu(c),c),[u,f]),_=(0,K.useCallback)(()=>{b(c=>(c.forEach(c=>{c.onClose?.(),f("close-menu",{source:"dialog",id:c.id}),u.deleteOpenMenu(c.id)}),[]))},[u,f]);return(0,V.jsx)(oY.Provider,{value:{dialogs:g,addDialog:v,removeDialog:w,clearDialogs:_,updateDialog:x},children:c})}function useDialogs(){let c=(0,K.useContext)(oY);if(!c)throw Error("useDialogs must be used within a DialogsProvider");return c}function useExportAs(){let c=(0,tt.j)(),{addToast:u}=useToasts(),f=useTranslation();return(0,K.useCallback)(async function(g=c.selectedShapeIds,b="png"){if(0===g.length&&(g=[...c.currentPageShapeIds]),0===g.length)return;let v=await c.getSvg(g,{scale:1,background:c.instanceState.exportBackground});if(!v)throw Error("Could not construct SVG.");let x="shapes"+getTimestamp();if(1===g.length){let u=c.getShape(g[0]);x=c.isShapeOfType(u,"frame")?u.props.name??"frame":u.id.replace(/:/,"_")}switch(b){case"svg":{let c=await getSvgAsDataUrl(v);downloadDataURLAsFile(c,`${x}.svg`);return}case"webp":case"png":{let c=await getSvgAsImage(v,{type:b,quality:1,scale:2});if(!c){u({id:"export-fail",title:f("toast.error.export-fail.title"),description:f("toast.error.export-fail.desc")});return}let g=URL.createObjectURL(c);downloadDataURLAsFile(g,`${x}.${b}`),URL.revokeObjectURL(g);return}case"json":{let u=c.getContentFromCurrentPage(g),f=URL.createObjectURL(new Blob([JSON.stringify(u,null,4)],{type:"application/json"}));downloadDataURLAsFile(f,`${x||"shapes"}.json`),URL.revokeObjectURL(f);return}default:throw Error(`Export type ${b} not supported.`)}},[c,u,f])}function getTimestamp(){let c=new Date,u=String(c.getFullYear()).slice(2),f=String(c.getMonth()+1).padStart(2,"0"),g=String(c.getDate()).padStart(2,"0"),b=String(c.getHours()).padStart(2,"0"),v=String(c.getMinutes()).padStart(2,"0"),x=String(c.getSeconds()).padStart(2,"0");return` at ${u}-${f}-${g} ${b}.${v}.${x}`}function useInsertMedia(){let c=(0,tt.j)(),u=(0,K.useRef)();return(0,K.useEffect)(()=>{let f=window.document.createElement("input");async function onchange(u){let g=u.target.files;g&&0!==g.length&&(await c.putExternalContent({type:"files",files:Array.from(g),point:c.viewportPageBounds.center,ignoreParent:!1}),f.value="")}return f.type="file",f.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",f.multiple=!0,u.current=f,f.addEventListener("change",onchange),()=>{u.current=void 0,f.removeEventListener("change",onchange)}},[c]),(0,K.useCallback)(()=>{u.current?.click()},[u])}function usePrint(){let c=(0,tt.j)(),u=(0,K.useRef)(null),f=(0,K.useRef)(null);return(0,K.useCallback)(async function(){let g=document.createElement("div"),b=document.createElement("style"),clearElements=(c,u)=>{c&&(c.innerHTML=""),u&&document.head.contains(u)&&document.head.removeChild(u),c&&document.body.contains(c)&&document.body.removeChild(c)};clearElements(u.current,f.current),u.current=g,f.current=b;let v=`tl-print-surface-${(0,tQ.E)()}`;g.className=v,b.innerHTML=`
			.${v} {
				display: none;
			}

			.${v} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${v} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${v}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${v}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${v}__item__header {
					display: none;
				}

				.${v}__item__footer {
					display: none;
					text-align: right;
				}

				.${v}__item__footer__hide {
					display: none;
				}

				
			}

		`;let beforePrintHandler=()=>{document.head.appendChild(b),document.body.appendChild(g)},afterPrintHandler=()=>{c.once("change-history",()=>{clearElements(g,b)})};function addPageToPrint(c,u,f){try{g.innerHTML+=`<div class="${v}__item">
        <div class="${v}__item__header">
          ${c.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${v}__item__main">
          ${f.outerHTML}
        </div>
        <div class="${v}__item__footer ${v}__item__footer__${u?"":"hide"}">
          ${u??""}
        </div>
      </div>`}catch(c){console.error(c)}}function triggerPrint(){c.environment.isChromeForIos?(beforePrintHandler(),window.print()):c.environment.isSafari?(beforePrintHandler(),document.execCommand("print",!1)):window.print()}window.addEventListener("beforeprint",beforePrintHandler),window.addEventListener("afterprint",afterPrintHandler);let{pages:x,currentPageId:w,selectedShapeIds:_}=c,k={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(c.selectedShapeIds.length>0){let u=await c.getSvg(_,k);if(u){let c=x.find(c=>c.id===w);addPageToPrint(`tldraw \u2014 ${c?.name}`,null,u),triggerPrint()}}else{let u=c.currentPage,f=await c.getSvg(c.getSortedChildIdsForParent(u.id),k);f&&(addPageToPrint(`tldraw \u2014 ${u.name}`,null,f),triggerPrint())}window.removeEventListener("beforeprint",beforePrintHandler),window.removeEventListener("afterprint",afterPrintHandler)},[c])}let oq=K.createContext({});function makeActions(c){return Object.fromEntries(c.map(c=>[c.id,c]))}function ActionsProvider({overrides:c,children:u}){let f=(0,tt.j)(),{addDialog:g,clearDialogs:b}=useDialogs(),{clearToasts:v}=useToasts(),x=useInsertMedia(),w=usePrint(),{cut:_,copy:k,paste:E}=useMenuClipboardEvents(),T=useCopyAs(),$=useExportAs(),I=useUiEvents(),M=K.useMemo(()=>{function mustGoBackToSelectToolFirst(){return f.isIn("select")||(f.complete(),f.setCurrentTool("select")),!1}function hasSelectedShapes(){return f.selectedShapeIds.length>0}let u=makeActions([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("edit-link",{source:c}),f.mark("edit-link"),g({component:oR})))}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(c){I("insert-embed",{source:c}),g({component:oL})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(c){I("insert-media",{source:c}),x()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(c){I("undo",{source:c}),f.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(c){I("redo",{source:c}),f.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(c){I("export-as",{format:"svg",source:c}),$(f.selectedShapeIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(c){I("export-as",{format:"png",source:c}),$(f.selectedShapeIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(c){I("export-as",{format:"json",source:c}),$(f.selectedShapeIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(c){I("copy-as",{format:"svg",source:c}),T(f.selectedShapeIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(c){I("copy-as",{format:"png",source:c}),T(f.selectedShapeIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(c){I("copy-as",{format:"json",source:c}),T(f.selectedShapeIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("toggle-auto-size",{source:c}),f.mark("toggling auto size"),f.updateShapes(f.selectedShapes.filter(c=>f.isShapeOfType(c,"text")&&!1===c.props.autoSize).map(c=>({id:c.id,type:c.type,props:{...c.props,w:8,autoSize:!0}})))))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(c){I("open-embed-link",{source:c});let u=f.selectedShapeIds,g="No embed shapes selected";if(1!==u.length){console.error(g);return}let b=f.getShape(u[0]);if(!b||!f.isShapeOfType(b,"embed")){console.error(g);return}openWindow(b.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(c){if(f.root.current.value?.id!=="zoom"&&(I("zoom-tool",{source:c}),!(f.inputs.shiftKey||f.inputs.ctrlKey))){let c=f.root.current.value;c&&c.current.value?.id==="idle"&&f.setCurrentTool("zoom",{onInteractionEnd:c.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||f.batch(()=>{I("convert-to-bookmark",{source:c});let u=f.selectedShapes,g=[],b=[];for(let c of u){if(!c||!f.isShapeOfType(c,"embed")||!c.props.url)continue;let u=new tl.G(c.x,c.y);u.rot(-c.rotation),u.add(new tl.G(c.props.w/2-150,c.props.h/2-160)),u.rot(c.rotation);let v={id:(0,e8.F1)(),type:"bookmark",rotation:c.rotation,x:u.x,y:u.y,opacity:1,props:{url:c.props.url}};g.push(v),b.push(c.id)}f.mark("convert shapes to bookmark"),f.deleteShapes(b),f.createShapes(g)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("convert-to-embed",{source:c}),f.batch(()=>{let c=f.selectedShapeIds,u=(0,e4.oA)(c.map(c=>f.getShape(c))),g=[],b=[];for(let c of u){if(!f.isShapeOfType(c,"bookmark"))continue;let{url:u}=c.props,v=getEmbedInfo(c.props.url);if(!v||!v.definition)continue;let{width:x,height:w}=v.definition,_=new tl.G(c.x,c.y);_.rot(-c.rotation),_.add(new tl.G(c.props.w/2-x/2,c.props.h/2-w/2)),_.rot(c.rotation);let k={id:(0,e8.F1)(),type:"embed",x:_.x,y:_.y,rotation:c.rotation,props:{url:u,w:x,h:w}};g.push(k),b.push(c.id)}f.mark("convert shapes to embed"),f.deleteShapes(b),f.createShapes(g)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(c){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;I("duplicate-shapes",{source:c});let u=f.selectedShapeIds,g=nT.No.Common((0,e4.oA)(u.map(c=>f.getShapePageBounds(c)))),b=f.instanceState.canMoveCamera?{x:g.width+10,y:0}:{x:16/f.zoomLevel,y:16/f.zoomLevel};f.mark("duplicate shapes"),f.duplicateShapes(u,b)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("ungroup-shapes",{source:c}),f.mark("ungroup"),f.ungroupShapes(f.selectedShapeIds)))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(c){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;I("group-shapes",{source:c});let{onlySelectedShape:u}=f;u&&f.isShapeOfType(u,"group")?(f.mark("ungroup"),f.ungroupShapes(f.selectedShapeIds)):(f.mark("group"),f.groupShapes(f.selectedShapeIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"left",source:c}),f.mark("align left"),f.alignShapes(f.selectedShapeIds,"left")))}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"center-horizontal",source:c}),f.mark("align center horizontal"),f.alignShapes(f.selectedShapeIds,"center-horizontal")))}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"right",source:c}),f.mark("align right"),f.alignShapes(f.selectedShapeIds,"right")))}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"center-vertical",source:c}),f.mark("align center vertical"),f.alignShapes(f.selectedShapeIds,"center-vertical")))}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"top",source:c}),f.mark("align top"),f.alignShapes(f.selectedShapeIds,"top")))}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("align-shapes",{operation:"bottom",source:c}),f.mark("align bottom"),f.alignShapes(f.selectedShapeIds,"bottom")))}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("distribute-shapes",{operation:"horizontal",source:c}),f.mark("distribute horizontal"),f.distributeShapes(f.selectedShapeIds,"horizontal")))}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("distribute-shapes",{operation:"vertical",source:c}),f.mark("distribute vertical"),f.distributeShapes(f.selectedShapeIds,"vertical")))}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("stretch-shapes",{operation:"horizontal",source:c}),f.mark("stretch horizontal"),f.stretchShapes(f.selectedShapeIds,"horizontal")))}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("stretch-shapes",{operation:"vertical",source:c}),f.mark("stretch vertical"),f.stretchShapes(f.selectedShapeIds,"vertical")))}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("flip-shapes",{operation:"horizontal",source:c}),f.mark("flip horizontal"),f.flipShapes(f.selectedShapeIds,"horizontal")))}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("flip-shapes",{operation:"vertical",source:c}),f.mark("flip vertical"),f.flipShapes(f.selectedShapeIds,"vertical")))}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("pack-shapes",{source:c}),f.mark("pack"),f.packShapes(f.selectedShapeIds,16)))}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("stack-shapes",{operation:"vertical",source:c}),f.mark("stack-vertical"),f.stackShapes(f.selectedShapeIds,"vertical",16)))}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("stack-shapes",{operation:"horizontal",source:c}),f.mark("stack-horizontal"),f.stackShapes(f.selectedShapeIds,"horizontal",16)))}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("reorder-shapes",{operation:"toFront",source:c}),f.mark("bring to front"),f.bringToFront(f.selectedShapeIds)))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("reorder-shapes",{operation:"forward",source:c}),f.mark("bring forward"),f.bringForward(f.selectedShapeIds)))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("reorder-shapes",{operation:"backward",source:c}),f.mark("send backward"),f.sendBackward(f.selectedShapeIds)))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("reorder-shapes",{operation:"toBack",source:c}),f.mark("send to back"),f.sendToBack(f.selectedShapeIds)))}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(f.mark("cut"),_(c)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||k(c))}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(c){navigator.clipboard?.read().then(u=>{E(u,c,"context-menu"===c?f.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(c){f.batch(()=>{mustGoBackToSelectToolFirst()||(I("select-all-shapes",{source:c}),f.mark("select all kbd"),f.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("select-none-shapes",{source:c}),f.mark("select none"),f.selectNone()))}},{id:"delete",label:"action.delete",kbd:"⌫,del,backspace",icon:"trash",readonlyOk:!1,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("delete-shapes",{source:c}),f.mark("delete"),f.deleteShapes(f.selectedShapeIds)))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(c){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;I("rotate-cw",{source:c}),f.mark("rotate-cw");let u=f.selectionRotation%(ts.gc/2),g=(0,ts.C2)(u,0)||(0,ts.C2)(u,ts.gc/2);f.rotateShapesBy(f.selectedShapeIds,ts.gc/2-(g?0:u))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(c){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;I("rotate-ccw",{source:c}),f.mark("rotate-ccw");let u=f.selectionRotation%(ts.gc/2),g=(0,ts.C2)(u,0);f.rotateShapesBy(f.selectedShapeIds,g?-(ts.gc/2):-u)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(c){I("zoom-in",{source:c}),f.zoomIn(f.viewportScreenCenter,{duration:td.KD})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(c){I("zoom-out",{source:c}),f.zoomOut(f.viewportScreenCenter,{duration:td.KD})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(c){I("reset-zoom",{source:c}),f.resetZoom(f.viewportScreenCenter,{duration:td.KD})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(c){I("zoom-to-fit",{source:c}),f.zoomToFit({duration:td.KD})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(c){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(I("zoom-to-selection",{source:c}),f.zoomToSelection({duration:td.KD})))}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(c){I("toggle-snap-mode",{source:c}),f.user.updateUserPreferences({isSnapMode:!f.user.isSnapMode})},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(c){I("toggle-dark-mode",{source:c}),f.user.updateUserPreferences({isDarkMode:!f.user.isDarkMode})},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(c){I("toggle-reduce-motion",{source:c}),f.user.updateUserPreferences({animationSpeed:0===f.user.animationSpeed?1:0})},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(c){I("toggle-transparent",{source:c}),f.updateInstanceState({exportBackground:!f.instanceState.exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(c){I("toggle-tool-lock",{source:c}),f.updateInstanceState({isToolLocked:!f.instanceState.isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",readonlyOk:!1,onSelect(c){I("unlock-all",{source:c});let u=[];for(let c of f.currentPageShapes)c.isLocked&&u.push({id:c.id,type:c.type,isLocked:!1});u.length>0&&f.updateShapes(u)}},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(c){requestAnimationFrame(()=>{f.batch(()=>{I("toggle-focus-mode",{source:c}),b(),v(),f.updateInstanceState({isFocusMode:!f.instanceState.isFocusMode})})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(c){I("toggle-grid-mode",{source:c}),f.updateInstanceState({isGridMode:!f.instanceState.isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(c){I("toggle-debug-mode",{source:c}),f.updateInstanceState({isDebugMode:!f.instanceState.isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(c){I("print",{source:c}),w()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(c){I("exit-pen-mode",{source:c}),f.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(c){I("stop-following",{source:c}),f.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(c){I("zoom-to-content",{source:c}),f.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect(c){f.mark("locking"),I("toggle-lock",{source:c}),f.toggleLock(f.selectedShapeIds)}}]);return c?c(f,u,void 0):u},[I,c,f,g,x,$,T,_,k,E,b,v,w]);return(0,V.jsx)(oq.Provider,{value:asActions(M),children:u})}function useActions(){let c=K.useContext(oq);if(!c)throw Error("useTools must be used within a ToolProvider");return c}function asActions(c){return c}function compactMenuItems(c){return c.filter(c=>null!=c&&!1!==c)}function menuGroup(c,...u){let f=compactMenuItems(u);return 0===f.length?null:{id:c,type:"group",checkbox:f.every(c=>"item"===c.type&&c.actionItem.checkbox),disabled:f.every(c=>c.disabled),readonlyOk:f.some(c=>c.readonlyOk),children:f}}function menuSubmenu(c,u,...f){let g=compactMenuItems(f);return 0===g.length?null:{id:c,type:"submenu",label:u,children:g,disabled:g.every(c=>c.disabled),readonlyOk:g.some(c=>c.readonlyOk)}}function menuCustom(c,u={}){let{readonlyOk:f=!0,disabled:g=!1}=u;return{id:c,type:"custom",disabled:g,readonlyOk:f}}function menuItem(c,u={}){if(!c)throw Error("No action item provided to menuItem");if(!c.label)throw Error("Trying to create menu item for action item that doesn't have a label");let{checked:f=!1,disabled:g=!1}=u;return{id:c.id,type:"item",actionItem:c,disabled:g,checked:f,readonlyOk:c.readonlyOk}}function shapesWithUnboundArrows(c){let{selectedShapeIds:u}=c,f=u.map(u=>c.getShape(u));return f.filter(u=>!(!u||c.isShapeOfType(u,"arrow")&&"binding"===u.props.start.type||c.isShapeOfType(u,"arrow")&&"binding"===u.props.end.type))}let useThreeStackableItems=()=>{let c=(0,tt.j)();return(0,e5.Hg)("threeStackableItems",()=>shapesWithUnboundArrows(c).length>2,[c])},useAllowGroup=()=>{let c=(0,tt.j)();return(0,e5.Hg)("allowGroup",()=>shapesWithUnboundArrows(c).length>1,[c])},useAllowUngroup=()=>{let c=(0,tt.j)();return(0,e5.Hg)("allowUngroup",()=>c.selectedShapeIds.some(u=>c.getShape(u)?.type==="group"),[])};function findMenuItem(c,u){let f=_findMenuItem(c,u);return(0,e4.hu)(f,`Menu item ${u.join(" > ")} not found`),f}function _findMenuItem(c,u){let[f,...g]=u;if(!f)return null;let b=c.find(c=>c.id===f);if(!b)return null;switch(b.type){case"group":case"submenu":return 0===g.length?b:_findMenuItem(b.children,g);case"item":case"custom":return 0===g.length?b:null;default:(0,e4.iP)(b,"type")}}let oX="undefined"!=typeof window&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,oJ=[0,380,420,460,580,640,840,1023],oQ=K.createContext(0);function BreakPointProvider({children:c}){let u=(0,tt.j)(),f=(0,e5.Hg)("breakpoint",()=>{let{width:c}=u.viewportScreenBounds;for(let u=0;u<oJ.length-1;u++)if(c>oJ[u]&&c<=oJ[u+1])return u;return oJ.length},[u]);return(0,V.jsx)(oQ.Provider,{value:f,children:c})}function useBreakpoint(){let c=(0,K.useContext)(oQ),u=new URL(window.location.href).searchParams.get("layout");return"desktop"===u?c=7:"mobile"===u&&(c=1),c}function useHasLinkShapeSelected(){let c=(0,tt.j)();return(0,e5.Hg)("hasLinkShapeSelected",()=>{let{selectedShapes:u}=c;return 1===u.length&&"url"in u[0].props&&"embed"!==u[0].type},[c])}let o0=K.createContext({}),o1=(0,e5.j)(function({overrides:c,children:u}){let f=(0,tt.j)(),g=useActions(),b=f.selectedShapeIds.length,v=b>0,x=b>1,w=b>2,_=useThreeStackableItems(),k=useAllowGroup(),E=useAllowUngroup(),T=useHasLinkShapeSelected(),$=useBreakpoint(),I=1===f.zoomLevel,M=(0,K.useMemo)(()=>{let u=[menuItem(g["align-left"],{disabled:!x}),menuItem(g["align-center-horizontal"],{disabled:!x}),menuItem(g["align-right"],{disabled:!x}),menuItem(g["stretch-horizontal"],{disabled:!x}),menuItem(g["align-top"],{disabled:!x}),menuItem(g["align-center-vertical"],{disabled:!x}),menuItem(g["align-bottom"],{disabled:!x}),menuItem(g["stretch-vertical"],{disabled:!x}),menuItem(g["distribute-horizontal"],{disabled:!w}),menuItem(g["distribute-vertical"],{disabled:!w}),menuItem(g["stack-horizontal"],{disabled:!_}),menuItem(g["stack-vertical"],{disabled:!_}),menuItem(g["send-to-back"],{disabled:!v}),menuItem(g["send-backward"],{disabled:!v}),menuItem(g["bring-forward"],{disabled:!v}),menuItem(g["bring-to-front"],{disabled:!v}),$<5?menuItem(g["zoom-to-100"],{disabled:!!I}):menuItem(g["rotate-ccw"],{disabled:!v}),menuItem(g["rotate-cw"],{disabled:!v}),menuItem(g["edit-link"],{disabled:!T}),k?menuItem(g.group,{disabled:!x}):E?menuItem(g.ungroup):menuItem(g.group,{disabled:!x})];return c?c(f,u,{actions:g,oneSelected:v,twoSelected:x,threeSelected:w}):u},[f,I,k,c,g,v,x,w,_,E,T,$]);return(0,V.jsx)(o0.Provider,{value:M,children:u})});function useActionsMenuSchema(){let c=K.useContext(o0);if(!c)throw Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return c}function useOnlyFlippableShape(){let c=(0,tt.j)();return(0,e5.Hg)("onlyFlippableShape",()=>{let{selectedShapes:u}=c;return 1===u.length&&u.every(u=>c.isShapeOfType(u,"group")||c.isShapeOfType(u,"arrow")||c.isShapeOfType(u,"line")||c.isShapeOfType(u,"draw"))},[c])}function useShowAutoSizeToggle(){let c=(0,tt.j)();return(0,e5.Hg)("showAutoSizeToggle",()=>{let{selectedShapes:u}=c;return 1===u.length&&c.isShapeOfType(u[0],"text")&&!1===u[0].props.autoSize},[c])}let o2=K.createContext({}),o5=(0,e5.j)(function({overrides:c,children:u}){let f=(0,tt.j)(),g=useActions(),b=useShowAutoSizeToggle(),v=useOnlyFlippableShape(),x=f.selectedShapeIds.length,w=x>0,_=x>1,k=x>2,E=useThreeStackableItems(),T=(0,e5.Hg)("atLeastOneShapeOnPage",()=>f.currentPageShapeIds.size>0,[]),$=(0,e5.Hg)("isTransparentBg",()=>f.instanceState.exportBackground,[]),I=useAllowGroup(),M=useAllowUngroup(),j=!!window.navigator.clipboard?.write,D=useHasLinkShapeSelected(),{onlySelectedShape:L}=f,F=L&&f.isShapeOrAncestorLocked(L),B=(0,K.useMemo)(()=>{let u=compactMenuItems([menuGroup("selection",b&&menuItem(g["toggle-auto-size"]),D&&!F&&menuItem(g["edit-link"]),w&&!F&&menuItem(g.duplicate),I&&!F&&menuItem(g.group),M&&!F&&menuItem(g.ungroup),w&&menuItem(g["toggle-lock"])),menuGroup("modify",(_||v)&&menuSubmenu("arrange","context-menu.arrange",_&&menuGroup("align",menuItem(g["align-left"]),menuItem(g["align-center-horizontal"]),menuItem(g["align-right"]),menuItem(g["align-top"]),menuItem(g["align-center-vertical"]),menuItem(g["align-bottom"])),k&&menuGroup("distribute",menuItem(g["distribute-horizontal"]),menuItem(g["distribute-vertical"])),_&&menuGroup("stretch",menuItem(g["stretch-horizontal"]),menuItem(g["stretch-vertical"])),v&&!F&&menuGroup("flip",menuItem(g["flip-horizontal"]),menuItem(g["flip-vertical"])),_&&menuGroup("order",menuItem(g.pack,{disabled:!_}),E&&menuItem(g["stack-vertical"]),E&&menuItem(g["stack-horizontal"]))),w&&!F&&menuSubmenu("reorder","context-menu.reorder",menuGroup("reorder",menuItem(g["bring-to-front"]),menuItem(g["bring-forward"]),menuItem(g["send-backward"]),menuItem(g["send-to-back"]))),w&&!F&&menuCustom("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),menuGroup("clipboard-group",w&&!F&&menuItem(g.cut),w&&menuItem(g.copy),oX&&menuItem(g.paste)),T&&menuGroup("conversions",menuSubmenu("copy-as","context-menu.copy-as",menuGroup("copy-as-group",menuItem(g["copy-as-svg"]),j&&menuItem(g["copy-as-png"]),menuItem(g["copy-as-json"])),menuGroup("export-bg",menuItem(g["toggle-transparent"],{checked:!$}))),menuSubmenu("export-as","context-menu.export-as",menuGroup("export-as-group",menuItem(g["export-as-svg"]),menuItem(g["export-as-png"]),menuItem(g["export-as-json"])),menuGroup("export-bg,",menuItem(g["toggle-transparent"],{checked:!$})))),T&&menuGroup("set-selection-group",menuItem(g["select-all"]),w&&menuItem(g["select-none"])),w&&!F&&menuGroup("delete-group",menuItem(g.delete))]);return c&&(u=c(f,u,{actions:g,oneSelected:w,twoSelected:_,threeSelected:k,showAutoSizeToggle:b,showUngroup:M,onlyFlippableShapeSelected:v})),u},[f,c,g,w,_,k,b,v,T,E,I,M,j,D,$,F]);return(0,V.jsx)(o2.Provider,{value:B,children:u})});function useContextMenuSchema(){let c=K.useContext(o2);if(!c)throw Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return c}let o3=K.createContext({});function ToolsProvider({overrides:c,children:u}){let f=(0,tt.j)(),g=useUiEvents(),{addDialog:b}=useDialogs(),v=useInsertMedia(),x=K.useMemo(()=>{let u=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(c){f.setCurrentTool("select"),g("select-tool",{source:c,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(c){f.setCurrentTool("hand"),g("select-tool",{source:c,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(c){f.setCurrentTool("eraser"),g("select-tool",{source:c,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(c){f.setCurrentTool("draw"),g("select-tool",{source:c,id:"draw"})}},...[...e8.Zu.values].map(c=>({id:c,label:`tool.${c}`,readonlyOk:!1,meta:{geo:c},kbd:"rectangle"===c?"r":"ellipse"===c?"o":void 0,icon:"geo-"+c,onSelect(u){f.batch(()=>{f.updateInstanceState({stylesForNextShape:{...f.instanceState.stylesForNextShape,[e8.Zu.id]:c}},{ephemeral:!0}),f.setCurrentTool("geo"),g("select-tool",{source:u,id:`geo-${c}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(c){f.setCurrentTool("arrow"),g("select-tool",{source:c,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(c){f.setCurrentTool("line"),g("select-tool",{source:c,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(c){f.setCurrentTool("frame"),g("select-tool",{source:c,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(c){f.setCurrentTool("text"),g("select-tool",{source:c,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(c){v(),g("select-tool",{source:c,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(c){f.setCurrentTool("note"),g("select-tool",{source:c,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(c){f.setCurrentTool("laser"),g("select-tool",{source:c,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(c){b({component:oL}),g("select-tool",{source:c,id:"embed"})}}];u.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(c){f.setCurrentTool("highlight"),g("select-tool",{source:c,id:"highlight"})}});let x=Object.fromEntries(u.map(c=>[c.id,c]));return c?c(f,x,{insertMedia:v}):x},[c,f,g,v,b]);return(0,V.jsx)(o3.Provider,{value:x,children:u})}function useTools(){let c=K.useContext(o3);if(!c)throw Error("useTools must be used within a ToolProvider");return c}let o8=K.createContext({}),o4=(0,e5.j)(function({overrides:c,children:u}){let f=(0,tt.j)(),g=useTools(),b=useActions(),v=(0,K.useMemo)(()=>{let u=(0,e4.oA)([menuGroup("shortcuts-dialog.tools",menuItem(b["toggle-tool-lock"]),menuItem(g.select),menuItem(g.draw),menuItem(g.eraser),menuItem(g.hand),menuItem(g.rectangle),menuItem(g.ellipse),menuItem(g.arrow),menuItem(g.line),menuItem(g.text),menuItem(g.frame),menuItem(g.note),menuItem(g.laser)),menuGroup("shortcuts-dialog.file",menuItem(b["insert-media"]),menuItem(b.print)),menuGroup("shortcuts-dialog.preferences",menuItem(b["toggle-dark-mode"]),menuItem(b["toggle-focus-mode"]),menuItem(b["toggle-grid"])),menuGroup("shortcuts-dialog.edit",menuItem(b.undo),menuItem(b.redo),menuItem(b.cut),menuItem(b.copy),menuItem(b.paste),menuItem(b["select-all"]),menuItem(b.delete),menuItem(b.duplicate),menuItem(b["export-as-svg"]),menuItem(b["export-as-png"])),menuGroup("shortcuts-dialog.view",menuItem(b["zoom-in"]),menuItem(b["zoom-out"]),menuItem(b["zoom-to-100"]),menuItem(b["zoom-to-fit"]),menuItem(b["zoom-to-selection"])),menuGroup("shortcuts-dialog.transform",menuItem(b["bring-to-front"]),menuItem(b["bring-forward"]),menuItem(b["send-backward"]),menuItem(b["send-to-back"]),menuItem(b.group),menuItem(b.ungroup),menuItem(b["flip-horizontal"]),menuItem(b["flip-vertical"]),menuItem(b["align-top"]),menuItem(b["align-center-vertical"]),menuItem(b["align-bottom"]),menuItem(b["align-left"]),menuItem(b["align-center-horizontal"]),menuItem(b["align-right"]))]);return c?c(f,u,{tools:g,actions:b}):u},[f,c,b,g]);return(0,V.jsx)(o8.Provider,{value:v,children:u})});function useKeyboardShortcutsSchema(){let c=K.useContext(o8);if(!c)throw Error("Shortcuts must be used inside of a ShortcutsProvider.");return c}let KeyboardShortcutsDialog=()=>{let c=useTranslation(),u=useReadonly(),f=useKeyboardShortcutsSchema();function getKeyboardShortcutItem(f){if(u&&!f.readonlyOk)return null;switch(f.type){case"group":return(0,V.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,V.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:c(f.id)}),(0,V.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:f.children.filter(c=>"item"===c.type&&c.actionItem.kbd).map(getKeyboardShortcutItem)})]},f.id);case"item":{let{id:u,label:g,shortcutsLabel:b,kbd:v}=f.actionItem;return(0,V.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,V.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:c(b??g)}),(0,V.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,V.jsx)(Kbd,{children:v})})]},u)}}}return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Header,{className:"tlui-shortcuts-dialog__header",children:[(0,V.jsx)(Title,{children:c("shortcuts-dialog.title")}),(0,V.jsx)(CloseButton,{})]}),(0,V.jsx)(Body,{className:"tlui-shortcuts-dialog__body",children:f.map(getKeyboardShortcutItem)}),(0,V.jsx)("div",{className:"tlui-dialog__scrim"})]})};function useLanguages(){let c=(0,tt.j)();return{languages:e8.a2,currentLanguage:c.user.locale}}let o6=K.createContext({}),o7=(0,e5.j)(function({overrides:c,children:u}){let f=(0,tt.j)(),g=useActions(),b=f.selectedShapeIds.length,v=b>0,x=b>1,w=b>2,{languages:_,currentLanguage:k}=useLanguages(),{addDialog:E}=useDialogs(),T=(0,K.useMemo)(()=>{let u=(0,e4.oA)([menuGroup("top",menuCustom("LANGUAGE_MENU",{readonlyOk:!0}),menuItem({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){E({component:KeyboardShortcutsDialog})}}))]);return c?c(f,u,{actions:g,currentLanguage:k,languages:_,oneSelected:v,twoSelected:x,threeSelected:w}):u},[f,c,_,g,v,x,w,k,E]);return(0,V.jsx)(o6.Provider,{value:T,children:u})});function useHelpMenuSchema(){let c=K.useContext(o6);if(!c)throw Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return c}function useCanRedo(){let c=(0,tt.j)();return(0,e5.Hg)("useCanRedo",()=>c.canRedo,[c])}function useCanUndo(){let c=(0,tt.j)();return(0,e5.Hg)("useCanUndo",()=>c.canUndo,[c])}let o9=K.createContext({});function TLUiMenuSchemaProvider({overrides:c,children:u}){let f=(0,tt.j)(),g=useActions(),b=useBreakpoint(),v=b<5,x=(0,e5.Hg)("isDarkMode",()=>f.user.isDarkMode,[f]),w=(0,e5.Hg)("animationSpeed",()=>f.user.animationSpeed,[f]),_=(0,e5.Hg)("isGridMode",()=>f.instanceState.isGridMode,[f]),k=(0,e5.Hg)("isSnapMode",()=>f.user.isSnapMode,[f]),E=(0,e5.Hg)("isToolLock",()=>f.instanceState.isToolLocked,[f]),T=(0,e5.Hg)("isFocusMode",()=>f.instanceState.isFocusMode,[f]),$=(0,e5.Hg)("isDebugMode",()=>f.instanceState.isDebugMode,[f]),I=(0,e5.Hg)("exportBackground",()=>f.instanceState.exportBackground,[f]),M=(0,e5.Hg)("emptyPage",()=>0===f.currentPageShapeIds.size,[f]),j=(0,e5.Hg)("selectedCount",()=>f.selectedShapeIds.length,[f]),D=0===j,L=j>0,F=j>1,B=j>2,G=!!window.navigator.clipboard?.write,U=useHasLinkShapeSelected(),Z=useShowAutoSizeToggle(),Y=useAllowGroup(),X=useAllowUngroup(),J=useCanUndo(),Q=useCanRedo(),ee=(0,e5.Hg)("isZoomedTo100",()=>1===f.zoomLevel,[f]),et=(0,e5.Hg)("oneEmbedSelected",()=>{let{onlySelectedShape:c}=f;return!!c&&!!(f.isShapeOfType(c,"embed")&&c.props.url&&!f.isShapeOrAncestorLocked(c))},[]),en=(0,e5.Hg)("oneEmbeddableBookmarkSelected",()=>{let{onlySelectedShape:c}=f;return!!c&&!!(f.isShapeOfType(c,"bookmark")&&c.props.url&&getEmbedInfo(c.props.url)&&!f.isShapeOrAncestorLocked(c))},[]),er=(0,K.useMemo)(()=>{let u=compactMenuItems([menuGroup("menu",menuSubmenu("file","menu.file",menuGroup("print",menuItem(g.print,{disabled:M}))),menuSubmenu("edit","menu.edit",menuGroup("undo-actions",menuItem(g.undo,{disabled:!J}),menuItem(g.redo,{disabled:!Q})),menuGroup("clipboard-actions",menuItem(g.cut,{disabled:D}),menuItem(g.copy,{disabled:D}),menuItem(g.paste,{disabled:!oX})),menuGroup("conversions",menuSubmenu("copy-as","menu.copy-as",menuGroup("copy-as-group",menuItem(g["copy-as-svg"],{disabled:M}),menuItem(g["copy-as-png"],{disabled:M||!G}),menuItem(g["copy-as-json"],{disabled:M})),menuGroup("export-bg",menuItem(g["toggle-transparent"],{checked:!I}))),menuSubmenu("export-as","menu.export-as",menuGroup("export-as-group",menuItem(g["export-as-svg"],{disabled:M}),menuItem(g["export-as-png"],{disabled:M}),menuItem(g["export-as-json"],{disabled:M})),menuGroup("export-bg",menuItem(g["toggle-transparent"],{checked:!I})))),menuGroup("set-selection-group",menuItem(g["select-all"],{disabled:M}),menuItem(g["select-none"],{disabled:!L})),menuGroup("selection",Z&&menuItem(g["toggle-auto-size"]),U&&menuItem(g["edit-link"]),menuItem(g.duplicate,{disabled:!L}),Y&&menuItem(g.group),X&&menuItem(g.ungroup),menuItem(g["unlock-all"],{disabled:M})),menuGroup("delete-group",menuItem(g.delete,{disabled:!L})),menuGroup("embeds",et&&menuItem(g["open-embed-link"]),et&&menuItem(g["convert-to-bookmark"]),en&&menuItem(g["convert-to-embed"]))),menuSubmenu("view","menu.view",menuGroup("view-actions",menuItem(g["zoom-in"]),menuItem(g["zoom-out"]),menuItem(g["zoom-to-100"],{disabled:ee}),menuItem(g["zoom-to-fit"],{disabled:M}),menuItem(g["zoom-to-selection"],{disabled:M||!L})))),menuGroup("extras",menuItem(g["insert-embed"]),menuItem(g["insert-media"])),menuGroup("preferences",menuSubmenu("preferences","menu.preferences",menuGroup("preferences-actions",menuItem(g["toggle-snap-mode"],{checked:k}),menuItem(g["toggle-tool-lock"],{checked:E}),menuItem(g["toggle-grid"],{checked:_}),menuItem(g["toggle-dark-mode"],{checked:x}),menuItem(g["toggle-focus-mode"],{checked:T}),menuItem(g["toggle-reduce-motion"],{checked:0===w}),menuItem(g["toggle-debug-mode"],{checked:$}))),v&&menuCustom("LANGUAGE_MENU",{readonlyOk:!0}))]);return c?c(f,u,{actions:g,noneSelected:D,oneSelected:L,twoSelected:F,threeSelected:B}):u},[f,c,g,L,F,B,M,v,Y,X,U,G,Z,D,J,Q,w,x,_,k,E,T,I,$,ee,en,et]);return(0,V.jsx)(o9.Provider,{value:er,children:u})}function useMenuSchema(){let c=K.useContext(o9);if(!c)throw Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return c}function toolbarItem(c){return{id:c.id,type:"item",readonlyOk:c.readonlyOk,toolItem:c}}let ae=K.createContext([]);function ToolbarSchemaProvider({overrides:c,children:u}){let f=(0,tt.j)(),g=useTools(),b=K.useMemo(()=>{let u=(0,e4.oA)([toolbarItem(g.select),toolbarItem(g.hand),toolbarItem(g.draw),toolbarItem(g.eraser),toolbarItem(g.arrow),toolbarItem(g.text),toolbarItem(g.note),toolbarItem(g.asset),toolbarItem(g.rectangle),toolbarItem(g.ellipse),toolbarItem(g.diamond),toolbarItem(g.triangle),toolbarItem(g.trapezoid),toolbarItem(g.rhombus),toolbarItem(g.hexagon),toolbarItem(g.cloud),toolbarItem(g.star),toolbarItem(g.oval),toolbarItem(g["x-box"]),toolbarItem(g["check-box"]),toolbarItem(g["arrow-left"]),toolbarItem(g["arrow-up"]),toolbarItem(g["arrow-down"]),toolbarItem(g["arrow-right"]),toolbarItem(g.frame),toolbarItem(g.line),toolbarItem(g.highlight),toolbarItem(g.laser)]);return c?c(f,u,{tools:g}):u},[f,c,g]);return(0,V.jsx)(ae.Provider,{value:b,children:u})}function useToolbarSchema(){let c=K.useContext(ae);if(!c)throw Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return c}function useDefaultHelpers(){let{addToast:c,removeToast:u,clearToasts:f}=useToasts(),{addDialog:g,clearDialogs:b,removeDialog:v,updateDialog:x}=useDialogs(),w=useBreakpoint(),_=w<5,k=useTranslation();return(0,K.useMemo)(()=>({addToast:c,removeToast:u,clearToasts:f,addDialog:g,clearDialogs:b,removeDialog:v,updateDialog:x,msg:k,isMobile:_}),[g,c,b,f,k,v,u,x,_])}function mergeOverrides(c,u){let f={};for(let u of c)if(u.translations)for(let[c,g]of(0,e4.EP)(u.translations)){let u=f[c];u||(u=f[c]={}),Object.assign(u,g)}return{actionsMenu:(f,g,b)=>{for(let v of c)v.actionsMenu&&(g=v.actionsMenu(f,g,{...u,...b}));return g},actions:(f,g)=>{for(let b of c)b.actions&&(g=b.actions(f,g,u));return g},contextMenu:(f,g,b)=>{for(let v of c)v.contextMenu&&(g=v.contextMenu(f,g,{...u,...b}));return g},helpMenu:(f,g,b)=>{for(let v of c)v.helpMenu&&(g=v.helpMenu(f,g,{...u,...b}));return g},menu:(f,g,b)=>{for(let v of c)v.menu&&(g=v.menu(f,g,{...u,...b}));return g},toolbar:(f,g,b)=>{for(let v of c)v.toolbar&&(g=v.toolbar(f,g,{...u,...b}));return g},keyboardShortcutsMenu:(f,g,b)=>{for(let v of c)v.keyboardShortcutsMenu&&(g=v.keyboardShortcutsMenu(f,g,{...u,...b}));return g},tools:(f,g,b)=>{for(let v of c)v.tools&&(g=v.tools(f,g,{...u,...b}));return g},translations:f}}function useShallowArrayEquality(c){return(0,K.useMemo)(()=>c,c)}function useMergedTranslationOverrides(c){let u=useShallowArrayEquality(null==c?[]:Array.isArray(c)?c:[c]);return(0,K.useMemo)(()=>{let c={};for(let f of u)if(f.translations)for(let[u,g]of(0,e4.EP)(f.translations)){let f=c[u];f||(f=c[u]={}),Object.assign(f,g)}return c},[u])}function useMergedOverrides(c){let u=useDefaultHelpers(),f=useShallowArrayEquality(null==c?[]:Array.isArray(c)?c:[c]);return(0,K.useMemo)(()=>mergeOverrides(f,u),[f,u])}function TldrawUiContextProvider({overrides:c,assetUrls:u,onUiEvent:f,children:g}){return(0,V.jsx)(AssetUrlsProvider,{assetUrls:useDefaultUiAssetUrlsWithOverrides(u),children:(0,V.jsx)(nV,{overrides:useMergedTranslationOverrides(c),children:(0,V.jsx)(UiEventsProvider,{onEvent:f,children:(0,V.jsx)(ToastsProvider,{children:(0,V.jsx)(DialogsProvider,{children:(0,V.jsx)(BreakPointProvider,{children:(0,V.jsx)(InternalProviders,{overrides:c,children:g})})})})})})})}function InternalProviders({overrides:c,children:u}){let f=useMergedOverrides(c);return(0,V.jsx)(ActionsProvider,{overrides:f.actions,children:(0,V.jsx)(ToolsProvider,{overrides:f.tools,children:(0,V.jsx)(ToolbarSchemaProvider,{overrides:f.toolbar,children:(0,V.jsx)(o1,{overrides:f.actionsMenu,children:(0,V.jsx)(o4,{overrides:f.keyboardShortcutsMenu,children:(0,V.jsx)(o5,{overrides:f.contextMenu,children:(0,V.jsx)(o7,{overrides:f.helpMenu,children:(0,V.jsx)(TLUiMenuSchemaProvider,{overrides:f.menu,children:u})})})})})})})})}function BackToContent(){let c=(0,tt.j)(),u=useActions(),f=u["back-to-content"],[g,b]=(0,K.useState)(!1);return((0,K.useEffect)(()=>{let u=!1,f=setInterval(()=>{let{renderingShapes:f,renderingBounds:g}=c,v=f.filter(c=>c.maskedPageBounds&&g.includes(c.maskedPageBounds)),x=0===v.length&&c.currentPageShapes.length>0;u!==x&&(b(x),u=x)},1e3);return()=>{clearInterval(f)}},[c]),g)?(0,V.jsx)(nq,{iconLeft:f.icon,label:f.label,onClick:()=>{f.onSelect("helper-buttons"),b(!1)}}):null}let at=0;function createNShapes(c,u){let f=Array(u),g=Math.floor(Math.sqrt(u));for(let c=0;c<u;c++)at++,f[c]={id:(0,e8.F1)("box"+at),type:"geo",x:c%g*132,y:132*Math.floor(c/g)};c.batch(()=>{c.createShapes(f).setSelectedShapes(f.map(c=>c.id))})}let an=K.memo(function({renderDebugMenuItems:c}){let u=useTranslation();return(0,V.jsxs)("div",{className:"tlui-debug-panel",children:[(0,V.jsx)(ar,{}),(0,V.jsx)(ShapeCount,{}),(0,V.jsxs)(Root,{id:"debug",children:[(0,V.jsx)(Trigger,{children:(0,V.jsx)(nq,{icon:"dots-horizontal",title:u("debug-panel.more")})}),(0,V.jsx)(Content,{side:"top",align:"end",alignOffset:0,children:(0,V.jsx)(ai,{renderDebugMenuItems:c})})]})]})}),ar=(0,e5.j)(function(){let c=(0,tt.j)();return(0,V.jsx)("div",{className:"tlui-debug-panel__current-state",children:c.root.path.value})}),ShapeCount=function(){let c=(0,tt.j)(),u=(0,e5.Hg)("rendering shapes count",()=>c.renderingShapes.length,[c]);return(0,V.jsxs)("div",{children:[u," Shapes"]})},ai=(0,e5.j)(function({renderDebugMenuItems:c}){let u=(0,tt.j)(),{addToast:f}=useToasts(),{addDialog:g}=useDialogs(),[b,v]=K.useState(!1);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Group,{children:[(0,V.jsx)(Item,{onClick:()=>{f({id:(0,tQ.E)(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:(0,V.jsx)("span",{children:"Show toast"})}),(0,V.jsx)(Item,{onClick:()=>{g({component:({onClose:c})=>(0,V.jsx)(ExampleDialog,{displayDontShowAgain:!0,onCancel:()=>{c()},onContinue:()=>{c()}}),onClose:()=>{}})},children:(0,V.jsx)("span",{children:"Show dialog"})}),(0,V.jsx)(Item,{onClick:()=>createNShapes(u,100),children:(0,V.jsx)("span",{children:"Create 100 shapes"})}),(0,V.jsx)(Item,{onClick:()=>{function countDescendants({children:c}){let u=0;if(!c.length)return 0;for(let f of[...c])u++,u+=countDescendants(f);return u}let{selectedShapes:c}=u,f=0===c.length?u.renderingShapes:c,g=f.map(c=>document.getElementById(c.id).parentElement),b=g.length;for(let c of g)b+=countDescendants(c);window.alert(`Shapes ${f.length}, DOM nodes:${b}`)},children:(0,V.jsx)("span",{children:"Count shapes and nodes"})}),(()=>{if(b)throw Error("oh no!")})(),(0,V.jsx)(Item,{onClick:()=>{v(!0)},children:(0,V.jsx)("span",{children:"Throw error"})}),(0,V.jsx)(Item,{onClick:()=>{hardResetEditor()},children:(0,V.jsx)("span",{children:"Hard reset"})})]}),(0,V.jsxs)(Group,{children:[(0,V.jsx)(ao,{flag:te.debugSvg}),(0,V.jsx)(ao,{flag:te.forceSrgb}),(0,V.jsx)(ao,{flag:te.debugGeometry}),(0,V.jsx)(ao,{flag:te.hideShapes})]}),(0,V.jsx)(Group,{children:Object.values(e9).map(c=>(0,V.jsx)(ao,{flag:c},c.name))}),c?.()]})});function Toggle({label:c,value:u,onChange:f}){return(0,V.jsx)(CheckboxItem,{title:c,checked:u,onSelect:()=>f(!u),children:c})}let ao=(0,e5.j)(function({flag:c,onChange:u}){return(0,V.jsx)(Toggle,{label:c.name.replace(/([a-z0-9])([A-Z])/g,c=>`${c[0]} ${c[1].toLowerCase()}`).replace(/^[a-z]/,c=>c.toUpperCase()),value:c.value,onChange:f=>{c.set(f),u?.(f)}})});function ExampleDialog({title:c="title",body:u="hello hello hello",cancel:f="Cancel",confirm:g="Continue",displayDontShowAgain:b=!1,onCancel:v,onContinue:x}){let[w,_]=K.useState(!1);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(Header,{children:[(0,V.jsx)(Title,{children:c}),(0,V.jsx)(CloseButton,{})]}),(0,V.jsx)(Body,{style:{maxWidth:350},children:u}),(0,V.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[b&&(0,V.jsx)(nq,{onClick:()=>_(!w),iconLeft:w?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,V.jsx)(nq,{onClick:v,children:f}),(0,V.jsx)(nq,{type:"primary",onClick:async()=>x(),children:g})]})]})}let Dialog=({id:c,component:u,onClose:f})=>{let{removeDialog:g}=useDialogs(),b=useContainer(),v=(0,K.useCallback)(u=>{if(!u){if(f)try{f()}catch(c){console.warn(c)}g(c)}},[c,f,g]);return(0,V.jsx)($5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,{onOpenChange:v,defaultOpen:!0,children:(0,V.jsx)($5d3850c4d0b4e6c7$export$602eac185826482c,{container:b,children:(0,V.jsx)(eU,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,V.jsx)(eW,{dir:"ltr",className:"tlui-dialog__content",children:(0,V.jsx)(u,{onClose:()=>v(!1)})})})})})};function _Dialogs(){let{dialogs:c}=useDialogs();return(0,V.jsx)(V.Fragment,{children:c.map(c=>(0,V.jsx)(Dialog,{...c},c.id))})}let aa=K.memo(_Dialogs);function FollowingIndicator(){let c=(0,tt.j)(),u=(0,e5.Hg)("follow",()=>c.instanceState.followingUserId,[c]);return u?(0,V.jsx)(FollowingIndicatorInner,{userId:u}):null}function FollowingIndicatorInner({userId:c}){let u=usePresence(c);return u?(0,V.jsx)("div",{className:"tlui-following",style:{borderColor:u.color}}):null}function LanguageMenu(){let c=(0,tt.j)(),{languages:u,currentLanguage:f}=useLanguages(),g=(0,K.useCallback)(u=>c.user.updateUserPreferences({locale:u}),[c]);return(0,V.jsxs)(Sub,{id:"help menu language",children:[(0,V.jsx)(SubTrigger,{label:"menu.language","data-direction":"left"}),(0,V.jsx)(SubContent,{sideOffset:-4,children:(0,V.jsx)(Group,{children:u.map(({locale:c,label:u})=>(0,V.jsx)(RadioItem,{title:c,checked:c===f,onSelect:()=>g(c),children:(0,V.jsx)("span",{children:u})},c))})})]})}let as=K.memo(function(){let c=useContainer(),u=useTranslation(),[f,g]=useMenuIsOpen("help menu");return(0,V.jsx)("div",{className:"tlui-help-menu",children:(0,V.jsxs)($d08ef79370b62062$export$be92b6f5f03c0fe9,{dir:"ltr",open:f,onOpenChange:g,modal:!1,children:[(0,V.jsx)(im,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:u("help-menu.title"),children:(0,V.jsx)(nW,{icon:"question-mark"})}),(0,V.jsx)($d08ef79370b62062$export$602eac185826482c,{container:c,dir:"ltr",children:(0,V.jsx)(iy,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,V.jsx)(HelpMenuContent,{})})})]})})});function HelpMenuContent(){let c=useHelpMenuSchema(),u=useReadonly();function getHelpMenuItem(c){if(u&&!c.readonlyOk)return null;switch(c.type){case"custom":if("LANGUAGE_MENU"===c.id)return(0,V.jsx)(LanguageMenu,{},"item");break;case"group":return(0,V.jsx)(Group,{size:"small",children:c.children.map(getHelpMenuItem)},c.id);case"submenu":return(0,V.jsxs)(Sub,{id:`help menu ${c.id}`,children:[(0,V.jsx)(SubTrigger,{label:c.label}),(0,V.jsx)(SubContent,{children:c.children.map(getHelpMenuItem)})]},c.id);case"item":{let{id:u,kbd:f,label:g,onSelect:b,icon:v}=c.actionItem;return(0,V.jsx)(Item,{kbd:f,label:g,onClick:()=>b("help-menu"),iconLeft:v},u)}}}return(0,V.jsx)(V.Fragment,{children:c.map(getHelpMenuItem)})}function index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c,u,{checkForDefaultPrevented:f=!0}={}){return function(g){if(null==c||c(g),!1===f||!g.defaultPrevented)return null==u?void 0:u(g)}}function index_module_$6ed0406888f73fc4$var$setRef(c,u){"function"==typeof c?c(u):null!=c&&(c.current=u)}function index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(...c){return u=>c.forEach(c=>index_module_$6ed0406888f73fc4$var$setRef(c,u))}function index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(...c){return(0,K.useCallback)(index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(...c),c)}function index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(c,u=[]){let f=[];function $c512c27ab02ef895$export$fd42f52fd3ae1109(u,g){let b=(0,K.createContext)(g),v=f.length;function Provider(u){let{scope:f,children:g,...x}=u,w=(null==f?void 0:f[c][v])||b,_=(0,K.useMemo)(()=>x,Object.values(x));return(0,K.createElement)(w.Provider,{value:_},g)}function useContext(f,x){let w=(null==x?void 0:x[c][v])||b,_=(0,K.useContext)(w);if(_)return _;if(void 0!==g)return g;throw Error(`\`${f}\` must be used within \`${u}\``)}return f=[...f,g],Provider.displayName=u+"Provider",[Provider,useContext]}let createScope=()=>{let u=f.map(c=>(0,K.createContext)(c));return function(f){let g=(null==f?void 0:f[c])||u;return(0,K.useMemo)(()=>({[`__scope${c}`]:{...f,[c]:g}}),[f,g])}};return createScope.scopeName=c,[$c512c27ab02ef895$export$fd42f52fd3ae1109,index_module_$c512c27ab02ef895$var$composeContextScopes(createScope,...u)]}function index_module_$c512c27ab02ef895$var$composeContextScopes(...c){let u=c[0];if(1===c.length)return u;let createScope1=()=>{let f=c.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(c){let g=f.reduce((u,{useScope:f,scopeName:g})=>{let b=f(c),v=b[`__scope${g}`];return{...u,...v}},{});return(0,K.useMemo)(()=>({[`__scope${u.scopeName}`]:g}),[g])}};return createScope1.scopeName=u.scopeName,createScope1}let al=(0,K.forwardRef)((c,u)=>{let{children:f,...g}=c,b=K.Children.toArray(f),v=b.find(index_module_$5e63c961fc1ce211$var$isSlottable);if(v){let c=v.props.children,f=b.map(u=>u!==v?u:K.Children.count(c)>1?K.Children.only(null):(0,K.isValidElement)(c)?c.props.children:null);return(0,K.createElement)(ac,_extends({},g,{ref:u}),(0,K.isValidElement)(c)?(0,K.cloneElement)(c,void 0,f):null)}return(0,K.createElement)(ac,_extends({},g,{ref:u}),f)});al.displayName="Slot";let ac=(0,K.forwardRef)((c,u)=>{let{children:f,...g}=c;return(0,K.isValidElement)(f)?(0,K.cloneElement)(f,{...index_module_$5e63c961fc1ce211$var$mergeProps(g,f.props),ref:index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(u,f.ref)}):K.Children.count(f)>1?K.Children.only(null):null});ac.displayName="SlotClone";let index_module_$5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:c})=>(0,K.createElement)(K.Fragment,null,c);function index_module_$5e63c961fc1ce211$var$isSlottable(c){return(0,K.isValidElement)(c)&&c.type===index_module_$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function index_module_$5e63c961fc1ce211$var$mergeProps(c,u){let f={...u};for(let g in u){let b=c[g],v=u[g],x=/^on[A-Z]/.test(g);x?b&&v?f[g]=(...c)=>{v(...c),b(...c)}:b&&(f[g]=b):"style"===g?f[g]={...b,...v}:"className"===g&&(f[g]=[b,v].filter(Boolean).join(" "))}return{...c,...f}}let au=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((c,u)=>{let f=(0,K.forwardRef)((c,f)=>{let{asChild:g,...b}=c,v=g?al:u;return(0,K.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,K.createElement)(v,_extends({},b,{ref:f}))});return f.displayName=`Primitive.${u}`,{...c,[u]:f}},{});function index_module_$8927f6f2acc4f386$export$6d1a0317bde7de7f(c,u){c&&(0,Q.flushSync)(()=>c.dispatchEvent(u))}function index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c){let u=(0,K.useRef)(c);return(0,K.useEffect)(()=>{u.current=c}),(0,K.useMemo)(()=>(...c)=>{var f;return null===(f=u.current)||void 0===f?void 0:f.call(u,...c)},[])}function index_module_$addc16e1bbe58fd0$export$3a72a57244d6e765(c,u=null==globalThis?void 0:globalThis.document){let f=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c);(0,K.useEffect)(()=>{let handleKeyDown=c=>{"Escape"===c.key&&f(c)};return u.addEventListener("keydown",handleKeyDown),()=>u.removeEventListener("keydown",handleKeyDown)},[f,u])}let ad="dismissableLayer.update",ah=(0,K.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ap=(0,K.forwardRef)((c,u)=>{var f;let{disableOutsidePointerEvents:g=!1,onEscapeKeyDown:b,onPointerDownOutside:v,onFocusOutside:w,onInteractOutside:_,onDismiss:k,...E}=c,T=(0,K.useContext)(ah),[$,I]=(0,K.useState)(null),M=null!==(f=null==$?void 0:$.ownerDocument)&&void 0!==f?f:null==globalThis?void 0:globalThis.document,[,j]=(0,K.useState)({}),D=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>I(c)),L=Array.from(T.layers),[F]=[...T.layersWithOutsidePointerEventsDisabled].slice(-1),B=L.indexOf(F),G=$?L.indexOf($):-1,U=T.layersWithOutsidePointerEventsDisabled.size>0,V=G>=B,Z=index_module_$5cb92bef7577960e$var$usePointerDownOutside(c=>{let u=c.target,f=[...T.branches].some(c=>c.contains(u));!V||f||(null==v||v(c),null==_||_(c),c.defaultPrevented||null==k||k())},M),Y=index_module_$5cb92bef7577960e$var$useFocusOutside(c=>{let u=c.target,f=[...T.branches].some(c=>c.contains(u));f||(null==w||w(c),null==_||_(c),c.defaultPrevented||null==k||k())},M);return index_module_$addc16e1bbe58fd0$export$3a72a57244d6e765(c=>{let u=G===T.layers.size-1;u&&(null==b||b(c),!c.defaultPrevented&&k&&(c.preventDefault(),k()))},M),(0,K.useEffect)(()=>{if($)return g&&(0===T.layersWithOutsidePointerEventsDisabled.size&&(x=M.body.style.pointerEvents,M.body.style.pointerEvents="none"),T.layersWithOutsidePointerEventsDisabled.add($)),T.layers.add($),index_module_$5cb92bef7577960e$var$dispatchUpdate(),()=>{g&&1===T.layersWithOutsidePointerEventsDisabled.size&&(M.body.style.pointerEvents=x)}},[$,M,g,T]),(0,K.useEffect)(()=>()=>{$&&(T.layers.delete($),T.layersWithOutsidePointerEventsDisabled.delete($),index_module_$5cb92bef7577960e$var$dispatchUpdate())},[$,T]),(0,K.useEffect)(()=>{let handleUpdate=()=>j({});return document.addEventListener(ad,handleUpdate),()=>document.removeEventListener(ad,handleUpdate)},[]),(0,K.createElement)(au.div,_extends({},E,{ref:D,style:{pointerEvents:U?V?"auto":"none":void 0,...c.style},onFocusCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusCapture,Y.onFocusCapture),onBlurCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onBlurCapture,Y.onBlurCapture),onPointerDownCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDownCapture,Z.onPointerDownCapture)}))});function index_module_$5cb92bef7577960e$var$usePointerDownOutside(c,u=null==globalThis?void 0:globalThis.document){let f=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c),g=(0,K.useRef)(!1),b=(0,K.useRef)(()=>{});return(0,K.useEffect)(()=>{let handlePointerDown=c=>{if(c.target&&!g.current){let g={originalEvent:c};function handleAndDispatchPointerDownOutsideEvent(){index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.pointerDownOutside",f,g,{discrete:!0})}"touch"===c.pointerType?(u.removeEventListener("click",b.current),b.current=handleAndDispatchPointerDownOutsideEvent,u.addEventListener("click",b.current,{once:!0})):handleAndDispatchPointerDownOutsideEvent()}g.current=!1},c=window.setTimeout(()=>{u.addEventListener("pointerdown",handlePointerDown)},0);return()=>{window.clearTimeout(c),u.removeEventListener("pointerdown",handlePointerDown),u.removeEventListener("click",b.current)}},[u,f]),{onPointerDownCapture:()=>g.current=!0}}function index_module_$5cb92bef7577960e$var$useFocusOutside(c,u=null==globalThis?void 0:globalThis.document){let f=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c),g=(0,K.useRef)(!1);return(0,K.useEffect)(()=>{let handleFocus=c=>{c.target&&!g.current&&index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.focusOutside",f,{originalEvent:c},{discrete:!1})};return u.addEventListener("focusin",handleFocus),()=>u.removeEventListener("focusin",handleFocus)},[u,f]),{onFocusCapture:()=>g.current=!0,onBlurCapture:()=>g.current=!1}}function index_module_$5cb92bef7577960e$var$dispatchUpdate(){let c=new CustomEvent(ad);document.dispatchEvent(c)}function index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent(c,u,f,{discrete:g}){let b=f.originalEvent.target,v=new CustomEvent(c,{bubbles:!1,cancelable:!0,detail:f});u&&b.addEventListener(c,u,{once:!0}),g?index_module_$8927f6f2acc4f386$export$6d1a0317bde7de7f(b,v):b.dispatchEvent(v)}let af=0;function index_module_$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){(0,K.useEffect)(()=>{var c,u;let f=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(c=f[0])&&void 0!==c?c:index_module_$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",null!==(u=f[1])&&void 0!==u?u:index_module_$3db38b7d1fb3fe6a$var$createFocusGuard()),af++,()=>{1===af&&document.querySelectorAll("[data-radix-focus-guard]").forEach(c=>c.remove()),af--}},[])}function index_module_$3db38b7d1fb3fe6a$var$createFocusGuard(){let c=document.createElement("span");return c.setAttribute("data-radix-focus-guard",""),c.tabIndex=0,c.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",c}let ag="focusScope.autoFocusOnMount",am="focusScope.autoFocusOnUnmount",ay={bubbles:!1,cancelable:!0},ab=(0,K.forwardRef)((c,u)=>{let{loop:f=!1,trapped:g=!1,onMountAutoFocus:b,onUnmountAutoFocus:v,...x}=c,[w,_]=(0,K.useState)(null),k=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(b),E=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(v),T=(0,K.useRef)(null),$=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>_(c)),I=(0,K.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,K.useEffect)(()=>{if(g){function handleFocusIn(c){if(I.paused||!w)return;let u=c.target;w.contains(u)?T.current=u:index_module_$d3863c46a17e8a28$var$focus(T.current,{select:!0})}function handleFocusOut(c){I.paused||!w||w.contains(c.relatedTarget)||index_module_$d3863c46a17e8a28$var$focus(T.current,{select:!0})}return document.addEventListener("focusin",handleFocusIn),document.addEventListener("focusout",handleFocusOut),()=>{document.removeEventListener("focusin",handleFocusIn),document.removeEventListener("focusout",handleFocusOut)}}},[g,w,I.paused]),(0,K.useEffect)(()=>{if(w){av.add(I);let c=document.activeElement,u=w.contains(c);if(!u){let u=new CustomEvent(ag,ay);w.addEventListener(ag,k),w.dispatchEvent(u),u.defaultPrevented||(index_module_$d3863c46a17e8a28$var$focusFirst(index_module_$d3863c46a17e8a28$var$removeLinks(index_module_$d3863c46a17e8a28$var$getTabbableCandidates(w)),{select:!0}),document.activeElement===c&&index_module_$d3863c46a17e8a28$var$focus(w))}return()=>{w.removeEventListener(ag,k),setTimeout(()=>{let u=new CustomEvent(am,ay);w.addEventListener(am,E),w.dispatchEvent(u),u.defaultPrevented||index_module_$d3863c46a17e8a28$var$focus(null!=c?c:document.body,{select:!0}),w.removeEventListener(am,E),av.remove(I)},0)}}},[w,k,E,I]);let M=(0,K.useCallback)(c=>{if(!f&&!g||I.paused)return;let u="Tab"===c.key&&!c.altKey&&!c.ctrlKey&&!c.metaKey,b=document.activeElement;if(u&&b){let u=c.currentTarget,[g,v]=index_module_$d3863c46a17e8a28$var$getTabbableEdges(u),x=g&&v;x?c.shiftKey||b!==v?c.shiftKey&&b===g&&(c.preventDefault(),f&&index_module_$d3863c46a17e8a28$var$focus(v,{select:!0})):(c.preventDefault(),f&&index_module_$d3863c46a17e8a28$var$focus(g,{select:!0})):b===u&&c.preventDefault()}},[f,g,I.paused]);return(0,K.createElement)(au.div,_extends({tabIndex:-1},x,{ref:$,onKeyDown:M}))});function index_module_$d3863c46a17e8a28$var$focusFirst(c,{select:u=!1}={}){let f=document.activeElement;for(let g of c)if(index_module_$d3863c46a17e8a28$var$focus(g,{select:u}),document.activeElement!==f)return}function index_module_$d3863c46a17e8a28$var$getTabbableEdges(c){let u=index_module_$d3863c46a17e8a28$var$getTabbableCandidates(c),f=index_module_$d3863c46a17e8a28$var$findVisible(u,c),g=index_module_$d3863c46a17e8a28$var$findVisible(u.reverse(),c);return[f,g]}function index_module_$d3863c46a17e8a28$var$getTabbableCandidates(c){let u=[],f=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{let u="INPUT"===c.tagName&&"hidden"===c.type;return c.disabled||c.hidden||u?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;f.nextNode();)u.push(f.currentNode);return u}function index_module_$d3863c46a17e8a28$var$findVisible(c,u){for(let f of c)if(!index_module_$d3863c46a17e8a28$var$isHidden(f,{upTo:u}))return f}function index_module_$d3863c46a17e8a28$var$isHidden(c,{upTo:u}){if("hidden"===getComputedStyle(c).visibility)return!0;for(;c&&(void 0===u||c!==u);){if("none"===getComputedStyle(c).display)return!0;c=c.parentElement}return!1}function index_module_$d3863c46a17e8a28$var$isSelectableInput(c){return c instanceof HTMLInputElement&&"select"in c}function index_module_$d3863c46a17e8a28$var$focus(c,{select:u=!1}={}){if(c&&c.focus){let f=document.activeElement;c.focus({preventScroll:!0}),c!==f&&index_module_$d3863c46a17e8a28$var$isSelectableInput(c)&&u&&c.select()}}let av=index_module_$d3863c46a17e8a28$var$createFocusScopesStack();function index_module_$d3863c46a17e8a28$var$createFocusScopesStack(){let c=[];return{add(u){let f=c[0];u!==f&&(null==f||f.pause()),(c=index_module_$d3863c46a17e8a28$var$arrayRemove(c,u)).unshift(u)},remove(u){var f;null===(f=(c=index_module_$d3863c46a17e8a28$var$arrayRemove(c,u))[0])||void 0===f||f.resume()}}}function index_module_$d3863c46a17e8a28$var$arrayRemove(c,u){let f=[...c],g=f.indexOf(u);return -1!==g&&f.splice(g,1),f}function index_module_$d3863c46a17e8a28$var$removeLinks(c){return c.filter(c=>"A"!==c.tagName)}let aS=(null==globalThis?void 0:globalThis.document)?K.useLayoutEffect:()=>{},ax=Z["useId".toString()]||(()=>void 0),aw=0;function index_module_$1746a345f3d73bb7$export$f680877a34711e37(c){let[u,f]=K.useState(ax());return aS(()=>{c||f(c=>null!=c?c:String(aw++))},[c]),c||(u?`radix-${u}`:"")}function floating_ui_core_browser_min_t(c){return c.split("-")[0]}function e(c){return c.split("-")[1]}function n(c){return["top","bottom"].includes(floating_ui_core_browser_min_t(c))?"x":"y"}function r(c){return"y"===c?"height":"width"}function i(c,u,f){let g,{reference:b,floating:v}=c,x=b.x+b.width/2-v.width/2,w=b.y+b.height/2-v.height/2,_=n(u),k=r(_),E=b[k]/2-v[k]/2,T="x"===_;switch(floating_ui_core_browser_min_t(u)){case"top":g={x:x,y:b.y-v.height};break;case"bottom":g={x:x,y:b.y+b.height};break;case"right":g={x:b.x+b.width,y:w};break;case"left":g={x:b.x-v.width,y:w};break;default:g={x:b.x,y:b.y}}switch(e(u)){case"start":g[_]-=E*(f&&T?-1:1);break;case"end":g[_]+=E*(f&&T?-1:1)}return g}let floating_ui_core_browser_min_o=async(c,u,f)=>{let{placement:g="bottom",strategy:b="absolute",middleware:v=[],platform:x}=f,w=await (null==x.isRTL?void 0:x.isRTL(u)),_=await x.getElementRects({reference:c,floating:u,strategy:b}),{x:k,y:E}=i(_,g,w),T=g,$={},I=0;for(let f=0;f<v.length;f++){let{name:M,fn:j}=v[f],{x:D,y:L,data:F,reset:B}=await j({x:k,y:E,initialPlacement:g,placement:T,strategy:b,middlewareData:$,rects:_,platform:x,elements:{reference:c,floating:u}});k=null!=D?D:k,E=null!=L?L:E,$={...$,[M]:{...$[M],...F}},B&&I<=50&&(I++,"object"==typeof B&&(B.placement&&(T=B.placement),B.rects&&(_=!0===B.rects?await x.getElementRects({reference:c,floating:u,strategy:b}):B.rects),{x:k,y:E}=i(_,T,w)),f=-1)}return{x:k,y:E,placement:T,strategy:b,middlewareData:$}};function a(c){return"number"!=typeof c?{top:0,right:0,bottom:0,left:0,...c}:{top:c,right:c,bottom:c,left:c}}function l(c){return{...c,top:c.y,left:c.x,right:c.x+c.width,bottom:c.y+c.height}}async function s(c,u){var f;void 0===u&&(u={});let{x:g,y:b,platform:v,rects:x,elements:w,strategy:_}=c,{boundary:k="clippingAncestors",rootBoundary:E="viewport",elementContext:T="floating",altBoundary:$=!1,padding:I=0}=u,M=a(I),j=w[$?"floating"===T?"reference":"floating":T],D=l(await v.getClippingRect({element:null==(f=await (null==v.isElement?void 0:v.isElement(j)))||f?j:j.contextElement||await (null==v.getDocumentElement?void 0:v.getDocumentElement(w.floating)),boundary:k,rootBoundary:E,strategy:_})),L=l(v.convertOffsetParentRelativeRectToViewportRelativeRect?await v.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===T?{...x.floating,x:g,y:b}:x.reference,offsetParent:await (null==v.getOffsetParent?void 0:v.getOffsetParent(w.floating)),strategy:_}):x[T]);return{top:D.top-L.top+M.top,bottom:L.bottom-D.bottom+M.bottom,left:D.left-L.left+M.left,right:L.right-D.right+M.right}}let a_=Math.min,ak=Math.max,m=c=>({name:"arrow",options:c,async fn(u){let{element:f,padding:g=0}=null!=c?c:{},{x:b,y:v,placement:x,rects:w,platform:_}=u;if(null==f)return{};let k=a(g),E={x:b,y:v},T=n(x),$=e(x),I=r(T),M=await _.getDimensions(f),j="y"===T?"top":"left",D="y"===T?"bottom":"right",L=w.reference[I]+w.reference[T]-E[T]-w.floating[I],F=E[T]-w.reference[T],B=await (null==_.getOffsetParent?void 0:_.getOffsetParent(f)),G=B?"y"===T?B.clientHeight||0:B.clientWidth||0:0;0===G&&(G=w.floating[I]);let U=k[j],V=G-M[I]-k[D],K=G/2-M[I]/2+(L/2-F/2),Z=ak(U,a_(K,V)),Y=("start"===$?k[j]:k[D])>0&&K!==Z&&w.reference[I]<=w.floating[I];return{[T]:E[T]-(Y?K<U?U-K:V-K:0),data:{[T]:Z,centerOffset:K-Z}}}}),aC={left:"right",right:"left",bottom:"top",top:"bottom"};function d(c){return c.replace(/left|right|bottom|top/g,c=>aC[c])}function p(c,u,f){void 0===f&&(f=!1);let g=e(c),b=n(c),v=r(b),x="x"===b?g===(f?"end":"start")?"right":"left":"start"===g?"bottom":"top";return u.reference[v]>u.floating[v]&&(x=d(x)),{main:x,cross:d(x)}}let aE={start:"end",end:"start"};function y(c){return c.replace(/start|end/g,c=>aE[c])}let aP=["top","right","bottom","left"];function R(c,u){return{top:c.top-u.height,right:c.right-u.width,bottom:c.bottom-u.height,left:c.left-u.width}}function A(c){return aP.some(u=>c[u]>=0)}aP.reduce((c,u)=>c.concat(u,u+"-start",u+"-end"),[]);let P=function(c){let{strategy:u="referenceHidden",...f}=void 0===c?{}:c;return{name:"hide",async fn(c){let{rects:g}=c;switch(u){case"referenceHidden":{let u=R(await s(c,{...f,elementContext:"reference"}),g.reference);return{data:{referenceHiddenOffsets:u,referenceHidden:A(u)}}}case"escaped":{let u=R(await s(c,{...f,altBoundary:!0}),g.floating);return{data:{escapedOffsets:u,escaped:A(u)}}}default:return{}}}}};function O(c){return"x"===c?"y":"x"}function floating_ui_dom_browser_min_n(c){return c&&c.document&&c.location&&c.alert&&c.setInterval}function o(c){if(null==c)return window;if(!floating_ui_dom_browser_min_n(c)){let u=c.ownerDocument;return u&&u.defaultView||window}return c}function floating_ui_dom_browser_min_i(c){return o(c).getComputedStyle(c)}function floating_ui_dom_browser_min_r(c){return floating_ui_dom_browser_min_n(c)?"":c?(c.nodeName||"").toLowerCase():""}function floating_ui_dom_browser_min_l(){let c=navigator.userAgentData;return null!=c&&c.brands?c.brands.map(c=>c.brand+"/"+c.version).join(" "):navigator.userAgent}function floating_ui_dom_browser_min_c(c){return c instanceof o(c).HTMLElement}function floating_ui_dom_browser_min_f(c){return c instanceof o(c).Element}function floating_ui_dom_browser_min_s(c){return"undefined"!=typeof ShadowRoot&&(c instanceof o(c).ShadowRoot||c instanceof ShadowRoot)}function floating_ui_dom_browser_min_u(c){let{overflow:u,overflowX:f,overflowY:g}=floating_ui_dom_browser_min_i(c);return/auto|scroll|overlay|hidden/.test(u+g+f)}function floating_ui_dom_browser_min_d(c){return["table","td","th"].includes(floating_ui_dom_browser_min_r(c))}function floating_ui_dom_browser_min_h(c){let u=/firefox/i.test(floating_ui_dom_browser_min_l()),f=floating_ui_dom_browser_min_i(c);return"none"!==f.transform||"none"!==f.perspective||"paint"===f.contain||["transform","perspective"].includes(f.willChange)||u&&"filter"===f.willChange||u&&!!f.filter&&"none"!==f.filter}function floating_ui_dom_browser_min_a(){return!/^((?!chrome|android).)*safari/i.test(floating_ui_dom_browser_min_l())}let aT=Math.min,a$=Math.max,aI=Math.round;function floating_ui_dom_browser_min_w(c,u,f){var g,b,v,x;void 0===u&&(u=!1),void 0===f&&(f=!1);let w=c.getBoundingClientRect(),_=1,k=1;u&&floating_ui_dom_browser_min_c(c)&&(_=c.offsetWidth>0&&aI(w.width)/c.offsetWidth||1,k=c.offsetHeight>0&&aI(w.height)/c.offsetHeight||1);let E=floating_ui_dom_browser_min_f(c)?o(c):window,T=!floating_ui_dom_browser_min_a()&&f,$=(w.left+(T&&null!=(g=null==(b=E.visualViewport)?void 0:b.offsetLeft)?g:0))/_,I=(w.top+(T&&null!=(v=null==(x=E.visualViewport)?void 0:x.offsetTop)?v:0))/k,M=w.width/_,j=w.height/k;return{width:M,height:j,top:I,right:$+M,bottom:I+j,left:$,x:$,y:I}}function floating_ui_dom_browser_min_v(c){return((c instanceof o(c).Node?c.ownerDocument:c.document)||window.document).documentElement}function floating_ui_dom_browser_min_y(c){return floating_ui_dom_browser_min_f(c)?{scrollLeft:c.scrollLeft,scrollTop:c.scrollTop}:{scrollLeft:c.pageXOffset,scrollTop:c.pageYOffset}}function floating_ui_dom_browser_min_x(c){return floating_ui_dom_browser_min_w(floating_ui_dom_browser_min_v(c)).left+floating_ui_dom_browser_min_y(c).scrollLeft}function floating_ui_dom_browser_min_b(c,u,f){let g=floating_ui_dom_browser_min_c(u),b=floating_ui_dom_browser_min_v(u),v=floating_ui_dom_browser_min_w(c,g&&function(c){let u=floating_ui_dom_browser_min_w(c);return aI(u.width)!==c.offsetWidth||aI(u.height)!==c.offsetHeight}(u),"fixed"===f),x={scrollLeft:0,scrollTop:0},w={x:0,y:0};if(g||!g&&"fixed"!==f){if(("body"!==floating_ui_dom_browser_min_r(u)||floating_ui_dom_browser_min_u(b))&&(x=floating_ui_dom_browser_min_y(u)),floating_ui_dom_browser_min_c(u)){let c=floating_ui_dom_browser_min_w(u,!0);w.x=c.x+u.clientLeft,w.y=c.y+u.clientTop}else b&&(w.x=floating_ui_dom_browser_min_x(b))}return{x:v.left+x.scrollLeft-w.x,y:v.top+x.scrollTop-w.y,width:v.width,height:v.height}}function floating_ui_dom_browser_min_L(c){return"html"===floating_ui_dom_browser_min_r(c)?c:c.assignedSlot||c.parentNode||(floating_ui_dom_browser_min_s(c)?c.host:null)||floating_ui_dom_browser_min_v(c)}function floating_ui_dom_browser_min_R(c){return floating_ui_dom_browser_min_c(c)&&"fixed"!==getComputedStyle(c).position?c.offsetParent:null}function floating_ui_dom_browser_min_T(c){let u=o(c),f=floating_ui_dom_browser_min_R(c);for(;f&&floating_ui_dom_browser_min_d(f)&&"static"===getComputedStyle(f).position;)f=floating_ui_dom_browser_min_R(f);return f&&("html"===floating_ui_dom_browser_min_r(f)||"body"===floating_ui_dom_browser_min_r(f)&&"static"===getComputedStyle(f).position&&!floating_ui_dom_browser_min_h(f))?u:f||function(c){let u=floating_ui_dom_browser_min_L(c);for(floating_ui_dom_browser_min_s(u)&&(u=u.host);floating_ui_dom_browser_min_c(u)&&!["html","body"].includes(floating_ui_dom_browser_min_r(u));){if(floating_ui_dom_browser_min_h(u))return u;u=u.parentNode}return null}(c)||u}function W(c){if(floating_ui_dom_browser_min_c(c))return{width:c.offsetWidth,height:c.offsetHeight};let u=floating_ui_dom_browser_min_w(c);return{width:u.width,height:u.height}}function floating_ui_dom_browser_min_E(c){let u=floating_ui_dom_browser_min_L(c);return["html","body","#document"].includes(floating_ui_dom_browser_min_r(u))?c.ownerDocument.body:floating_ui_dom_browser_min_c(u)&&floating_ui_dom_browser_min_u(u)?u:floating_ui_dom_browser_min_E(u)}function H(c,u){var f;void 0===u&&(u=[]);let g=floating_ui_dom_browser_min_E(c),b=g===(null==(f=c.ownerDocument)?void 0:f.body),v=o(g),x=b?[v].concat(v.visualViewport||[],floating_ui_dom_browser_min_u(g)?g:[]):g,w=u.concat(x);return b?w:w.concat(H(x))}function C(c,u,f){return"viewport"===u?l(function(c,u){let f=o(c),g=floating_ui_dom_browser_min_v(c),b=f.visualViewport,v=g.clientWidth,x=g.clientHeight,w=0,_=0;if(b){v=b.width,x=b.height;let c=floating_ui_dom_browser_min_a();(c||!c&&"fixed"===u)&&(w=b.offsetLeft,_=b.offsetTop)}return{width:v,height:x,x:w,y:_}}(c,f)):floating_ui_dom_browser_min_f(u)?function(c,u){let f=floating_ui_dom_browser_min_w(c,!1,"fixed"===u),g=f.top+c.clientTop,b=f.left+c.clientLeft;return{top:g,left:b,x:b,y:g,right:b+c.clientWidth,bottom:g+c.clientHeight,width:c.clientWidth,height:c.clientHeight}}(u,f):l(function(c){var u;let f=floating_ui_dom_browser_min_v(c),g=floating_ui_dom_browser_min_y(c),b=null==(u=c.ownerDocument)?void 0:u.body,v=a$(f.scrollWidth,f.clientWidth,b?b.scrollWidth:0,b?b.clientWidth:0),x=a$(f.scrollHeight,f.clientHeight,b?b.scrollHeight:0,b?b.clientHeight:0),w=-g.scrollLeft+floating_ui_dom_browser_min_x(c),_=-g.scrollTop;return"rtl"===floating_ui_dom_browser_min_i(b||f).direction&&(w+=a$(f.clientWidth,b?b.clientWidth:0)-v),{width:v,height:x,x:w,y:_}}(floating_ui_dom_browser_min_v(c)))}function S(c){let u=H(c),f=["absolute","fixed"].includes(floating_ui_dom_browser_min_i(c).position)&&floating_ui_dom_browser_min_c(c)?floating_ui_dom_browser_min_T(c):c;return floating_ui_dom_browser_min_f(f)?u.filter(c=>floating_ui_dom_browser_min_f(c)&&function(c,u){let f=null==u.getRootNode?void 0:u.getRootNode();if(c.contains(u))return!0;if(f&&floating_ui_dom_browser_min_s(f)){let f=u;do{if(f&&c===f)return!0;f=f.parentNode||f.host}while(f)}return!1}(c,f)&&"body"!==floating_ui_dom_browser_min_r(c)):[]}let aA={getClippingRect:function(c){let{element:u,boundary:f,rootBoundary:g,strategy:b}=c,v=[..."clippingAncestors"===f?S(u):[].concat(f),g],x=v[0],w=v.reduce((c,f)=>{let g=C(u,f,b);return c.top=a$(g.top,c.top),c.right=aT(g.right,c.right),c.bottom=aT(g.bottom,c.bottom),c.left=a$(g.left,c.left),c},C(u,x,b));return{width:w.right-w.left,height:w.bottom-w.top,x:w.left,y:w.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(c){let{rect:u,offsetParent:f,strategy:g}=c,b=floating_ui_dom_browser_min_c(f),v=floating_ui_dom_browser_min_v(f);if(f===v)return u;let x={scrollLeft:0,scrollTop:0},w={x:0,y:0};if((b||!b&&"fixed"!==g)&&(("body"!==floating_ui_dom_browser_min_r(f)||floating_ui_dom_browser_min_u(v))&&(x=floating_ui_dom_browser_min_y(f)),floating_ui_dom_browser_min_c(f))){let c=floating_ui_dom_browser_min_w(f,!0);w.x=c.x+f.clientLeft,w.y=c.y+f.clientTop}return{...u,x:u.x-x.scrollLeft+w.x,y:u.y-x.scrollTop+w.y}},isElement:floating_ui_dom_browser_min_f,getDimensions:W,getOffsetParent:floating_ui_dom_browser_min_T,getDocumentElement:floating_ui_dom_browser_min_v,getElementRects:c=>{let{reference:u,floating:f,strategy:g}=c;return{reference:floating_ui_dom_browser_min_b(u,floating_ui_dom_browser_min_T(f),g),floating:{...W(f),x:0,y:0}}},getClientRects:c=>Array.from(c.getClientRects()),isRTL:c=>"rtl"===floating_ui_dom_browser_min_i(c).direction};function N(c,u,f,g){void 0===g&&(g={});let{ancestorScroll:b=!0,ancestorResize:v=!0,elementResize:x=!0,animationFrame:w=!1}=g,_=b&&!w,k=v&&!w,E=_||k?[...floating_ui_dom_browser_min_f(c)?H(c):[],...H(u)]:[];E.forEach(c=>{_&&c.addEventListener("scroll",f,{passive:!0}),k&&c.addEventListener("resize",f)});let T,$=null;if(x){let g=!0;$=new ResizeObserver(()=>{g||f(),g=!1}),floating_ui_dom_browser_min_f(c)&&!w&&$.observe(c),$.observe(u)}let I=w?floating_ui_dom_browser_min_w(c):null;return w&&function e(){let u=floating_ui_dom_browser_min_w(c);I&&(u.x!==I.x||u.y!==I.y||u.width!==I.width||u.height!==I.height)&&f(),I=u,T=requestAnimationFrame(e)}(),f(),()=>{var c;E.forEach(c=>{_&&c.removeEventListener("scroll",f),k&&c.removeEventListener("resize",f)}),null==(c=$)||c.disconnect(),$=null,w&&cancelAnimationFrame(T)}}let z=(c,u,f)=>floating_ui_core_browser_min_o(c,u,{platform:aA,...f});var aM="undefined"!=typeof document?K.useLayoutEffect:K.useEffect;function floating_ui_react_dom_esm_deepEqual(c,u){let f,g,b;if(c===u)return!0;if(typeof c!=typeof u)return!1;if("function"==typeof c&&c.toString()===u.toString())return!0;if(c&&u&&"object"==typeof c){if(Array.isArray(c)){if((f=c.length)!=u.length)return!1;for(g=f;0!=g--;)if(!floating_ui_react_dom_esm_deepEqual(c[g],u[g]))return!1;return!0}if((f=(b=Object.keys(c)).length)!==Object.keys(u).length)return!1;for(g=f;0!=g--;)if(!Object.prototype.hasOwnProperty.call(u,b[g]))return!1;for(g=f;0!=g--;){let f=b[g];if(("_owner"!==f||!c.$$typeof)&&!floating_ui_react_dom_esm_deepEqual(c[f],u[f]))return!1}return!0}return c!=c&&u!=u}function floating_ui_react_dom_esm_useLatestRef(c){let u=K.useRef(c);return aM(()=>{u.current=c}),u}function floating_ui_react_dom_esm_useFloating(c){let{middleware:u,placement:f="bottom",strategy:g="absolute",whileElementsMounted:b}=void 0===c?{}:c,v=K.useRef(null),x=K.useRef(null),w=floating_ui_react_dom_esm_useLatestRef(b),_=K.useRef(null),[k,E]=K.useState({x:null,y:null,strategy:g,placement:f,middlewareData:{}}),[T,$]=K.useState(u);floating_ui_react_dom_esm_deepEqual(null==T?void 0:T.map(c=>{let{options:u}=c;return u}),null==u?void 0:u.map(c=>{let{options:u}=c;return u}))||$(u);let I=K.useCallback(()=>{v.current&&x.current&&z(v.current,x.current,{middleware:T,placement:f,strategy:g}).then(c=>{M.current&&Q.flushSync(()=>{E(c)})})},[T,f,g]);aM(()=>{M.current&&I()},[I]);let M=K.useRef(!1);aM(()=>(M.current=!0,()=>{M.current=!1}),[]);let j=K.useCallback(()=>{if("function"==typeof _.current&&(_.current(),_.current=null),v.current&&x.current){if(w.current){let c=w.current(v.current,x.current,I);_.current=c}else I()}},[I,w]),D=K.useCallback(c=>{v.current=c,j()},[j]),L=K.useCallback(c=>{x.current=c,j()},[j]),F=K.useMemo(()=>({reference:v,floating:x}),[]);return K.useMemo(()=>({...k,update:I,refs:F,reference:D,floating:L}),[k,I,F,D,L])}let floating_ui_react_dom_esm_arrow=c=>{let{element:u,padding:f}=c;function isRef(c){return Object.prototype.hasOwnProperty.call(c,"current")}return{name:"arrow",options:c,fn(c){if(isRef(u)){if(null!=u.current)return m({element:u.current,padding:f}).fn(c)}else if(u)return m({element:u,padding:f}).fn(c);return{}}}},aj=(0,K.forwardRef)((c,u)=>{let{children:f,width:g=10,height:b=5,...v}=c;return(0,K.createElement)(au.svg,_extends({},v,{ref:u,width:g,height:b,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),c.asChild?f:(0,K.createElement)("polygon",{points:"0,0 30,0 15,10"}))});function index_module_$db6c3485150b8e66$export$1ab7ae714698c4b8(c){let[u,f]=(0,K.useState)(void 0);return aS(()=>{if(c){f({width:c.offsetWidth,height:c.offsetHeight});let u=new ResizeObserver(u=>{let g,b;if(!Array.isArray(u)||!u.length)return;let v=u[0];if("borderBoxSize"in v){let c=v.borderBoxSize,u=Array.isArray(c)?c[0]:c;g=u.inlineSize,b=u.blockSize}else g=c.offsetWidth,b=c.offsetHeight;f({width:g,height:b})});return u.observe(c,{box:"border-box"}),()=>u.unobserve(c)}f(void 0)},[c]),u}let aO="Popper",[aR,aD]=index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(aO),[aL,aN]=aR(aO),aF=(0,K.forwardRef)((c,u)=>{let{__scopePopper:f,virtualRef:g,...b}=c,v=aN("PopperAnchor",f),x=(0,K.useRef)(null),w=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,x);return(0,K.useEffect)(()=>{v.onAnchorChange((null==g?void 0:g.current)||x.current)}),g?null:(0,K.createElement)(au.div,_extends({},b,{ref:w}))}),aB="PopperContent",[az,aG]=aR(aB),[aU,aH]=aR(aB,{hasParent:!1,positionUpdateFns:new Set}),aV=(0,K.forwardRef)((c,u)=>{var f,g,b,v,x,w,_,k,E,T,$,I,M;let{__scopePopper:j,side:D="bottom",sideOffset:L=0,align:F="center",alignOffset:B=0,arrowPadding:G=0,collisionBoundary:U=[],collisionPadding:V=0,sticky:Z="partial",hideWhenDetached:Y=!1,avoidCollisions:X=!0,onPlaced:J,...Q}=c,ee=aN(aB,j),[et,en]=(0,K.useState)(null),er=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>en(c)),[ei,eo]=(0,K.useState)(null),ea=index_module_$db6c3485150b8e66$export$1ab7ae714698c4b8(ei),es=null!==(f=null==ea?void 0:ea.width)&&void 0!==f?f:0,el=null!==(g=null==ea?void 0:ea.height)&&void 0!==g?g:0,ec="number"==typeof V?V:{top:0,right:0,bottom:0,left:0,...V},eu=Array.isArray(U)?U:[U],ed=eu.length>0,eh={padding:ec,boundary:eu.filter(index_module_$cf1ac5d9fe0e8206$var$isNotNull),altBoundary:ed},{reference:ep,floating:ef,strategy:eg,x:em,y:ey,placement:eb,middlewareData:ev,update:eS}=floating_ui_react_dom_esm_useFloating({strategy:"fixed",placement:D+("center"!==F?"-"+F:""),whileElementsMounted:N,middleware:[{name:"offset",options:E={mainAxis:L+el,alignmentAxis:B},async fn(c){let{x:u,y:f}=c,g=await async function(c,u){let{placement:f,platform:g,elements:b}=c,v=await (null==g.isRTL?void 0:g.isRTL(b.floating)),x=floating_ui_core_browser_min_t(f),w=e(f),_="x"===n(f),k=["left","top"].includes(x)?-1:1,E=v&&_?-1:1,T="function"==typeof u?u(c):u,{mainAxis:$,crossAxis:I,alignmentAxis:M}="number"==typeof T?{mainAxis:T,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...T};return w&&"number"==typeof M&&(I="end"===w?-1*M:M),_?{x:I*E,y:$*k}:{x:$*k,y:I*E}}(c,E);return{x:u+g.x,y:f+g.y,data:g}}},X?{name:"shift",options:$={mainAxis:!0,crossAxis:!1,limiter:"partial"===Z?(void 0===T&&(T={}),{options:T,fn(c){let{x:u,y:f,placement:g,rects:b,middlewareData:v}=c,{offset:x=0,mainAxis:w=!0,crossAxis:_=!0}=T,k={x:u,y:f},E=n(g),$=O(E),I=k[E],M=k[$],j="function"==typeof x?x({...b,placement:g}):x,D="number"==typeof j?{mainAxis:j,crossAxis:0}:{mainAxis:0,crossAxis:0,...j};if(w){let c="y"===E?"height":"width",u=b.reference[E]-b.floating[c]+D.mainAxis,f=b.reference[E]+b.reference[c]-D.mainAxis;I<u?I=u:I>f&&(I=f)}if(_){var L,F,B,G;let c="y"===E?"width":"height",u=["top","left"].includes(floating_ui_core_browser_min_t(g)),f=b.reference[$]-b.floating[c]+(u&&null!=(L=null==(F=v.offset)?void 0:F[$])?L:0)+(u?0:D.crossAxis),x=b.reference[$]+b.reference[c]+(u?0:null!=(B=null==(G=v.offset)?void 0:G[$])?B:0)-(u?D.crossAxis:0);M<f?M=f:M>x&&(M=x)}return{[E]:I,[$]:M}}}):void 0,...eh},async fn(c){let{x:u,y:f,placement:g}=c,{mainAxis:b=!0,crossAxis:v=!1,limiter:x={fn:c=>{let{x:u,y:f}=c;return{x:u,y:f}}},...w}=$,_={x:u,y:f},k=await s(c,w),E=n(floating_ui_core_browser_min_t(g)),T=O(E),I=_[E],M=_[T];if(b){let c="y"===E?"bottom":"right";I=ak(I+k["y"===E?"top":"left"],a_(I,I-k[c]))}v&&(M=ak(M+k["y"===T?"top":"left"],a_(M,M-k["y"===T?"bottom":"right"])));let j=x.fn({...c,[E]:I,[T]:M});return{...j,data:{x:j.x-u,y:j.y-f}}}}:void 0,X?{name:"flip",options:I={...eh},async fn(c){var u,f,g,b;let{placement:v,middlewareData:x,rects:w,initialPlacement:_,platform:k,elements:E}=c,{mainAxis:T=!0,crossAxis:$=!0,fallbackPlacements:M,fallbackStrategy:j="bestFit",flipAlignment:D=!0,...L}=I,F=floating_ui_core_browser_min_t(v),B=M||(F!==_&&D?function(c){let u=d(c);return[y(c),u,y(u)]}(_):[d(_)]),G=[_,...B],U=await s(c,L),V=[],K=(null==(u=x.flip)?void 0:u.overflows)||[];if(T&&V.push(U[F]),$){let{main:c,cross:u}=p(v,w,await (null==k.isRTL?void 0:k.isRTL(E.floating)));V.push(U[c],U[u])}if(K=[...K,{placement:v,overflows:V}],!V.every(c=>c<=0)){let c=(null!=(f=null==(g=x.flip)?void 0:g.index)?f:0)+1,u=G[c];if(u)return{data:{index:c,overflows:K},reset:{placement:u}};let w="bottom";switch(j){case"bestFit":{let c=null==(b=K.map(c=>[c,c.overflows.filter(c=>c>0).reduce((c,u)=>c+u,0)]).sort((c,u)=>c[1]-u[1])[0])?void 0:b[0].placement;c&&(w=c);break}case"initialPlacement":w=_}if(v!==w)return{reset:{placement:w}}}return{}}}:void 0,{name:"size",options:M={...eh,apply:({elements:c,rects:u,availableWidth:f,availableHeight:g})=>{let{width:b,height:v}=u.reference,x=c.floating.style;x.setProperty("--radix-popper-available-width",`${f}px`),x.setProperty("--radix-popper-available-height",`${g}px`),x.setProperty("--radix-popper-anchor-width",`${b}px`),x.setProperty("--radix-popper-anchor-height",`${v}px`)}},async fn(c){let u,f;let{placement:g,rects:b,platform:v,elements:x}=c,{apply:w,..._}=M,k=await s(c,_),E=floating_ui_core_browser_min_t(g),T=e(g);"top"===E||"bottom"===E?(u=E,f=T===(await (null==v.isRTL?void 0:v.isRTL(x.floating))?"start":"end")?"left":"right"):(f=E,u="end"===T?"top":"bottom");let $=ak(k.left,0),I=ak(k.right,0),j=ak(k.top,0),D=ak(k.bottom,0),L={availableHeight:b.floating.height-(["left","right"].includes(g)?2*(0!==j||0!==D?j+D:ak(k.top,k.bottom)):k[u]),availableWidth:b.floating.width-(["top","bottom"].includes(g)?2*(0!==$||0!==I?$+I:ak(k.left,k.right)):k[f])},F=await v.getDimensions(x.floating);null==w||w({...c,...L});let B=await v.getDimensions(x.floating);return F.width!==B.width||F.height!==B.height?{reset:{rects:!0}}:{}}},ei?floating_ui_react_dom_esm_arrow({element:ei,padding:G}):void 0,index_module_$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:es,arrowHeight:el}),Y?P({strategy:"referenceHidden"}):void 0].filter($cf1ac5d9fe0e8206$var$isDefined)});aS(()=>{ep(ee.anchor)},[ep,ee.anchor]);let ex=null!==em&&null!==ey,[ew,e_]=index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(eb),ek=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(J);aS(()=>{ex&&(null==ek||ek())},[ex,ek]);let eC=null===(b=ev.arrow)||void 0===b?void 0:b.x,eE=null===(v=ev.arrow)||void 0===v?void 0:v.y,eP=(null===(x=ev.arrow)||void 0===x?void 0:x.centerOffset)!==0,[eT,e$]=(0,K.useState)();aS(()=>{et&&e$(window.getComputedStyle(et).zIndex)},[et]);let{hasParent:eI,positionUpdateFns:eA}=aH(aB,j),eM=!eI;(0,K.useLayoutEffect)(()=>{if(!eM)return eA.add(eS),()=>{eA.delete(eS)}},[eM,eA,eS]),aS(()=>{eM&&ex&&Array.from(eA).reverse().forEach(c=>requestAnimationFrame(c))},[eM,ex,eA]);let ej={"data-side":ew,"data-align":e_,...Q,ref:er,style:{...Q.style,animation:ex?void 0:"none",opacity:null!==(w=ev.hide)&&void 0!==w&&w.referenceHidden?0:void 0}};return(0,K.createElement)("div",{ref:ef,"data-radix-popper-content-wrapper":"",style:{position:eg,left:0,top:0,transform:ex?`translate3d(${Math.round(em)}px, ${Math.round(ey)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:eT,"--radix-popper-transform-origin":[null===(_=ev.transformOrigin)||void 0===_?void 0:_.x,null===(k=ev.transformOrigin)||void 0===k?void 0:k.y].join(" ")},dir:c.dir},(0,K.createElement)(az,{scope:j,placedSide:ew,onArrowChange:eo,arrowX:eC,arrowY:eE,shouldHideArrow:eP},eM?(0,K.createElement)(aU,{scope:j,hasParent:!0,positionUpdateFns:eA},(0,K.createElement)(au.div,ej)):(0,K.createElement)(au.div,ej)))}),aW={top:"bottom",right:"left",bottom:"top",left:"right"};function $cf1ac5d9fe0e8206$var$isDefined(c){return void 0!==c}function index_module_$cf1ac5d9fe0e8206$var$isNotNull(c){return null!==c}let index_module_$cf1ac5d9fe0e8206$var$transformOrigin=c=>({name:"transformOrigin",options:c,fn(u){var f,g,b,v,x;let{placement:w,rects:_,middlewareData:k}=u,E=(null===(f=k.arrow)||void 0===f?void 0:f.centerOffset)!==0,T=E?0:c.arrowWidth,$=E?0:c.arrowHeight,[I,M]=index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(w),j={start:"0%",center:"50%",end:"100%"}[M],D=(null!==(g=null===(b=k.arrow)||void 0===b?void 0:b.x)&&void 0!==g?g:0)+T/2,L=(null!==(v=null===(x=k.arrow)||void 0===x?void 0:x.y)&&void 0!==v?v:0)+$/2,F="",B="";return"bottom"===I?(F=E?j:`${D}px`,B=`${-$}px`):"top"===I?(F=E?j:`${D}px`,B=`${_.floating.height+$}px`):"right"===I?(F=`${-$}px`,B=E?j:`${L}px`):"left"===I&&(F=`${_.floating.width+$}px`,B=E?j:`${L}px`),{data:{x:F,y:B}}}});function index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(c){let[u,f="center"]=c.split("-");return[u,f]}let index_module_$cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=c=>{let{__scopePopper:u,children:f}=c,[g,b]=(0,K.useState)(null);return(0,K.createElement)(aL,{scope:u,anchor:g,onAnchorChange:b},f)},aK=(0,K.forwardRef)((c,u)=>{var f;let{container:g=null==globalThis?void 0:null===(f=globalThis.document)||void 0===f?void 0:f.body,...b}=c;return g?Q.createPortal((0,K.createElement)(au.div,_extends({},b,{ref:u})),g):null});function index_module_$fe963b355347cc68$export$3e6543de14f8614f(c,u){return(0,K.useReducer)((c,f)=>{let g=u[c][f];return null!=g?g:c},c)}let index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b=c=>{let{present:u,children:f}=c,g=index_module_$921a889cee6df7e8$var$usePresence(u),b="function"==typeof f?f({present:g.isPresent}):K.Children.only(f),v=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g.ref,b.ref),x="function"==typeof f;return x||g.isPresent?(0,K.cloneElement)(b,{ref:v}):null};function index_module_$921a889cee6df7e8$var$usePresence(c){let[u,f]=(0,K.useState)(),g=(0,K.useRef)({}),b=(0,K.useRef)(c),v=(0,K.useRef)("none"),x=c?"mounted":"unmounted",[w,_]=index_module_$fe963b355347cc68$export$3e6543de14f8614f(x,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,K.useEffect)(()=>{let c=index_module_$921a889cee6df7e8$var$getAnimationName(g.current);v.current="mounted"===w?c:"none"},[w]),aS(()=>{let u=g.current,f=b.current,x=f!==c;if(x){let g=v.current,x=index_module_$921a889cee6df7e8$var$getAnimationName(u);c?_("MOUNT"):"none"===x||(null==u?void 0:u.display)==="none"?_("UNMOUNT"):f&&g!==x?_("ANIMATION_OUT"):_("UNMOUNT"),b.current=c}},[c,_]),aS(()=>{if(u){let handleAnimationEnd=c=>{let f=index_module_$921a889cee6df7e8$var$getAnimationName(g.current),b=f.includes(c.animationName);c.target===u&&b&&(0,Q.flushSync)(()=>_("ANIMATION_END"))},handleAnimationStart=c=>{c.target===u&&(v.current=index_module_$921a889cee6df7e8$var$getAnimationName(g.current))};return u.addEventListener("animationstart",handleAnimationStart),u.addEventListener("animationcancel",handleAnimationEnd),u.addEventListener("animationend",handleAnimationEnd),()=>{u.removeEventListener("animationstart",handleAnimationStart),u.removeEventListener("animationcancel",handleAnimationEnd),u.removeEventListener("animationend",handleAnimationEnd)}}_("ANIMATION_END")},[u,_]),{isPresent:["mounted","unmountSuspended"].includes(w),ref:(0,K.useCallback)(c=>{c&&(g.current=getComputedStyle(c)),f(c)},[])}}function index_module_$921a889cee6df7e8$var$getAnimationName(c){return(null==c?void 0:c.animationName)||"none"}function index_module_$71cd76cc60e0454e$export$6f32135080cb4c3({prop:c,defaultProp:u,onChange:f=()=>{}}){let[g,b]=index_module_$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:u,onChange:f}),v=void 0!==c,x=v?c:g,w=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(f),_=(0,K.useCallback)(u=>{if(v){let f="function"==typeof u?u(c):u;f!==c&&w(f)}else b(u)},[v,c,b,w]);return[x,_]}function index_module_$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:c,onChange:u}){let f=(0,K.useState)(c),[g]=f,b=(0,K.useRef)(g),v=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(u);return(0,K.useEffect)(()=>{b.current!==g&&(v(g),b.current=g)},[g,b,v]),f}index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";let aZ="Popover",[aY,aq]=index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(aZ,[aD]),aX=aD(),[aJ,aQ]=aY(aZ),a0=(0,K.forwardRef)((c,u)=>{let{__scopePopover:f,...g}=c,b=aQ("PopoverTrigger",f),v=aX(f),x=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,b.triggerRef),w=(0,K.createElement)(au.button,_extends({type:"button","aria-haspopup":"dialog","aria-expanded":b.open,"aria-controls":b.contentId,"data-state":$cb5cc270b50c6fcd$var$getState(b.open)},g,{ref:x,onClick:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onClick,b.onOpenToggle)}));return b.hasCustomAnchor?w:(0,K.createElement)(aF,_extends({asChild:!0},v),w)}),a1="PopoverPortal",[a2,a5]=aY(a1,{forceMount:void 0}),a3="PopoverContent",a8=(0,K.forwardRef)((c,u)=>{let f=a5(a3,c.__scopePopover),{forceMount:g=f.forceMount,...b}=c,v=aQ(a3,c.__scopePopover);return(0,K.createElement)(index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:g||v.open},v.modal?(0,K.createElement)(a4,_extends({},b,{ref:u})):(0,K.createElement)(a6,_extends({},b,{ref:u})))}),a4=(0,K.forwardRef)((c,u)=>{let f=aQ(a3,c.__scopePopover),g=(0,K.useRef)(null),b=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,g),v=(0,K.useRef)(!1);return(0,K.useEffect)(()=>{let c=g.current;if(c)return hideOthers(c)},[]),(0,K.createElement)(e$,{as:al,allowPinchZoom:!0},(0,K.createElement)(a7,_extends({},c,{ref:b,trapFocus:f.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onCloseAutoFocus,c=>{var u;c.preventDefault(),v.current||null===(u=f.triggerRef.current)||void 0===u||u.focus()}),onPointerDownOutside:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDownOutside,c=>{let u=c.detail.originalEvent,f=0===u.button&&!0===u.ctrlKey,g=2===u.button||f;v.current=g},{checkForDefaultPrevented:!1}),onFocusOutside:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})))}),a6=(0,K.forwardRef)((c,u)=>{let f=aQ(a3,c.__scopePopover),g=(0,K.useRef)(!1),b=(0,K.useRef)(!1);return(0,K.createElement)(a7,_extends({},c,{ref:u,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:u=>{var v,x;null===(v=c.onCloseAutoFocus)||void 0===v||v.call(c,u),u.defaultPrevented||(g.current||null===(x=f.triggerRef.current)||void 0===x||x.focus(),u.preventDefault()),g.current=!1,b.current=!1},onInteractOutside:u=>{var v,x;null===(v=c.onInteractOutside)||void 0===v||v.call(c,u),u.defaultPrevented||(g.current=!0,"pointerdown"!==u.detail.originalEvent.type||(b.current=!0));let w=u.target,_=null===(x=f.triggerRef.current)||void 0===x?void 0:x.contains(w);_&&u.preventDefault(),"focusin"===u.detail.originalEvent.type&&b.current&&u.preventDefault()}}))}),a7=(0,K.forwardRef)((c,u)=>{let{__scopePopover:f,trapFocus:g,onOpenAutoFocus:b,onCloseAutoFocus:v,disableOutsidePointerEvents:x,onEscapeKeyDown:w,onPointerDownOutside:_,onFocusOutside:k,onInteractOutside:E,...T}=c,$=aQ(a3,f),I=aX(f);return index_module_$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),(0,K.createElement)(ab,{asChild:!0,loop:!0,trapped:g,onMountAutoFocus:b,onUnmountAutoFocus:v},(0,K.createElement)(ap,{asChild:!0,disableOutsidePointerEvents:x,onInteractOutside:E,onEscapeKeyDown:w,onPointerDownOutside:_,onFocusOutside:k,onDismiss:()=>$.onOpenChange(!1)},(0,K.createElement)(aV,_extends({"data-state":$cb5cc270b50c6fcd$var$getState($.open),role:"dialog",id:$.contentId},I,T,{ref:u,style:{...T.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function $cb5cc270b50c6fcd$var$getState(c){return c?"open":"closed"}let $cb5cc270b50c6fcd$export$be92b6f5f03c0fe9=c=>{let{__scopePopover:u,children:f,open:g,defaultOpen:b,onOpenChange:v,modal:x=!1}=c,w=aX(u),_=(0,K.useRef)(null),[k,E]=(0,K.useState)(!1),[T=!1,$]=index_module_$71cd76cc60e0454e$export$6f32135080cb4c3({prop:g,defaultProp:b,onChange:v});return(0,K.createElement)(index_module_$cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,w,(0,K.createElement)(aJ,{scope:u,contentId:index_module_$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:_,open:T,onOpenChange:$,onOpenToggle:(0,K.useCallback)(()=>$(c=>!c),[$]),hasCustomAnchor:k,onCustomAnchorAdd:(0,K.useCallback)(()=>E(!0),[]),onCustomAnchorRemove:(0,K.useCallback)(()=>E(!1),[]),modal:x},f))},$cb5cc270b50c6fcd$export$602eac185826482c=c=>{let{__scopePopover:u,forceMount:f,children:g,container:b}=c,v=aQ(a1,u);return(0,K.createElement)(a2,{scope:u,forceMount:f},(0,K.createElement)(index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:f||v.open},(0,K.createElement)(aK,{asChild:!0,container:b},g)))},Popover=({id:c,children:u,onOpenChange:f})=>{let[g,b]=useMenuIsOpen(c,f);return(0,V.jsx)($cb5cc270b50c6fcd$export$be92b6f5f03c0fe9,{onOpenChange:b,open:g,children:(0,V.jsx)("div",{className:"tlui-popover",children:u})})},PopoverTrigger=({children:c,disabled:u,"data-testid":f})=>(0,V.jsx)(a0,{"data-testid":f,disabled:u,asChild:!0,dir:"ltr",children:c}),PopoverContent=({side:c,children:u,align:f="center",sideOffset:g=8,alignOffset:b=0})=>{let v=useContainer();return(0,V.jsx)($cb5cc270b50c6fcd$export$602eac185826482c,{dir:"ltr",container:v,children:(0,V.jsx)(a8,{className:"tlui-popover__content",side:c,sideOffset:g,align:f,alignOffset:b,dir:"ltr",children:u})})},a9=(0,K.memo)(function(){let c=useTranslation(),u=useContainer(),f=useActionsMenuSchema(),g=useReadonly();function getActionMenuItem(u){if(g&&!u.readonlyOk)return null;if("item"===u.type){let{id:f,icon:g,label:b,kbd:v,onSelect:x}=u.actionItem;return(0,V.jsx)(nq,{className:"tlui-button-grid__button","data-testid":`menu-item.${u.id}`,icon:g,title:b?v?`${c(b)} ${kbdStr(v)}`:`${c(b)}`:v?`${kbdStr(v)}`:"",onClick:()=>x("actions-menu"),disabled:u.disabled},f)}}return(0,V.jsxs)(Popover,{id:"actions menu",children:[(0,V.jsx)(PopoverTrigger,{children:(0,V.jsx)(nq,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:c("actions-menu.title"),smallIcon:!0})}),(0,V.jsx)($cb5cc270b50c6fcd$export$602eac185826482c,{dir:"ltr",container:u,children:(0,V.jsx)(a8,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,V.jsx)("div",{className:"tlui-actions-menu tlui-button-grid__four",children:f.map(getActionMenuItem)})})})]})}),se=(0,e5.j)(function(){let c=(0,tt.j)(),u=useActions(),f=useTranslation(),g=u.duplicate;return(0,V.jsx)(nq,{icon:g.icon,onClick:()=>g.onSelect("quick-actions"),disabled:!(c.isIn("select")&&c.selectedShapeIds.length>0),title:`${f(g.label)} ${kbdStr(g.kbd)}`,smallIcon:!0})}),st=K.memo(function(){let c=useTranslation();return(0,V.jsxs)(Root,{id:"main menu",children:[(0,V.jsx)(Trigger,{children:(0,V.jsx)(nq,{className:"tlui-menu__trigger","data-testid":"main.menu",title:c("menu.title"),icon:"menu"})}),(0,V.jsx)(Content,{alignOffset:0,sideOffset:6,children:(0,V.jsx)(MenuContent,{})})]})});function MenuContent(){let c=(0,tt.j)(),u=useTranslation(),f=useMenuSchema(),g=useBreakpoint(),b=useReadonly();function getMenuItem(c,f,v,x){switch(f.type){case"custom":if(b&&!f.readonlyOk)return null;if("LANGUAGE_MENU"===f.id)return(0,V.jsx)(LanguageMenu,{},"item");return null;case"group":if(b&&!f.readonlyOk)return null;return(0,V.jsx)(Group,{size:x<=1?"medium":g<3||v?.type==="submenu"&&x>2?"tiny":"medium",children:f.children.map(u=>getMenuItem(c,u,f,x+1))},f.id);case"submenu":if(b&&!f.readonlyOk)return null;return(0,V.jsxs)(Sub,{id:`main menu ${v?v.id+" ":""}${f.id}`,children:[(0,V.jsx)(SubTrigger,{label:f.label,"data-testid":`menu-item.${f.id}`}),(0,V.jsx)(SubContent,{sideOffset:-4,alignOffset:-1,children:f.children.map(u=>getMenuItem(c,u,f,x+1))})]},f.id);case"item":{if(b&&!f.readonlyOk)return null;let{id:c,checkbox:g,menuLabel:v,label:x,onSelect:w,kbd:_}=f.actionItem,k=v??x,E=k?u(k):void 0;if(g)return(0,V.jsxs)(CheckboxItem,{onSelect:()=>w("menu"),title:E||"",checked:f.checked,disabled:f.disabled,children:[E&&(0,V.jsx)("span",{children:E}),_&&(0,V.jsx)(Kbd,{children:_})]},c);return(0,V.jsx)(Item,{"data-testid":`menu-item.${f.id}`,kbd:_,label:k,onClick:()=>w("menu"),disabled:f.disabled},c)}}}return(0,V.jsx)(V.Fragment,{children:f.map(u=>getMenuItem(c,u,null,0))})}let PageItemInput=function({name:c,id:u,isCurrentPage:f}){let g=(0,tt.j)(),b=(0,K.useRef)(null),v=(0,K.useCallback)(c=>{g.renamePage(u,c||"New Page",{ephemeral:!0})},[g,u]),x=(0,K.useCallback)(c=>{g.mark("rename page"),g.renamePage(u,c||"New Page",{ephemeral:!1})},[g,u]);return(0,V.jsx)(oO,{className:"tlui-page-menu__item__input",ref:c=>b.current=c,defaultValue:c,onValueChange:v,onComplete:x,onCancel:x,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:f,autoselect:!0})},onMovePage=(c,u,f,g)=>{let b;let v=c.pages,x=f>g?v[g-1]:v[g],w=f>g?v[g]:v[g+1];(b=x&&!w?(0,nF._L)(x.index):!x&&w?(0,nF.Xg)(v[0].index):(0,nF.eI)(x.index,w.index))!==v[f].index&&(c.mark("moving page"),c.updatePage({id:u,index:b}))},sn=(0,e5.j)(function({index:c,listSize:u,item:f,onRename:g}){let b=(0,tt.j)(),v=useTranslation(),x=b.pages,w=(0,K.useCallback)(()=>{b.mark("creating page");let c=e8.ez.createId();b.duplicatePage(f.id,c)},[b,f]),_=(0,K.useCallback)(()=>{onMovePage(b,f.id,c,c-1)},[b,f,c]),k=(0,K.useCallback)(()=>{onMovePage(b,f.id,c,c+1)},[b,f,c]),E=(0,K.useCallback)(()=>{b.mark("deleting page"),b.deletePage(f.id)},[b,f]);return(0,V.jsxs)(Root,{id:`page item submenu ${c}`,children:[(0,V.jsx)(Trigger,{children:(0,V.jsx)(nq,{title:v("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,V.jsxs)(Content,{alignOffset:0,children:[(0,V.jsxs)(Group,{children:[g&&(0,V.jsx)(iv,{dir:"ltr",onSelect:g,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),(0,V.jsx)(iv,{dir:"ltr",onSelect:w,disabled:x.length>=td.Et,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),c>0&&(0,V.jsx)(iv,{dir:"ltr",onSelect:_,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),c<u-1&&(0,V.jsx)(iv,{dir:"ltr",onSelect:k,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),u>1&&(0,V.jsx)(Group,{children:(0,V.jsx)(iv,{dir:"ltr",onSelect:E,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),PageMenu=function(){let c=(0,tt.j)(),u=useTranslation(),f=useBreakpoint(),g=(0,K.useCallback)(()=>j(!1),[]),[b,v]=useMenuIsOpen("page-menu",g),x=f<5?36:40,w=(0,K.useRef)(null),_=(0,e5.Hg)("pages",()=>c.pages,[c]),k=(0,e5.Hg)("currentPage",()=>c.currentPage,[c]),E=(0,e5.Hg)("currentPageId",()=>c.currentPageId,[c]),T=useReadonly(),$=(0,e5.Hg)("maxPageCountReached",()=>c.pages.length>=td.Et,[c]),I=(0,e5.Hg)("isCoarsePointer",()=>c.instanceState.isCoarsePointer,[c]),[M,j]=(0,K.useState)(!1),D=(0,K.useCallback)(()=>{T||j(c=>!c)},[T]),L=(0,K.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[F,B]=(0,K.useState)(Object.fromEntries(_.map((c,u)=>[c.id,{y:u*x,offsetY:0,isSelected:!1}])));(0,K.useLayoutEffect)(()=>{B(Object.fromEntries(_.map((c,u)=>[c.id,{y:u*x,offsetY:0,isSelected:!1}])))},[x,_]),(0,K.useEffect)(()=>{b&&requestAnimationFrame(()=>{let c=document.querySelector(`[data-testid="page-menu-item-${E}"]`);if(c){let u=w.current;if(!u)return;let f=c.offsetTop,g=u.scrollTop;f<g&&u.scrollTo({top:f});let b=f+x,v=u.scrollTop+u.offsetHeight;b>v&&u.scrollTo({top:b-u.offsetHeight})}})},[x,E,b]);let G=(0,K.useCallback)(c=>{let{clientY:u,currentTarget:f}=c,{dataset:{id:g,index:b}}=f;if(!g||!b)return;let v=L.current;setPointerCapture(c.currentTarget,c),v.status="pointing",v.pointing={id:g,index:+b};let w=F[g],k=w.y;v.startY=u,v.startIndex=Math.max(0,Math.min(Math.round(k/x),_.length-1))},[x,_.length,F]),U=(0,K.useCallback)(c=>{let u=L.current;if("pointing"===u.status){let{clientY:f}=c,g=f-u.startY;Math.abs(g)>5&&(u.status="dragging")}if("dragging"===u.status){let{clientY:f}=c,g=f-u.startY,b=F[u.pointing.id],{startIndex:v,pointing:w}=u,k=b.y+g,E=Math.max(0,Math.min(Math.round(k/x),_.length-1)),T={...F};if(T[w.id]={y:b.y,offsetY:g,isSelected:!0},E!==u.dragIndex){u.dragIndex=E;for(let c=0;c<_.length;c++){let f=_[c];if(f.id===u.pointing.id)continue;let{y:g}=T[f.id];E===v?g=c*x:E<v?g=E<=c&&c<v?(c+1)*x:c*x:E>v&&(g=E>=c&&c>v?(c-1)*x:c*x),g!==T[f.id].y&&(T[f.id]={y:g,offsetY:0,isSelected:!0})}}B(T)}},[x,_,F]),Z=(0,K.useCallback)(u=>{let f=L.current;if("dragging"===f.status){let{id:u,index:g}=f.pointing;onMovePage(c,u,g,f.dragIndex)}releasePointerCapture(u.currentTarget,u),f.status="idle"},[c]),Y=(0,K.useCallback)(c=>{let u=L.current;"Escape"===c.key&&("dragging"===u.status&&B(Object.fromEntries(_.map((c,u)=>[c.id,{y:u*x,offsetY:0,isSelected:!1}]))),u.status="idle")},[x,_]),X=(0,K.useCallback)(()=>{T||c.batch(()=>{c.mark("creating page");let f=e8.ez.createId();c.createPage({name:u("page-menu.new-page-initial-name"),id:f}),c.setCurrentPage(f),j(!0)})},[c,u,T]);return(0,V.jsxs)(Popover,{id:"page menu",onOpenChange:v,open:b,children:[(0,V.jsx)(PopoverTrigger,{children:(0,V.jsx)(nq,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:k.name,children:(0,V.jsx)("div",{className:"tlui-page-menu__name",children:k.name})})}),(0,V.jsx)(PopoverContent,{side:"bottom",align:"start",sideOffset:6,children:(0,V.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,V.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,V.jsx)("div",{className:"tlui-page-menu__header__title",children:u("page-menu.title")}),!T&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(nq,{"data-testid":"page-menu.edit",title:u(M?"page-menu.edit-done":"page-menu.edit-start"),icon:M?"check":"edit",onClick:D}),(0,V.jsx)(nq,{"data-testid":"page-menu.create",icon:"plus",title:u($?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:$,onClick:X})]})]}),(0,V.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:x*_.length+4},ref:w,children:_.map((g,b)=>{let v=F[g.id]??{position:40*b,offsetY:0};return M?(0,V.jsxs)("div",{"data-testid":`page-menu-item-${g.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:g.id===k.id?888:b,transform:`translate(0px, ${v.y+v.offsetY}px)`},children:[(0,V.jsx)(nq,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:G,onPointerUp:Z,onPointerMove:U,onKeyDown:Y,"data-id":g.id,"data-index":b}),f<5&&I?(0,V.jsx)(nq,{className:"tlui-page-menu__item__button",onClick:()=>{let u=window.prompt("Rename page",g.name);u&&u!==g.name&&c.renamePage(g.id,u)},onDoubleClick:D,isChecked:g.id===k.id,children:(0,V.jsx)("span",{children:g.name})}):(0,V.jsx)("div",{className:"tlui-page_menu__item__sortable__title",style:{height:x},children:(0,V.jsx)(PageItemInput,{id:g.id,name:g.name,isCurrentPage:g.id===k.id})}),!T&&(0,V.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":M,children:(0,V.jsx)(sn,{index:b,item:g,listSize:_.length})})]},g.id+"_editing"):(0,V.jsxs)("div",{"data-testid":`page-menu-item-${g.id}`,className:"tlui-page-menu__item",children:[(0,V.jsxs)(nq,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>c.setCurrentPage(g.id),onDoubleClick:D,isChecked:g.id===k.id,title:u("page-menu.go-to-page"),children:[(0,V.jsx)("div",{className:"tlui-page-menu__item__button__check",children:g.id===k.id&&(0,V.jsx)(nW,{icon:"check"})}),(0,V.jsx)("span",{children:g.name})]}),!T&&(0,V.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,V.jsx)(sn,{index:b,item:g,listSize:_.length,onRename:()=>{if(c.environment.isIos){let u=window.prompt("Rename page",g.name);u&&u!==g.name&&c.renamePage(g.id,u)}else c.batch(()=>{j(!0),c.setCurrentPage(g.id)})}})})]},g.id)})})]})})]})},sr=(0,K.memo)(function(){let c=useTranslation(),u=useCanRedo(),f=useActions(),g=f.redo;return(0,V.jsx)(nq,{"data-testid":"main.redo",icon:g.icon,title:`${c(g.label)} ${kbdStr(g.kbd)}`,disabled:!u,onClick:()=>g.onSelect("quick-actions"),smallIcon:!0})}),si=(0,e5.j)(function(){let c=(0,tt.j)(),u=useActions(),f=useTranslation(),g=u.delete,b=useReadonly();return b?null:(0,V.jsx)(nq,{icon:g.icon,onClick:()=>g.onSelect("quick-actions"),disabled:!(c.isIn("select")&&c.selectedShapeIds.length>0),title:`${f(g.label)} ${kbdStr(g.kbd)}`,smallIcon:!0})}),so=(0,K.memo)(function(){let c=useTranslation(),u=useCanUndo(),f=useActions(),g=f.undo;return(0,V.jsx)(nq,{"data-testid":"main.undo",icon:g.icon,title:`${c(g.label)} ${kbdStr(g.kbd)}`,disabled:!u,onClick:()=>g.onSelect("quick-actions"),smallIcon:!0})}),sa=(0,e5.j)(function(){let c=(0,tt.j)(),u=useBreakpoint(),f=useReadonly();return(0,V.jsx)("div",{className:"tlui-menu-zone",children:(0,V.jsxs)("div",{className:"tlui-menu-zone__controls",children:[(0,V.jsx)(st,{}),(0,V.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,V.jsx)(PageMenu,{}),u>=6&&!f&&!c.isInAny("hand","zoom")&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,V.jsx)(so,{}),(0,V.jsx)(sr,{}),(0,V.jsx)(si,{}),(0,V.jsx)(se,{}),(0,V.jsx)(a9,{})]})]})})});function useLocalStorageState(c,u){let[f,g]=K.useState(u);K.useLayoutEffect(()=>{let u=localStorage.getItem(c);if(u)try{g(JSON.parse(u))}catch(u){console.error(`Could not restore value ${c} from local storage.`)}},[c]);let b=K.useCallback(u=>{g(f=>{let g="function"==typeof u?u(f):u;return localStorage.setItem(c,JSON.stringify(g)),g})},[c]);return[f,b]}let MinimapManager=class MinimapManager{constructor(c){this.editor=c}dpr=1;colors={shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"};id=(0,tQ.E)();cvs=null;pageBounds=[];collaborators=[];canvasScreenBounds=new nT.No;canvasPageBounds=new nT.No;contentPageBounds=new nT.No;contentScreenBounds=new nT.No;originPagePoint=new tl.G;originPageCenter=new tl.G;isInViewport=!1;debug=!1;setDpr(c){this.dpr=+c.toFixed(2)}updateContentScreenBounds=()=>{let{contentScreenBounds:c,contentPageBounds:u,canvasScreenBounds:f}=this,{x:g,y:b,w:v,h:x}=c;if(u.w>u.h){let c=f.w/(u.w/u.h);c>f.h?(g=(f.w-f.w*(f.h/c))/2,b=0,v=f.w*(f.h/c),x=f.h):(g=0,b=(f.h-c)/2,v=f.w,x=c)}else if(u.w<u.h){let c=f.h/(u.h/u.w);g=(f.w-c)/2,b=0,v=c,x=f.h}else g=f.h/2,b=0,v=f.h,x=f.h;c.set(g,b,v,x)};updateCanvasPageBounds=()=>{let{canvasPageBounds:c,canvasScreenBounds:u,contentPageBounds:f,contentScreenBounds:g}=this;c.set(0,0,f.width/(g.width/u.width),f.height/(g.height/u.height)),c.center=f.center};getScreenPoint=(c,u)=>{let{canvasScreenBounds:f}=this,g=(c-f.minX)*this.dpr,b=(u-f.minY)*this.dpr;return{x:g,y:b}};getPagePoint=(c,u)=>{let{contentPageBounds:f,contentScreenBounds:g,canvasPageBounds:b}=this,{x:v,y:x}=this.getScreenPoint(c,u);return new tl.G(b.minX+v*f.width/g.width,b.minY+x*f.height/g.height,1)};minimapScreenPointToPagePoint=(c,u,f=!1,g=!1)=>{let{editor:b}=this,{viewportPageBounds:v}=b,{x:x,y:w}=this.getPagePoint(c,u);if(g){let c=this.editor.currentPageBounds,u=(c?.minX??0)-v.width/2,f=(c?.maxX??0)+v.width/2,g=(c?.minY??0)-v.height/2,b=(c?.maxY??0)+v.height/2,_=Math.max(0,u+v.width-x),k=Math.max(0,-(f-v.width-x)),E=Math.max(0,g+v.height-w),T=Math.max(0,-(b-v.height-w)),$=Math.max(0,_-k),I=Math.max(0,k-_),M=Math.max(0,E-T),j=Math.max(0,T-E);$&&$>I?x+=$/2:I&&(x-=I/2),M&&M>j?w+=M/2:j&&(w-=j/2),x=(0,ts.uZ)(x,u,f),w=(0,ts.uZ)(w,g,b)}if(f){let{originPagePoint:c}=this,u=Math.abs(x-c.x),f=Math.abs(w-c.y);u>f?w=c.y:x=c.x}return new tl.G(x,w)};render=()=>{let c,u;let{cvs:f,pageBounds:g}=this;this.updateCanvasPageBounds();let{editor:b,canvasScreenBounds:v,canvasPageBounds:x,contentPageBounds:w,contentScreenBounds:_}=this,{width:k,height:E}=v,{viewportPageBounds:T,selectedShapeIds:$}=b;if(!f||!g)return;let I=f.getContext("2d");if(!I)throw Error("Minimap (shapes): Could not get context");I.resetTransform(),I.globalAlpha=1,I.clearRect(0,0,k,E);let M=_.width/w.width,j=_.height/w.height;I.translate((k-_.width)/2,(E-_.height)/2),I.scale(M,j),I.translate(-w.minX,-w.minY);let D=8/M,L=8/M,F=1/M,B=1/M,G=D/4,U=L/4,V=new Path2D,K=new Path2D,{shapeFill:Z,selectFill:Y,viewportFill:X}=this.colors;for(let u=0,f=g.length;u<f;u++)c=g[u],MinimapManager.roundedRect($.includes(c.id)?K:V,c.minX,c.minY,c.width,c.height,(0,ts.uZ)(D,F,c.width/G),(0,ts.uZ)(L,B,c.height/U));if(I.fillStyle=Z,I.fill(V),I.fillStyle=Y,I.fill(K),this.debug){let c=nT.No.Common(g),{minX:u,minY:f,width:b,height:v}=c;I.strokeStyle="green",I.lineWidth=2/M,I.strokeRect(u+1/M,f+1/j,b-2/M,v-2/j)}{let{brush:c}=b.instanceState;if(c){let{x:u,y:f,w:g,h:b}=c;I.beginPath(),MinimapManager.sharpRect(I,u,f,g,b),I.closePath(),I.fillStyle=X,I.fill()}}{let{minX:c,minY:u,width:f,height:g}=T;I.beginPath();let b=12/M,v=12/M;MinimapManager.roundedRect(I,c,u,f,g,Math.min(f/4,b),Math.min(g/4,v)),I.closePath(),I.fillStyle=X,I.fill(),this.debug&&(I.strokeStyle="orange",I.strokeRect(c+1/M,u+1/j,f-2/M,g-2/j))}let J=2.5/M,Q=2.5/j,{currentPageId:ee}=b;for(let c=0;c<this.collaborators.length;c++)(u=this.collaborators[c]).currentPageId===ee&&(I.beginPath(),I.ellipse((0,ts.uZ)(u.cursor.x,x.minX+J,x.maxX-J),(0,ts.uZ)(u.cursor.y,x.minY+Q,x.maxY-Q),5/M,5/j,0,0,ts.yo),I.fillStyle=u.color,I.fill());if(this.debug){I.lineWidth=2/M;{let{minX:c,minY:u,width:f,height:g}=w;I.strokeStyle="red",I.strokeRect(c+1/M,u+1/j,f-2/M,g-2/j)}{let{minX:c,minY:u,width:f,height:g}=x;I.strokeStyle="blue",I.strokeRect(c+1/M,u+1/j,f-2/M,g-2/j)}}};static roundedRect(c,u,f,g,b,v,x){if(v<1&&x<1){c.rect(u,f,g,b);return}c.moveTo(u+v,f),c.lineTo(u+g-v,f),c.quadraticCurveTo(u+g,f,u+g,f+x),c.lineTo(u+g,f+b-x),c.quadraticCurveTo(u+g,f+b,u+g-v,f+b),c.lineTo(u+v,f+b),c.quadraticCurveTo(u,f+b,u,f+b-x),c.lineTo(u,f+x),c.quadraticCurveTo(u,f,u+v,f)}static sharpRect(c,u,f,g,b,v,x){c.rect(u,f,g,b)}};function Minimap({shapeFill:c,selectFill:u,viewportFill:f}){let g=(0,tt.j)(),b=K.useRef(null),v=K.useRef(!1),x=useIsDarkMode(),w=(0,e5.vc)("dpr",()=>g.instanceState.devicePixelRatio,[g]),_=K.useMemo(()=>g.store.query.records("instance_presence"),[g]),k=K.useMemo(()=>new MinimapManager(g),[g]);K.useEffect(()=>{let b=requestAnimationFrame(()=>{let b=getComputedStyle(g.getContainer());k.colors={shapeFill:b.getPropertyValue(c).trim(),selectFill:b.getPropertyValue(u).trim(),viewportFill:b.getPropertyValue(f).trim()},k.render()});return()=>{cancelAnimationFrame(b)}},[g,u,c,f,k,x]);let E=K.useCallback(c=>{if(!g.currentPageShapeIds.size)return;let u=k.minimapScreenPointToPagePoint(c.clientX,c.clientY,!1,!1),f=k.minimapScreenPointToPagePoint(c.clientX,c.clientY,!1,!0);k.originPagePoint.setTo(f),k.originPageCenter.setTo(g.viewportPageBounds.center),g.centerOnPoint(u,{duration:td.KD})},[g,k]),T=K.useCallback(c=>{let u=c.currentTarget;if(setPointerCapture(u,c),!g.currentPageShapeIds.size)return;v.current=!0,k.isInViewport=!1;let f=k.minimapScreenPointToPagePoint(c.clientX,c.clientY,!1,!1),b=k.minimapScreenPointToPagePoint(c.clientX,c.clientY,!1,!0),x=g.viewportPageBounds;if(k.isInViewport=x.containsPoint(b),k.isInViewport)k.originPagePoint.setTo(b),k.originPageCenter.setTo(x.center);else{let c=tl.G.Sub(x.center,x.point),u=tl.G.Add(f,c);k.originPagePoint.setTo(u),k.originPageCenter.setTo(f),g.centerOnPoint(f,{duration:td.KD})}function release(c){u&&releasePointerCapture(u,c),v.current=!1,document.body.removeEventListener("pointerup",release)}document.body.addEventListener("pointerup",release)},[g,k]),$=K.useCallback(c=>{let u=k.minimapScreenPointToPagePoint(c.clientX,c.clientY,c.shiftKey,!0);if(v.current){if(k.isInViewport){let c=k.originPagePoint.clone().sub(k.originPageCenter);g.centerOnPoint(tl.G.Sub(u,c));return}g.centerOnPoint(u)}let f=k.getPagePoint(c.clientX,c.clientY),b=g.pageToScreen(f),x={type:"pointer",target:"canvas",name:"pointer_move",...getPointerInfo(c),point:b,isPen:g.instanceState.isPenMode};g.dispatch(x)},[g,k]),I=K.useCallback(c=>{let u=normalizeWheel(c);g.dispatch({type:"wheel",name:"wheel",delta:u,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey})},[g]);return(0,e5.BK)("update when dpr changes",()=>{let c=w.value;k.setDpr(c);let u=b.current,f=u.getBoundingClientRect(),g=f.width*c,v=f.height*c;u.width=g,u.height=v,k.canvasScreenBounds.set(f.x,f.y,g,v),k.cvs=b.current},[w,k]),(0,e5.BK)("minimap render when pagebounds or collaborators changes",()=>{let{currentPageShapeIds:c,viewportPageBounds:u,currentPageBounds:f}=g;w.value,k.contentPageBounds=f?nT.No.Expand(f,u):u,k.updateContentScreenBounds();let b=[];c.forEach(c=>{let u=g.getShapePageBounds(c);if(!u)return;let f=g.getShapeMask(c);if(f){let c=(0,nw.tY)(f,u.corners);if(!c)return;u=nT.No.FromPoints(c)}u&&(u.id=c,b.push(u))}),k.pageBounds=b,k.collaborators=_.value,k.render()},[g,k]),(0,V.jsx)("div",{className:"tlui-minimap",children:(0,V.jsx)("canvas",{ref:b,className:"tlui-minimap__canvas",onDoubleClick:E,onPointerMove:$,onPointerDown:T,onWheel:I})})}let ss=(0,e5.j)(function(){let c=(0,tt.j)(),u=useTranslation(),f=useBreakpoint(),g=c.zoomLevel,b=c.currentPageShapeIds.size>0,v=c.selectedShapeIds.length>0,x=1===c.zoomLevel,w=K.useCallback(()=>{c.resetZoom(c.viewportScreenCenter,{duration:td.KD})},[c]);return(0,V.jsxs)(Root,{id:"zoom",children:[(0,V.jsx)(Trigger,{children:(0,V.jsx)(nq,{title:`${u("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:f<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:w,icon:f<4?"zoom-in":void 0,children:f<4?null:(0,V.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*g),"%"]})})}),(0,V.jsx)(Content,{side:"top",align:"start",alignOffset:0,children:(0,V.jsxs)(Group,{children:[(0,V.jsx)(ZoomMenuItem,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,V.jsx)(ZoomMenuItem,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,V.jsx)(ZoomMenuItem,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:x}),(0,V.jsx)(ZoomMenuItem,{action:"zoom-to-fit",disabled:!b,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,V.jsx)(ZoomMenuItem,{action:"zoom-to-selection",disabled:!v,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function ZoomMenuItem(c){let{action:u,disabled:f=!1,noClose:g=!1}=c,b=useActions();return(0,V.jsx)(Item,{label:b[u].label,kbd:b[u].kbd,"data-testid":c["data-testid"],onClick:()=>b[u].onSelect("zoom-menu"),noClose:g,disabled:f})}let sl=(0,K.memo)(function(){let c=useActions(),u=useTranslation(),f=useBreakpoint(),[g,b]=useLocalStorageState("minimap",!0),v=(0,K.useCallback)(()=>{b(c=>!c)},[b]);return f<4?null:(0,V.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,V.jsx)("div",{className:"tlui-navigation-zone__controls",children:f<6?(0,V.jsx)(ss,{}):g?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ss,{}),(0,V.jsx)(nq,{title:u("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:v,icon:g?"chevrons-ne":"chevrons-sw"})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(nq,{icon:"minus","data-testid":"minimap.zoom-out",title:`${u(c["zoom-out"].label)} ${kbdStr(c["zoom-out"].kbd)}`,onClick:()=>c["zoom-out"].onSelect("navigation-zone")}),(0,V.jsx)(ss,{}),(0,V.jsx)(nq,{icon:"plus","data-testid":"minimap.zoom-in",title:`${u(c["zoom-in"].label)} ${kbdStr(c["zoom-in"].kbd)}`,onClick:()=>c["zoom-in"].onSelect("navigation-zone")}),(0,V.jsx)(nq,{title:u("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:v,icon:g?"chevrons-ne":"chevrons-sw"})]})}),f>=6&&!g&&(0,V.jsx)(Minimap,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),sc=(0,e5.j)(function(){let c=(0,tt.j)(),u=c.instanceState.isPenMode,f=useActions();if(!u)return null;let g=f["exit-pen-mode"];return(0,V.jsx)(nq,{label:g.label,iconLeft:g.icon,onClick:()=>g.onSelect("helper-buttons")})}),su=(0,e5.j)(function(){let c=(0,tt.j)(),u=useActions();if(!c.instanceState.followingUserId)return null;let f=u["stop-following"];return(0,V.jsx)(nq,{label:f.label,iconLeft:f.icon,onClick:()=>f.onSelect("people-menu")})}),sd=[e8.R_,e8.ci,e8.pp,e8.ST];function useRelevantStyles(){let c=(0,tt.j)();return(0,e5.Hg)("getRelevantStyles",()=>{let u=new nR.o(c.sharedStyles),f=c.selectedShapeIds.length>0||!!c.root.current.value?.shapeType;if(0===u.size&&c.isIn("select")&&0===c.selectedShapeIds.length)for(let f of sd)u.applyValue(f,c.getStyleForNextShape(f));return 0!==u.size||f?{styles:u,opacity:c.sharedOpacity}:null},[c])}function _ButtonPicker(c){let{uiType:u,items:f,title:g,style:b,value:v,columns:x=(0,ts.uZ)(f.length,2,4),onValueChange:w}=c,_=(0,tt.j)(),k=useTranslation(),E=(0,K.useRef)(!1),{handleButtonClick:T,handleButtonPointerDown:$,handleButtonPointerEnter:I,handleButtonPointerUp:M}=K.useMemo(()=>{let handlePointerUp=()=>{E.current=!1,window.removeEventListener("pointerup",handlePointerUp)};return{handleButtonClick:c=>{let{id:u}=c.currentTarget.dataset;("shared"!==v.type||v.value!==u)&&(_.mark("point picker item"),w(b,u,!1))},handleButtonPointerDown:c=>{let{id:u}=c.currentTarget.dataset;_.mark("point picker item"),w(b,u,!0),E.current=!0,window.addEventListener("pointerup",handlePointerUp)},handleButtonPointerEnter:c=>{if(!E.current)return;let{id:u}=c.currentTarget.dataset;w(b,u,!0)},handleButtonPointerUp:c=>{let{id:u}=c.currentTarget.dataset;w(b,u,!1)}}},[v,_,w,b]),j=(0,e5.Hg)("theme",()=>(0,e8.y6)({isDarkMode:_.user.isDarkMode}),[_]);return(0,V.jsx)("div",{className:e2("tlui-button-grid",{"tlui-button-grid__two":2===x,"tlui-button-grid__three":3===x,"tlui-button-grid__four":4===x}),children:f.map(c=>(0,V.jsx)(nq,{"data-id":c.value,"data-testid":`style.${u}.${c.value}`,"aria-label":c.value,"data-state":"shared"===v.type&&v.value===c.value?"hinted":void 0,title:g+" — "+k(`${u}-style.${c.value}`),className:e2("tlui-button-grid__button"),style:b===e8.R_?{color:j[c.value].solid}:void 0,onPointerEnter:I,onPointerDown:$,onPointerUp:M,onClick:T,icon:c.icon},c.value))})}let sh=K.memo(_ButtonPicker);function $ae6933e535247d3d$export$7d15b64cf5a3a4c4(c,[u,f]){return Math.min(f,Math.max(u,c))}function $010c2913dbd2fe3d$export$5cae361ad82dce8b(c){let u=(0,K.useRef)({value:c,previous:c});return(0,K.useMemo)(()=>(u.current.value!==c&&(u.current.previous=u.current.value,u.current.value=c),u.current.previous),[c])}let sp=["PageUp","PageDown"],sf=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sg={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},sm="Slider",[sy,sb,sv]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(sm),[sS,sx]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(sm,[sv]),[sw,s_]=sS(sm),sk=(0,K.forwardRef)((c,u)=>{let{name:f,min:g=0,max:b=100,step:v=1,orientation:x="horizontal",disabled:w=!1,minStepsBetweenThumbs:_=0,defaultValue:k=[g],value:E,onValueChange:T=()=>{},onValueCommit:$=()=>{},inverted:I=!1,...M}=c,[j,D]=(0,K.useState)(null),L=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>D(c)),F=(0,K.useRef)(new Set),B=(0,K.useRef)(0),G=!j||!!j.closest("form"),U="horizontal"===x?sP:sT,[V=[],Z]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:E,defaultProp:k,onChange:c=>{var u;let f=[...F.current];null===(u=f[B.current])||void 0===u||u.focus(),T(c)}}),Y=(0,K.useRef)(V);function handleSlideStart(c){let u=$faa2e61a3361514f$var$getClosestValueIndex(V,c);updateValues(c,u)}function handleSlideMove(c){updateValues(c,B.current)}function handleSlideEnd(){let c=Y.current[B.current],u=V[B.current];u!==c&&$(V)}function updateValues(c,u,{commit:f}={commit:!1}){let x=$faa2e61a3361514f$var$getDecimalCount(v),w=$faa2e61a3361514f$var$roundValue(Math.round((c-g)/v)*v+g,x),k=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(w,[g,b]);Z((c=[])=>{let g=$faa2e61a3361514f$var$getNextSortedValues(c,k,u);if(!$faa2e61a3361514f$var$hasMinStepsBetweenValues(g,_*v))return c;{B.current=g.indexOf(k);let u=String(g)!==String(c);return u&&f&&$(g),u?g:c}})}return(0,K.createElement)(sw,{scope:c.__scopeSlider,disabled:w,min:g,max:b,valueIndexToChangeRef:B,thumbs:F.current,values:V,orientation:x},(0,K.createElement)(sy.Provider,{scope:c.__scopeSlider},(0,K.createElement)(sy.Slot,{scope:c.__scopeSlider},(0,K.createElement)(U,_extends({"aria-disabled":w,"data-disabled":w?"":void 0},M,{ref:L,onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(M.onPointerDown,()=>{w||(Y.current=V)}),min:g,max:b,inverted:I,onSlideStart:w?void 0:handleSlideStart,onSlideMove:w?void 0:handleSlideMove,onSlideEnd:w?void 0:handleSlideEnd,onHomeKeyDown:()=>!w&&updateValues(g,0,{commit:!0}),onEndKeyDown:()=>!w&&updateValues(b,V.length-1,{commit:!0}),onStepKeyDown:({event:c,direction:u})=>{if(!w){let f=sp.includes(c.key),g=f||c.shiftKey&&sf.includes(c.key),b=B.current,x=V[b],w=v*(g?10:1)*u;updateValues(x+w,b,{commit:!0})}}})))),G&&V.map((c,u)=>(0,K.createElement)($faa2e61a3361514f$var$BubbleInput,{key:u,name:f?f+(V.length>1?"[]":""):void 0,value:c})))}),[sC,sE]=sS(sm,{startEdge:"left",endEdge:"right",size:"width",direction:1}),sP=(0,K.forwardRef)((c,u)=>{let{min:f,max:g,dir:b,inverted:v,onSlideStart:x,onSlideMove:w,onSlideEnd:_,onStepKeyDown:k,...E}=c,[T,$]=(0,K.useState)(null),I=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>$(c)),M=(0,K.useRef)(),j=$f631663db3294ace$export$b39126d51d94e6f3(b),D="ltr"===j,L=D&&!v||!D&&v;function getValueFromPointer(c){let u=M.current||T.getBoundingClientRect(),b=[0,u.width],v=$faa2e61a3361514f$var$linearScale(b,L?[f,g]:[g,f]);return M.current=u,v(c-u.left)}return(0,K.createElement)(sC,{scope:c.__scopeSlider,startEdge:L?"left":"right",endEdge:L?"right":"left",direction:L?1:-1,size:"width"},(0,K.createElement)(s$,_extends({dir:j,"data-orientation":"horizontal"},E,{ref:I,style:{...E.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:c=>{let u=getValueFromPointer(c.clientX);null==x||x(u)},onSlideMove:c=>{let u=getValueFromPointer(c.clientX);null==w||w(u)},onSlideEnd:()=>{M.current=void 0,null==_||_()},onStepKeyDown:c=>{let u=sg[L?"from-left":"from-right"].includes(c.key);null==k||k({event:c,direction:u?-1:1})}})))}),sT=(0,K.forwardRef)((c,u)=>{let{min:f,max:g,inverted:b,onSlideStart:v,onSlideMove:x,onSlideEnd:w,onStepKeyDown:_,...k}=c,E=(0,K.useRef)(null),T=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,E),$=(0,K.useRef)(),I=!b;function getValueFromPointer(c){let u=$.current||E.current.getBoundingClientRect(),b=[0,u.height],v=$faa2e61a3361514f$var$linearScale(b,I?[g,f]:[f,g]);return $.current=u,v(c-u.top)}return(0,K.createElement)(sC,{scope:c.__scopeSlider,startEdge:I?"bottom":"top",endEdge:I?"top":"bottom",size:"height",direction:I?1:-1},(0,K.createElement)(s$,_extends({"data-orientation":"vertical"},k,{ref:T,style:{...k.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:c=>{let u=getValueFromPointer(c.clientY);null==v||v(u)},onSlideMove:c=>{let u=getValueFromPointer(c.clientY);null==x||x(u)},onSlideEnd:()=>{$.current=void 0,null==w||w()},onStepKeyDown:c=>{let u=sg[I?"from-bottom":"from-top"].includes(c.key);null==_||_({event:c,direction:u?-1:1})}})))}),s$=(0,K.forwardRef)((c,u)=>{let{__scopeSlider:f,onSlideStart:g,onSlideMove:b,onSlideEnd:v,onHomeKeyDown:x,onEndKeyDown:w,onStepKeyDown:_,...k}=c,E=s_(sm,f);return(0,K.createElement)(en.span,_extends({},k,{ref:u,onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onKeyDown,c=>{"Home"===c.key?(x(c),c.preventDefault()):"End"===c.key?(w(c),c.preventDefault()):sp.concat(sf).includes(c.key)&&(_(c),c.preventDefault())}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDown,c=>{let u=c.target;u.setPointerCapture(c.pointerId),c.preventDefault(),E.thumbs.has(u)?u.focus():g(c)}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,c=>{let u=c.target;u.hasPointerCapture(c.pointerId)&&b(c)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerUp,c=>{let u=c.target;u.hasPointerCapture(c.pointerId)&&(u.releasePointerCapture(c.pointerId),v(c))})}))}),sI=(0,K.forwardRef)((c,u)=>{let{__scopeSlider:f,...g}=c,b=s_("SliderTrack",f);return(0,K.createElement)(en.span,_extends({"data-disabled":b.disabled?"":void 0,"data-orientation":b.orientation},g,{ref:u}))}),sA="SliderRange",sM=(0,K.forwardRef)((c,u)=>{let{__scopeSlider:f,...g}=c,b=s_(sA,f),v=sE(sA,f),x=(0,K.useRef)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,x),_=b.values.length,k=b.values.map(c=>$faa2e61a3361514f$var$convertValueToPercentage(c,b.min,b.max));return(0,K.createElement)(en.span,_extends({"data-orientation":b.orientation,"data-disabled":b.disabled?"":void 0},g,{ref:w,style:{...c.style,[v.startEdge]:(_>1?Math.min(...k):0)+"%",[v.endEdge]:100-Math.max(...k)+"%"}}))}),sj="SliderThumb",sO=(0,K.forwardRef)((c,u)=>{let f=sb(c.__scopeSlider),[g,b]=(0,K.useState)(null),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>b(c)),x=(0,K.useMemo)(()=>g?f().findIndex(c=>c.ref.current===g):-1,[f,g]);return(0,K.createElement)(sR,_extends({},c,{ref:v,index:x}))}),sR=(0,K.forwardRef)((c,u)=>{let{__scopeSlider:f,index:g,...b}=c,v=s_(sj,f),x=sE(sj,f),[w,_]=(0,K.useState)(null),k=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(u,c=>_(c)),E=$db6c3485150b8e66$export$1ab7ae714698c4b8(w),T=v.values[g],$=void 0===T?0:$faa2e61a3361514f$var$convertValueToPercentage(T,v.min,v.max),I=$faa2e61a3361514f$var$getLabel(g,v.values.length),M=null==E?void 0:E[x.size],j=M?$faa2e61a3361514f$var$getThumbInBoundsOffset(M,$,x.direction):0;return(0,K.useEffect)(()=>{if(w)return v.thumbs.add(w),()=>{v.thumbs.delete(w)}},[w,v.thumbs]),(0,K.createElement)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[x.startEdge]:`calc(${$}% + ${j}px)`}},(0,K.createElement)(sy.ItemSlot,{scope:c.__scopeSlider},(0,K.createElement)(en.span,_extends({role:"slider","aria-label":c["aria-label"]||I,"aria-valuemin":v.min,"aria-valuenow":T,"aria-valuemax":v.max,"aria-orientation":v.orientation,"data-orientation":v.orientation,"data-disabled":v.disabled?"":void 0,tabIndex:v.disabled?void 0:0},b,{ref:k,style:void 0===T?{display:"none"}:c.style,onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onFocus,()=>{v.valueIndexToChangeRef.current=g})}))))}),$faa2e61a3361514f$var$BubbleInput=c=>{let{value:u,...f}=c,g=(0,K.useRef)(null),b=$010c2913dbd2fe3d$export$5cae361ad82dce8b(u);return(0,K.useEffect)(()=>{let c=g.current,f=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(f,"value"),x=v.set;if(b!==u&&x){let f=new Event("input",{bubbles:!0});x.call(c,u),c.dispatchEvent(f)}},[b,u]),(0,K.createElement)("input",_extends({style:{display:"none"}},f,{ref:g,defaultValue:u}))};function $faa2e61a3361514f$var$getNextSortedValues(c=[],u,f){let g=[...c];return g[f]=u,g.sort((c,u)=>c-u)}function $faa2e61a3361514f$var$convertValueToPercentage(c,u,f){return $ae6933e535247d3d$export$7d15b64cf5a3a4c4(100/(f-u)*(c-u),[0,100])}function $faa2e61a3361514f$var$getLabel(c,u){return u>2?`Value ${c+1} of ${u}`:2===u?["Minimum","Maximum"][c]:void 0}function $faa2e61a3361514f$var$getClosestValueIndex(c,u){if(1===c.length)return 0;let f=c.map(c=>Math.abs(c-u)),g=Math.min(...f);return f.indexOf(g)}function $faa2e61a3361514f$var$getThumbInBoundsOffset(c,u,f){let g=c/2,b=$faa2e61a3361514f$var$linearScale([0,50],[0,g]);return(g-b(u)*f)*f}function $faa2e61a3361514f$var$getStepsBetweenValues(c){return c.slice(0,-1).map((u,f)=>c[f+1]-u)}function $faa2e61a3361514f$var$hasMinStepsBetweenValues(c,u){if(u>0){let f=$faa2e61a3361514f$var$getStepsBetweenValues(c);return Math.min(...f)>=u}return!0}function $faa2e61a3361514f$var$linearScale(c,u){return f=>{if(c[0]===c[1]||u[0]===u[1])return u[0];let g=(u[1]-u[0])/(c[1]-c[0]);return u[0]+g*(f-c[0])}}function $faa2e61a3361514f$var$getDecimalCount(c){return(String(c).split(".")[1]||"").length}function $faa2e61a3361514f$var$roundValue(c,u){let f=Math.pow(10,u);return Math.round(c*f)/f}let sD=(0,K.memo)(function(c){let{title:u,steps:f,value:g,label:b,onValueChange:v}=c,x=(0,tt.j)(),w=useTranslation(),_=(0,K.useCallback)(c=>{v(c[0],!0)},[v]),k=(0,K.useCallback)(()=>{x.mark("click slider")},[x]),E=(0,K.useCallback)(()=>{g&&v(g,!1)},[g,v]);return(0,V.jsx)("div",{className:"tlui-slider__container",children:(0,V.jsxs)(sk,{"data-testid":c["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:f,step:1,value:g?[g]:void 0,onPointerDown:k,onValueChange:_,onPointerUp:E,title:u+" — "+w(b),children:[(0,V.jsx)(sI,{className:"tlui-slider__track",dir:"ltr",children:null!==g&&(0,V.jsx)(sM,{className:"tlui-slider__range",dir:"ltr"})}),null!==g&&(0,V.jsx)(sO,{className:"tlui-slider__thumb",dir:"ltr"})]})})}),sL=K.memo(function({label:c,uiTypeA:u,uiTypeB:f,labelA:g,labelB:b,itemsA:v,itemsB:x,styleA:w,styleB:_,valueA:k,valueB:E,onValueChange:T}){let $=useTranslation(),I=K.useMemo(()=>v.find(c=>"shared"===k.type&&k.value===c.value)?.icon??"mixed",[v,k]),M=K.useMemo(()=>x.find(c=>"shared"===E.type&&E.value===c.value)?.icon??"mixed",[x,E]);return void 0===k&&void 0===E?null:(0,V.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,V.jsx)("div",{title:$(c),className:"tlui-style-panel__double-select-picker-label",children:$(c)}),(0,V.jsxs)(Root,{id:`style panel ${u} A`,children:[(0,V.jsx)(im,{asChild:!0,onTouchEnd:c=>preventDefault(c),children:(0,V.jsx)(nq,{"data-testid":`style.${u}`,title:$(g)+" — "+(null===k?$("style-panel.mixed"):$(`${u}-style.${k}`)),icon:I,invertIcon:!0,smallIcon:!0})}),(0,V.jsx)(Content,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,V.jsx)("div",{className:e2("tlui-button-grid",{"tlui-button-grid__two":v.length<4,"tlui-button-grid__four":v.length>=4}),children:v.map(c=>(0,V.jsx)(Item,{className:"tlui-button-grid__button",title:$(g)+" — "+$(`${u}-style.${c.value}`),"data-testid":`style.${u}.${c.value}`,icon:c.icon,onClick:()=>T(w,c.value,!1),invertIcon:!0},c.value))})})]}),(0,V.jsxs)(Root,{id:`style panel ${f}`,children:[(0,V.jsx)(im,{asChild:!0,onTouchEnd:c=>preventDefault(c),children:(0,V.jsx)(nq,{"data-testid":`style.${f}`,title:$(b)+" — "+(null===E?$("style-panel.mixed"):$(`${f}-style.${E}`)),icon:M,smallIcon:!0})}),(0,V.jsx)(Content,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,V.jsx)("div",{className:e2("tlui-button-grid",{"tlui-button-grid__two":v.length<4,"tlui-button-grid__four":v.length>=4}),children:x.map(c=>(0,V.jsx)(Item,{className:"tlui-button-grid__button",title:$(b)+" — "+$(`${f}-style.${c.value}`),"data-testid":`style.${f}.${c.value}`,icon:c.icon,onClick:()=>T(_,c.value,!1)},c.value))})})]})]})}),sN=K.memo(function({id:c,label:u,uiType:f,style:g,items:b,value:v,onValueChange:x}){let w=useTranslation(),_=K.useMemo(()=>b.find(c=>"shared"===v.type&&c.value===v.value)?.icon,[b,v]);return(0,V.jsxs)(Root,{id:`style panel ${c}`,children:[(0,V.jsx)(im,{asChild:!0,onTouchEnd:c=>preventDefault(c),children:(0,V.jsx)(nq,{"data-testid":`style.${f}`,title:"mixed"===v.type?w("style-panel.mixed"):w(`${f}-style.${v.value}`),label:u,icon:_??"mixed"})}),(0,V.jsx)(Content,{side:"left",align:"center",alignOffset:0,children:(0,V.jsx)("div",{className:e2("tlui-button-grid",{"tlui-button-grid__two":b.length<3,"tlui-button-grid__three":3==b.length,"tlui-button-grid__four":b.length>=4}),children:b.map(c=>(0,V.jsx)(Item,{className:"tlui-button-grid__button","data-testid":`style.${f}.${c.value}`,title:w(`${f}-style.${c.value}`),icon:c.icon,onClick:()=>x(g,c.value,!1)},c.value))})})]})}),sF={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},StylePanel=function({isMobile:c}){let u=(0,tt.j)(),f=useRelevantStyles(),g=(0,K.useCallback)(()=>{c||u.updateInstanceState({isChangingStyle:!1})},[u,c]);if(!f)return null;let{styles:b,opacity:v}=f,x=b.get(e8.Zu),w=b.get(e8.ZJ),_=b.get(e8.TA),k=b.get(e8.t8),E=b.get(e8.Y8);return(0,V.jsxs)("div",{className:"tlui-style-panel","data-ismobile":c,onPointerLeave:g,children:[(0,V.jsx)(CommonStylePickerSet,{styles:b,opacity:v}),void 0!==E&&(0,V.jsx)(TextStylePickerSet,{styles:b}),!(void 0===x&&void 0===w&&void 0===_&&void 0===k)&&(0,V.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,V.jsx)(GeoStylePickerSet,{styles:b}),(0,V.jsx)(ArrowheadStylePickerSet,{styles:b}),(0,V.jsx)(SplineStylePickerSet,{styles:b})]})]})};function useStyleChangeCallback(){let c=(0,tt.j)();return K.useMemo(()=>function(u,f,g){c.batch(()=>{c.isIn("select")&&c.setStyleForSelectedShapes(u,f,{squashing:g}),c.setStyleForNextShapes(u,f,{squashing:g}),c.updateInstanceState({isChangingStyle:!0})})},[c])}let sB=[.1,.25,.5,.75,1];function CommonStylePickerSet({styles:c,opacity:u}){let f=(0,tt.j)(),g=useTranslation(),b=useStyleChangeCallback(),v=K.useCallback((c,u)=>{let g=sB[c];f.batch(()=>{f.isIn("select")&&f.setOpacityForSelectedShapes(g,{ephemeral:u}),f.setOpacityForNextShapes(g,{ephemeral:u}),f.updateInstanceState({isChangingStyle:!0})})},[f]),x=c.get(e8.R_),w=c.get(e8.pp),_=c.get(e8.ci),k=c.get(e8.ST),E="mixed"===u.type?-1:sB.indexOf((0,e4.F)(sB,c=>Math.abs(c-u.value)));return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===x?null:(0,V.jsx)(sh,{title:g("style-panel.color"),uiType:"color",style:e8.R_,items:sF.color,value:x,onValueChange:b}),void 0===u?null:(0,V.jsx)(sD,{"data-testid":"style.opacity",value:E>=0?E:sB.length-1,label:"mixed"===u.type?"style-panel.mixed":`opacity-style.${u.value}`,onValueChange:v,steps:sB.length-1,title:g("style-panel.opacity")})]}),(void 0!==w||void 0!==_||void 0!==k)&&(0,V.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===w?null:(0,V.jsx)(sh,{title:g("style-panel.fill"),uiType:"fill",style:e8.pp,items:sF.fill,value:w,onValueChange:b}),void 0===_?null:(0,V.jsx)(sh,{title:g("style-panel.dash"),uiType:"dash",style:e8.ci,items:sF.dash,value:_,onValueChange:b}),void 0===k?null:(0,V.jsx)(sh,{title:g("style-panel.size"),uiType:"size",style:e8.ST,items:sF.size,value:k,onValueChange:b})]})]})}function TextStylePickerSet({styles:c}){let u=useTranslation(),f=useStyleChangeCallback(),g=c.get(e8.Y8),b=c.get(e8.Xo),v=c.get(e8.HO);return void 0===g&&void 0===b?null:(0,V.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===g?null:(0,V.jsx)(sh,{title:u("style-panel.font"),uiType:"font",style:e8.Y8,items:sF.font,value:g,onValueChange:f}),void 0===b?null:(0,V.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,V.jsx)(sh,{title:u("style-panel.align"),uiType:"align",style:e8.Xo,items:sF.horizontalAlign,value:b,onValueChange:f}),void 0===v?(0,V.jsx)(nq,{title:u("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,V.jsx)(sN,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:e8.HO,items:sF.verticalAlign,value:v,onValueChange:f})]})]})}function GeoStylePickerSet({styles:c}){let u=useStyleChangeCallback(),f=c.get(e8.Zu);return void 0===f?null:(0,V.jsx)(sN,{id:"geo",label:"style-panel.geo",uiType:"geo",style:e8.Zu,items:sF.geo,value:f,onValueChange:u})}function SplineStylePickerSet({styles:c}){let u=useStyleChangeCallback(),f=c.get(e8.t8);return void 0===f?null:(0,V.jsx)(sN,{id:"spline",label:"style-panel.spline",uiType:"spline",style:e8.t8,items:sF.spline,value:f,onValueChange:u})}function ArrowheadStylePickerSet({styles:c}){let u=useStyleChangeCallback(),f=c.get(e8.ZJ),g=c.get(e8.TA);return f&&g?(0,V.jsx)(sL,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:e8.TA,itemsA:sF.arrowheadStart,valueA:g,uiTypeB:"arrowheadEnd",styleB:e8.ZJ,itemsB:sF.arrowheadEnd,valueB:f,onValueChange:u,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function Toast({toast:c}){let{removeToast:u}=useToasts(),f=useTranslation(),g=c.actions&&c.actions.length>0;return(0,V.jsxs)(ow,{onOpenChange:f=>{f||u(c.id)},className:"tlui-toast__container",duration:c.keepOpen?1/0:5e3,children:[c.icon&&(0,V.jsx)("div",{className:"tlui-toast__icon",children:(0,V.jsx)(nW,{icon:c.icon})}),(0,V.jsxs)("div",{className:"tlui-toast__main",children:[(0,V.jsxs)("div",{className:"tlui-toast__content",children:[c.title&&(0,V.jsx)(oE,{className:"tlui-toast__title",children:c.title}),c.description&&(0,V.jsx)(oP,{className:"tlui-toast__description",children:c.description})]}),c.actions&&(0,V.jsxs)("div",{className:"tlui-toast__actions",children:[c.actions.map((c,u)=>(0,V.jsx)(oT,{altText:c.label,asChild:!0,onClick:c.onClick,children:(0,V.jsx)(nq,{className:"warn"===c.type?"tlui-button__warning":"tlui-button__primary",children:c.label})},u)),g&&(0,V.jsx)(o$,{asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:c.closeLabel??f("toast.close")})})]})]}),!g&&(0,V.jsx)(o$,{asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-toast__close",children:c.closeLabel??f("toast.close")})})]})}function _Toasts(){let{toasts:c}=useToasts();return(0,V.jsx)(V.Fragment,{children:c.map(c=>(0,V.jsx)(Toast,{toast:c},c.id))})}let sz=K.memo(_Toasts);function ToastViewport(){let{toasts:c}=useToasts(),[u,f]=K.useState(!1);return(K.useEffect(()=>{let u=!1;return c.length?f(!0):setTimeout(()=>{u||f(!1)},1e3),()=>{u=!0}},[c.length,f]),u)?(0,V.jsx)(ov,{className:"tlui-toast__viewport"}):null}function useOpenMenuCloser(){let c=(0,tt.j)(),u=(0,K.useRef)(!1),f=(0,K.useCallback)(()=>{c.openMenus.length>0&&(c.updateInstanceState({openMenus:[]}),u.current=!0)},[c]),g=(0,K.useCallback)(c=>{u.current&&preventDefault(c),u.current=!1},[]);return{handlePointerDown:f,handleClick:g}}function MobileStylePanel(){let c=(0,tt.j)(),u=useTranslation(),f=useRelevantStyles(),g=f?.styles.get(e8.R_),b=(0,e8.y6)({isDarkMode:c.user.isDarkMode}),v=(g?.type==="shared"?b[g.value]:b.black).solid,x=(0,e5.Hg)("isHandOrEraserToolActive",()=>c.isInAny("hand","zoom","eraser","laser"),[c]),w=(0,K.useCallback)(u=>{u||c.updateInstanceState({isChangingStyle:!1})},[c]),_=useOpenMenuCloser();return(0,V.jsxs)(Popover,{id:"style menu",onOpenChange:w,children:[(0,V.jsx)(PopoverTrigger,{disabled:x,children:(0,V.jsx)(nq,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:x?"var(--color-muted-1)":v},title:u("style-panel.title"),..._,children:(0,V.jsx)(nW,{icon:x?"blob":g?.type==="mixed"?"mixed":"blob"})})}),(0,V.jsx)(PopoverContent,{side:"top",align:"end",children:(0,V.jsx)(StylePanel,{isMobile:!0})})]})}let sG=["select","hand","draw","eraser","text","zoom","laser","highlight"];function ToggleToolLockedButton({activeToolId:c}){let u=(0,tt.j)(),f=useBreakpoint(),g=useTranslation(),b=(0,e5.Hg)("is tool locked",()=>u.instanceState.isToolLocked,[u]);return!c||sG.includes(c)?null:(0,V.jsx)(nq,{title:g("action.toggle-tool-lock"),className:e2("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":f<5}),icon:b?"lock":"unlock",onClick:()=>u.updateInstanceState({isToolLocked:!b}),smallIcon:!0})}let sU=(0,K.memo)(function(){let c=(0,tt.j)(),u=useTranslation(),f=useBreakpoint(),g=K.useRef(void 0),b=useReadonly(),v=useToolbarSchema(),x=v.find(c=>"laser"===c.toolItem.id),w=(0,e5.Hg)("current tool id",()=>c.currentToolId,[c]),_=(0,e5.Hg)("geo",()=>c.sharedStyles.getAsKnownValue(e8.Zu),[c]),getTitle=c=>c.label?`${u(c.label)} ${c.kbd?kbdStr(c.kbd):""}`:"",k=v.find(c=>isActiveTLUiToolItem(c.toolItem,w,_)),{itemsInPanel:E,itemsInDropdown:T,dropdownFirstItem:$}=K.useMemo(()=>{let c;let u=[],b=[],x=Math.min(8,5+f);for(let f=4;f<v.length;f++){let g=v[f];f<x?u.push(g):(g===k&&(c=g),b.push(g))}return c||(g.current||(g.current=b[0]),c=g.current,b.includes(c)||(c=b[0])),g.current=c,b.length<=2&&(u.push(...b),b.length=0),{itemsInPanel:u,itemsInDropdown:b,dropdownFirstItem:c}},[v,k,f]);return(0,V.jsx)("div",{className:"tlui-toolbar",children:(0,V.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,V.jsxs)("div",{className:"tlui-toolbar__left",children:[!b&&(0,V.jsxs)("div",{className:"tlui-toolbar__extras",children:[f<6&&!("hand"===w||"zoom"===w)&&(0,V.jsxs)("div",{className:"tlui-toolbar__extras__controls",children:[(0,V.jsx)(so,{}),(0,V.jsx)(sr,{}),(0,V.jsx)(si,{}),(0,V.jsx)(se,{}),(0,V.jsx)(a9,{})]}),(0,V.jsx)(ToggleToolLockedButton,{activeToolId:w})]}),(0,V.jsxs)("div",{className:e2("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":f<5}),children:[v.slice(0,2).map(({toolItem:c})=>(0,V.jsx)(ToolbarButton,{item:c,title:getTitle(c),isSelected:isActiveTLUiToolItem(c,w,_)},c.id)),b&&x&&(0,V.jsx)(ToolbarButton,{item:x.toolItem,title:getTitle(x.toolItem),isSelected:isActiveTLUiToolItem(x.toolItem,w,_)},x.toolItem.id),!b&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{className:"tlui-toolbar__divider"}),v.slice(2,4).map(({toolItem:c})=>(0,V.jsx)(ToolbarButton,{item:c,title:getTitle(c),isSelected:isActiveTLUiToolItem(c,w,_)},c.id)),(0,V.jsx)("div",{className:"tlui-toolbar__divider"}),E.map(({toolItem:c})=>(0,V.jsx)(ToolbarButton,{item:c,title:getTitle(c),isSelected:isActiveTLUiToolItem(c,w,_)},c.id)),T.length?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ToolbarButton,{item:$.toolItem,title:getTitle($.toolItem),isSelected:isActiveTLUiToolItem($.toolItem,w,_)},$.toolItem.id),(0,V.jsxs)(Root,{id:"toolbar overflow",modal:!1,children:[(0,V.jsx)(Trigger,{children:(0,V.jsx)(nq,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:u("tool-panel.more")})}),(0,V.jsx)(Content,{side:"top",align:"center",children:(0,V.jsx)(sH,{toolbarItems:T})})]})]}):null]})]})]}),f<5&&!b&&(0,V.jsx)("div",{className:"tlui-toolbar__tools",children:(0,V.jsx)(MobileStylePanel,{})})]})})}),sH=(0,e5.j)(function({toolbarItems:c}){let u=useTranslation();return(0,V.jsx)("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:c.map(({toolItem:{id:c,meta:f,kbd:g,label:b,onSelect:v,icon:x}})=>(0,V.jsx)(Item,{className:"tlui-button-grid__button","data-testid":`tools.${c}`,"data-tool":c,"data-geo":f?.geo??"","aria-label":b,onClick:()=>v("toolbar"),title:b?`${u(b)} ${g?kbdStr(g):""}`:"",icon:x},c))})});function ToolbarButton({item:c,title:u,isSelected:f}){return(0,V.jsx)(nq,{className:"tlui-toolbar__tools__button","data-testid":`tools.${c.id}`,"data-tool":c.id,"data-geo":c.meta?.geo??"","aria-label":c.label,title:u,icon:c.icon,"data-state":f?"selected":void 0,onClick:()=>c.onSelect("toolbar"),onTouchStart:u=>{preventDefault(u),c.onSelect("toolbar")}})}let isActiveTLUiToolItem=(c,u,f)=>c.meta?.geo?"geo"===u&&f===c.meta?.geo:u===c.id;function useEditorEvents(){let c=(0,tt.j)(),{addToast:u}=useToasts();(0,K.useEffect)(()=>{function handleMaxShapes({name:c,count:f}){u({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${c} (${f}). Please delete some shapes or move to a different page to continue.`})}return c.addListener("max-shapes",handleMaxShapes),()=>{c.removeListener("max-shapes",handleMaxShapes)}},[c,u])}let sV="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function addEvent(c,u,f,g){c.addEventListener?c.addEventListener(u,f,g):c.attachEvent&&c.attachEvent("on".concat(u),f)}function removeEvent(c,u,f,g){c.removeEventListener?c.removeEventListener(u,f,g):c.detachEvent&&c.detachEvent("on".concat(u),f)}function getMods(c,u){let f=u.slice(0,u.length-1);for(let u=0;u<f.length;u++)f[u]=c[f[u].toLowerCase()];return f}function getKeys(c){"string"!=typeof c&&(c=""),c=c.replace(/\s/g,"");let u=c.split(","),f=u.lastIndexOf("");for(;f>=0;)u[f-1]+=",",u.splice(f,1),f=u.lastIndexOf("");return u}function compareArray(c,u){let f=c.length>=u.length?c:u,g=c.length>=u.length?u:c,b=!0;for(let c=0;c<f.length;c++)-1===g.indexOf(f[c])&&(b=!1);return b}let sW={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":sV?173:189,"=":sV?61:187,";":sV?59:186,"'":222,"[":219,"]":221,"\\":220},sK={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},sZ={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},sY={16:!1,18:!1,17:!1,91:!1},sq={};for(let c=1;c<20;c++)sW["f".concat(c)]=111+c;let sX=[],sJ=null,sQ="all",s0=new Map,code=c=>sW[c.toLowerCase()]||sK[c.toLowerCase()]||c.toUpperCase().charCodeAt(0),getKey=c=>Object.keys(sW).find(u=>sW[u]===c),getModifier=c=>Object.keys(sK).find(u=>sK[u]===c);function setScope(c){sQ=c||"all"}function getScope(){return sQ||"all"}function getPressedKeyCodes(){return sX.slice(0)}function getPressedKeyString(){return sX.map(c=>getKey(c)||getModifier(c)||String.fromCharCode(c))}function getAllKeyCodes(){let c=[];return Object.keys(sq).forEach(u=>{sq[u].forEach(u=>{let{key:f,scope:g,mods:b,shortcut:v}=u;c.push({scope:g,shortcut:v,mods:b,keys:f.split("+").map(c=>code(c))})})}),c}function filter(c){let u=c.target||c.srcElement,{tagName:f}=u,g=!0,b="INPUT"===f&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(u.type);return(u.isContentEditable||(b||"TEXTAREA"===f||"SELECT"===f)&&!u.readOnly)&&(g=!1),g}function isPressed(c){return"string"==typeof c&&(c=code(c)),-1!==sX.indexOf(c)}function deleteScope(c,u){let f,g;for(let u in c||(c=getScope()),sq)if(Object.prototype.hasOwnProperty.call(sq,u))for(g=0,f=sq[u];g<f.length;)if(f[g].scope===c){let c=f.splice(g,1);c.forEach(c=>{let{element:u}=c;return removeKeyEvent(u)})}else g++;getScope()===c&&setScope(u||"all")}function clearModifier(c){let u=c.keyCode||c.which||c.charCode,f=sX.indexOf(u);if(f>=0&&sX.splice(f,1),c.key&&"meta"===c.key.toLowerCase()&&sX.splice(0,sX.length),(93===u||224===u)&&(u=91),u in sY)for(let c in sY[u]=!1,sK)sK[c]===u&&(hotkeys[c]=!1)}function unbind(c){if(void 0===c)Object.keys(sq).forEach(c=>{Array.isArray(sq[c])&&sq[c].forEach(c=>eachUnbind(c)),delete sq[c]}),removeKeyEvent(null);else if(Array.isArray(c))c.forEach(c=>{c.key&&eachUnbind(c)});else if("object"==typeof c)c.key&&eachUnbind(c);else if("string"==typeof c){for(var u=arguments.length,f=Array(u>1?u-1:0),g=1;g<u;g++)f[g-1]=arguments[g];let[b,v]=f;"function"==typeof b&&(v=b,b=""),eachUnbind({key:c,scope:b,method:v,splitKey:"+"})}}let eachUnbind=c=>{let{key:u,scope:f,method:g,splitKey:b="+"}=c,v=getKeys(u);v.forEach(c=>{let u=c.split(b),v=u.length,x=u[v-1],w="*"===x?"*":code(x);if(!sq[w])return;f||(f=getScope());let _=v>1?getMods(sK,u):[],k=[];sq[w]=sq[w].filter(c=>{let u=!g||c.method===g,b=u&&c.scope===f&&compareArray(c.mods,_);return b&&k.push(c.element),!b}),k.forEach(c=>removeKeyEvent(c))})};function eventHandler(c,u,f,g){let b;if(u.element===g&&(u.scope===f||"all"===u.scope)){for(let c in b=u.mods.length>0,sY)Object.prototype.hasOwnProperty.call(sY,c)&&(!sY[c]&&u.mods.indexOf(+c)>-1||sY[c]&&-1===u.mods.indexOf(+c))&&(b=!1);(0!==u.mods.length||sY[16]||sY[18]||sY[17]||sY[91])&&!b&&"*"!==u.shortcut||(u.keys=[],u.keys=u.keys.concat(sX),!1===u.method(c,u)&&(c.preventDefault?c.preventDefault():c.returnValue=!1,c.stopPropagation&&c.stopPropagation(),c.cancelBubble&&(c.cancelBubble=!0)))}}function dispatch(c,u){let f=sq["*"],g=c.keyCode||c.which||c.charCode;if(!hotkeys.filter.call(this,c))return;if((93===g||224===g)&&(g=91),-1===sX.indexOf(g)&&229!==g&&sX.push(g),["ctrlKey","altKey","shiftKey","metaKey"].forEach(u=>{let f=sZ[u];c[u]&&-1===sX.indexOf(f)?sX.push(f):!c[u]&&sX.indexOf(f)>-1?sX.splice(sX.indexOf(f),1):"metaKey"===u&&c[u]&&3===sX.length&&!(c.ctrlKey||c.shiftKey||c.altKey)&&(sX=sX.slice(sX.indexOf(f)))}),g in sY){for(let c in sY[g]=!0,sK)sK[c]===g&&(hotkeys[c]=!0);if(!f)return}for(let u in sY)Object.prototype.hasOwnProperty.call(sY,u)&&(sY[u]=c[sZ[u]]);c.getModifierState&&!(c.altKey&&!c.ctrlKey)&&c.getModifierState("AltGraph")&&(-1===sX.indexOf(17)&&sX.push(17),-1===sX.indexOf(18)&&sX.push(18),sY[17]=!0,sY[18]=!0);let b=getScope();if(f)for(let g=0;g<f.length;g++)f[g].scope===b&&("keydown"===c.type&&f[g].keydown||"keyup"===c.type&&f[g].keyup)&&eventHandler(c,f[g],b,u);if(!(g in sq))return;let v=sq[g],x=v.length;for(let f=0;f<x;f++)if(("keydown"===c.type&&v[f].keydown||"keyup"===c.type&&v[f].keyup)&&v[f].key){let g=v[f],{splitKey:x}=g,w=g.key.split(x),_=[];for(let c=0;c<w.length;c++)_.push(code(w[c]));_.sort().join("")===sX.sort().join("")&&eventHandler(c,g,b,u)}}function hotkeys(c,u,f){sX=[];let g=getKeys(c),b=[],v="all",x=document,w=0,_=!1,k=!0,E="+",T=!1,$=!1;for(void 0===f&&"function"==typeof u&&(f=u),"[object Object]"===Object.prototype.toString.call(u)&&(u.scope&&(v=u.scope),u.element&&(x=u.element),u.keyup&&(_=u.keyup),void 0!==u.keydown&&(k=u.keydown),void 0!==u.capture&&(T=u.capture),"string"==typeof u.splitKey&&(E=u.splitKey),!0===u.single&&($=!0)),"string"==typeof u&&(v=u),$&&unbind(c,v);w<g.length;w++)c=g[w].split(E),b=[],c.length>1&&(b=getMods(sK,c)),(c="*"===(c=c[c.length-1])?"*":code(c))in sq||(sq[c]=[]),sq[c].push({keyup:_,keydown:k,scope:v,mods:b,shortcut:g[w],method:f,key:g[w],splitKey:E,element:x});if(void 0!==x&&window){if(!s0.has(x)){let keydownListener=function(){let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;return dispatch(c,x)},keyupListenr=function(){let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;dispatch(c,x),clearModifier(c)};s0.set(x,{keydownListener,keyupListenr,capture:T}),addEvent(x,"keydown",keydownListener,T),addEvent(x,"keyup",keyupListenr,T)}if(!sJ){let listener=()=>{sX=[]};sJ={listener,capture:T},addEvent(window,"focus",listener,T)}}}function trigger(c){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(sq).forEach(f=>{let g=sq[f].filter(f=>f.scope===u&&f.shortcut===c);g.forEach(c=>{c&&c.method&&c.method()})})}function removeKeyEvent(c){let u=Object.values(sq).flat(),f=u.findIndex(u=>{let{element:f}=u;return f===c});if(f<0){let{keydownListener:u,keyupListenr:f,capture:g}=s0.get(c)||{};u&&f&&(removeEvent(c,"keyup",f,g),removeEvent(c,"keydown",u,g),s0.delete(c))}if(u.length<=0||s0.size<=0){let c=Object.keys(s0);if(c.forEach(c=>{let{keydownListener:u,keyupListenr:f,capture:g}=s0.get(c)||{};u&&f&&(removeEvent(c,"keyup",f,g),removeEvent(c,"keydown",u,g),s0.delete(c))}),s0.clear(),Object.keys(sq).forEach(c=>delete sq[c]),sJ){let{listener:c,capture:u}=sJ;removeEvent(window,"focus",c,u),sJ=null}}}let s1={getPressedKeyString,setScope,getScope,deleteScope,getPressedKeyCodes,getAllKeyCodes,isPressed,filter,trigger,unbind,keyMap:sW,modifier:sK,modifierMap:sZ};for(let c in s1)Object.prototype.hasOwnProperty.call(s1,c)&&(hotkeys[c]=s1[c]);if("undefined"!=typeof window){let c=window.hotkeys;hotkeys.noConflict=u=>(u&&window.hotkeys===hotkeys&&(window.hotkeys=c),hotkeys),window.hotkeys=hotkeys}let s2=["copy","cut","paste","asset"];function useKeyboardShortcuts(){let c=(0,tt.j)(),u=useReadonly(),f=useActions(),g=useTools(),b=(0,e5.Hg)("is focused",()=>c.instanceState.isFocused,[c]);(0,K.useEffect)(()=>{if(!b)return;let v=c.getContainer();hotkeys.setScope(c.store.id);let hot=(u,f)=>{hotkeys(u,{element:v,scope:c.store.id},f)},areShortcutsDisabled=()=>c.isMenuOpen||null!==c.editingShapeId||c.crashingError;for(let c of Object.values(f))c.kbd&&(!u||c.readonlyOk)&&(s2.includes(c.id)||hot(getHotkeysStringFromKbd(c.kbd),u=>{areShortcutsDisabled()||(preventDefault(u),c.onSelect("kbd"))}));for(let u of Object.values(g))u.kbd&&(u.readonlyOk||!c.instanceState.isReadonly)&&(s2.includes(u.id)||hot(getHotkeysStringFromKbd(u.kbd),c=>{areShortcutsDisabled()||(preventDefault(c),u.onSelect("kbd"))}));return()=>{hotkeys.deleteScope(c.store.id)}},[f,g,u,c,b])}function getHotkeysStringFromKbd(c){return useKeyboardShortcuts_getKeys(c).map(c=>{let u=c.split("");return 1===u.length?u[0]:"!"===u[0]?`shift+${u[1]}`:"?"===u[0]?3===u.length&&"!"===u[1]?`alt+shift+${u[2]}`:`alt+${u[1]}`:"$"===u[0]?"!"===u[1]?`cmd+shift+${u[2]},ctrl+shift+${u[2]}`:"?"===u[1]?`cmd+\u2325+${u[2]},ctrl+alt+${u[2]}`:`cmd+${u[1]},ctrl+${u[1]}`:c}).join(",")}function useKeyboardShortcuts_getKeys(c){"string"!=typeof c&&(c=""),c=c.replace(/\s/g,"");let u=c.split(","),f=u.lastIndexOf("");for(;f>=0;)u[f-1]+=",",u.splice(f,1),f=u.lastIndexOf("");return u}let s5=K.memo(function({shareZone:c,topZone:u,renderDebugMenuItems:f,children:g,hideUi:b,...v}){return(0,V.jsx)(TldrawUiContextProvider,{...v,children:(0,V.jsx)(s3,{hideUi:b,shareZone:c,topZone:u,renderDebugMenuItems:f,children:g})})}),s3=K.memo(function({children:c,hideUi:u,...f}){return(0,V.jsxs)(V.Fragment,{children:[c,u?null:(0,V.jsx)(s8,{...f})]})}),s8=K.memo(function({shareZone:c,topZone:u,renderDebugMenuItems:f}){let g=(0,tt.j)(),b=useTranslation(),v=useBreakpoint(),x=(0,e5.Hg)("isReadonlyMode",()=>g.instanceState.isReadonly,[g]),w=(0,e5.Hg)("focus",()=>g.instanceState.isFocusMode,[g]),_=(0,e5.Hg)("debug",()=>g.instanceState.isDebugMode,[g]);useKeyboardShortcuts(),useNativeClipboardEvents(),useEditorEvents();let{"toggle-focus-mode":k}=useActions();return(0,V.jsx)($054eb8030ebde76e$export$f5d03d415824e0e,{children:(0,V.jsxs)("div",{className:e2("tlui-layout",{"tlui-layout__mobile":v<5}),"data-breakpoint":v,children:[w?(0,V.jsx)("div",{className:"tlui-layout__top",children:(0,V.jsx)(nq,{className:"tlui-focus-button",title:`${b("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>k.onSelect("menu")})}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("div",{className:"tlui-layout__top",children:[(0,V.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,V.jsx)(sa,{}),(0,V.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,V.jsx)(sc,{}),(0,V.jsx)(BackToContent,{}),(0,V.jsx)(su,{})]})]}),(0,V.jsx)("div",{className:"tlui-layout__top__center",children:u}),(0,V.jsxs)("div",{className:"tlui-layout__top__right",children:[c,v>=5&&!x&&(0,V.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,V.jsx)(StylePanel,{})})]})]}),(0,V.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,V.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,V.jsx)(sl,{}),(0,V.jsx)(sU,{}),v>=4&&(0,V.jsx)(as,{})]}),_&&(0,V.jsx)(an,{renderDebugMenuItems:f??null})]})]}),(0,V.jsx)(sz,{}),(0,V.jsx)(aa,{}),(0,V.jsx)(ToastViewport,{}),(0,V.jsx)(FollowingIndicator,{})]})})}),s4="ContextMenu",[s6,s7]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(s4,[rD]),s9=rD(),[le,lt]=s6(s4),ln=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,disabled:g=!1,...b}=c,v=lt("ContextMenuTrigger",f),x=s9(f),w=(0,K.useRef)({x:0,y:0}),_=(0,K.useRef)({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...w.current})}),k=(0,K.useRef)(0),E=(0,K.useCallback)(()=>window.clearTimeout(k.current),[]),handleOpen=c=>{w.current={x:c.clientX,y:c.clientY},v.onOpenChange(!0)};return(0,K.useEffect)(()=>E,[E]),(0,K.useEffect)(()=>void(g&&E()),[g,E]),(0,K.createElement)(K.Fragment,null,(0,K.createElement)(rU,_extends({},x,{virtualRef:_})),(0,K.createElement)(en.span,_extends({"data-state":v.open?"open":"closed","data-disabled":g?"":void 0},b,{ref:u,style:{WebkitTouchCallout:"none",...c.style},onContextMenu:g?c.onContextMenu:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onContextMenu,c=>{E(),handleOpen(c),c.preventDefault()}),onPointerDown:g?c.onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerDown,$1b0217ee4a91d156$var$whenTouchOrPen(c=>{E(),k.current=window.setTimeout(()=>handleOpen(c),700)})),onPointerMove:g?c.onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerMove,$1b0217ee4a91d156$var$whenTouchOrPen(E)),onPointerCancel:g?c.onPointerCancel:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerCancel,$1b0217ee4a91d156$var$whenTouchOrPen(E)),onPointerUp:g?c.onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(c.onPointerUp,$1b0217ee4a91d156$var$whenTouchOrPen(E))})))}),lr=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=lt("ContextMenuContent",f),v=s9(f),x=(0,K.useRef)(!1);return(0,K.createElement)(rq,_extends({},v,g,{ref:u,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:u=>{var f;null===(f=c.onCloseAutoFocus)||void 0===f||f.call(c,u),!u.defaultPrevented&&x.current&&u.preventDefault(),x.current=!1},onInteractOutside:u=>{var f;null===(f=c.onInteractOutside)||void 0===f||f.call(c,u),u.defaultPrevented||b.modal||(x.current=!0)},style:{...c.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),lo=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=s9(f);return(0,K.createElement)(r0,_extends({},b,g,{ref:u}))}),la=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=s9(f);return(0,K.createElement)(r5,_extends({},b,g,{ref:u}))}),ls=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=s9(f);return(0,K.createElement)(r8,_extends({},b,g,{ref:u}))}),ll=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=s9(f);return(0,K.createElement)(is,_extends({},b,g,{ref:u}))}),lc=(0,K.forwardRef)((c,u)=>{let{__scopeContextMenu:f,...g}=c,b=s9(f);return(0,K.createElement)(il,_extends({},b,g,{ref:u,style:{...c.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function $1b0217ee4a91d156$var$whenTouchOrPen(c){return u=>"mouse"!==u.pointerType?c(u):void 0}let $1b0217ee4a91d156$export$be92b6f5f03c0fe9=c=>{let{__scopeContextMenu:u,children:f,onOpenChange:g,dir:b,modal:v=!0}=c,[x,w]=(0,K.useState)(!1),_=s9(u),k=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g),E=(0,K.useCallback)(c=>{w(c),k(c)},[k]);return(0,K.createElement)(le,{scope:u,open:x,onOpenChange:E,modal:v},(0,K.createElement)($6cc32821e9371a1c$export$be92b6f5f03c0fe9,_extends({},_,{dir:b,open:x,onOpenChange:E,modal:v}),f))},$1b0217ee4a91d156$export$602eac185826482c=c=>{let{__scopeContextMenu:u,...f}=c,g=s9(u);return(0,K.createElement)($6cc32821e9371a1c$export$602eac185826482c,_extends({},g,f))},$1b0217ee4a91d156$export$d7a01e11500dfb6f=c=>{let{__scopeContextMenu:u,children:f,onOpenChange:g,open:b,defaultOpen:v}=c,x=s9(u),[w,_]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:b,defaultProp:v,onChange:g});return(0,K.createElement)($6cc32821e9371a1c$export$d7a01e11500dfb6f,_extends({},x,{open:w,onOpenChange:_}),f)},lu=(0,e5.j)(function(){let c=(0,tt.j)(),u=useContainer(),f=c.pages,g=c.currentPageId,b=useTranslation(),{addToast:v}=useToasts();return(0,V.jsxs)($1b0217ee4a91d156$export$d7a01e11500dfb6f,{children:[(0,V.jsx)(ll,{dir:"ltr",asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,V.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:u,dir:"ltr",children:(0,V.jsxs)(lc,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,V.jsx)(lo,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:f.map(u=>(0,V.jsx)(la,{disabled:g===u.id,onSelect:()=>{c.mark("move_shapes_to_page"),c.moveShapesToPage(c.selectedShapeIds,u.id);let f=c.getPage(u.id);f&&v({title:"Changed Page",description:`Moved to ${f.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{c.mark("change-page"),c.setCurrentPage(g)}}]})},asChild:!0,children:(0,V.jsx)(nq,{title:u.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:(0,V.jsx)("span",{children:u.name})})},u.id))},"pages"),(0,V.jsx)(lo,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,V.jsx)(la,{onSelect:()=>{let u=e8.ez.createId(),f=c.selectedShapeIds;c.batch(()=>{c.mark("move_shapes_to_page"),c.createPage({name:"Page",id:u}),c.moveShapesToPage(f,u)})},asChild:!0,children:(0,V.jsx)(nq,{title:b("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:b("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),ContextMenu=function({children:c}){let u=(0,tt.j)(),f=useContextMenuSchema(),g=(0,K.useCallback)(c=>{if(c){if(u.instanceState.isCoarsePointer){let{selectedShapes:c,inputs:{currentPagePoint:f}}=u,g=u.getShapesAtPoint(f);if(!u.selectedShapes.length||!g.some(u=>c.includes(u))){let c=g.filter(c=>u.isShapeOrAncestorLocked(c));c.length&&u.select(...c.map(c=>c.id))}}}else{let{onlySelectedShape:c}=u;c&&u.isShapeOrAncestorLocked(c)&&u.setSelectedShapes([])}},[u]),b=useContainer(),[v,x]=useMenuIsOpen("context menu",g),w=useReadonly(),_=0===f.length||w&&f.every(c=>!c.readonlyOk),k=(0,e5.Hg)("isSelectToolActive",()=>"select"===u.currentToolId,[u]),E=!k||_;return(0,V.jsxs)($1b0217ee4a91d156$export$be92b6f5f03c0fe9,{dir:"ltr",onOpenChange:x,children:[(0,V.jsx)(ln,{onContextMenu:E?preventDefault:void 0,dir:"ltr",disabled:E,children:c}),(0,V.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:b,children:(0,V.jsx)(ContextMenuContent,{})})]})};function ContextMenuContent(){let c=(0,tt.j)(),u=useTranslation(),f=useContextMenuSchema(),[g,b]=useMenuIsOpen("context menu sub"),v=useReadonly(),x=useBreakpoint(),w=useContainer(),[_,k]=(0,K.useState)(!1);function getContextMenuItem(c,f,g,E){if(v&&!f.readonlyOk)return null;switch(f.type){case"custom":if("MOVE_TO_PAGE_MENU"===f.id)return(0,V.jsx)(lu,{},f.id);break;case"group":return(0,V.jsx)(lo,{dir:"ltr",className:e2("tlui-menu__group",{"tlui-menu__group__small":g?.type==="submenu"}),"data-testid":`menu-item.${f.id}`,children:f.children.map(u=>getContextMenuItem(c,u,f,E+1))},f.id);case"submenu":return(0,V.jsxs)($1b0217ee4a91d156$export$d7a01e11500dfb6f,{onOpenChange:b,children:[(0,V.jsx)(ll,{dir:"ltr",disabled:f.disabled,asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button",label:f.label,"data-testid":`menu-item.${f.id}`,icon:"chevron-right"})}),(0,V.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:w,dir:"ltr",children:(0,V.jsx)(lc,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:f.children.map(u=>getContextMenuItem(c,u,f,E+1))})})]},f.id);case"item":{if(v&&!f.readonlyOk)return null;let{id:c,checkbox:g,contextMenuLabel:b,label:w,onSelect:T,kbd:$,icon:I}=f.actionItem,M=b??w,j=M?u(M):void 0;if(g)return(0,V.jsxs)(ls,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:f.disabled,onSelect:c=>{T("context-menu"),preventDefault(c)},title:j||void 0,checked:f.checked,children:[(0,V.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${f.checked?1:.5})`,opacity:f.checked?1:.5},children:(0,V.jsx)(nW,{small:!0,icon:f.checked?"check":"checkbox-empty"})}),j&&(0,V.jsx)("span",{children:j}),$&&(0,V.jsx)(Kbd,{children:$})]},c);return(0,V.jsx)(la,{dir:"ltr",asChild:!0,children:(0,V.jsx)(nq,{className:"tlui-menu__button","data-testid":`menu-item.${c}`,kbd:$,label:M,disabled:f.disabled,iconLeft:x<3&&E>2?I:void 0,onClick:()=>{_?k(!1):T("context-menu")}})},c)}}}return(0,V.jsx)($1b0217ee4a91d156$export$602eac185826482c,{dir:"ltr",container:w,children:(0,V.jsx)(lr,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:preventDefault,children:f.map(u=>getContextMenuItem(c,u,null,0))})})}var ld=((E=ld||{})[E.SUCCESS=0]="SUCCESS",E[E.FAILED=1]="FAILED",E[E.WAITING=2]="WAITING",E);let usePreloadFont=(c,u)=>{let[f,g]=(0,K.useState)(2);return(0,K.useEffect)(()=>{let{url:f,style:b="normal",weight:v="500",display:x,featureSettings:w,stretch:_,unicodeRange:k,variant:E}=u,T=!1;g(2);let $=new FontFace(c,`url(${f})`,{style:b,weight:v,display:x,featureSettings:w,stretch:_,unicodeRange:k,variant:E});return $.load().then(()=>{T||(document.fonts.add($),g(0))}).catch(c=>{T||(console.error(c),g(1))}),$.$$_url=f,$.$$_fontface=`
@font-face {
	font-family: ${$.family};
	font-stretch: ${$.stretch};
	font-weight: ${$.weight};
	font-style: ${$.style};
	src: url("${f}") format("woff2")
}`,()=>{document.fonts.delete($),T=!0}},[c,u]),f};function getTypefaces(c){return{draw:{url:c.fonts.draw},serif:{url:c.fonts.serif},sansSerif:{url:c.fonts.sansSerif},monospace:{url:c.fonts.monospace}}}function usePreloadAssets(c){let u=(0,K.useMemo)(()=>getTypefaces(c),[c]),f=[usePreloadFont("tldraw_draw",u.draw),usePreloadFont("tldraw_serif",u.serif),usePreloadFont("tldraw_sans",u.sansSerif),usePreloadFont("tldraw_mono",u.monospace)];return{error:f.some(c=>1===c),done:!f.some(c=>2===c)}}function Tldraw(c){let{children:u,maxImageDimension:f,maxAssetSize:g,acceptedImageMimeTypes:b,acceptedVideoMimeTypes:v,onMount:x,...w}=c,_={initialState:"select",...w,components:(0,K.useMemo)(()=>({Scribble:TldrawScribble,CollaboratorScribble:TldrawScribble,SelectionForeground:i$,SelectionBackground:TldrawSelectionBackground,Handles:TldrawHandles,HoveredShapeIndicator:TldrawHoveredShapeIndicator,...w.components}),[w.components]),shapeUtils:(0,K.useMemo)(()=>[...oe,...w.shapeUtils??[]],[w.shapeUtils]),tools:(0,K.useMemo)(()=>[...oa,...iG,...w.tools??[]],[w.tools])},k=useDefaultEditorAssetsWithOverrides(w.assetUrls),{done:E,error:T}=usePreloadAssets(k);return T?(0,V.jsx)(ErrorScreen,{children:"Could not load assets. Please refresh the page."}):E?(0,V.jsx)(np,{..._,children:(0,V.jsxs)(s5,{..._,children:[(0,V.jsx)(ContextMenu,{children:(0,V.jsx)(Canvas,{})}),(0,V.jsx)(InsideOfEditorContext,{maxImageDimension:f,maxAssetSize:g,acceptedImageMimeTypes:b,acceptedVideoMimeTypes:v,onMount:x}),u]})}):(0,V.jsx)(LoadingScreen,{children:"Loading assets..."})}function InsideOfEditorContext({maxImageDimension:c=1e3,maxAssetSize:u=10485760,acceptedImageMimeTypes:f=["image/jpeg","image/png","image/gif","image/svg+xml"],acceptedVideoMimeTypes:g=["video/mp4","video/quicktime"],onMount:b}){let v=(0,tt.j)(),x=Tldraw_useEvent(v=>{let x=[];return x.push(...registerDefaultSideEffects(v)),registerDefaultExternalContentHandlers(v,{maxImageDimension:c,maxAssetSize:u,acceptedImageMimeTypes:f,acceptedVideoMimeTypes:g}),x.push(b?.(v)),()=>{x.forEach(c=>c?.())}});return(0,K.useLayoutEffect)(()=>{if(v)return x?.(v)},[v,x]),null}function Tldraw_useEvent(c){let u=(0,K.useRef)();return(0,K.useLayoutEffect)(()=>{u.current=c}),(0,K.useDebugValue)(c),(0,K.useCallback)((...c)=>{let f=u.current;return(0,e4.hu)(f,"fn does not exist"),f(...c)},[])}function OfflineIndicator(){let c=useTranslation(),u=(0,K.useRef)(null);return(0,V.jsxs)("div",{className:e2("tlui-offline-indicator"),ref:u,children:[c("status.offline"),(0,V.jsx)(nW,{"aria-label":"offline",icon:"status-offline",small:!0})]})}function buildFromV1Document(c,u){c.batch(()=>{u=migrate(u,15.5),c.cancel().cancel().cancel().cancel();let f=c.pages[0].id;for(let u of(c.setCurrentPage(f),c.pages.slice(1)))c.deletePage(u.id);c.selectAll(),c.deleteShapes(c.selectedShapeIds);let g=new Map;Object.values(u.assets??{}).forEach(u=>{switch(u.type){case"image":{let f=e8.Yk.createId();g.set(u.id,f);let b={id:f,typeName:"asset",type:"image",props:{w:coerceDimension(u.size[0]),h:coerceDimension(u.size[1]),name:u.fileName??"Untitled",isAnimated:!1,mimeType:null,src:u.src},meta:{}};c.createAssets([b]),tryMigrateAsset(c,b);break}case"video":{let f=e8.Yk.createId();g.set(u.id,f),c.createAssets([{id:f,typeName:"asset",type:"video",props:{w:coerceDimension(u.size[0]),h:coerceDimension(u.size[1]),name:u.fileName??"Untitled",isAnimated:!0,mimeType:null,src:u.src},meta:{}}])}}});let b=new Map;Object.values(u.pages??{}).sort((c,u)=>(c.childIndex??1)<(u.childIndex??1)?-1:1).forEach((u,f)=>{if(0===f)b.set(u.id,c.currentPageId);else{let f=e8.ez.createId();b.set(u.id,f),c.createPage({name:u.name??"Page",id:f})}}),Object.values(u.pages??{}).sort((c,u)=>(c.childIndex??1)<(u.childIndex??1)?-1:1).forEach(u=>{c.setCurrentPage(b.get(u.id));let f=new Map,v=new Map,x=Object.values(u.shapes??{}).sort((c,u)=>c.childIndex<u.childIndex?-1:1).slice(0,td.kx);function decideNotToCreateShape(c){f.delete(c.id);let u=v.has(c.parentId);if(u){let u=v.get(c.parentId).filter(u=>u!==c.id);v.set(c.parentId,u)}}x.forEach(c=>{if("group"!==c.type)return;let u=(0,e8.F1)();f.set(c.id,u),v.set(c.id,[])}),x.forEach(x=>{if("group"===x.type)return;let w=(0,e8.F1)();f.set(x.id,w),x.parentId!==u.id&&(v.has(x.parentId)?v.get(x.parentId).push(x.id):console.warn("parent does not exist",x));let _=b.get(u.id),k={id:w,parentId:_,x:coerceNumber(x.point[0]),y:coerceNumber(x.point[1]),rotation:0,isLocked:!!x.isLocked};switch(x.type){case"sticky":c.createShapes([{...k,type:"note",props:{text:x.text??"",color:getV2Color(x.style.color),size:getV2Size(x.style.size),font:getV2Font(x.style.font),align:getV2Align(x.style.textAlign)}}]);break;case"rectangle":{c.createShapes([{...k,type:"geo",props:{geo:"rectangle",w:coerceDimension(x.size[0]),h:coerceDimension(x.size[1]),text:x.label??"",fill:getV2Fill(x.style.isFilled,x.style.color),labelColor:getV2Color(x.style.color),color:getV2Color(x.style.color),size:getV2Size(x.style.size),font:getV2Font(x.style.font),dash:getV2Dash(x.style.dash),align:"middle"}}]);let u=c.getShapePageBounds(k.id);if(c.updateShapes([{id:k.id,type:"geo",props:{text:x.label??""}}]),u.width===u.height){let u=c.getShape(k.id),{growY:f}=u.props,g=coerceDimension(u.props.w),b=coerceDimension(u.props.h),v=g+f/2,x=b+f/2;c.updateShapes([{id:k.id,type:"geo",x:coerceNumber(u.x)-(v-g)/2,y:coerceNumber(u.y)-(x-b)/2,props:{w:v,h:x}}])}break}case"triangle":{c.createShapes([{...k,type:"geo",props:{geo:"triangle",w:coerceDimension(x.size[0]),h:coerceDimension(x.size[1]),fill:getV2Fill(x.style.isFilled,x.style.color),labelColor:getV2Color(x.style.color),color:getV2Color(x.style.color),size:getV2Size(x.style.size),font:getV2Font(x.style.font),dash:getV2Dash(x.style.dash),align:"middle"}}]);let u=c.getShapePageBounds(k.id);if(c.updateShapes([{id:k.id,type:"geo",props:{text:x.label??""}}]),u.width===u.height){let u=c.getShape(k.id),{growY:f}=u.props,g=coerceDimension(u.props.w),b=coerceDimension(u.props.h),v=g+f/2,x=b+f/2;c.updateShapes([{id:k.id,type:"geo",x:coerceNumber(u.x)-(v-g)/2,y:coerceNumber(u.y)-(x-b)/2,props:{w:v,h:x}}])}break}case"ellipse":{c.createShapes([{...k,type:"geo",props:{geo:"ellipse",w:2*coerceDimension(x.radius[0]),h:2*coerceDimension(x.radius[1]),fill:getV2Fill(x.style.isFilled,x.style.color),labelColor:getV2Color(x.style.color),color:getV2Color(x.style.color),size:getV2Size(x.style.size),font:getV2Font(x.style.font),dash:getV2Dash(x.style.dash),align:"middle"}}]);let u=c.getShapePageBounds(k.id);if(c.updateShapes([{id:k.id,type:"geo",props:{text:x.label??""}}]),u.width===u.height){let u=c.getShape(k.id),{growY:f}=u.props,g=coerceDimension(u.props.w),b=coerceDimension(u.props.h),v=g+f/2,x=b+f/2;c.updateShapes([{id:k.id,type:"geo",x:coerceNumber(u.x)-(v-g)/2,y:coerceNumber(u.y)-(x-b)/2,props:{w:v,h:x}}])}break}case"draw":if(0===x.points.length){decideNotToCreateShape(x);break}c.createShapes([{...k,type:"draw",props:{fill:getV2Fill(x.style.isFilled,x.style.color),color:getV2Color(x.style.color),size:getV2Size(x.style.size),dash:getV2Dash(x.style.dash),isPen:!1,isComplete:x.isComplete,segments:[{type:"free",points:x.points.map(getV2Point)}]}}]);break;case"arrow":{let u=coerceNumber(x.bend),f=getV2Point(x.handles.start.point),g=getV2Point(x.handles.end.point),b=tl.G.Dist(f,g);c.createShapes([{...k,type:"arrow",props:{text:x.label??"",color:getV2Color(x.style.color),labelColor:getV2Color(x.style.color),size:getV2Size(x.style.size),font:getV2Font(x.style.font),dash:getV2Dash(x.style.dash),arrowheadStart:getV2Arrowhead(x.decorations?.start),arrowheadEnd:getV2Arrowhead(x.decorations?.end),start:{type:"point",x:coerceNumber(x.handles.start.point[0]),y:coerceNumber(x.handles.start.point[1])},end:{type:"point",x:coerceNumber(x.handles.end.point[0]),y:coerceNumber(x.handles.end.point[1])},bend:-(b*u)/2}}]);break}case"text":c.createShapes([{...k,type:"text",props:{text:x.text??" ",color:getV2Color(x.style.color),size:getV2TextSize(x.style.size),font:getV2Font(x.style.font),align:getV2Align(x.style.textAlign),scale:x.style.scale??1}}]);break;case"image":{let u=g.get(x.assetId);if(!u){console.warn("Could not find asset id",x.assetId);return}c.createShapes([{...k,type:"image",props:{w:coerceDimension(x.size[0]),h:coerceDimension(x.size[1]),assetId:u}}]);break}case"video":{let u=g.get(x.assetId);if(!u){console.warn("Could not find asset id",x.assetId);return}c.createShapes([{...k,type:"video",props:{w:coerceDimension(x.size[0]),h:coerceDimension(x.size[1]),assetId:u}}])}}let E=coerceNumber(x.rotation);0!==E&&(c.select(w),c.rotateShapesBy([w],E))}),v.forEach((g,b)=>{let v=g.map(c=>f.get(c)),x=f.get(b);c.groupShapes(v,x);let w=u.shapes[b],_=coerceNumber(w.rotation);0!==_&&(c.select(x),c.rotateShapesBy([x],_))}),x.forEach(g=>{if("arrow"!==g.type)return;let b=f.get(g.id),v=c.getShapeUtil("arrow");for(let x of(c.inputs.ctrlKey=!1,["start","end"])){let w=g.handles[x].bindingId;if(w){let g=u.bindings[w];if(!g)continue;let _=f.get(g.toId),k=c.getShape(_);if(!k)continue;if(_){let u=c.getShapePageBounds(_),f=c.getShape(b),w=(0,ts.uZ)((coerceNumber(g.point[0])+.5)/2,.2,.8),k=(0,ts.uZ)((coerceNumber(g.point[1])+.5)/2,.2,.8),E=c.getPointInShapeSpace(f,{x:u.minX+u.width*w,y:u.minY+u.height*k}),T=c.getShapeHandles(f),$=v.onHandleChange(f,{handle:{...T.find(c=>c.id===x),x:E.x,y:E.y},isPrecise:.5!==E.x||.5!==E.y});if($){if($.props?.[x]){let c=$.props?.[x];"binding"===c.type&&(c.isExact=0===g.distance,c.boundShapeId!==_&&(console.warn("Hit the wrong shape!"),c.boundShapeId=_,c.normalizedAnchor={x:.5,y:.5}))}c.updateShapes([$])}}}}})}),c.setCurrentPage(f),c.history.clear(),c.selectNone(),c.updateViewportScreenBounds();let v=c.currentPageBounds;v&&c.zoomToBounds(v,1)})}function coerceNumber(c){return"number"!=typeof c||Number.isNaN(c)||!Number.isFinite(c)?0:c}function coerceDimension(c){let u=coerceNumber(c);return u<=0?1:u}async function tryMigrateAsset(c,u){try{if("bookmark"===u.type||!u.props.src)return;let f=await fetch(u.props.src);if(!f.ok)return;let g=new File([await f.blob()],u.props.name,{type:f.headers.get("content-type")??u.props.mimeType??void 0}),b=await c.getAssetForExternalContent({type:"file",file:g});if(!b)throw Error("Could not get asset for external content");if("bookmark"===b.type)return;c.updateAssets([{id:u.id,type:u.type,props:{...b.props,name:u.props.name}}])}catch(c){}}function migrate(c,u){let{version:f=0}=c;c.assets||(c.assets={});let g=new Set;return Object.values(c.pages).forEach(c=>Object.values(c.shapes).forEach(u=>{let{parentId:f,children:b,assetId:v}=u;v&&g.add(v),f===c.id||c.shapes[f]||(console.warn("Encountered a shape with a missing parent!"),u.parentId=c.id),"group"===u.type&&b&&b.forEach(f=>{c.shapes[f]||(console.warn("Encountered a parent with a missing child!",u.id,f),b?.splice(b.indexOf(f),1))})})),Object.keys(c.assets).forEach(u=>{g.has(u)||delete c.assets[u]}),f!==u&&(f<14&&Object.values(c.pages).forEach(c=>{Object.values(c.shapes).filter(c=>"text"===c.type).forEach(c=>{void 0===c.style.font&&c.style.font})}),f<=13&&Object.values(c.pages).forEach(c=>{Object.values(c.bindings).forEach(c=>{Object.assign(c,c.meta)}),Object.values(c.shapes).forEach(c=>{Object.entries(c.style).forEach(([u,f])=>{"string"==typeof f&&(c.style[u]=f.toLowerCase())}),"arrow"===c.type&&c.decorations&&Object.entries(c.decorations).forEach(([u,f])=>{"Arrow"===f&&(c.decorations={...c.decorations,[u]:"arrow"})})})}),f<=13.1&&null==c.name&&(c.name="New Document"),f<15&&null==c.assets&&(c.assets={}),Object.values(c.pages).forEach(c=>{Object.values(c.shapes).forEach(c=>{f<15.2&&("image"===c.type||"video"===c.type)&&null==c.style.isFilled&&(c.style.isFilled=!0),f<15.3&&("rectangle"===c.type||"triangle"===c.type||"ellipse"===c.type||"arrow"===c.type)&&("text"in c&&"string"==typeof c.text&&(c.label=c.text),c.label||(c.label=""),c.labelPoint||(c.labelPoint=[.5,.5]))})})),Object.values(c.pageStates).forEach(u=>{u.selectedIds=u.selectedIds.filter(f=>void 0!==c.pages[u.id].shapes[f]),u.bindingId=void 0,u.editingId=void 0,u.hoveredId=void 0,u.pointedId=void 0}),c.version=u,c}var lh=((T=lh||{}).Sticky="sticky",T.Ellipse="ellipse",T.Rectangle="rectangle",T.Triangle="triangle",T.Draw="draw",T.Arrow="arrow",T.Text="text",T.Group="group",T.Image="image",T.Video="video",T),lp=(($=lp||{}).White="white",$.LightGray="lightGray",$.Gray="gray",$.Black="black",$.Green="green",$.Cyan="cyan",$.Blue="blue",$.Indigo="indigo",$.Violet="violet",$.Red="red",$.Orange="orange",$.Yellow="yellow",$),lf=((I=lf||{}).Small="small",I.Medium="medium",I.Large="large",I),lg=((M=lg||{}).Draw="draw",M.Solid="solid",M.Dashed="dashed",M.Dotted="dotted",M),lm=((j=lm||{}).Start="start",j.Middle="middle",j.End="end",j.Justify="justify",j),ly=((D=ly||{}).Script="script",D.Sans="sans",D.Serif="serif",D.Mono="mono",D),lb=((L=lb||{}).Arrow="arrow",L),lv=((F=lv||{}).Image="image",F.Video="video",F);let lS={white:"black",black:"black",lightGray:"grey",gray:"grey",green:"light-green",cyan:"green",blue:"light-blue",indigo:"blue",orange:"orange",yellow:"yellow",red:"red",violet:"light-violet"},lx={mono:"mono",sans:"sans",script:"draw",serif:"serif"},lw={start:"start",middle:"middle",end:"end",justify:"start"},l_={small:"s",medium:"l",large:"xl"},lk={small:"m",medium:"l",large:"xl"},lC={solid:"solid",dashed:"dashed",dotted:"dotted",draw:"draw"};function getV2Color(c){return c?lS[c]??"black":"black"}function getV2Font(c){return c?lx[c]??"draw":"draw"}function getV2Align(c){return c?lw[c]??"middle":"middle"}function getV2TextSize(c){return c?l_[c]??"m":"m"}function getV2Size(c){return c?lk[c]??"l":"l"}function getV2Dash(c){return c?lC[c]??"draw":"draw"}function getV2Point(c){return{x:coerceNumber(c[0]),y:coerceNumber(c[1]),z:null==c[2]?.5:coerceNumber(c[2])}}function getV2Arrowhead(c){return"arrow"===c?"arrow":"none"}function getV2Fill(c,u){return c?"black"===u||"white"===u?"semi":"solid":"none"}let lE=".tldr",lP=e6.T.object({tldrawFileFormatVersion:e6.T.nonZeroInteger,schema:e6.T.object({schemaVersion:e6.T.positiveInteger,storeVersion:e6.T.positiveInteger,recordVersions:e6.T.dict(e6.T.string,e6.T.object({version:e6.T.positiveInteger,subTypeVersions:e6.T.dict(e6.T.string,e6.T.positiveInteger).optional(),subTypeKey:e6.T.string.optional()}))}),records:e6.T.arrayOf(e6.T.object({id:e6.T.string,typeName:e6.T.string}).allowUnknownProperties())});function isV1File(c){try{if(c.document?.version)return!0;return!1}catch(c){return!1}}function parseTldrawJsonFile({json:c,schema:u}){let f,g;try{f=lP.validate(JSON.parse(c))}catch(u){try{if(f=JSON.parse(c),isV1File(f))return e4.x4.err({type:"v1File",data:f})}catch(c){}return e4.x4.err({type:"notATldrawFile",cause:u})}if(f.tldrawFileFormatVersion>1)return e4.x4.err({type:"fileFormatVersionTooNew",version:f.tldrawFileFormatVersion});try{let c=Object.fromEntries(f.records.map(c=>[c.id,c]));g=u.migrateStoreSnapshot({store:c,schema:f.schema})}catch(c){return e4.x4.err({type:"invalidRecords",cause:c})}if("error"===g.type)return e4.x4.err({type:"migrationFailed",reason:g.reason});try{return e4.x4.ok(createTLStore({initialData:g.value,schema:u}))}catch(c){return e4.x4.err({type:"invalidRecords",cause:c})}}async function serializeTldrawJson(c){let u=[],f=new Set,g=[];for(let b of c.allRecords())switch(b.typeName){case"asset":if("bookmark"!==b.type&&b.props.src&&!b.props.src.startsWith("data:")){let c;try{c=await e4.P6.fileToBase64(await (await fetch(b.props.src)).blob())}catch{c=b.props.src}g.push({...b,props:{...b.props,src:c}})}else g.push(b);break;case"shape":"assetId"in b.props&&f.add(b.props.assetId),u.push(b);break;default:u.push(b)}let b=u.concat(g.filter(c=>f.has(c.id)));return JSON.stringify({tldrawFileFormatVersion:1,schema:c.schema.serialize(),records:b})}async function serializeTldrawJsonBlob(c){return new Blob([await serializeTldrawJson(c)],{type:"application/vnd.tldraw+json"})}async function parseAndLoadDocument(c,u,f,g,b,v){let x=parseTldrawJsonFile({schema:c.store.schema,json:u});if(!x.ok){let u;switch(x.error.type){case"notATldrawFile":c.annotateError(x.error.cause,{origin:"file-system.open.parse",willCrashApp:!1,tags:{parseErrorType:x.error.type}}),reportError(x.error.cause),u=f("file-system.file-open-error.not-a-tldraw-file");break;case"fileFormatVersionTooNew":u=f("file-system.file-open-error.file-format-version-too-new");break;case"migrationFailed":u=f(x.error.reason===e3.qx.TargetVersionTooNew?"file-system.file-open-error.file-format-version-too-new":"file-system.file-open-error.generic-corrupted-file");break;case"invalidRecords":c.annotateError(x.error.cause,{origin:"file-system.open.parse",willCrashApp:!1,tags:{parseErrorType:x.error.type}}),reportError(x.error.cause),u=f("file-system.file-open-error.generic-corrupted-file");break;case"v1File":buildFromV1Document(c,x.error.data.document),b?.();return;default:(0,e4.iP)(x.error,"type")}g({title:f("file-system.file-open-error.title"),description:u});return}(0,e5.ay)(()=>{c.store.clear();let[u,f]=(0,e4.uK)(x.value.allRecords(),c=>"shape"===c.typeName);c.store.put(f,"initialize"),c.store.ensureStoreIsUsable(),c.store.put(u,"initialize"),c.history.clear(),c.updateViewportScreenBounds(),c.updateRenderingBounds();let g=c.currentPageBounds;g&&c.zoomToBounds(g,1)}),v&&c.user.updateUserPreferences({isDarkMode:!0})}},40563:function(c,u,f){"use strict";f.d(u,{ZJ:function(){return eY},TA:function(){return eZ},Yk:function(){return eM},AN:function(){return E},R_:function(){return eB},qi:function(){return eF},ci:function(){return eG},pp:function(){return eU},p6:function(){return eV},Y8:function(){return eH},Xo:function(){return tl},ST:function(){return eW},HO:function(){return tc},_A:function(){return ev},Lu:function(){return te},$I:function(){return EnumStyleProp},Zu:function(){return tu},iS:function(){return eo},AM:function(){return ef},a2:function(){return tL},t8:function(){return tk},ez:function(){return Y},zh:function(){return ec},fV:function(){return StyleProp},G4:function(){return eS},PQ:function(){return Q},LV:function(){return eu},z:function(){return L},Vm:function(){return e0},si:function(){return eJ},_3:function(){return b},TD:function(){return eA},$A:function(){return e$},h9:function(){return e5},qU:function(){return e1},tF:function(){return $},MN:function(){return F},tL:function(){return createAssetValidator},GP:function(){return createPresenceStateDerivation},F1:function(){return createShapeId},JY:function(){return createShapeValidator},HH:function(){return createTLSchema},_l:function(){return e6},wu:function(){return e8},BF:function(){return to},gB:function(){return tt},DW:function(){return tn},gR:function(){return ts},k7:function(){return ta},P3:function(){return tp},eG:function(){return td},y6:function(){return getDefaultColorTheme},Bz:function(){return getDefaultTranslationLocale},DR:function(){return getShapePropKeysByStyle},c4:function(){return tg},A7:function(){return tf},J1:function(){return ty},VW:function(){return tm},yd:function(){return idValidator},y5:function(){return tx},Fc:function(){return tv},r5:function(){return isPageId},VV:function(){return isShape},YT:function(){return isShapeId},FH:function(){return tP},BG:function(){return tC},C_:function(){return tI},m0:function(){return tT},jm:function(){return D},CF:function(){return U},Mv:function(){return ee},cL:function(){return eR},gw:function(){return G},u5:function(){return et},pL:function(){return tj},XB:function(){return tA},tn:function(){return T},lY:function(){return tD},p$:function(){return tO}});var g=f(45958);function idValidator(c){return g.T.string.refine(u=>{if(!u.startsWith(`${c}:`))throw Error(`${c} ID must start with "${c}:"`);return u})}let b=idValidator("asset");function createAssetValidator(c,u){return g.T.object({id:b,typeName:g.T.literal("asset"),type:g.T.literal(c),props:u,meta:g.T.jsonValue})}var v=f(39957),x=f(83925);let w=g.T.model("camera",g.T.object({typeName:g.T.literal("camera"),id:idValidator("camera"),x:g.T.number,y:g.T.number,z:g.T.number,meta:g.T.jsonValue})),_={AddMeta:1},k=(0,x.zn)({currentVersion:_.AddMeta,migrators:{[_.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}}),E=(0,x.ju)("camera",{validator:w,migrations:k,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),T=g.T.object({x:g.T.number,y:g.T.number,z:g.T.number.optional()}),$=g.T.object({x:g.T.number,y:g.T.number,w:g.T.number,h:g.T.number}),I=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),M=g.T.setEnum(I),j=g.T.object({type:M,rotation:g.T.number}),D=g.T.number.check(c=>{if(c<0||c>1)throw new g.T.ValidationError("Opacity must be between 0 and 1")}),L=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),F=g.T.setEnum(L),B=new Set(["starting","paused","active","stopping"]),G=g.T.object({points:g.T.arrayOf(T),size:g.T.positiveNumber,color:F,opacity:g.T.number,state:g.T.setEnum(B),delay:g.T.number}),U=idValidator("page"),V=g.T.model("page",g.T.object({typeName:g.T.literal("page"),id:U,name:g.T.string,index:g.T.string,meta:g.T.jsonValue})),K={AddMeta:1},Z=(0,x.zn)({currentVersion:K.AddMeta,migrators:{[K.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}}),Y=(0,x.ju)("page",{validator:V,migrations:Z,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function isPageId(c){return Y.isId(c)}function createInstanceRecordType(c){let u={};for(let[f,b]of c)u[f]=g.T.optional(b);let f=g.T.model("instance",g.T.object({typeName:g.T.literal("instance"),id:idValidator("instance"),currentPageId:U,followingUserId:g.T.string.nullable(),brush:$.nullable(),opacityForNextShape:D,stylesForNextShape:g.T.object(u),cursor:j,scribble:G.nullable(),isFocusMode:g.T.boolean,isDebugMode:g.T.boolean,isToolLocked:g.T.boolean,exportBackground:g.T.boolean,screenBounds:$,zoomBrush:$.nullable(),isPenMode:g.T.boolean,isGridMode:g.T.boolean,chatMessage:g.T.string,isChatting:g.T.boolean,highlightedUserIds:g.T.arrayOf(g.T.string),canMoveCamera:g.T.boolean,isFocused:g.T.boolean,devicePixelRatio:g.T.number,isCoarsePointer:g.T.boolean,isHoveringCanvas:g.T.boolean.nullable(),openMenus:g.T.arrayOf(g.T.string),isChangingStyle:g.T.boolean,isReadonly:g.T.boolean,meta:g.T.jsonValue}));return(0,x.ju)("instance",{migrations:J,validator:f,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:"undefined"==typeof window?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{}}))}idValidator("instance");let X={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21},J=(0,x.zn)({currentVersion:X.AddHoveringCanvas,migrators:{[X.AddTransparentExportBgs]:{up:c=>({...c,exportBackground:!0}),down:({exportBackground:c,...u})=>u},[X.RemoveDialog]:{up:({dialog:c,...u})=>u,down:c=>({...c,dialog:null})},[X.AddToolLockMode]:{up:c=>({...c,isToolLocked:!1}),down:({isToolLocked:c,...u})=>u},[X.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:c,...u})=>({...u,propsForNextShape:Object.fromEntries(Object.entries(c).filter(([c])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(c)))}),down:c=>c},[X.AddLabelColor]:{up:({propsForNextShape:c,...u})=>({...u,propsForNextShape:{...c,labelColor:"black"}}),down:c=>{let{labelColor:u,...f}=c.propsForNextShape;return{...c,propsForNextShape:{...f}}}},[X.AddFollowingUserId]:{up:c=>({...c,followingUserId:null}),down:({followingUserId:c,...u})=>u},[X.RemoveAlignJustify]:{up:c=>{let u=c.propsForNextShape.align;return"justify"===u&&(u="start"),{...c,propsForNextShape:{...c.propsForNextShape,align:u}}},down:c=>({...c})},[X.AddZoom]:{up:c=>({...c,zoomBrush:null}),down:({zoomBrush:c,...u})=>u},[X.AddVerticalAlign]:{up:c=>({...c,propsForNextShape:{...c.propsForNextShape,verticalAlign:"middle"}}),down:c=>{let{verticalAlign:u,...f}=c.propsForNextShape;return{...c,propsForNextShape:f}}},[X.AddScribbleDelay]:{up:c=>null!==c.scribble?{...c,scribble:{...c.scribble,delay:0}}:{...c},down:c=>{if(null!==c.scribble){let{delay:u,...f}=c.scribble;return{...c,scribble:f}}return{...c}}},[X.RemoveUserId]:{up:({userId:c,...u})=>u,down:c=>({...c,userId:"user:none"})},[X.AddIsPenModeAndIsGridMode]:{up:c=>({...c,isPenMode:!1,isGridMode:!1}),down:({isPenMode:c,isGridMode:u,...f})=>f},[X.HoistOpacity]:{up:({propsForNextShape:{opacity:c,...u},...f})=>({...f,opacityForNextShape:Number(c??"1"),propsForNextShape:u}),down:({opacityForNextShape:c,...u})=>({...u,propsForNextShape:{...u.propsForNextShape,opacity:c<.175?"0.1":c<.375?"0.25":c<.625?"0.5":c<.875?"0.75":"1"}})},[X.AddChat]:{up:c=>({...c,chatMessage:"",isChatting:!1}),down:({chatMessage:c,isChatting:u,...f})=>f},[X.AddHighlightedUserIds]:{up:c=>({...c,highlightedUserIds:[]}),down:({highlightedUserIds:c,...u})=>u},[X.ReplacePropsForNextShapeWithStylesForNextShape]:{up:({propsForNextShape:c,...u})=>({...u,stylesForNextShape:{}}),down:({stylesForNextShape:c,...u})=>({...u,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})},[X.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})},[X.RemoveCursorColor]:{up:c=>{let{color:u,...f}=c.cursor;return{...c,cursor:f}},down:c=>({...c,cursor:{...c.cursor,color:"black"}})},[X.AddLonelyProperties]:{up:c=>({...c,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1}),down:({canMoveCamera:c,isFocused:u,devicePixelRatio:f,isCoarsePointer:g,openMenus:b,isChangingStyle:v,isReadOnly:x,...w})=>({...w})},[X.ReadOnlyReadonly]:{up:({isReadOnly:c,...u})=>({...u,isReadonly:c}),down:({isReadonly:c,...u})=>({...u,isReadOnly:c})},[X.AddHoveringCanvas]:{up:c=>({...c,isHoveringCanvas:null}),down:({isHoveringCanvas:c,...u})=>({...u})}}}),Q="instance:instance",ee=g.T.string.refine(c=>{if(!c.startsWith("page:")&&!c.startsWith("shape:"))throw Error('Parent ID must start with "page:" or "shape:"');return c}),et=idValidator("shape");function createShapeValidator(c,u,f){return g.T.object({id:et,typeName:g.T.literal("shape"),x:g.T.number,y:g.T.number,rotation:g.T.number,index:g.T.string,parentId:ee,type:g.T.literal(c),isLocked:g.T.boolean,opacity:D,props:u?g.T.object(u):g.T.jsonValue,meta:f?g.T.object(f):g.T.jsonValue})}let en=g.T.model("instance_page_state",g.T.object({typeName:g.T.literal("instance_page_state"),id:idValidator("instance_page_state"),pageId:U,selectedShapeIds:g.T.arrayOf(et),hintingShapeIds:g.T.arrayOf(et),erasingShapeIds:g.T.arrayOf(et),hoveredShapeId:et.nullable(),editingShapeId:et.nullable(),croppingShapeId:et.nullable(),focusedGroupId:et.nullable(),meta:g.T.jsonValue})),er={AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5},ei=(0,x.zn)({currentVersion:er.RenamePropertiesAgain,migrators:{[er.AddCroppingId]:{up:c=>({...c,croppingShapeId:null}),down:({croppingShapeId:c,...u})=>u},[er.RemoveInstanceIdAndCameraId]:{up:({instanceId:c,cameraId:u,...f})=>f,down:c=>({...c,instanceId:Q,cameraId:E.createId("void")})},[er.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})},[er.RenameProperties]:{up:c=>{let{selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w,..._}=c;return{selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w,..._}},down:c=>{let{selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w,..._}=c;return{selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w,..._}}},[er.RenamePropertiesAgain]:{up:c=>{let{selectedIds:u,hintingIds:f,erasingIds:g,hoveredId:b,editingId:v,croppingId:x,focusLayerId:w,..._}=c;return{..._,selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w}},down:c=>{let{selectedShapeIds:u,hintingShapeIds:f,erasingShapeIds:g,hoveredShapeId:b,editingShapeId:v,croppingShapeId:x,focusedGroupId:w,..._}=c;return{..._,selectedIds:u,hintingIds:f,erasingIds:g,hoveredId:b,editingId:v,croppingId:x,focusLayerId:w}}}}}),eo=(0,x.ju)("instance_page_state",{migrations:ei,validator:en,scope:"session"}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),ea=g.T.model("pointer",g.T.object({typeName:g.T.literal("pointer"),id:idValidator("pointer"),x:g.T.number,y:g.T.number,lastActivityTimestamp:g.T.number,meta:g.T.jsonValue})),es={AddMeta:1},el=(0,x.zn)({currentVersion:es.AddMeta,migrators:{[es.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}}),ec=(0,x.ju)("pointer",{validator:ea,migrations:el,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),eu=ec.createId("pointer"),ed=g.T.model("instance_presence",g.T.object({typeName:g.T.literal("instance_presence"),id:idValidator("instance_presence"),userId:g.T.string,userName:g.T.string,lastActivityTimestamp:g.T.number,followingUserId:g.T.string.nullable(),cursor:g.T.object({x:g.T.number,y:g.T.number,type:M,rotation:g.T.number}),color:g.T.string,camera:g.T.object({x:g.T.number,y:g.T.number,z:g.T.number}),screenBounds:$,selectedShapeIds:g.T.arrayOf(idValidator("shape")),currentPageId:idValidator("page"),brush:$.nullable(),scribble:G.nullable(),chatMessage:g.T.string,meta:g.T.jsonValue})),eh={AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5},ep=(0,x.zn)({currentVersion:eh.RenameSelectedShapeIds,migrators:{[eh.AddScribbleDelay]:{up:c=>null!==c.scribble?{...c,scribble:{...c.scribble,delay:0}}:{...c},down:c=>{if(null!==c.scribble){let{delay:u,...f}=c.scribble;return{...c,scribble:f}}return{...c}}},[eh.RemoveInstanceId]:{up:({instanceId:c,...u})=>u,down:c=>({...c,instanceId:Q})},[eh.AddChatMessage]:{up:c=>({...c,chatMessage:""}),down:({chatMessage:c,...u})=>u},[eh.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})},[eh.RenameSelectedShapeIds]:{up:c=>{let{selectedShapeIds:u,...f}=c;return{selectedShapeIds:u,...f}},down:c=>{let{selectedShapeIds:u,...f}=c;return{selectedShapeIds:u,...f}}}}}),ef=(0,x.ju)("instance_presence",{migrations:ep,validator:ed,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribble:null,chatMessage:"",meta:{}})),createPresenceStateDerivation=(c,u)=>f=>(0,v.Fl)("instancePresence",()=>{let g=f.get(Q),b=f.get(eo.createId(g?.currentPageId)),v=f.get(E.createId(g?.currentPageId)),x=f.get(eu),w=c.value;return b&&g&&v&&x&&w?ef.create({id:u??ef.createId(f.id),selectedShapeIds:b.selectedShapeIds,brush:g.brush,scribble:g.scribble,userId:w.id,userName:w.name,followingUserId:g.followingUserId,camera:{x:v.x,y:v.y,z:v.z},color:w.color,currentPageId:g.currentPageId,cursor:{x:x.x,y:x.y,rotation:g.cursor.rotation,type:g.cursor.type},lastActivityTimestamp:x.lastActivityTimestamp,screenBounds:g.screenBounds,chatMessage:g.chatMessage,meta:{}}):null});var eg=f(47110);let em=g.T.model("document",g.T.object({typeName:g.T.literal("document"),id:g.T.literal("document:document"),gridSize:g.T.number,name:g.T.string,meta:g.T.jsonValue})),ey={AddName:1,AddMeta:2},eb=(0,x.zn)({currentVersion:ey.AddMeta,migrators:{[ey.AddName]:{up:c=>({...c,name:""}),down:({name:c,...u})=>u},[ey.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}}),ev=(0,x.ju)("document",{migrations:eb,validator:em,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),eS=ev.createId("document");function sortByIndex(c,u){return c.index<u.index?-1:c.index>u.index?1:0}function redactRecordForErrorReporting(c){"asset"===c.typeName&&("src"in c&&(c.src="<redacted>"),"src"in c.props&&(c.props.src="<redacted>"))}let onValidationFailure=({error:c,phase:u,record:f,recordBefore:g})=>{throw(0,eg.lw)(c,{tags:{origin:"store.validateRecord",storePhase:u,isExistingValidationIssue:"initialize"===u},extras:{recordBefore:g?redactRecordForErrorReporting((0,eg.v4)(g)):void 0,recordAfter:redactRecordForErrorReporting((0,eg.v4)(f))}}),c};function getDefaultPages(){return[Y.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function createIntegrityChecker(c){let u=c.query.ids("page"),ensureStoreIsUsable=()=>{if(!c.has(eS))return c.put([ev.create({id:eS,name:c.props.defaultName})]),ensureStoreIsUsable();if(!c.has(eu))return c.put([ec.create({id:eu})]),ensureStoreIsUsable();let f=u.value;if(0===f.size)return c.put(getDefaultPages()),ensureStoreIsUsable();let g=c.get(Q);if(!g)return c.put([c.schema.types.instance.create({id:Q,currentPageId:[...f].map(u=>c.get(u)).sort(sortByIndex)[0].id,exportBackground:!0})]),ensureStoreIsUsable();if(!f.has(g.currentPageId))return c.put([{...g,currentPageId:[...f].map(u=>c.get(u)).sort(sortByIndex)[0].id}]),ensureStoreIsUsable();let b=new Set,v=new Set;for(let u of f){let f=eo.createId(u);c.has(f)||b.add(f);let g=E.createId(u);c.has(g)||v.add(g)}b.size>0&&c.put([...b].map(c=>eo.create({id:c,pageId:eo.parseId(c)}))),v.size>0&&c.put([...v].map(c=>E.create({id:c})))};return ensureStoreIsUsable}let ex=createAssetValidator("bookmark",g.T.object({title:g.T.string,description:g.T.string,image:g.T.string,src:g.T.string.nullable()})),ew=(0,x.zn)({}),e_=createAssetValidator("image",g.T.object({w:g.T.number,h:g.T.number,name:g.T.string,isAnimated:g.T.boolean,mimeType:g.T.string.nullable(),src:g.T.string.nullable()})),ek={AddIsAnimated:1,RenameWidthHeight:2},eC=(0,x.zn)({currentVersion:ek.RenameWidthHeight,migrators:{[ek.AddIsAnimated]:{up:c=>({...c,props:{...c.props,isAnimated:!1}}),down:c=>{let{isAnimated:u,...f}=c.props;return{...c,props:f}}},[ek.RenameWidthHeight]:{up:c=>{let{width:u,height:f,...g}=c.props;return{...c,props:{w:u,h:f,...g}}},down:c=>{let{w:u,h:f,...g}=c.props;return{...c,props:{width:u,height:f,...g}}}}}}),eE=createAssetValidator("video",g.T.object({w:g.T.number,h:g.T.number,name:g.T.string,isAnimated:g.T.boolean,mimeType:g.T.string.nullable(),src:g.T.string.nullable()})),eP={AddIsAnimated:1,RenameWidthHeight:2},eT=(0,x.zn)({currentVersion:eP.RenameWidthHeight,migrators:{[eP.AddIsAnimated]:{up:c=>({...c,props:{...c.props,isAnimated:!1}}),down:c=>{let{isAnimated:u,...f}=c.props;return{...c,props:f}}},[eP.RenameWidthHeight]:{up:c=>{let{width:u,height:f,...g}=c.props;return{...c,props:{w:u,h:f,...g}}},down:c=>{let{w:u,h:f,...g}=c.props;return{...c,props:{width:u,height:f,...g}}}}}}),e$=g.T.model("asset",g.T.union("type",{image:e_,video:eE,bookmark:ex})),eI={AddMeta:1},eA=(0,x.zn)({subTypeKey:"type",subTypeMigrations:{image:eC,video:eT,bookmark:ew},currentVersion:eI.AddMeta,migrators:{[eI.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}}),eM=(0,x.ju)("asset",{migrations:eA,validator:e$,scope:"document"}).withDefaultProperties(()=>({meta:{}}));var ej=f(37350);let StyleProp=class StyleProp{constructor(c,u,f){this.id=c,this.defaultValue=u,this.type=f}static define(c,u){let{defaultValue:f,type:b=g.T.any}=u;return new StyleProp(c,f,b)}static defineEnum(c,u){let{defaultValue:f,values:g}=u;return new EnumStyleProp(c,f,g)}validate(c){return this.type.validate(c)}};let EnumStyleProp=class EnumStyleProp extends StyleProp{constructor(c,u,f){super(c,u,g.T.literalEnum(...f)),this.values=f}};let eO={AddIsLocked:1,HoistOpacity:2,AddMeta:3},eR=(0,x.zn)({currentVersion:eO.AddMeta,migrators:{[eO.AddIsLocked]:{up:c=>({...c,isLocked:!1}),down:c=>{let{isLocked:u,...f}=c;return{...f}}},[eO.HoistOpacity]:{up:({props:{opacity:c,...u},...f})=>({...f,opacity:Number(c??"1"),props:u}),down:({opacity:c,...u})=>({...u,props:{...u.props,opacity:c<.175?"0.1":c<.375?"0.25":c<.625?"0.5":c<.875?"0.75":"1"}})},[eO.AddMeta]:{up:c=>({...c,meta:{}}),down:({meta:c,...u})=>({...u})}}});function isShape(c){return!!c&&"shape"===c.typeName}function isShapeId(c){return!!c&&c.startsWith("shape:")}function createShapeId(c){return`shape:${c??(0,ej.nanoid)()}`}function getShapePropKeysByStyle(c){let u=new Map;for(let[f,g]of Object.entries(c))if(g instanceof StyleProp){if(u.has(g))throw Error(`Duplicate style prop ${g.id}. Each style prop can only be used once within a shape.`);u.set(g,f)}return u}function createShapeRecordType(c){return(0,x.ju)("shape",{migrations:(0,x.zn)({currentVersion:eR.currentVersion,firstVersion:eR.firstVersion,migrators:eR.migrators,subTypeKey:"type",subTypeMigrations:(0,eg.Fm)(c,(c,u)=>u.migrations??(0,x.zn)({}))}),scope:"document",validator:g.T.model("shape",g.T.union("type",(0,eg.Fm)(c,(c,{props:u,meta:f})=>createShapeValidator(c,u,f))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}let eD={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},eL=(0,x.zn)({currentVersion:eD.RemoveUserDocument,migrators:{[eD.RemoveCodeAndIconShapeTypes]:{up:c=>Object.fromEntries(Object.entries(c).filter(([c,u])=>"shape"!==u.typeName||"icon"!==u.type&&"code"!==u.type)),down:c=>c},[eD.AddInstancePresenceType]:{up:c=>c,down:c=>Object.fromEntries(Object.entries(c).filter(([c,u])=>"instance_presence"!==u.typeName))},[eD.RemoveTLUserAndPresenceAndAddPointer]:{up:c=>Object.fromEntries(Object.entries(c).filter(([c,u])=>!u.typeName.match(/^(user|user_presence)$/))),down:c=>Object.fromEntries(Object.entries(c).filter(([c,u])=>"pointer"!==u.typeName))},[eD.RemoveUserDocument]:{up:c=>Object.fromEntries(Object.entries(c).filter(([c,u])=>!u.typeName.match("user_document"))),down:c=>c}}});function createTLSchema({shapes:c}){let u=new Map;for(let f of(0,eg.UM)(c))for(let c of getShapePropKeysByStyle(f.props??{}).keys()){if(u.has(c.id)&&u.get(c.id)!==c)throw Error(`Multiple StyleProp instances with the same id: ${c.id}`);u.set(c.id,c)}let f=createShapeRecordType(c),g=createInstanceRecordType(u);return x.sS.create({asset:eM,camera:E,document:ev,instance:g,instance_page_state:eo,page:Y,shape:f,instance_presence:ef,pointer:ec},{snapshotMigrations:eL,onValidationFailure:onValidationFailure,createIntegrityChecker:createIntegrityChecker})}let eN=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],eF={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{id:"dark",text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function getDefaultColorTheme(c){return c.isDarkMode?eF.darkMode:eF.lightMode}let eB=StyleProp.defineEnum("tldraw:color",{defaultValue:"black",values:eN}),ez=StyleProp.defineEnum("tldraw:labelColor",{defaultValue:"black",values:eN}),eG=StyleProp.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),eU=StyleProp.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),eH=StyleProp.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),eV={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},eW=StyleProp.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),eK=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],eZ=StyleProp.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:eK}),eY=StyleProp.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:eK}),eX=g.T.union("type",{binding:g.T.object({type:g.T.literal("binding"),boundShapeId:et,normalizedAnchor:T,isExact:g.T.boolean}),point:g.T.object({type:g.T.literal("point"),x:g.T.number,y:g.T.number})}),eJ={labelColor:ez,color:eB,fill:eU,dash:eG,size:eW,arrowheadStart:eZ,arrowheadEnd:eY,font:eH,start:eX,end:eX,bend:g.T.number,text:g.T.string},eQ={AddLabelColor:1},e0=(0,x.zn)({currentVersion:eQ.AddLabelColor,migrators:{[eQ.AddLabelColor]:{up:c=>({...c,props:{...c.props,labelColor:"black"}}),down:c=>{let{labelColor:u,...f}=c.props;return{...c,props:f}}}}}),e1={w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,assetId:b.nullable(),url:g.T.string},e2={NullAssetId:1},e5=(0,x.zn)({currentVersion:e2.NullAssetId,migrators:{[e2.NullAssetId]:{up:c=>void 0===c.props.assetId?{...c,props:{...c.props,assetId:null}}:c,down:c=>{if(null===c.props.assetId){let{assetId:u,...f}=c.props;return{...c,props:f}}return c}}}}),e3=g.T.object({type:g.T.literalEnum("free","straight"),points:g.T.arrayOf(T)}),e8={color:eB,fill:eU,dash:eG,size:eW,segments:g.T.arrayOf(e3),isComplete:g.T.boolean,isClosed:g.T.boolean,isPen:g.T.boolean},e4={AddInPen:1},e6=(0,x.zn)({currentVersion:e4.AddInPen,migrators:{[e4.AddInPen]:{up:c=>{let{points:u}=c.props.segments[0];if(0===u.length)return{...c,props:{...c.props,isPen:!1}};let f=!(0===u[0].z||.5===u[0].z);return u[1]&&(f=f&&!(0===u[1].z||.5===u[1].z)),{...c,props:{...c.props,isPen:f}}},down:c=>{let{isPen:u,...f}=c.props;return{...c,props:{...f}}}}}});var e7=f(62601);let e9=/(^\/r\/[^/]+\/?$)/,safeParseUrl=c=>{try{return new URL(c)}catch(c){return}},te=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(e9))return c},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(e9))return c}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:c=>{if(c.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!c.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${c}`},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/embed\/?$/)){let c=u.searchParams.get("url");if(c)return c}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{if(c.includes("/maps/")){let u;let f=c.match(/@(.*),(.*),(.*)z/);if(f){let[,g,b,v]=f,x=new URL(c).host.replace("www.","");u=`https://${x}/maps/embed/v1/view?key=${e7.env.NEXT_PUBLIC_GC_API_KEY}&center=${g},${b}&zoom=${v}`}else u="";return u}},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(!u)return;let f=u.pathname.match(/^\/maps\/embed\/v1\/view\/?$/);if(f&&u.searchParams.has("center")&&u.searchParams.get("zoom")){let c=u.searchParams.get("zoom"),[f,g]=u.searchParams.get("center").split(",");return`https://www.google.com/maps/@${f},${g},${c}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c),f=u&&u.pathname.match(/\/v\/([^/]+)\/?/);if(f)return`https://www.val.town/embed/${f[1]}`},fromEmbedUrl:c=>{let u=safeParseUrl(c),f=u&&u.pathname.match(/\/embed\/([^/]+)\/?/);if(f)return`https://www.val.town/v/${f[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c),f=u&&u.pathname.match(/\/s\/([^/]+)\/?/);if(f)return`https://codesandbox.io/embed/${f[1]}`},fromEmbedUrl:c=>{let u=safeParseUrl(c),f=u&&u.pathname.match(/\/embed\/([^/]+)\/?/);if(f)return`https://codesandbox.io/s/${f[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=c.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(u){let[c,f,g]=u;return`https://codepen.io/${f}/embed/${g}`}},fromEmbedUrl:c=>{let u=c.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(u){let[c,f,g]=u;return`https://codepen.io/${f}/pen/${g}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:c=>{let u=c.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(u){let[c,f]=u;return`https://scratch.mit.edu/projects/embed/${f}`}},fromEmbedUrl:c=>{let u=c.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(u){let[c,f]=u;return`https://scratch.mit.edu/projects/${f}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:c=>{let u=safeParseUrl(c);if(!u)return;let f=u.hostname.replace(/^www./,"");if("youtu.be"===f){let c=u.pathname.split("/").filter(Boolean)[0];return`https://www.youtube.com/embed/${c}`}if(("youtube.com"===f||"m.youtube.com"===f)&&u.pathname.match(/^\/watch/)){let c=u.searchParams.get("v");return`https://www.youtube.com/embed/${c}`}},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(!u)return;let f=u.hostname.replace(/^www./,"");if("youtube.com"===f){let c=u.pathname.match(/^\/embed\/([^/]+)\/?/);if(c)return`https://www.youtube.com/watch?v=${c[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:c=>{let u=safeParseUrl(c),f=u?.searchParams.get("cid");if(u?.pathname.match(/\/calendar\/u\/0/)&&f){u.pathname="/calendar/embed";let c=Array.from(u.searchParams.keys());for(let f of c)u.searchParams.delete(f);return u.searchParams.set("src",f),u.href}},fromEmbedUrl:c=>{let u=safeParseUrl(c),f=u?.searchParams.get("src");if(u?.pathname.match(/\/calendar\/embed/)&&f){u.pathname="/calendar/u/0";let c=Array.from(u.searchParams.keys());for(let f of c)u.searchParams.delete(f);return u.searchParams.set("cid",f),u.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u?.pathname.match(/^\/presentation/)&&u?.pathname.match(/\/pub\/?$/)){u.pathname=u.pathname.replace(/\/pub$/,"/embed");let c=Array.from(u.searchParams.keys());for(let f of c)u.searchParams.delete(f);return u.href}},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u?.pathname.match(/^\/presentation/)&&u?.pathname.match(/\/embed\/?$/)){u.pathname=u.pathname.replace(/\/embed$/,"/pub");let c=Array.from(u.searchParams.keys());for(let f of c)u.searchParams.delete(f);return u.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!c.split("/").pop())return;return c}},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!c.split("/").pop())return;return c}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${c}?embed=true`},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/\/@([^/]+)\/([^/]+)/)&&u.searchParams.has("embed"))return u.searchParams.delete("embed"),u.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/map\//))return u.origin+"/embed"+u.pathname},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/embed\/map\//))return u.pathname=u.pathname.replace(/^\/embed/,""),u.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/(artist|album)\//))return u.origin+"/embed"+u.pathname},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/embed\/(artist|album)\//))return u.origin+u.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&"vimeo.com"===u.hostname&&u.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+u.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&"player.vimeo.com"===u.hostname){let c=u.pathname.match(/^\/video\/([^/]+)\/?$/);if(c)return"https://vimeo.com/"+c[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.hash.match(/#room=/))return c},fromEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.hash.match(/#room=/))return c}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:c=>{let u=safeParseUrl(c);if(u&&u.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${u.origin}/embed${u.pathname}?cell=*`;if(u&&u.pathname.match(/^\/d\/([^/]+)\/?$/)){let c=u.pathname.replace(/^\/d/,"");return`${u.origin}/embed${c}?cell=*`}},fromEmbedUrl:c=>{let u=safeParseUrl(c);return u&&u.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?`${u.origin}${u.pathname.replace("/embed","")}#cell-*`:u&&u.pathname.match(/^\/embed\/([^/]+)\/?$/)?`${u.origin}${u.pathname.replace("/embed","/d")}#cell-*`:void 0}}],tt={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},tn={w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,url:g.T.string},ti={GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4},to=(0,x.zn)({currentVersion:ti.RemovePermissionOverrides,migrators:{[ti.GenOriginalUrlInEmbed]:{up:c=>{let u;let f=c.props.url,g=new URL(f).host.replace("www.","");for(let c of te)if(c.hostnames.includes(g))try{u=c.fromEmbedUrl(f)}catch(c){console.warn(c)}return{...c,props:{...c.props,tmpOldUrl:c.props.url,url:u??""}}},down:c=>{let u=c.props.tmpOldUrl;if(!u||""===u){let f=c.props.url,g=new URL(f).host.replace("www.","");for(let c of te)if(c.hostnames.includes(g))try{u=c.toEmbedUrl(f)}catch(c){console.warn(c)}}let{tmpOldUrl:f,...g}=c.props;return{...c,props:{...g,url:u??""}}}},[ti.RemoveDoesResize]:{up:c=>{let{doesResize:u,...f}=c.props;return{...c,props:{...f}}},down:c=>({...c,props:{...c.props,doesResize:!0}})},[ti.RemoveTmpOldUrl]:{up:c=>{let{tmpOldUrl:u,...f}=c.props;return{...c,props:{...f}}},down:c=>({...c,props:{...c.props}})},[ti.RemovePermissionOverrides]:{up:c=>{let{overridePermissions:u,...f}=c.props;return{...c,props:{...f}}},down:c=>({...c,props:{...c.props}})}}}),ta={w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,name:g.T.string},ts=(0,x.zn)({}),tl=StyleProp.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),tc=StyleProp.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),tu=StyleProp.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),td={geo:tu,labelColor:ez,color:eB,fill:eU,dash:eG,size:eW,font:eH,align:tl,verticalAlign:tc,url:g.T.string,w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,growY:g.T.positiveNumber,text:g.T.string},th={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7},tp=(0,x.zn)({currentVersion:th.AddCloud,migrators:{[th.AddUrlProp]:{up:c=>({...c,props:{...c.props,url:""}}),down:c=>{let{url:u,...f}=c.props;return{...c,props:f}}},[th.AddLabelColor]:{up:c=>({...c,props:{...c.props,labelColor:"black"}}),down:c=>{let{labelColor:u,...f}=c.props;return{...c,props:f}}},[th.RemoveJustify]:{up:c=>{let u=c.props.align;return"justify"===u&&(u="start"),{...c,props:{...c.props,align:u}}},down:c=>({...c})},[th.AddCheckBox]:{up:c=>({...c}),down:c=>({...c,props:{...c.props,geo:"check-box"===c.props.geo?"rectangle":c.props.geo}})},[th.AddVerticalAlign]:{up:c=>({...c,props:{...c.props,verticalAlign:"middle"}}),down:c=>{let{verticalAlign:u,...f}=c.props;return{...c,props:f}}},[th.MigrateLegacyAlign]:{up:c=>{let u;switch(c.props.align){case"start":u="start-legacy";break;case"end":u="end-legacy";break;default:u="middle-legacy"}return{...c,props:{...c.props,align:u}}},down:c=>{let u;switch(c.props.align){case"start-legacy":u="start";break;case"end-legacy":u="end";break;case"middle-legacy":u="middle";break;default:u=c.props.align}return{...c,props:{...c.props,align:u}}}},[th.AddCloud]:{up:c=>c,down:c=>{if("cloud"===c.props.geo)return{...c,props:{...c.props,geo:"rectangle"}}}}}}),tf={},tg=(0,x.zn)({}),tm={color:eB,size:eW,segments:g.T.arrayOf(e3),isComplete:g.T.boolean,isPen:g.T.boolean},ty=(0,x.zn)({}),tb=g.T.object({topLeft:T,bottomRight:T}),tv={w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,playing:g.T.boolean,url:g.T.string,assetId:b.nullable(),crop:tb.nullable()},tS={AddUrlProp:1,AddCropProp:2},tx=(0,x.zn)({currentVersion:tS.AddCropProp,migrators:{[tS.AddUrlProp]:{up:c=>({...c,props:{...c.props,url:""}}),down:c=>{let{url:u,...f}=c.props;return{...c,props:f}}},[tS.AddCropProp]:{up:c=>({...c,props:{...c.props,crop:null}}),down:c=>{let{crop:u,...f}=c.props;return{...c,props:f}}}}}),tw=new Set(["vertex","virtual","create"]),t_=g.T.object({id:g.T.string,type:g.T.setEnum(tw),canBind:g.T.boolean.optional(),canSnap:g.T.boolean.optional(),index:g.T.string,x:g.T.number,y:g.T.number}),tk=StyleProp.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),tC={color:eB,dash:eG,size:eW,spline:tk,handles:g.T.dict(g.T.string,t_)},tE={AddSnapHandles:1},tP=(0,x.zn)({currentVersion:tE.AddSnapHandles,migrators:{[tE.AddSnapHandles]:{up:c=>{let u=(0,eg.p$)(c.props.handles);for(let c in u)u[c].canSnap=!0;return{...c,props:{...c.props,handles:u}}},down:c=>{let u=(0,eg.p$)(c.props.handles);for(let c in u)delete u[c].canSnap;return{...c,props:{...c.props,handles:u}}}}}}),tT={color:eB,size:eW,font:eH,align:tl,verticalAlign:tc,growY:g.T.positiveNumber,url:g.T.string,text:g.T.string},t$={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4},tI=(0,x.zn)({currentVersion:t$.AddVerticalAlign,migrators:{[t$.AddUrlProp]:{up:c=>({...c,props:{...c.props,url:""}}),down:c=>{let{url:u,...f}=c.props;return{...c,props:f}}},[t$.RemoveJustify]:{up:c=>{let u=c.props.align;return"justify"===u&&(u="start"),{...c,props:{...c.props,align:u}}},down:c=>({...c})},[t$.MigrateLegacyAlign]:{up:c=>{let u;switch(c.props.align){case"start":u="start-legacy";break;case"end":u="end-legacy";break;default:u="middle-legacy"}return{...c,props:{...c.props,align:u}}},down:c=>{let u;switch(c.props.align){case"start-legacy":u="start";break;case"end-legacy":u="end";break;case"middle-legacy":u="middle";break;default:u=c.props.align}return{...c,props:{...c.props,align:u}}}},[t$.AddVerticalAlign]:{up:c=>({...c,props:{...c.props,verticalAlign:"middle"}}),down:c=>{let{verticalAlign:u,...f}=c.props;return{...c,props:f}}}}}),tA={color:eB,size:eW,font:eH,align:tl,w:g.T.nonZeroNumber,text:g.T.string,scale:g.T.nonZeroNumber,autoSize:g.T.boolean},tM={RemoveJustify:1},tj=(0,x.zn)({currentVersion:tM.RemoveJustify,migrators:{[tM.RemoveJustify]:{up:c=>{let u=c.props.align;return"justify"===u&&(u="start"),{...c,props:{...c.props,align:u}}},down:c=>({...c})}}}),tO={w:g.T.nonZeroNumber,h:g.T.nonZeroNumber,time:g.T.number,playing:g.T.boolean,url:g.T.string,assetId:b.nullable()},tR={AddUrlProp:1},tD=(0,x.zn)({currentVersion:tR.AddUrlProp,migrators:{[tR.AddUrlProp]:{up:c=>({...c,props:{...c.props,url:""}}),down:c=>{let{url:u,...f}=c.props;return{...c,props:f}}}}}),tL=[{locale:"ar",label:"عربي"},{locale:"ca",label:"Catal\xe0"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xf1ol"},{locale:"fa",label:"فارسی"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Fran\xe7ais"},{locale:"gl",label:"Galego"},{locale:"he",label:"עברית"},{locale:"it",label:"Italiano"},{locale:"ja",label:"日本語"},{locale:"ko-kr",label:"한국어"},{locale:"ku",label:"کوردی"},{locale:"hi-in",label:"हिन्दी"},{locale:"hu",label:"Magyar"},{locale:"my",label:"မြန်မာစာ"},{locale:"ne",label:"नेपाली"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xeas - Brasil"},{locale:"pt-pt",label:"Portugu\xeas - Europeu"},{locale:"ro",label:"Rom\xe2nă"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"tr",label:"T\xfcrk\xe7e"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Tiếng Việt"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function getDefaultTranslationLocale(){let c="undefined"!=typeof window?window.navigator.languages??["en"]:["en"];return _getDefaultTranslationLocale(c)}function _getDefaultTranslationLocale(c){for(let u of c){let c=getSupportedLocale(u);if(c)return c}return"en"}let tN={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function getSupportedLocale(c){let u=tL.find(u=>u.locale===c.toLowerCase());if(u)return u.locale;let[f,g]=c.split(/[-_]/).map(c=>c.toLowerCase());if(g){let c=tL.find(c=>c.locale===f);if(c)return c.locale}return f in tN?tN[f]:null}},47110:function(c,u,f){"use strict";let g;function rotateArray(c,u){return c.map((f,g)=>c[(g+u)%c.length])}function dedupe(c,u){let f=[];t:for(let g of c){for(let c of f)if(u?u(g,c):g===c)continue t;f.push(g)}return f}function compact(c){return c.filter(c=>null!=c)}function last(c){return c[c.length-1]}function minBy(c,u){let f;let g=1/0;for(let b of c){let c=u(b);c<g&&(f=b,g=c)}return f}function partition(c,u){let f=[],g=[];for(let b of c)u(b)?f.push(b):g.push(b);return[f,g]}function throttle(c,u){let f,g;return function(...b){return f||(f=!0,setTimeout(()=>f=!1,u),g=c(...b)),g}}function omitFromStackTrace(c){let wrappedFn=(...u)=>{try{return c(...u)}catch(c){throw c instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(c,wrappedFn),c}};return wrappedFn}function noop(){}f.d(u,{P6:function(){return FileHelpers},xe:function(){return MediaHelpers},bM:function(){return PngHelpers},x4:function(){return b},lw:function(){return annotateError},hu:function(){return v},kP:function(){return x},oA:function(){return compact},Ds:function(){return debounce},D8:function(){return dedupe},p$:function(){return deepCopy},iP:function(){return exhaustiveSwitchError},H4:function(){return filterEntries},wi:function(){return getErrorAnnotations},lr:function(){return getFirstFromIterable},pT:function(){return getHashForObject},jK:function(){return getHashForString},eg:function(){return getOwnProperty},nr:function(){return object_hasOwnProperty},$K:function(){return isDefined},GT:function(){return isNonNull},cF:function(){return isNonNullish},jv:function(){return isValidUrl},Z$:function(){return last},t7:function(){return lerp},L8:function(){return lns},Fm:function(){return mapObjectMapValues},F:function(){return minBy},vm:function(){return modulate},ZT:function(){return noop},EP:function(){return objectMapEntries},Ls:function(){return objectMapFromEntries},GH:function(){return objectMapKeys},UM:function(){return objectMapValues},fP:function(){return omitFromStackTrace},uK:function(){return partition},un:function(){return promiseWithResolve},TE:function(){return rafThrottle},Vk:function(){return rng},R8:function(){return rotateArray},uv:function(){return sortById},v4:function(){return $},P2:function(){return throttle},xP:function(){return throttledRaf}});let b={ok:c=>({ok:!0,value:c}),err:c=>({ok:!1,error:c})};function exhaustiveSwitchError(c,u){let f=u&&c&&"object"==typeof c&&u in c?c[u]:c;throw Error(`Unknown switch case ${f}`)}let v=omitFromStackTrace((c,u)=>{if(!c)throw Error(u||"Assertion Error")}),x=omitFromStackTrace((c,u)=>{if(null==c)throw Error(u??"value must be defined");return c});function promiseWithResolve(){let c,u;let f=new Promise((f,g)=>{c=f,u=g});return Object.assign(f,{resolve:c,reject:u})}function debounce(c,u){let f;let fn=(...g)=>(f||((f={}).promise=new Promise((c,u)=>{f.resolve=c,f.reject=u})),clearTimeout(f.timeout),f.latestArgs=g,f.timeout=setTimeout(()=>{let u=f;f=void 0;try{u.resolve(c(...u.latestArgs))}catch(c){u.reject(c)}},u),f.promise);return fn.cancel=()=>{f&&clearTimeout(f.timeout)},fn}let w=new WeakMap;function annotateError(c,u){if("object"!=typeof c||null===c)return;let f=w.get(c);f||(f={tags:{},extras:{}},w.set(c,f)),u.tags&&(f.tags={...f.tags,...u.tags}),u.extras&&(f.extras={...f.extras,...u.extras})}function getErrorAnnotations(c){return w.get(c)??{tags:{},extras:{}}}let FileHelpers=class FileHelpers{static async base64ToFile(c){return fetch(c).then(function(c){return c.arrayBuffer()})}static async fileToBase64(c){return await new Promise((u,f)=>{if(c){let g=new FileReader;g.readAsDataURL(c),g.onload=()=>u(g.result),g.onerror=c=>f(c),g.onabort=c=>f(c)}})}};function getHashForString(c){let u=0;for(let f=0;f<c.length;f++)u=(u<<5)-u+c.charCodeAt(f)|0;return u+""}function getHashForObject(c){return getHashForString(JSON.stringify(c))}function lns(c){let u=c.split("");return u.push(...u.splice(0,Math.round(u.length/5))),u.push(...u.splice(0,Math.round(u.length/4))),u.push(...u.splice(0,Math.round(u.length/3))),u.push(...u.splice(0,Math.round(u.length/2))),u.reverse().map(c=>+c?5>+c?5+ +c:+c>5?+c-5:c:c).join("")}function getFirstFromIterable(c){return c.values().next().value}let _=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(_=new Int32Array(_));let crc=(c,u)=>{let f=0===u?0:-1^~~u;for(let u=0;u<c.length;u++)f=_[(f^c[u])&255]^f>>>8;return -1^f};let PngHelpers=class PngHelpers{static isPng(c,u){return 137===c.getUint8(u+0)&&80===c.getUint8(u+1)&&78===c.getUint8(u+2)&&71===c.getUint8(u+3)&&13===c.getUint8(u+4)&&10===c.getUint8(u+5)&&26===c.getUint8(u+6)&&10===c.getUint8(u+7)}static getChunkType(c,u){return[String.fromCharCode(c.getUint8(u)),String.fromCharCode(c.getUint8(u+1)),String.fromCharCode(c.getUint8(u+2)),String.fromCharCode(c.getUint8(u+3))].join("")}static readChunks(c,u=0){let f={};if(!PngHelpers.isPng(c,u))throw Error("Not a PNG");for(u+=8;u<=c.buffer.byteLength;){let g=u,b=c.getInt32(u);u+=4;let v=PngHelpers.getChunkType(c,u);if("IDAT"===v&&f[v]){u+=b+4+4;continue}if("IEND"===v)break;f[v]={start:g,dataOffset:u+4,size:b},u+=b+4+4}return f}static parsePhys(c,u){return{ppux:c.getUint32(u),ppuy:c.getUint32(u+4),unit:c.getUint8(u+4)}}static findChunk(c,u){let f=PngHelpers.readChunks(c);return f[u]}static setPhysChunk(c,u=1,f){let g=46,b=0,v=PngHelpers.findChunk(c,"pHYs");v&&(g=v.start,b=v.size);let x=PngHelpers.findChunk(c,"IDAT");x&&(g=x.start,b=0);let w=new ArrayBuffer(21),_=new DataView(w);_.setUint32(0,9),_.setUint8(4,112),_.setUint8(5,72),_.setUint8(6,89),_.setUint8(7,115),_.setInt32(8,2835.5*u),_.setInt32(12,2835.5*u),_.setInt8(16,1);let k=new Uint8Array(w.slice(4,17));_.setInt32(17,crc(k));let E=c.buffer.slice(0,g),T=c.buffer.slice(g+b);return new Blob([E,w,T],f)}};let MediaHelpers=class MediaHelpers{static async getVideoSizeFromSrc(c){return await new Promise((u,f)=>{let g=document.createElement("video");g.onloadeddata=()=>u({w:g.videoWidth,h:g.videoHeight}),g.onerror=c=>{console.error(c),f(Error("Could not get video size"))},g.crossOrigin="anonymous",g.src=c})}static async getImageSizeFromSrc(c){return await new Promise((u,f)=>{let g=new Image;g.onload=async()=>{try{let f=await FileHelpers.base64ToFile(c),b=new DataView(f);if(PngHelpers.isPng(b,0)){let c=PngHelpers.findChunk(b,"pHYs");if(c){let f=PngHelpers.parsePhys(b,c.dataOffset);if(0===f.unit&&f.ppux===f.ppuy){let c=Math.round(f.ppux/2834.5);u({w:g.width/c,h:g.height/c});return}}}u({w:g.width,h:g.height})}catch(c){console.error(c),u({w:g.width,h:g.height})}},g.onerror=c=>{console.error(c),f(Error("Could not get image size"))},g.crossOrigin="anonymous",g.src=c})}};function lerp(c,u,f){return c+(u-c)*f}function rng(c=""){let u=0,f=0,g=0,b=0;function next(){let c=u^u<<11;return u=f,f=g,g=b,(b^=(b>>>19^c^c>>>8)>>>0)/4294967296*2}for(let f=0;f<c.length+64;f++)u^=0|c.charCodeAt(f),next();return next}function modulate(c,u,f,g=!1){let[b,v]=u,[x,w]=f,_=x+(c-b)/(v-b)*(w-x);return g?x<w?Math.max(Math.min(_,w),x):Math.max(Math.min(_,x),w):_}function object_hasOwnProperty(c,u){return Object.prototype.hasOwnProperty.call(c,u)}function getOwnProperty(c,u){if(object_hasOwnProperty(c,u))return c[u]}function deepCopy(c){if(!c)return c;if(Array.isArray(c)){let u=[],f=c.length;for(let g=0;g<f;g++)u.push(deepCopy(c[g]));return u}if("object"==typeof c){let u=Object.keys(c),f=u.length,g={};for(let b=0;b<f;b++){let f=u[b];g[f]=deepCopy(c[f])}return g}return c}function objectMapKeys(c){return Object.keys(c)}function objectMapValues(c){return Object.values(c)}function objectMapEntries(c){return Object.entries(c)}function objectMapFromEntries(c){return Object.fromEntries(c)}function filterEntries(c,u){let f={},g=!1;for(let[b,v]of objectMapEntries(c))u(b,v)?f[b]=v:g=!0;return g?f:c}function mapObjectMapValues(c,u){let f={};for(let[g,b]of objectMapEntries(c)){let c=u(g,b);f[g]=c}return f}var k=f(62601);let isTest=()=>void 0!==k&&!1,E=[],tick=()=>{let c=E.splice(0,E.length);for(let u of c)u()};function raf(){g||(g=requestAnimationFrame(()=>{g=void 0,tick()}))}function rafThrottle(c){return isTest()?c:()=>{E.includes(c)||(E.push(c),raf())}}function throttledRaf(c){if(isTest())return c();E.includes(c)||(E.push(c),raf())}function sortById(c,u){return c.id>u.id?1:-1}let T=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function isValidUrl(c){return T.test(c)}function isDefined(c){return void 0!==c}function isNonNull(c){return null!==c}function isNonNullish(c){return null!=c}let $="undefined"!=typeof window&&window.structuredClone?window.structuredClone:c=>c?JSON.parse(JSON.stringify(c)):c},45958:function(c,u,f){"use strict";f.d(u,{UR:function(){return ArrayOfValidator},oy:function(){return DictValidator},kx:function(){return ObjectValidator},T:function(){return g},zr:function(){return UnionValidator},cX:function(){return Validator}});var g={};f.r(g),f.d(g,{ArrayOfValidator:function(){return ArrayOfValidator},DictValidator:function(){return DictValidator},ObjectValidator:function(){return ObjectValidator},UnionValidator:function(){return UnionValidator},ValidationError:function(){return ValidationError},Validator:function(){return Validator},any:function(){return x},array:function(){return D},arrayOf:function(){return arrayOf},bigint:function(){return j},boolean:function(){return M},dict:function(){return dict},integer:function(){return T},jsonDict:function(){return jsonDict},jsonValue:function(){return F},literal:function(){return literal},literalEnum:function(){return literalEnum},model:function(){return model},nonZeroInteger:function(){return I},nonZeroNumber:function(){return E},nullable:function(){return nullable},number:function(){return _},object:function(){return object},optional:function(){return optional},positiveInteger:function(){return $},positiveNumber:function(){return k},setEnum:function(){return setEnum},string:function(){return w},union:function(){return union},unknown:function(){return v},unknownObject:function(){return L}});var b=f(47110);function formatPath(c){if(!c.length)return null;let u="";for(let f of c)"number"==typeof f?u+=`.${f}`:f.startsWith("(")?u.endsWith(")")?u=`${u.slice(0,-1)}, ${f.slice(1)}`:u+=f:u+=`.${f}`;return u.startsWith(".")?u.slice(1):u}let ValidationError=class ValidationError extends Error{constructor(c,u=[]){let f=formatPath(u),g=c.split("\n").map((c,u)=>0===u?c:`  ${c}`).join("\n");super(u?`At ${f}: ${g}`:g),this.rawMessage=c,this.path=u}name="ValidationError"};function prefixError(c,u){try{return u()}catch(u){if(u instanceof ValidationError)throw new ValidationError(u.rawMessage,[c,...u.path]);throw new ValidationError(u.toString(),[c])}}function typeToString(c){if(null===c)return"null";if(Array.isArray(c))return"an array";let u=typeof c;switch(u){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${u}`;case"object":return`an ${u}`;case"undefined":return"undefined";default:(0,b.iP)(u)}}let Validator=class Validator{constructor(c){this.validationFn=c}validate(c){let u=this.validationFn(c);return u}nullable(){return nullable(this)}optional(){return optional(this)}refine(c){return new Validator(u=>c(this.validate(u)))}check(c,u){return"string"==typeof c?this.refine(f=>(prefixError(`(check ${c})`,()=>u(f)),f)):this.refine(u=>(c(u),u))}};let ArrayOfValidator=class ArrayOfValidator extends Validator{constructor(c){super(u=>{let f=D.validate(u);for(let u=0;u<f.length;u++)prefixError(u,()=>c.validate(f[u]));return f}),this.itemValidator=c}nonEmpty(){return this.check(c=>{if(0===c.length)throw new ValidationError("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(c=>{if(c.length<=1)throw new ValidationError("Expected an array with length greater than 1")})}};let ObjectValidator=class ObjectValidator extends Validator{constructor(c,u=!1){super(f=>{if("object"!=typeof f||null===f)throw new ValidationError(`Expected object, got ${typeToString(f)}`);for(let[u,g]of Object.entries(c))prefixError(u,()=>{g.validate((0,b.eg)(f,u))});if(!u){for(let u of Object.keys(f))if(!(0,b.nr)(c,u))throw new ValidationError("Unexpected property",[u])}return f}),this.config=c,this.shouldAllowUnknownProperties=u}allowUnknownProperties(){return new ObjectValidator(this.config,!0)}extend(c){return new ObjectValidator({...this.config,...c})}};let UnionValidator=class UnionValidator extends Validator{constructor(c,u,f){super(f=>{if("object"!=typeof f||null===f)throw new ValidationError(`Expected an object, got ${typeToString(f)}`,[]);let g=(0,b.eg)(f,c);if("string"!=typeof g)throw new ValidationError(`Expected a string for key "${c}", got ${typeToString(g)}`);let v=(0,b.nr)(u,g)?u[g]:void 0;return void 0===v?this.unknownValueValidation(f,g):prefixError(`(${c} = ${g})`,()=>v.validate(f))}),this.key=c,this.config=u,this.unknownValueValidation=f}validateUnknownVariants(c){return new UnionValidator(this.key,this.config,c)}};let DictValidator=class DictValidator extends Validator{constructor(c,u){super(f=>{if("object"!=typeof f||null===f)throw new ValidationError(`Expected object, got ${typeToString(f)}`);for(let[g,b]of Object.entries(f))prefixError(g,()=>{c.validate(g),u.validate(b)});return f}),this.keyValidator=c,this.valueValidator=u}};function typeofValidator(c){return new Validator(u=>{if(typeof u!==c)throw new ValidationError(`Expected ${c}, got ${typeToString(u)}`);return u})}let v=new Validator(c=>c),x=new Validator(c=>c),w=typeofValidator("string"),_=typeofValidator("number").check(c=>{if(Number.isNaN(c))throw new ValidationError("Expected a number, got NaN");if(!Number.isFinite(c))throw new ValidationError(`Expected a finite number, got ${c}`)}),k=_.check(c=>{if(c<0)throw new ValidationError(`Expected a positive number, got ${c}`)}),E=_.check(c=>{if(c<=0)throw new ValidationError(`Expected a non-zero positive number, got ${c}`)}),T=_.check(c=>{if(!Number.isInteger(c))throw new ValidationError(`Expected an integer, got ${c}`)}),$=T.check(c=>{if(c<0)throw new ValidationError(`Expected a positive integer, got ${c}`)}),I=T.check(c=>{if(c<=0)throw new ValidationError(`Expected a non-zero positive integer, got ${c}`)}),M=typeofValidator("boolean"),j=typeofValidator("bigint");function literal(c){return new Validator(u=>{if(u!==c)throw new ValidationError(`Expected ${c}, got ${JSON.stringify(u)}`);return c})}let D=new Validator(c=>{if(!Array.isArray(c))throw new ValidationError(`Expected an array, got ${typeToString(c)}`);return c});function arrayOf(c){return new ArrayOfValidator(c)}let L=new Validator(c=>{if("object"!=typeof c||null===c)throw new ValidationError(`Expected object, got ${typeToString(c)}`);return c});function object(c){return new ObjectValidator(c)}function isValidJson(c){return null===c||"number"==typeof c||"string"==typeof c||"boolean"==typeof c||(Array.isArray(c)?c.every(isValidJson):"object"==typeof c&&Object.values(c).every(isValidJson))}let F=new Validator(c=>{if(isValidJson(c))return c;throw new ValidationError(`Expected json serializable value, got ${typeof c}`)});function jsonDict(){return dict(w,F)}function dict(c,u){return new DictValidator(c,u)}function union(c,u){return new UnionValidator(c,u,(f,g)=>{throw new ValidationError(`Expected one of ${Object.keys(u).map(c=>JSON.stringify(c)).join(" or ")}, got ${JSON.stringify(g)}`,[c])})}function model(c,u){return new Validator(f=>{let g=f&&"object"==typeof f&&"id"in f&&"string"==typeof f.id?`${c}(id = ${f.id})`:c;return prefixError(g,()=>u.validate(f))})}function setEnum(c){return new Validator(u=>{if(!c.has(u)){let f=Array.from(c,c=>JSON.stringify(c)).join(" or ");throw new ValidationError(`Expected ${f}, got ${u}`)}return u})}function optional(c){return new Validator(u=>{if(void 0!==u)return c.validate(u)})}function nullable(c){return new Validator(u=>null===u?null:c.validate(u))}function literalEnum(...c){return setEnum(new Set(c))}},37350:function(c,u,f){"use strict";f.r(u),f.d(u,{customAlphabet:function(){return customAlphabet},customRandom:function(){return customRandom},nanoid:function(){return nanoid},random:function(){return random},urlAlphabet:function(){return g}});let g="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",random=c=>crypto.getRandomValues(new Uint8Array(c)),customRandom=(c,u,f)=>{let g=(2<<Math.log(c.length-1)/Math.LN2)-1,b=-~(1.6*g*u/c.length);return (v=u)=>{let x="";for(;;){let u=f(b),w=b;for(;w--;)if((x+=c[u[w]&g]||"").length===v)return x}}},customAlphabet=(c,u=21)=>customRandom(c,u,random),nanoid=(c=21)=>crypto.getRandomValues(new Uint8Array(c)).reduce((c,u)=>((u&=63)<36?c+=u.toString(36):u<62?c+=(u-26).toString(36).toUpperCase():u>62?c+="-":c+="_",c),"")},84988:function(c,u,f){"use strict";let g,b,v;f.d(u,{CZ:function(){return eH}});let x=[{id:"abap",name:"ABAP",import:()=>f.e(4085).then(f.bind(f,4085))},{id:"actionscript-3",name:"ActionScript",import:()=>f.e(5106).then(f.bind(f,95106))},{id:"ada",name:"Ada",import:()=>f.e(5147).then(f.bind(f,25147))},{id:"angular-html",name:"Angular HTML",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(157)]).then(f.bind(f,30157))},{id:"angular-ts",name:"Angular TypeScript",import:()=>Promise.all([f.e(8584),f.e(5604),f.e(8580),f.e(8203),f.e(1672),f.e(7992)]).then(f.bind(f,92536))},{id:"apache",name:"Apache Conf",import:()=>f.e(5056).then(f.bind(f,5056))},{id:"apex",name:"Apex",import:()=>f.e(8240).then(f.bind(f,28240))},{id:"apl",name:"APL",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(2693),f.e(4031)]).then(f.bind(f,44031))},{id:"applescript",name:"AppleScript",import:()=>f.e(4915).then(f.bind(f,54915))},{id:"ara",name:"Ara",import:()=>f.e(4482).then(f.bind(f,54482))},{id:"asm",name:"Assembly",import:()=>f.e(3766).then(f.bind(f,33766))},{id:"astro",name:"Astro",import:()=>Promise.all([f.e(8584),f.e(414),f.e(6673),f.e(8580),f.e(1672),f.e(2489),f.e(2090),f.e(1173)]).then(f.bind(f,91173))},{id:"awk",name:"AWK",import:()=>f.e(6166).then(f.bind(f,26166))},{id:"ballerina",name:"Ballerina",import:()=>f.e(4288).then(f.bind(f,74288))},{id:"bat",name:"Batch File",aliases:["batch"],import:()=>f.e(541).then(f.bind(f,90541))},{id:"beancount",name:"Beancount",import:()=>f.e(6452).then(f.bind(f,16452))},{id:"berry",name:"Berry",aliases:["be"],import:()=>f.e(25).then(f.bind(f,10025))},{id:"bibtex",name:"BibTeX",import:()=>f.e(5037).then(f.bind(f,65037))},{id:"bicep",name:"Bicep",import:()=>f.e(3504).then(f.bind(f,13504))},{id:"blade",name:"Blade",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(1616)]).then(f.bind(f,81616))},{id:"c",name:"C",import:()=>f.e(7809).then(f.bind(f,17809))},{id:"cadence",name:"Cadence",aliases:["cdc"],import:()=>f.e(3761).then(f.bind(f,83761))},{id:"clarity",name:"Clarity",import:()=>f.e(2412).then(f.bind(f,62412))},{id:"clojure",name:"Clojure",aliases:["clj"],import:()=>f.e(2617).then(f.bind(f,52617))},{id:"cmake",name:"CMake",import:()=>f.e(4733).then(f.bind(f,24733))},{id:"cobol",name:"COBOL",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(4490)]).then(f.bind(f,64490))},{id:"codeql",name:"CodeQL",aliases:["ql"],import:()=>f.e(1284).then(f.bind(f,91284))},{id:"coffee",name:"CoffeeScript",aliases:["coffeescript"],import:()=>Promise.all([f.e(8584),f.e(7433)]).then(f.bind(f,17433))},{id:"cpp",name:"C++",aliases:["c++"],import:()=>Promise.all([f.e(75),f.e(7185),f.e(3796),f.e(7809),f.e(6690)]).then(f.bind(f,24562))},{id:"crystal",name:"Crystal",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(7809),f.e(9819),f.e(675)]).then(f.bind(f,80675))},{id:"csharp",name:"C#",aliases:["c#","cs"],import:()=>f.e(6984).then(f.bind(f,26984))},{id:"css",name:"CSS",import:()=>f.e(8580).then(f.bind(f,98580))},{id:"csv",name:"CSV",import:()=>f.e(6127).then(f.bind(f,56127))},{id:"cue",name:"CUE",import:()=>f.e(4931).then(f.bind(f,34931))},{id:"cypher",name:"Cypher",aliases:["cql"],import:()=>f.e(5847).then(f.bind(f,55847))},{id:"d",name:"D",import:()=>f.e(9284).then(f.bind(f,29284))},{id:"dart",name:"Dart",import:()=>f.e(2771).then(f.bind(f,42771))},{id:"dax",name:"DAX",import:()=>f.e(1428).then(f.bind(f,51428))},{id:"diff",name:"Diff",import:()=>f.e(4870).then(f.bind(f,84870))},{id:"docker",name:"Dockerfile",aliases:["dockerfile"],import:()=>f.e(8054).then(f.bind(f,78054))},{id:"dream-maker",name:"Dream Maker",import:()=>f.e(7626).then(f.bind(f,57626))},{id:"elixir",name:"Elixir",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(1956)]).then(f.bind(f,11956))},{id:"elm",name:"Elm",import:()=>Promise.all([f.e(7809),f.e(6198)]).then(f.bind(f,36198))},{id:"erb",name:"ERB",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(9235),f.e(9718)]).then(f.bind(f,39718))},{id:"erlang",name:"Erlang",aliases:["erl"],import:()=>f.e(2192).then(f.bind(f,2192))},{id:"fish",name:"Fish",import:()=>f.e(9979).then(f.bind(f,79979))},{id:"fortran-fixed-form",name:"Fortran (Fixed Form)",aliases:["f","for","f77"],import:()=>Promise.all([f.e(7437),f.e(1178)]).then(f.bind(f,41178))},{id:"fortran-free-form",name:"Fortran (Free Form)",aliases:["f90","f95","f03","f08","f18"],import:()=>f.e(7437).then(f.bind(f,67437))},{id:"fsharp",name:"F#",aliases:["f#","fs"],import:()=>Promise.all([f.e(4686),f.e(1267)]).then(f.bind(f,81267))},{id:"gdresource",name:"GDResource",import:()=>f.e(357).then(f.bind(f,40357))},{id:"gdscript",name:"GDScript",import:()=>f.e(4648).then(f.bind(f,4648))},{id:"gdshader",name:"GDShader",import:()=>f.e(578).then(f.bind(f,90578))},{id:"gherkin",name:"Gherkin",import:()=>f.e(6506).then(f.bind(f,66506))},{id:"git-commit",name:"Git Commit Message",import:()=>f.e(3452).then(f.bind(f,3452))},{id:"git-rebase",name:"Git Rebase Message",import:()=>Promise.all([f.e(9819),f.e(4026)]).then(f.bind(f,34026))},{id:"gleam",name:"Gleam",import:()=>f.e(2264).then(f.bind(f,12264))},{id:"glimmer-js",name:"Glimmer JS",aliases:["gjs"],import:()=>Promise.all([f.e(8584),f.e(414),f.e(8580),f.e(8203),f.e(8826)]).then(f.bind(f,98826))},{id:"glimmer-ts",name:"Glimmer TS",aliases:["gts"],import:()=>Promise.all([f.e(8584),f.e(414),f.e(8580),f.e(8203),f.e(9002)]).then(f.bind(f,39002))},{id:"glsl",name:"GLSL",import:()=>Promise.all([f.e(7809),f.e(5153)]).then(f.bind(f,16690))},{id:"gnuplot",name:"Gnuplot",import:()=>f.e(8280).then(f.bind(f,78280))},{id:"go",name:"Go",import:()=>f.e(393).then(f.bind(f,30393))},{id:"graphql",name:"GraphQL",aliases:["gql"],import:()=>Promise.all([f.e(8584),f.e(414),f.e(6673),f.e(5519),f.e(8969)]).then(f.bind(f,8969))},{id:"groovy",name:"Groovy",import:()=>f.e(9532).then(f.bind(f,89532))},{id:"hack",name:"Hack",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(9747)]).then(f.bind(f,19747))},{id:"haml",name:"Ruby Haml",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(4686),f.e(9235),f.e(7433),f.e(7701)]).then(f.bind(f,27701))},{id:"handlebars",name:"Handlebars",aliases:["hbs"],import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(5130)]).then(f.bind(f,5130))},{id:"haskell",name:"Haskell",aliases:["hs"],import:()=>f.e(5599).then(f.bind(f,55599))},{id:"hcl",name:"HashiCorp HCL",import:()=>f.e(6374).then(f.bind(f,6374))},{id:"hjson",name:"Hjson",import:()=>f.e(2414).then(f.bind(f,82414))},{id:"hlsl",name:"HLSL",import:()=>f.e(9877).then(f.bind(f,49877))},{id:"html",name:"HTML",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203)]).then(f.bind(f,98203))},{id:"html-derivative",name:"HTML (Derivative)",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(9802)]).then(f.bind(f,19802))},{id:"http",name:"HTTP",import:()=>Promise.all([f.e(8584),f.e(414),f.e(6673),f.e(5519),f.e(2693),f.e(9819),f.e(1474)]).then(f.bind(f,41474))},{id:"imba",name:"Imba",import:()=>Promise.all([f.e(414),f.e(1434)]).then(f.bind(f,51434))},{id:"ini",name:"INI",aliases:["properties"],import:()=>f.e(3e3).then(f.bind(f,23e3))},{id:"java",name:"Java",import:()=>f.e(2693).then(f.bind(f,92693))},{id:"javascript",name:"JavaScript",aliases:["js"],import:()=>f.e(8584).then(f.bind(f,60150))},{id:"jinja",name:"Jinja",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(50)]).then(f.bind(f,30050))},{id:"jison",name:"Jison",import:()=>Promise.all([f.e(8584),f.e(4089)]).then(f.bind(f,4089))},{id:"json",name:"JSON",import:()=>f.e(9097).then(f.bind(f,29097))},{id:"json5",name:"JSON5",import:()=>f.e(2740).then(f.bind(f,72740))},{id:"jsonc",name:"JSON with Comments",import:()=>f.e(8238).then(f.bind(f,18238))},{id:"jsonl",name:"JSON Lines",import:()=>f.e(703).then(f.bind(f,90703))},{id:"jsonnet",name:"Jsonnet",import:()=>f.e(709).then(f.bind(f,30709))},{id:"jssm",name:"JSSM",aliases:["fsl"],import:()=>f.e(620).then(f.bind(f,90620))},{id:"jsx",name:"JSX",import:()=>f.e(5519).then(f.bind(f,75611))},{id:"julia",name:"Julia",aliases:["jl"],import:()=>Promise.all([f.e(8584),f.e(75),f.e(7185),f.e(3796),f.e(7809),f.e(4828),f.e(1210),f.e(418)]).then(f.bind(f,30287))},{id:"kotlin",name:"Kotlin",aliases:["kt","kts"],import:()=>f.e(6879).then(f.bind(f,36879))},{id:"kusto",name:"Kusto",aliases:["kql"],import:()=>f.e(1187).then(f.bind(f,61187))},{id:"latex",name:"LaTeX",import:()=>Promise.all([f.e(8584),f.e(414),f.e(75),f.e(7185),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(9235),f.e(4828),f.e(1210),f.e(5599),f.e(418),f.e(7795),f.e(4250)]).then(f.bind(f,34250))},{id:"less",name:"Less",import:()=>f.e(2489).then(f.bind(f,52489))},{id:"liquid",name:"Liquid",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(9792)]).then(f.bind(f,89792))},{id:"lisp",name:"Lisp",import:()=>f.e(6779).then(f.bind(f,86779))},{id:"logo",name:"Logo",import:()=>f.e(2972).then(f.bind(f,72972))},{id:"lua",name:"Lua",import:()=>Promise.all([f.e(7809),f.e(8139)]).then(f.bind(f,68139))},{id:"make",name:"Makefile",aliases:["makefile"],import:()=>f.e(7502).then(f.bind(f,87502))},{id:"markdown",name:"Markdown",aliases:["md"],import:()=>f.e(4686).then(f.bind(f,99802))},{id:"marko",name:"Marko",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(1672),f.e(2489),f.e(9841)]).then(f.bind(f,9841))},{id:"matlab",name:"MATLAB",import:()=>f.e(2020).then(f.bind(f,42020))},{id:"mdc",name:"MDC",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(4686),f.e(206)]).then(f.bind(f,90206))},{id:"mdx",name:"MDX",import:()=>f.e(5340).then(f.bind(f,55340))},{id:"mermaid",name:"Mermaid",import:()=>f.e(7010).then(f.bind(f,97010))},{id:"mojo",name:"Mojo",import:()=>f.e(4109).then(f.bind(f,34109))},{id:"move",name:"Move",import:()=>f.e(9830).then(f.bind(f,19830))},{id:"narrat",name:"Narrat Language",aliases:["nar"],import:()=>f.e(6228).then(f.bind(f,96228))},{id:"nextflow",name:"Nextflow",aliases:["nf"],import:()=>f.e(6787).then(f.bind(f,6787))},{id:"nginx",name:"Nginx",import:()=>Promise.all([f.e(7809),f.e(9453)]).then(f.bind(f,79453))},{id:"nim",name:"Nim",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(2693),f.e(7809),f.e(4686),f.e(1919)]).then(f.bind(f,31919))},{id:"nix",name:"Nix",import:()=>f.e(1574).then(f.bind(f,11574))},{id:"nushell",name:"nushell",aliases:["nu"],import:()=>f.e(90).then(f.bind(f,70090))},{id:"objective-c",name:"Objective-C",aliases:["objc"],import:()=>f.e(13).then(f.bind(f,30013))},{id:"objective-cpp",name:"Objective-C++",import:()=>f.e(5492).then(f.bind(f,29636))},{id:"ocaml",name:"OCaml",import:()=>f.e(1685).then(f.bind(f,21685))},{id:"pascal",name:"Pascal",import:()=>f.e(3590).then(f.bind(f,13590))},{id:"perl",name:"Perl",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(4588)]).then(f.bind(f,44588))},{id:"php",name:"PHP",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(1882),f.e(9815)]).then(f.bind(f,21882))},{id:"plsql",name:"PL/SQL",import:()=>f.e(3077).then(f.bind(f,33077))},{id:"postcss",name:"PostCSS",import:()=>f.e(4389).then(f.bind(f,84389))},{id:"powerquery",name:"PowerQuery",import:()=>f.e(4753).then(f.bind(f,94753))},{id:"powershell",name:"PowerShell",aliases:["ps","ps1"],import:()=>f.e(5030).then(f.bind(f,55030))},{id:"prisma",name:"Prisma",import:()=>f.e(1800).then(f.bind(f,81800))},{id:"prolog",name:"Prolog",import:()=>f.e(4857).then(f.bind(f,44857))},{id:"proto",name:"Protocol Buffer 3",import:()=>f.e(2867).then(f.bind(f,52867))},{id:"pug",name:"Pug",aliases:["jade"],import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(1672),f.e(2090),f.e(7433),f.e(58)]).then(f.bind(f,40058))},{id:"puppet",name:"Puppet",import:()=>f.e(4336).then(f.bind(f,14336))},{id:"purescript",name:"PureScript",import:()=>f.e(3246).then(f.bind(f,43246))},{id:"python",name:"Python",aliases:["py"],import:()=>f.e(4828).then(f.bind(f,4828))},{id:"r",name:"R",import:()=>f.e(1210).then(f.bind(f,71210))},{id:"raku",name:"Raku",aliases:["perl6"],import:()=>f.e(4342).then(f.bind(f,34342))},{id:"razor",name:"ASP.NET Razor",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(6984),f.e(895)]).then(f.bind(f,70895))},{id:"reg",name:"Windows Registry Script",import:()=>f.e(7286).then(f.bind(f,67286))},{id:"rel",name:"Rel",import:()=>f.e(1383).then(f.bind(f,60915))},{id:"riscv",name:"RISC-V",import:()=>f.e(7880).then(f.bind(f,97880))},{id:"rst",name:"reStructuredText",import:()=>Promise.all([f.e(8584),f.e(75),f.e(7185),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(9235),f.e(4828),f.e(1698)]).then(f.bind(f,97079))},{id:"ruby",name:"Ruby",aliases:["rb"],import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(9235)]).then(f.bind(f,29235))},{id:"rust",name:"Rust",aliases:["rs"],import:()=>f.e(9069).then(f.bind(f,89069))},{id:"sas",name:"SAS",import:()=>Promise.all([f.e(3796),f.e(6600)]).then(f.bind(f,6600))},{id:"sass",name:"Sass",import:()=>f.e(4548).then(f.bind(f,4548))},{id:"scala",name:"Scala",import:()=>f.e(7795).then(f.bind(f,47795))},{id:"scheme",name:"Scheme",import:()=>f.e(640).then(f.bind(f,50640))},{id:"scss",name:"SCSS",import:()=>Promise.all([f.e(8580),f.e(1672)]).then(f.bind(f,11672))},{id:"shaderlab",name:"ShaderLab",aliases:["shader"],import:()=>f.e(7442).then(f.bind(f,27442))},{id:"shellscript",name:"Shell",aliases:["bash","sh","shell","zsh"],import:()=>f.e(9819).then(f.bind(f,29819))},{id:"shellsession",name:"Shell Session",aliases:["console"],import:()=>Promise.all([f.e(9819),f.e(9138)]).then(f.bind(f,39138))},{id:"smalltalk",name:"Smalltalk",import:()=>f.e(1455).then(f.bind(f,11455))},{id:"solidity",name:"Solidity",import:()=>f.e(31).then(f.bind(f,40031))},{id:"sparql",name:"SPARQL",import:()=>f.e(9651).then(f.bind(f,19651))},{id:"splunk",name:"Splunk Query Language",aliases:["spl"],import:()=>f.e(6008).then(f.bind(f,6008))},{id:"sql",name:"SQL",import:()=>f.e(3796).then(f.bind(f,93796))},{id:"ssh-config",name:"SSH Config",import:()=>f.e(8471).then(f.bind(f,68471))},{id:"stata",name:"Stata",import:()=>Promise.all([f.e(3796),f.e(4597)]).then(f.bind(f,54597))},{id:"stylus",name:"Stylus",aliases:["styl"],import:()=>f.e(2090).then(f.bind(f,82090))},{id:"svelte",name:"Svelte",import:()=>Promise.all([f.e(8584),f.e(414),f.e(8580),f.e(8203),f.e(1672),f.e(4686),f.e(2489),f.e(2090),f.e(7433),f.e(58),f.e(2206)]).then(f.bind(f,72206))},{id:"swift",name:"Swift",import:()=>f.e(3301).then(f.bind(f,23301))},{id:"system-verilog",name:"SystemVerilog",import:()=>f.e(7047).then(f.bind(f,87047))},{id:"tasl",name:"Tasl",import:()=>f.e(4754).then(f.bind(f,4754))},{id:"tcl",name:"Tcl",import:()=>f.e(4674).then(f.bind(f,24674))},{id:"terraform",name:"Terraform",aliases:["tf","tfvars"],import:()=>f.e(1692).then(f.bind(f,21692))},{id:"tex",name:"TeX",import:()=>Promise.all([f.e(1210),f.e(9332)]).then(f.bind(f,29332))},{id:"toml",name:"TOML",import:()=>f.e(9930).then(f.bind(f,19930))},{id:"tsx",name:"TSX",import:()=>f.e(6673).then(f.bind(f,33379))},{id:"turtle",name:"Turtle",import:()=>f.e(1740).then(f.bind(f,1740))},{id:"twig",name:"Twig",import:()=>Promise.all([f.e(8584),f.e(8580),f.e(8203),f.e(3796),f.e(2693),f.e(7809),f.e(9819),f.e(1672),f.e(9235),f.e(4828),f.e(1882),f.e(3093)]).then(f.bind(f,73093))},{id:"typescript",name:"TypeScript",aliases:["ts"],import:()=>f.e(414).then(f.bind(f,73536))},{id:"typst",name:"Typst",aliases:["typ"],import:()=>f.e(8678).then(f.bind(f,98678))},{id:"v",name:"V",import:()=>f.e(6032).then(f.bind(f,46032))},{id:"vb",name:"Visual Basic",aliases:["cmd"],import:()=>f.e(3086).then(f.bind(f,83086))},{id:"verilog",name:"Verilog",import:()=>f.e(4231).then(f.bind(f,74231))},{id:"vhdl",name:"VHDL",import:()=>f.e(2313).then(f.bind(f,52313))},{id:"viml",name:"Vim Script",aliases:["vim","vimscript"],import:()=>f.e(6229).then(f.bind(f,16229))},{id:"vue",name:"Vue",import:()=>Promise.all([f.e(8584),f.e(414),f.e(6673),f.e(5519),f.e(8580),f.e(8203),f.e(1672),f.e(4686),f.e(2489),f.e(2090),f.e(7433),f.e(58),f.e(9200)]).then(f.bind(f,79200))},{id:"vue-html",name:"Vue HTML",import:()=>Promise.all([f.e(8584),f.e(414),f.e(6673),f.e(5519),f.e(8580),f.e(8203),f.e(1672),f.e(4686),f.e(2489),f.e(2090),f.e(7433),f.e(58),f.e(9200),f.e(9798)]).then(f.bind(f,9798))},{id:"vyper",name:"Vyper",aliases:["vy"],import:()=>f.e(683).then(f.bind(f,30683))},{id:"wasm",name:"WebAssembly",import:()=>f.e(3553).then(f.bind(f,93553))},{id:"wenyan",name:"Wenyan",aliases:["文言"],import:()=>f.e(7493).then(f.bind(f,37493))},{id:"wgsl",name:"WGSL",import:()=>f.e(6258).then(f.bind(f,26258))},{id:"wolfram",name:"Wolfram",aliases:["wl"],import:()=>f.e(963).then(f.bind(f,54614))},{id:"xml",name:"XML",import:()=>Promise.all([f.e(2693),f.e(2504)]).then(f.bind(f,99815))},{id:"xsl",name:"XSL",import:()=>Promise.all([f.e(2693),f.e(9403)]).then(f.bind(f,39403))},{id:"yaml",name:"YAML",aliases:["yml"],import:()=>f.e(7264).then(f.bind(f,57264))},{id:"zenscript",name:"ZenScript",import:()=>f.e(4805).then(f.bind(f,64805))},{id:"zig",name:"Zig",import:()=>f.e(7637).then(f.bind(f,7637))}],w=Object.fromEntries(x.map(c=>[c.id,c.import])),_=Object.fromEntries(x.flatMap(c=>c.aliases?.map(u=>[u,c.import])||[])),k={...w,..._},getWasmInlined=async c=>Promise.all([f.e(4795),f.e(1907)]).then(f.bind(f,51907)).then(u=>u.default(c)),E=[{id:"andromeeda",displayName:"Andromeeda",type:"dark",import:()=>f.e(8211).then(f.bind(f,18211))},{id:"aurora-x",displayName:"Aurora X",type:"dark",import:()=>f.e(8931).then(f.bind(f,68931))},{id:"ayu-dark",displayName:"Ayu Dark",type:"dark",import:()=>f.e(6924).then(f.bind(f,76924))},{id:"catppuccin-frappe",displayName:"Catppuccin Frapp\xe9",type:"dark",import:()=>f.e(5673).then(f.bind(f,75673))},{id:"catppuccin-latte",displayName:"Catppuccin Latte",type:"light",import:()=>f.e(3770).then(f.bind(f,13770))},{id:"catppuccin-macchiato",displayName:"Catppuccin Macchiato",type:"dark",import:()=>f.e(4708).then(f.bind(f,64708))},{id:"catppuccin-mocha",displayName:"Catppuccin Mocha",type:"dark",import:()=>f.e(928).then(f.bind(f,60928))},{id:"dark-plus",displayName:"Dark Plus",type:"dark",import:()=>f.e(2284).then(f.bind(f,72284))},{id:"dracula",displayName:"Dracula",type:"dark",import:()=>f.e(9155).then(f.bind(f,99155))},{id:"dracula-soft",displayName:"Dracula Soft",type:"dark",import:()=>f.e(301).then(f.bind(f,90301))},{id:"github-dark",displayName:"GitHub Dark",type:"dark",import:()=>f.e(8744).then(f.bind(f,8744))},{id:"github-dark-default",displayName:"GitHub Dark Default",type:"dark",import:()=>f.e(7833).then(f.bind(f,87833))},{id:"github-dark-dimmed",displayName:"GitHub Dark Dimmed",type:"dark",import:()=>f.e(8651).then(f.bind(f,28651))},{id:"github-light",displayName:"GitHub Light",type:"light",import:()=>f.e(9419).then(f.bind(f,99419))},{id:"github-light-default",displayName:"GitHub Light Default",type:"light",import:()=>f.e(7314).then(f.bind(f,27314))},{id:"houston",displayName:"Houston",type:"dark",import:()=>f.e(1789).then(f.bind(f,91789))},{id:"light-plus",displayName:"Light Plus",type:"light",import:()=>f.e(7742).then(f.bind(f,37742))},{id:"material-theme",displayName:"Material Theme",type:"dark",import:()=>f.e(5016).then(f.bind(f,75016))},{id:"material-theme-darker",displayName:"Material Theme Darker",type:"dark",import:()=>f.e(4245).then(f.bind(f,61616))},{id:"material-theme-lighter",displayName:"Material Theme Lighter",type:"light",import:()=>f.e(7900).then(f.bind(f,27900))},{id:"material-theme-ocean",displayName:"Material Theme Ocean",type:"dark",import:()=>f.e(9623).then(f.bind(f,89623))},{id:"material-theme-palenight",displayName:"Material Theme Palenight",type:"dark",import:()=>f.e(6432).then(f.bind(f,96432))},{id:"min-dark",displayName:"Min Dark",type:"dark",import:()=>f.e(1302).then(f.bind(f,51302))},{id:"min-light",displayName:"Min Light",type:"light",import:()=>f.e(6340).then(f.bind(f,36340))},{id:"monokai",displayName:"Monokai",type:"dark",import:()=>f.e(1511).then(f.bind(f,61511))},{id:"night-owl",displayName:"Night Owl",type:"dark",import:()=>f.e(9647).then(f.bind(f,79647))},{id:"nord",displayName:"Nord",type:"dark",import:()=>f.e(6745).then(f.bind(f,56745))},{id:"one-dark-pro",displayName:"One Dark Pro",type:"dark",import:()=>f.e(9285).then(f.bind(f,79285))},{id:"poimandres",displayName:"Poimandres",type:"dark",import:()=>f.e(3622).then(f.bind(f,13622))},{id:"red",displayName:"Red",type:"dark",import:()=>f.e(7522).then(f.bind(f,37522))},{id:"rose-pine",displayName:"Ros\xe9 Pine",type:"dark",import:()=>f.e(2627).then(f.bind(f,22627))},{id:"rose-pine-dawn",displayName:"Ros\xe9 Pine Dawn",type:"light",import:()=>f.e(6566).then(f.bind(f,96566))},{id:"rose-pine-moon",displayName:"Ros\xe9 Pine Moon",type:"dark",import:()=>f.e(8859).then(f.bind(f,58859))},{id:"slack-dark",displayName:"Slack Dark",type:"dark",import:()=>f.e(5154).then(f.bind(f,95154))},{id:"slack-ochin",displayName:"Slack Ochin",type:"light",import:()=>f.e(9230).then(f.bind(f,69230))},{id:"solarized-dark",displayName:"Solarized Dark",type:"dark",import:()=>f.e(4158).then(f.bind(f,74158))},{id:"solarized-light",displayName:"Solarized Light",type:"light",import:()=>f.e(7696).then(f.bind(f,67696))},{id:"synthwave-84",displayName:"Synthwave '84",type:"dark",import:()=>f.e(4149).then(f.bind(f,24149))},{id:"tokyo-night",displayName:"Tokyo Night",type:"dark",import:()=>f.e(2625).then(f.bind(f,12625))},{id:"vesper",displayName:"Vesper",type:"dark",import:()=>f.e(4737).then(f.bind(f,4737))},{id:"vitesse-black",displayName:"Vitesse Black",type:"dark",import:()=>f.e(2338).then(f.bind(f,52338))},{id:"vitesse-dark",displayName:"Vitesse Dark",type:"dark",import:()=>f.e(4881).then(f.bind(f,4881))},{id:"vitesse-light",displayName:"Vitesse Light",type:"light",import:()=>f.e(8483).then(f.bind(f,48483))}],T=Object.fromEntries(E.map(c=>[c.id,c.import]));($=I||(I={}))[$.NotSet=-1]="NotSet",$[$.None=0]="None",$[$.Italic=1]="Italic",$[$.Bold=2]="Bold",$[$.Underline=4]="Underline";var $,I,M,j=f(62601);function toOptionalTokenType(c){return c}function fromOptionalTokenType(c){return c}function createMatchers(c,u){let f=[],g=newTokenizer(c),b=g.next();for(;null!==b;){let c=0;if(2===b.length&&":"===b.charAt(1)){switch(b.charAt(0)){case"R":c=1;break;case"L":c=-1;break;default:console.log(`Unknown priority ${b} in scope selector`)}b=g.next()}let u=parseConjunction();if(f.push({matcher:u,priority:c}),","!==b)break;b=g.next()}return f;function parseOperand(){if("-"===b){b=g.next();let c=parseOperand();return u=>!!c&&!c(u)}if("("===b){b=g.next();let c=parseInnerExpression();return")"===b&&(b=g.next()),c}if(isIdentifier(b)){let c=[];do c.push(b),b=g.next();while(isIdentifier(b));return f=>u(c,f)}return null}function parseConjunction(){let c=[],u=parseOperand();for(;u;)c.push(u),u=parseOperand();return u=>c.every(c=>c(u))}function parseInnerExpression(){let c=[],u=parseConjunction();for(;u&&(c.push(u),"|"===b||","===b);){do b=g.next();while("|"===b||","===b);u=parseConjunction()}return u=>c.some(c=>c(u))}}function isIdentifier(c){return!!c&&!!c.match(/[\w\.:]+/)}function newTokenizer(c){let u=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,f=u.exec(c);return{next:()=>{if(!f)return null;let g=f[0];return f=u.exec(c),g}}}function disposeOnigString(c){"function"==typeof c.dispose&&c.dispose()}function clone(c){return doClone(c)}function doClone(c){return Array.isArray(c)?cloneArray(c):"object"==typeof c?cloneObj(c):c}function cloneArray(c){let u=[];for(let f=0,g=c.length;f<g;f++)u[f]=doClone(c[f]);return u}function cloneObj(c){let u={};for(let f in c)u[f]=doClone(c[f]);return u}function mergeObjects(c,...u){return u.forEach(u=>{for(let f in u)c[f]=u[f]}),c}function basename(c){let u=~c.lastIndexOf("/")||~c.lastIndexOf("\\");return 0===u?c:~u==c.length-1?basename(c.substring(0,c.length-1)):c.substr(~u+1)}void 0!==j&&j.env.VSCODE_TEXTMATE_DEBUG,function(c){function toBinaryStr(c){return c.toString(2).padStart(32,"0")}function print(u){let f=c.getLanguageId(u),g=c.getTokenType(u),b=c.getFontStyle(u),v=c.getForeground(u),x=c.getBackground(u);console.log({languageId:f,tokenType:g,fontStyle:b,foreground:v,background:x})}function getLanguageId(c){return(255&c)>>>0}function getTokenType(c){return(768&c)>>>8}function containsBalancedBrackets(c){return(1024&c)!=0}function getFontStyle(c){return(30720&c)>>>11}function getForeground(c){return(16744448&c)>>>15}function getBackground(c){return(4278190080&c)>>>24}function set(u,f,g,b,v,x,w){let _=c.getLanguageId(u),k=c.getTokenType(u),E=c.containsBalancedBrackets(u)?1:0,T=c.getFontStyle(u),$=c.getForeground(u),I=c.getBackground(u);return 0!==f&&(_=f),8!==g&&(k=fromOptionalTokenType(g)),null!==b&&(E=b?1:0),-1!==v&&(T=v),0!==x&&($=x),0!==w&&(I=w),(_<<0|k<<8|E<<10|T<<11|$<<15|I<<24)>>>0}c.toBinaryStr=toBinaryStr,c.print=print,c.getLanguageId=getLanguageId,c.getTokenType=getTokenType,c.containsBalancedBrackets=containsBalancedBrackets,c.getFontStyle=getFontStyle,c.getForeground=getForeground,c.getBackground=getBackground,c.set=set}(M||(M={}));let D=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;let RegexSource=class RegexSource{static hasCaptures(c){return null!==c&&(D.lastIndex=0,D.test(c))}static replaceCaptures(c,u,f){return c.replace(D,(c,g,b,v)=>{let x=f[parseInt(g||b,10)];if(!x)return c;{let c=u.substring(x.start,x.end);for(;"."===c[0];)c=c.substring(1);switch(v){case"downcase":return c.toLowerCase();case"upcase":return c.toUpperCase();default:return c}}})}};function strArrCmp(c,u){if(null===c&&null===u)return 0;if(!c)return -1;if(!u)return 1;let f=c.length,g=u.length;if(f===g){for(let g=0;g<f;g++){var b,v;let f=(b=c[g])<(v=u[g])?-1:b>v?1:0;if(0!==f)return f}return 0}return f-g}function isValidHexColor(c){return!!(/^#[0-9a-f]{6}$/i.test(c)||/^#[0-9a-f]{8}$/i.test(c)||/^#[0-9a-f]{3}$/i.test(c)||/^#[0-9a-f]{4}$/i.test(c))}function escapeRegExpCharacters(c){return c.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}let CachedFn=class CachedFn{fn;cache=new Map;constructor(c){this.fn=c}get(c){if(this.cache.has(c))return this.cache.get(c);let u=this.fn(c);return this.cache.set(c,u),u}};let TopLevelRuleReference=class TopLevelRuleReference{scopeName;constructor(c){this.scopeName=c}toKey(){return this.scopeName}};let TopLevelRepositoryRuleReference=class TopLevelRepositoryRuleReference{scopeName;ruleName;constructor(c,u){this.scopeName=c,this.ruleName=u}toKey(){return`${this.scopeName}#${this.ruleName}`}};let ExternalReferenceCollector=class ExternalReferenceCollector{_references=[];_seenReferenceKeys=new Set;get references(){return this._references}visitedRule=new Set;add(c){let u=c.toKey();this._seenReferenceKeys.has(u)||(this._seenReferenceKeys.add(u),this._references.push(c))}};let ScopeDependencyProcessor=class ScopeDependencyProcessor{repo;initialScopeName;seenFullScopeRequests=new Set;seenPartialScopeRequests=new Set;Q;constructor(c,u){this.repo=c,this.initialScopeName=u,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new TopLevelRuleReference(this.initialScopeName)]}processQueue(){let c=this.Q;this.Q=[];let u=new ExternalReferenceCollector;for(let f of c)collectReferencesOfReference(f,this.initialScopeName,this.repo,u);for(let c of u.references)if(c instanceof TopLevelRuleReference){if(this.seenFullScopeRequests.has(c.scopeName))continue;this.seenFullScopeRequests.add(c.scopeName),this.Q.push(c)}else{if(this.seenFullScopeRequests.has(c.scopeName)||this.seenPartialScopeRequests.has(c.toKey()))continue;this.seenPartialScopeRequests.add(c.toKey()),this.Q.push(c)}}};function collectReferencesOfReference(c,u,f,g){let b=f.lookup(c.scopeName);if(!b){if(c.scopeName===u)throw Error(`No grammar provided for <${u}>`);return}let v=f.lookup(u);c instanceof TopLevelRuleReference?collectExternalReferencesInTopLevelRule({baseGrammar:v,selfGrammar:b},g):collectExternalReferencesInTopLevelRepositoryRule(c.ruleName,{baseGrammar:v,selfGrammar:b,repository:b.repository},g);let x=f.injections(c.scopeName);if(x)for(let c of x)g.add(new TopLevelRuleReference(c))}function collectExternalReferencesInTopLevelRepositoryRule(c,u,f){if(u.repository&&u.repository[c]){let g=u.repository[c];collectExternalReferencesInRules([g],u,f)}}function collectExternalReferencesInTopLevelRule(c,u){c.selfGrammar.patterns&&Array.isArray(c.selfGrammar.patterns)&&collectExternalReferencesInRules(c.selfGrammar.patterns,{...c,repository:c.selfGrammar.repository},u),c.selfGrammar.injections&&collectExternalReferencesInRules(Object.values(c.selfGrammar.injections),{...c,repository:c.selfGrammar.repository},u)}function collectExternalReferencesInRules(c,u,f){for(let g of c){if(f.visitedRule.has(g))continue;f.visitedRule.add(g);let c=g.repository?mergeObjects({},u.repository,g.repository):u.repository;Array.isArray(g.patterns)&&collectExternalReferencesInRules(g.patterns,{...u,repository:c},f);let b=g.include;if(!b)continue;let v=parseInclude(b);switch(v.kind){case 0:collectExternalReferencesInTopLevelRule({...u,selfGrammar:u.baseGrammar},f);break;case 1:collectExternalReferencesInTopLevelRule(u,f);break;case 2:collectExternalReferencesInTopLevelRepositoryRule(v.ruleName,{...u,repository:c},f);break;case 3:case 4:let x=v.scopeName===u.selfGrammar.scopeName?u.selfGrammar:v.scopeName===u.baseGrammar.scopeName?u.baseGrammar:void 0;if(x){let g={baseGrammar:u.baseGrammar,selfGrammar:x,repository:c};4===v.kind?collectExternalReferencesInTopLevelRepositoryRule(v.ruleName,g,f):collectExternalReferencesInTopLevelRule(g,f)}else 4===v.kind?f.add(new TopLevelRepositoryRuleReference(v.scopeName,v.ruleName)):f.add(new TopLevelRuleReference(v.scopeName))}}}let BaseReference=class BaseReference{kind=0};let SelfReference=class SelfReference{kind=1};let RelativeReference=class RelativeReference{ruleName;kind=2;constructor(c){this.ruleName=c}};let TopLevelReference=class TopLevelReference{scopeName;kind=3;constructor(c){this.scopeName=c}};let TopLevelRepositoryReference=class TopLevelRepositoryReference{scopeName;ruleName;kind=4;constructor(c,u){this.scopeName=c,this.ruleName=u}};function parseInclude(c){if("$base"===c)return new BaseReference;if("$self"===c)return new SelfReference;let u=c.indexOf("#");if(-1===u)return new TopLevelReference(c);if(0===u)return new RelativeReference(c.substring(1));{let f=c.substring(0,u),g=c.substring(u+1);return new TopLevelRepositoryReference(f,g)}}let L=/\\(\d+)/,F=/\\(\d+)/g;let Rule=class Rule{$location;id;_nameIsCapturing;_name;_contentNameIsCapturing;_contentName;constructor(c,u,f,g){this.$location=c,this.id=u,this._name=f||null,this._nameIsCapturing=RegexSource.hasCaptures(this._name),this._contentName=g||null,this._contentNameIsCapturing=RegexSource.hasCaptures(this._contentName)}get debugName(){let c=this.$location?`${basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${c}`}getName(c,u){return this._nameIsCapturing&&null!==this._name&&null!==c&&null!==u?RegexSource.replaceCaptures(this._name,c,u):this._name}getContentName(c,u){return this._contentNameIsCapturing&&null!==this._contentName?RegexSource.replaceCaptures(this._contentName,c,u):this._contentName}};let CaptureRule=class CaptureRule extends Rule{retokenizeCapturedWithRuleId;constructor(c,u,f,g,b){super(c,u,f,g),this.retokenizeCapturedWithRuleId=b}dispose(){}collectPatterns(c,u){throw Error("Not supported!")}compile(c,u){throw Error("Not supported!")}compileAG(c,u,f,g){throw Error("Not supported!")}};let MatchRule=class MatchRule extends Rule{_match;captures;_cachedCompiledPatterns;constructor(c,u,f,g,b){super(c,u,f,null),this._match=new RegExpSource(g,this.id),this.captures=b,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(c,u){u.push(this._match)}compile(c,u){return this._getCachedCompiledPatterns(c).compile(c)}compileAG(c,u,f,g){return this._getCachedCompiledPatterns(c).compileAG(c,f,g)}_getCachedCompiledPatterns(c){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new RegExpSourceList,this.collectPatterns(c,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}};let IncludeOnlyRule=class IncludeOnlyRule extends Rule{hasMissingPatterns;patterns;_cachedCompiledPatterns;constructor(c,u,f,g,b){super(c,u,f,g),this.patterns=b.patterns,this.hasMissingPatterns=b.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(c,u){for(let f of this.patterns){let g=c.getRule(f);g.collectPatterns(c,u)}}compile(c,u){return this._getCachedCompiledPatterns(c).compile(c)}compileAG(c,u,f,g){return this._getCachedCompiledPatterns(c).compileAG(c,f,g)}_getCachedCompiledPatterns(c){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new RegExpSourceList,this.collectPatterns(c,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}};let BeginEndRule=class BeginEndRule extends Rule{_begin;beginCaptures;_end;endHasBackReferences;endCaptures;applyEndPatternLast;hasMissingPatterns;patterns;_cachedCompiledPatterns;constructor(c,u,f,g,b,v,x,w,_,k){super(c,u,f,g),this._begin=new RegExpSource(b,this.id),this.beginCaptures=v,this._end=new RegExpSource(x||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=w,this.applyEndPatternLast=_||!1,this.patterns=k.patterns,this.hasMissingPatterns=k.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(c,u){return this._end.resolveBackReferences(c,u)}collectPatterns(c,u){u.push(this._begin)}compile(c,u){return this._getCachedCompiledPatterns(c,u).compile(c)}compileAG(c,u,f,g){return this._getCachedCompiledPatterns(c,u).compileAG(c,f,g)}_getCachedCompiledPatterns(c,u){if(!this._cachedCompiledPatterns){for(let u of(this._cachedCompiledPatterns=new RegExpSourceList,this.patterns)){let f=c.getRule(u);f.collectPatterns(c,this._cachedCompiledPatterns)}this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,u):this._cachedCompiledPatterns.setSource(0,u)),this._cachedCompiledPatterns}};let BeginWhileRule=class BeginWhileRule extends Rule{_begin;beginCaptures;whileCaptures;_while;whileHasBackReferences;hasMissingPatterns;patterns;_cachedCompiledPatterns;_cachedCompiledWhilePatterns;constructor(c,u,f,g,b,v,x,w,_){super(c,u,f,g),this._begin=new RegExpSource(b,this.id),this.beginCaptures=v,this.whileCaptures=w,this._while=new RegExpSource(x,-2),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=_.patterns,this.hasMissingPatterns=_.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(c,u){return this._while.resolveBackReferences(c,u)}collectPatterns(c,u){u.push(this._begin)}compile(c,u){return this._getCachedCompiledPatterns(c).compile(c)}compileAG(c,u,f,g){return this._getCachedCompiledPatterns(c).compileAG(c,f,g)}_getCachedCompiledPatterns(c){if(!this._cachedCompiledPatterns)for(let u of(this._cachedCompiledPatterns=new RegExpSourceList,this.patterns)){let f=c.getRule(u);f.collectPatterns(c,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(c,u){return this._getCachedCompiledWhilePatterns(c,u).compile(c)}compileWhileAG(c,u,f,g){return this._getCachedCompiledWhilePatterns(c,u).compileAG(c,f,g)}_getCachedCompiledWhilePatterns(c,u){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new RegExpSourceList,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,u||"￿"),this._cachedCompiledWhilePatterns}};let RuleFactory=class RuleFactory{static createCaptureRule(c,u,f,g,b){return c.registerRule(c=>new CaptureRule(u,c,f,g,b))}static getCompiledRuleId(c,u,f){return c.id||u.registerRule(g=>{if(c.id=g,c.match)return new MatchRule(c.$vscodeTextmateLocation,c.id,c.name,c.match,RuleFactory._compileCaptures(c.captures,u,f));if(void 0===c.begin){c.repository&&(f=mergeObjects({},f,c.repository));let g=c.patterns;return void 0===g&&c.include&&(g=[{include:c.include}]),new IncludeOnlyRule(c.$vscodeTextmateLocation,c.id,c.name,c.contentName,RuleFactory._compilePatterns(g,u,f))}return c.while?new BeginWhileRule(c.$vscodeTextmateLocation,c.id,c.name,c.contentName,c.begin,RuleFactory._compileCaptures(c.beginCaptures||c.captures,u,f),c.while,RuleFactory._compileCaptures(c.whileCaptures||c.captures,u,f),RuleFactory._compilePatterns(c.patterns,u,f)):new BeginEndRule(c.$vscodeTextmateLocation,c.id,c.name,c.contentName,c.begin,RuleFactory._compileCaptures(c.beginCaptures||c.captures,u,f),c.end,RuleFactory._compileCaptures(c.endCaptures||c.captures,u,f),c.applyEndPatternLast,RuleFactory._compilePatterns(c.patterns,u,f))}),c.id}static _compileCaptures(c,u,f){let g=[];if(c){let b=0;for(let u in c){if("$vscodeTextmateLocation"===u)continue;let c=parseInt(u,10);c>b&&(b=c)}for(let c=0;c<=b;c++)g[c]=null;for(let b in c){if("$vscodeTextmateLocation"===b)continue;let v=parseInt(b,10),x=0;c[b].patterns&&(x=RuleFactory.getCompiledRuleId(c[b],u,f)),g[v]=RuleFactory.createCaptureRule(u,c[b].$vscodeTextmateLocation,c[b].name,c[b].contentName,x)}}return g}static _compilePatterns(c,u,f){let g=[];if(c)for(let b=0,v=c.length;b<v;b++){let v=c[b],x=-1;if(v.include){let c=parseInclude(v.include);switch(c.kind){case 0:case 1:x=RuleFactory.getCompiledRuleId(f[v.include],u,f);break;case 2:let g=f[c.ruleName];g&&(x=RuleFactory.getCompiledRuleId(g,u,f));break;case 3:case 4:let b=c.scopeName,w=4===c.kind?c.ruleName:null,_=u.getExternalGrammar(b,f);if(_){if(w){let c=_.repository[w];c&&(x=RuleFactory.getCompiledRuleId(c,u,_.repository))}else x=RuleFactory.getCompiledRuleId(_.repository.$self,u,_.repository)}}}else x=RuleFactory.getCompiledRuleId(v,u,f);if(-1!==x){let c=u.getRule(x),f=!1;if((c instanceof IncludeOnlyRule||c instanceof BeginEndRule||c instanceof BeginWhileRule)&&c.hasMissingPatterns&&0===c.patterns.length&&(f=!0),f)continue;g.push(x)}}return{patterns:g,hasMissingPatterns:(c?c.length:0)!==g.length}}};let RegExpSource=class RegExpSource{source;ruleId;hasAnchor;hasBackReferences;_anchorCache;constructor(c,u){if(c){let u=c.length,f=0,g=[],b=!1;for(let v=0;v<u;v++){let x=c.charAt(v);if("\\"===x&&v+1<u){let u=c.charAt(v+1);"z"===u?(g.push(c.substring(f,v)),g.push("$(?!\\n)(?<!\\n)"),f=v+2):("A"===u||"G"===u)&&(b=!0),v++}}this.hasAnchor=b,0===f?this.source=c:(g.push(c.substring(f,u)),this.source=g.join(""))}else this.hasAnchor=!1,this.source=c;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=u,this.hasBackReferences=L.test(this.source)}clone(){return new RegExpSource(this.source,this.ruleId)}setSource(c){this.source!==c&&(this.source=c,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(c,u){let f=u.map(u=>c.substring(u.start,u.end));return F.lastIndex=0,this.source.replace(F,(c,u)=>escapeRegExpCharacters(f[parseInt(u,10)]||""))}_buildAnchorCache(){let c,u,f,g,b=[],v=[],x=[],w=[];for(c=0,u=this.source.length;c<u;c++)f=this.source.charAt(c),b[c]=f,v[c]=f,x[c]=f,w[c]=f,"\\"===f&&c+1<u&&("A"===(g=this.source.charAt(c+1))?(b[c+1]="￿",v[c+1]="￿",x[c+1]="A",w[c+1]="A"):"G"===g?(b[c+1]="￿",v[c+1]="G",x[c+1]="￿",w[c+1]="G"):(b[c+1]=g,v[c+1]=g,x[c+1]=g,w[c+1]=g),c++);return{A0_G0:b.join(""),A0_G1:v.join(""),A1_G0:x.join(""),A1_G1:w.join("")}}resolveAnchors(c,u){return this.hasAnchor&&this._anchorCache?c?u?this._anchorCache.A1_G1:this._anchorCache.A1_G0:u?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}};let RegExpSourceList=class RegExpSourceList{_items;_hasAnchors;_cached;_anchorCache;constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(c){this._items.push(c),this._hasAnchors=this._hasAnchors||c.hasAnchor}unshift(c){this._items.unshift(c),this._hasAnchors=this._hasAnchors||c.hasAnchor}length(){return this._items.length}setSource(c,u){this._items[c].source!==u&&(this._disposeCaches(),this._items[c].setSource(u))}compile(c){if(!this._cached){let u=this._items.map(c=>c.source);this._cached=new CompiledRule(c,u,this._items.map(c=>c.ruleId))}return this._cached}compileAG(c,u,f){return this._hasAnchors?u?f?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(c,u,f)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(c,u,f)),this._anchorCache.A1_G0):f?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(c,u,f)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(c,u,f)),this._anchorCache.A0_G0):this.compile(c)}_resolveAnchors(c,u,f){return new CompiledRule(c,this._items.map(c=>c.resolveAnchors(u,f)),this._items.map(c=>c.ruleId))}};let CompiledRule=class CompiledRule{regExps;rules;scanner;constructor(c,u,f){this.regExps=u,this.rules=f,this.scanner=c.createOnigScanner(u)}dispose(){"function"==typeof this.scanner.dispose&&this.scanner.dispose()}toString(){let c=[];for(let u=0,f=this.rules.length;u<f;u++)c.push("   - "+this.rules[u]+": "+this.regExps[u]);return c.join("\n")}findNextMatchSync(c,u,f){let g=this.scanner.findNextMatchSync(c,u,f);return g?{ruleId:this.rules[g.index],captureIndices:g.captureIndices}:null}};let Theme=class Theme{_colorMap;_defaults;_root;static createFromRawTheme(c,u){return this.createFromParsedTheme(parseTheme(c),u)}static createFromParsedTheme(c,u){return resolveParsedThemeRules(c,u)}_cachedMatchRoot=new CachedFn(c=>this._root.match(c));constructor(c,u,f){this._colorMap=c,this._defaults=u,this._root=f}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(c){if(null===c)return this._defaults;let u=c.scopeName,f=this._cachedMatchRoot.get(u),g=f.find(u=>_scopePathMatchesParentScopes(c.parent,u.parentScopes));return g?new StyleAttributes(g.fontStyle,g.foreground,g.background):null}};let ScopeStack=class ScopeStack{parent;scopeName;static push(c,u){for(let f of u)c=new ScopeStack(c,f);return c}static from(...c){let u=null;for(let f=0;f<c.length;f++)u=new ScopeStack(u,c[f]);return u}constructor(c,u){this.parent=c,this.scopeName=u}push(c){return new ScopeStack(this,c)}getSegments(){let c=this,u=[];for(;c;)u.push(c.scopeName),c=c.parent;return u.reverse(),u}toString(){return this.getSegments().join(" ")}extends(c){return this===c||null!==this.parent&&this.parent.extends(c)}getExtensionIfDefined(c){let u=[],f=this;for(;f&&f!==c;)u.push(f.scopeName),f=f.parent;return f===c?u.reverse():void 0}};function _scopePathMatchesParentScopes(c,u){if(null===u)return!0;let f=0,g=u[0];for(;c;){if(_matchesScope(c.scopeName,g)){if(++f===u.length)return!0;g=u[f]}c=c.parent}return!1}function _matchesScope(c,u){return u===c||c.startsWith(u)&&"."===c[u.length]}let StyleAttributes=class StyleAttributes{fontStyle;foregroundId;backgroundId;constructor(c,u,f){this.fontStyle=c,this.foregroundId=u,this.backgroundId=f}};function parseTheme(c){if(!c||!c.settings||!Array.isArray(c.settings))return[];let u=c.settings,f=[],g=0;for(let c=0,b=u.length;c<b;c++){let b,v=u[c];if(!v.settings)continue;if("string"==typeof v.scope){let c=v.scope;b=(c=(c=c.replace(/^[,]+/,"")).replace(/[,]+$/,"")).split(",")}else b=Array.isArray(v.scope)?v.scope:[""];let x=-1;if("string"==typeof v.settings.fontStyle){x=0;let c=v.settings.fontStyle.split(" ");for(let u=0,f=c.length;u<f;u++)switch(c[u]){case"italic":x|=1;break;case"bold":x|=2;break;case"underline":x|=4;break;case"strikethrough":x|=8}}let w=null;"string"==typeof v.settings.foreground&&isValidHexColor(v.settings.foreground)&&(w=v.settings.foreground);let _=null;"string"==typeof v.settings.background&&isValidHexColor(v.settings.background)&&(_=v.settings.background);for(let u=0,v=b.length;u<v;u++){let v=b[u].trim().split(" "),k=v[v.length-1],E=null;v.length>1&&(E=v.slice(0,v.length-1)).reverse(),f[g++]=new ParsedThemeRule(k,E,c,x,w,_)}}return f}let ParsedThemeRule=class ParsedThemeRule{scope;parentScopes;index;fontStyle;foreground;background;constructor(c,u,f,g,b,v){this.scope=c,this.parentScopes=u,this.index=f,this.fontStyle=g,this.foreground=b,this.background=v}};function resolveParsedThemeRules(c,u){c.sort((c,u)=>{var f,g;let b=(f=c.scope)<(g=u.scope)?-1:f>g?1:0;return 0!==b||0!==(b=strArrCmp(c.parentScopes,u.parentScopes))?b:c.index-u.index});let f=0,g="#000000",b="#ffffff";for(;c.length>=1&&""===c[0].scope;){let u=c.shift();-1!==u.fontStyle&&(f=u.fontStyle),null!==u.foreground&&(g=u.foreground),null!==u.background&&(b=u.background)}let v=new ColorMap(u),x=new StyleAttributes(f,v.getId(g),v.getId(b)),w=new ThemeTrieElement(new ThemeTrieElementRule(0,null,-1,0,0),[]);for(let u=0,f=c.length;u<f;u++){let f=c[u];w.insert(0,f.scope,f.parentScopes,f.fontStyle,v.getId(f.foreground),v.getId(f.background))}return new Theme(v,x,w)}let ColorMap=class ColorMap{_isFrozen;_lastColorId;_id2color;_color2id;constructor(c){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(c)){this._isFrozen=!0;for(let u=0,f=c.length;u<f;u++)this._color2id[c[u]]=u,this._id2color[u]=c[u]}else this._isFrozen=!1}getId(c){if(null===c)return 0;c=c.toUpperCase();let u=this._color2id[c];if(u)return u;if(this._isFrozen)throw Error(`Missing color in color map - ${c}`);return u=++this._lastColorId,this._color2id[c]=u,this._id2color[u]=c,u}getColorMap(){return this._id2color.slice(0)}};let ThemeTrieElementRule=class ThemeTrieElementRule{scopeDepth;parentScopes;fontStyle;foreground;background;constructor(c,u,f,g,b){this.scopeDepth=c,this.parentScopes=u,this.fontStyle=f,this.foreground=g,this.background=b}clone(){return new ThemeTrieElementRule(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(c){let u=[];for(let f=0,g=c.length;f<g;f++)u[f]=c[f].clone();return u}acceptOverwrite(c,u,f,g){this.scopeDepth>c?console.log("how did this happen?"):this.scopeDepth=c,-1!==u&&(this.fontStyle=u),0!==f&&(this.foreground=f),0!==g&&(this.background=g)}};let ThemeTrieElement=class ThemeTrieElement{_mainRule;_children;_rulesWithParentScopes;constructor(c,u=[],f={}){this._mainRule=c,this._children=f,this._rulesWithParentScopes=u}static _sortBySpecificity(c){return 1===c.length||c.sort(this._cmpBySpecificity),c}static _cmpBySpecificity(c,u){if(c.scopeDepth===u.scopeDepth){let f=c.parentScopes,g=u.parentScopes,b=null===f?0:f.length,v=null===g?0:g.length;if(b===v)for(let c=0;c<b;c++){let u=f[c].length,b=g[c].length;if(u!==b)return b-u}return v-b}return u.scopeDepth-c.scopeDepth}match(c){let u,f;if(""===c)return ThemeTrieElement._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let g=c.indexOf(".");return(-1===g?(u=c,f=""):(u=c.substring(0,g),f=c.substring(g+1)),this._children.hasOwnProperty(u))?this._children[u].match(f):ThemeTrieElement._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(c,u,f,g,b,v){let x,w,_;if(""===u){this._doInsertHere(c,f,g,b,v);return}let k=u.indexOf(".");-1===k?(x=u,w=""):(x=u.substring(0,k),w=u.substring(k+1)),this._children.hasOwnProperty(x)?_=this._children[x]:(_=new ThemeTrieElement(this._mainRule.clone(),ThemeTrieElementRule.cloneArr(this._rulesWithParentScopes)),this._children[x]=_),_.insert(c+1,w,f,g,b,v)}_doInsertHere(c,u,f,g,b){if(null===u){this._mainRule.acceptOverwrite(c,f,g,b);return}for(let v=0,x=this._rulesWithParentScopes.length;v<x;v++){let x=this._rulesWithParentScopes[v];if(0===strArrCmp(x.parentScopes,u)){x.acceptOverwrite(c,f,g,b);return}}-1===f&&(f=this._mainRule.fontStyle),0===g&&(g=this._mainRule.foreground),0===b&&(b=this._mainRule.background),this._rulesWithParentScopes.push(new ThemeTrieElementRule(c,u,f,g,b))}};let BasicScopeAttributes=class BasicScopeAttributes{languageId;tokenType;constructor(c,u){this.languageId=c,this.tokenType=u}};let BasicScopeAttributesProvider=class BasicScopeAttributesProvider{_defaultAttributes;_embeddedLanguagesMatcher;constructor(c,u){this._defaultAttributes=new BasicScopeAttributes(c,8),this._embeddedLanguagesMatcher=new ScopeMatcher(Object.entries(u||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(c){return null===c?BasicScopeAttributesProvider._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(c)}static _NULL_SCOPE_METADATA=new BasicScopeAttributes(0,0);_getBasicScopeAttributes=new CachedFn(c=>{let u=this._scopeToLanguage(c),f=this._toStandardTokenType(c);return new BasicScopeAttributes(u,f)});_scopeToLanguage(c){return this._embeddedLanguagesMatcher.match(c)||0}_toStandardTokenType(c){let u=c.match(BasicScopeAttributesProvider.STANDARD_TOKEN_TYPE_REGEXP);if(!u)return 8;switch(u[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw Error("Unexpected match for standard token type!")}static STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/};let ScopeMatcher=class ScopeMatcher{values;scopesRegExp;constructor(c){if(0===c.length)this.values=null,this.scopesRegExp=null;else{this.values=new Map(c);let u=c.map(([c,u])=>escapeRegExpCharacters(c));u.sort(),u.reverse(),this.scopesRegExp=RegExp(`^((${u.join(")|(")}))($|\\.)`,"")}}match(c){if(!this.scopesRegExp)return;let u=c.match(this.scopesRegExp);if(u)return this.values.get(u[1])}};let TokenizeStringResult=class TokenizeStringResult{stack;stoppedEarly;constructor(c,u){this.stack=c,this.stoppedEarly=u}};function _tokenizeString(c,u,f,g,b,v,x,w){let _=u.content.length,k=!1,E=-1;if(x){let x=_checkWhileConditions(c,u,f,g,b,v);b=x.stack,g=x.linePos,f=x.isFirstLine,E=x.anchorPosition}let T=Date.now();for(;!k;){if(0!==w){let c=Date.now()-T;if(c>w)return new TokenizeStringResult(b,!0)}scanNext()}return new TokenizeStringResult(b,!1);function scanNext(){let x=matchRuleOrInjections(c,u,f,g,b,E);if(!x){v.produce(b,_),k=!0;return}let w=x.captureIndices,T=x.matchedRuleId,$=!!w&&w.length>0&&w[0].end>g;if(-1===T){let x=b.getRule(c);v.produce(b,w[0].start),b=b.withContentNameScopesList(b.nameScopesList),handleCaptures(c,u,f,b,v,x.endCaptures,w),v.produce(b,w[0].end);let T=b;if(b=b.parent,E=T.getAnchorPos(),!$&&T.getEnterPos()===g){b=T,v.produce(b,_),k=!0;return}}else{let x=c.getRule(T);v.produce(b,w[0].start);let I=b,M=x.getName(u.content,w),j=b.contentNameScopesList.pushAttributed(M,c);if(b=b.push(T,g,E,w[0].end===_,null,j,j),x instanceof BeginEndRule){handleCaptures(c,u,f,b,v,x.beginCaptures,w),v.produce(b,w[0].end),E=w[0].end;let g=x.getContentName(u.content,w),T=j.pushAttributed(g,c);if(b=b.withContentNameScopesList(T),x.endHasBackReferences&&(b=b.withEndRule(x.getEndWithResolvedBackReferences(u.content,w))),!$&&I.hasSameRuleAs(b)){b=b.pop(),v.produce(b,_),k=!0;return}}else if(x instanceof BeginWhileRule){handleCaptures(c,u,f,b,v,x.beginCaptures,w),v.produce(b,w[0].end),E=w[0].end;let g=x.getContentName(u.content,w),T=j.pushAttributed(g,c);if(b=b.withContentNameScopesList(T),x.whileHasBackReferences&&(b=b.withEndRule(x.getWhileWithResolvedBackReferences(u.content,w))),!$&&I.hasSameRuleAs(b)){b=b.pop(),v.produce(b,_),k=!0;return}}else if(handleCaptures(c,u,f,b,v,x.captures,w),v.produce(b,w[0].end),b=b.pop(),!$){b=b.safePop(),v.produce(b,_),k=!0;return}}w[0].end>g&&(g=w[0].end,f=!1)}}function _checkWhileConditions(c,u,f,g,b,v){let x=b.beginRuleCapturedEOL?0:-1,w=[];for(let u=b;u;u=u.pop()){let f=u.getRule(c);f instanceof BeginWhileRule&&w.push({rule:f,stack:u})}for(let _=w.pop();_;_=w.pop()){let{ruleScanner:w,findOptions:k}=prepareRuleWhileSearch(_.rule,c,_.stack.endRule,f,g===x),E=w.findNextMatchSync(u,g,k);if(E){let w=E.ruleId;if(-2!==w){b=_.stack.pop();break}E.captureIndices&&E.captureIndices.length&&(v.produce(_.stack,E.captureIndices[0].start),handleCaptures(c,u,f,_.stack,v,_.rule.whileCaptures,E.captureIndices),v.produce(_.stack,E.captureIndices[0].end),x=E.captureIndices[0].end,E.captureIndices[0].end>g&&(g=E.captureIndices[0].end,f=!1))}else{b=_.stack.pop();break}}return{stack:b,linePos:g,anchorPosition:x,isFirstLine:f}}function matchRuleOrInjections(c,u,f,g,b,v){let x=matchRule(c,u,f,g,b,v),w=c.getInjections();if(0===w.length)return x;let _=matchInjections(w,c,u,f,g,b,v);if(!_)return x;if(!x)return _;let k=x.captureIndices[0].start,E=_.captureIndices[0].start;return E<k||_.priorityMatch&&E===k?_:x}function matchRule(c,u,f,g,b,v){let x=b.getRule(c),{ruleScanner:w,findOptions:_}=prepareRuleSearch(x,c,b.endRule,f,g===v),k=w.findNextMatchSync(u,g,_);return k?{captureIndices:k.captureIndices,matchedRuleId:k.ruleId}:null}function matchInjections(c,u,f,g,b,v,x){let w,_=Number.MAX_VALUE,k=null,E=0,T=v.contentNameScopesList.getScopeNames();for(let v=0,$=c.length;v<$;v++){let $=c[v];if(!$.matcher(T))continue;let I=u.getRule($.ruleId),{ruleScanner:M,findOptions:j}=prepareRuleSearch(I,u,null,g,b===x),D=M.findNextMatchSync(f,b,j);if(!D)continue;let L=D.captureIndices[0].start;if(!(L>=_)&&(_=L,k=D.captureIndices,w=D.ruleId,E=$.priority,_===b))break}return k?{priorityMatch:-1===E,captureIndices:k,matchedRuleId:w}:null}function prepareRuleSearch(c,u,f,g,b){let v=c.compileAG(u,f,g,b);return{ruleScanner:v,findOptions:0}}function prepareRuleWhileSearch(c,u,f,g,b){let v=c.compileWhileAG(u,f,g,b);return{ruleScanner:v,findOptions:0}}function handleCaptures(c,u,f,g,b,v,x){if(0===v.length)return;let w=u.content,_=Math.min(v.length,x.length),k=[],E=x[0].end;for(let u=0;u<_;u++){let _=v[u];if(null===_)continue;let T=x[u];if(0===T.length)continue;if(T.start>E)break;for(;k.length>0&&k[k.length-1].endPos<=T.start;)b.produceFromScopes(k[k.length-1].scopes,k[k.length-1].endPos),k.pop();if(k.length>0?b.produceFromScopes(k[k.length-1].scopes,T.start):b.produce(g,T.start),_.retokenizeCapturedWithRuleId){let u=_.getName(w,x),v=g.contentNameScopesList.pushAttributed(u,c),k=_.getContentName(w,x),E=v.pushAttributed(k,c),$=g.push(_.retokenizeCapturedWithRuleId,T.start,-1,!1,null,v,E),I=c.createOnigString(w.substring(0,T.end));_tokenizeString(c,I,f&&0===T.start,T.start,$,b,!1,0),disposeOnigString(I);continue}let $=_.getName(w,x);if(null!==$){let u=k.length>0?k[k.length-1].scopes:g.contentNameScopesList,f=u.pushAttributed($,c);k.push(new LocalStackElement(f,T.end))}}for(;k.length>0;)b.produceFromScopes(k[k.length-1].scopes,k[k.length-1].endPos),k.pop()}let LocalStackElement=class LocalStackElement{scopes;endPos;constructor(c,u){this.scopes=c,this.endPos=u}};function createGrammar(c,u,f,g,b,v,x,w){return new Grammar(c,u,f,g,b,v,x,w)}function collectInjections(c,u,f,g,b){let v=createMatchers(u,nameMatcher),x=RuleFactory.getCompiledRuleId(f,g,b.repository);for(let f of v)c.push({debugSelector:u,matcher:f.matcher,ruleId:x,grammar:b,priority:f.priority})}function nameMatcher(c,u){if(u.length<c.length)return!1;let f=0;return c.every(c=>{for(let g=f;g<u.length;g++)if(scopesAreMatching(u[g],c))return f=g+1,!0;return!1})}function scopesAreMatching(c,u){if(!c)return!1;if(c===u)return!0;let f=u.length;return c.length>f&&c.substr(0,f)===u&&"."===c[f]}let Grammar=class Grammar{_rootScopeName;balancedBracketSelectors;_onigLib;_rootId;_lastRuleId;_ruleId2desc;_includedGrammars;_grammarRepository;_grammar;_injections;_basicScopeAttributesProvider;_tokenTypeMatchers;get themeProvider(){return this._grammarRepository}constructor(c,u,f,g,b,v,x,w){if(this._rootScopeName=c,this.balancedBracketSelectors=v,this._onigLib=w,this._basicScopeAttributesProvider=new BasicScopeAttributesProvider(f,g),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=x,this._grammar=initGrammar(u,null),this._injections=null,this._tokenTypeMatchers=[],b)for(let c of Object.keys(b)){let u=createMatchers(c,nameMatcher);for(let f of u)this._tokenTypeMatchers.push({matcher:f.matcher,type:b[c]})}}dispose(){for(let c of this._ruleId2desc)c&&c.dispose()}createOnigScanner(c){return this._onigLib.createOnigScanner(c)}createOnigString(c){return this._onigLib.createOnigString(c)}getMetadataForScope(c){return this._basicScopeAttributesProvider.getBasicScopeAttributes(c)}_collectInjections(){let c=[],u=this._rootScopeName,f=({lookup:c=>c===this._rootScopeName?this._grammar:this.getExternalGrammar(c),injections:c=>this._grammarRepository.injections(c)}).lookup(u);if(f){let g=f.injections;if(g)for(let u in g)collectInjections(c,u,g[u],this,f);let b=this._grammarRepository.injections(u);b&&b.forEach(u=>{let f=this.getExternalGrammar(u);if(f){let u=f.injectionSelector;u&&collectInjections(c,u,f,this,f)}})}return c.sort((c,u)=>c.priority-u.priority),c}getInjections(){return null===this._injections&&(this._injections=this._collectInjections()),this._injections}registerRule(c){let u=++this._lastRuleId,f=c(u);return this._ruleId2desc[u]=f,f}getRule(c){return this._ruleId2desc[c]}getExternalGrammar(c,u){if(this._includedGrammars[c])return this._includedGrammars[c];if(this._grammarRepository){let f=this._grammarRepository.lookup(c);if(f)return this._includedGrammars[c]=initGrammar(f,u&&u.$base),this._includedGrammars[c]}}tokenizeLine(c,u,f=0){let g=this._tokenize(c,u,!1,f);return{tokens:g.lineTokens.getResult(g.ruleStack,g.lineLength),ruleStack:g.ruleStack,stoppedEarly:g.stoppedEarly}}tokenizeLine2(c,u,f=0){let g=this._tokenize(c,u,!0,f);return{tokens:g.lineTokens.getBinaryResult(g.ruleStack,g.lineLength),ruleStack:g.ruleStack,stoppedEarly:g.stoppedEarly}}_tokenize(c,u,f,g){let b;if(-1===this._rootId&&(this._rootId=RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),u&&u!==StateStackImpl.NULL)b=!1,u.reset();else{let c;b=!0;let f=this._basicScopeAttributesProvider.getDefaultAttributes(),g=this.themeProvider.getDefaults(),v=M.set(0,f.languageId,f.tokenType,null,g.fontStyle,g.foregroundId,g.backgroundId),x=this.getRule(this._rootId).getName(null,null);c=x?AttributedScopeStack.createRootAndLookUpScopeName(x,v,this):AttributedScopeStack.createRoot("unknown",v),u=new StateStackImpl(null,this._rootId,-1,-1,!1,null,c,c)}c+="\n";let v=this.createOnigString(c),x=v.content.length,w=new LineTokens(f,c,this._tokenTypeMatchers,this.balancedBracketSelectors),_=_tokenizeString(this,v,b,0,u,w,!0,g);return disposeOnigString(v),{lineLength:x,lineTokens:w,ruleStack:_.stack,stoppedEarly:_.stoppedEarly}}};function initGrammar(c,u){return(c=clone(c)).repository=c.repository||{},c.repository.$self={$vscodeTextmateLocation:c.$vscodeTextmateLocation,patterns:c.patterns,name:c.scopeName},c.repository.$base=u||c.repository.$self,c}let AttributedScopeStack=class AttributedScopeStack{parent;scopePath;tokenAttributes;static fromExtension(c,u){let f=c,g=c?.scopePath??null;for(let c of u)f=new AttributedScopeStack(f,g=ScopeStack.push(g,c.scopeNames),c.encodedTokenAttributes);return f}static createRoot(c,u){return new AttributedScopeStack(null,new ScopeStack(null,c),u)}static createRootAndLookUpScopeName(c,u,f){let g=f.getMetadataForScope(c),b=new ScopeStack(null,c),v=f.themeProvider.themeMatch(b),x=AttributedScopeStack.mergeAttributes(u,g,v);return new AttributedScopeStack(null,b,x)}get scopeName(){return this.scopePath.scopeName}constructor(c,u,f){this.parent=c,this.scopePath=u,this.tokenAttributes=f}toString(){return this.getScopeNames().join(" ")}equals(c){return AttributedScopeStack.equals(this,c)}static equals(c,u){for(;;){if(c===u||!c&&!u)return!0;if(!c||!u||c.scopeName!==u.scopeName||c.tokenAttributes!==u.tokenAttributes)return!1;c=c.parent,u=u.parent}}static mergeAttributes(c,u,f){let g=-1,b=0,v=0;return null!==f&&(g=f.fontStyle,b=f.foregroundId,v=f.backgroundId),M.set(c,u.languageId,u.tokenType,null,g,b,v)}pushAttributed(c,u){if(null===c)return this;if(-1===c.indexOf(" "))return AttributedScopeStack._pushAttributed(this,c,u);let f=c.split(/ /g),g=this;for(let c of f)g=AttributedScopeStack._pushAttributed(g,c,u);return g}static _pushAttributed(c,u,f){let g=f.getMetadataForScope(u),b=c.scopePath.push(u),v=f.themeProvider.themeMatch(b),x=AttributedScopeStack.mergeAttributes(c.tokenAttributes,g,v);return new AttributedScopeStack(c,b,x)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(c){let u=[],f=this;for(;f&&f!==c;)u.push({encodedTokenAttributes:f.tokenAttributes,scopeNames:f.scopePath.getExtensionIfDefined(f.parent?.scopePath??null)}),f=f.parent;return f===c?u.reverse():void 0}};let StateStackImpl=class StateStackImpl{parent;ruleId;beginRuleCapturedEOL;endRule;nameScopesList;contentNameScopesList;_stackElementBrand=void 0;static NULL=new StateStackImpl(null,0,0,0,!1,null,null,null);_enterPos;_anchorPos;depth;constructor(c,u,f,g,b,v,x,w){this.parent=c,this.ruleId=u,this.beginRuleCapturedEOL=b,this.endRule=v,this.nameScopesList=x,this.contentNameScopesList=w,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=f,this._anchorPos=g}equals(c){return null!==c&&StateStackImpl._equals(this,c)}static _equals(c,u){return c===u||!!this._structuralEquals(c,u)&&AttributedScopeStack.equals(c.contentNameScopesList,u.contentNameScopesList)}static _structuralEquals(c,u){for(;;){if(c===u||!c&&!u)return!0;if(!c||!u||c.depth!==u.depth||c.ruleId!==u.ruleId||c.endRule!==u.endRule)return!1;c=c.parent,u=u.parent}}clone(){return this}static _reset(c){for(;c;)c._enterPos=-1,c._anchorPos=-1,c=c.parent}reset(){StateStackImpl._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(c,u,f,g,b,v,x){return new StateStackImpl(this,c,u,f,g,b,v,x)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(c){return c.getRule(this.ruleId)}toString(){let c=[];return this._writeString(c,0),"["+c.join(",")+"]"}_writeString(c,u){return this.parent&&(u=this.parent._writeString(c,u)),c[u++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,u}withContentNameScopesList(c){return this.contentNameScopesList===c?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,c)}withEndRule(c){return this.endRule===c?this:new StateStackImpl(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,c,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(c){let u=this;for(;u&&u._enterPos===c._enterPos;){if(u.ruleId===c.ruleId)return!0;u=u.parent}return!1}toStateStackFrame(){return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(c,u){let f=AttributedScopeStack.fromExtension(c?.nameScopesList??null,u.nameScopesList);return new StateStackImpl(c,u.ruleId,u.enterPos??-1,u.anchorPos??-1,u.beginRuleCapturedEOL,u.endRule,f,AttributedScopeStack.fromExtension(f,u.contentNameScopesList))}};let BalancedBracketSelectors=class BalancedBracketSelectors{balancedBracketScopes;unbalancedBracketScopes;allowAny=!1;constructor(c,u){this.balancedBracketScopes=c.flatMap(c=>"*"===c?(this.allowAny=!0,[]):createMatchers(c,nameMatcher).map(c=>c.matcher)),this.unbalancedBracketScopes=u.flatMap(c=>createMatchers(c,nameMatcher).map(c=>c.matcher))}get matchesAlways(){return this.allowAny&&0===this.unbalancedBracketScopes.length}get matchesNever(){return 0===this.balancedBracketScopes.length&&!this.allowAny}match(c){for(let u of this.unbalancedBracketScopes)if(u(c))return!1;for(let u of this.balancedBracketScopes)if(u(c))return!0;return this.allowAny}};let LineTokens=class LineTokens{balancedBracketSelectors;_emitBinaryTokens;_lineText;_tokens;_binaryTokens;_lastTokenEndIndex;_tokenTypeOverrides;constructor(c,u,f,g){this.balancedBracketSelectors=g,this._emitBinaryTokens=c,this._tokenTypeOverrides=f,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(c,u){this.produceFromScopes(c.contentNameScopesList,u)}produceFromScopes(c,u){if(this._lastTokenEndIndex>=u)return;if(this._emitBinaryTokens){let f=c?.tokenAttributes??0,g=!1;if(this.balancedBracketSelectors?.matchesAlways&&(g=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){let u=c?.getScopeNames()??[];for(let c of this._tokenTypeOverrides)c.matcher(u)&&(f=M.set(f,0,toOptionalTokenType(c.type),null,-1,0,0));this.balancedBracketSelectors&&(g=this.balancedBracketSelectors.match(u))}if(g&&(f=M.set(f,0,8,g,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===f){this._lastTokenEndIndex=u;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(f),this._lastTokenEndIndex=u;return}let f=c?.getScopeNames()??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:u,scopes:f}),this._lastTokenEndIndex=u}getResult(c,u){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===u-1&&this._tokens.pop(),0===this._tokens.length&&(this._lastTokenEndIndex=-1,this.produce(c,u),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(c,u){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===u-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),0===this._binaryTokens.length&&(this._lastTokenEndIndex=-1,this.produce(c,u),this._binaryTokens[this._binaryTokens.length-2]=0);let f=new Uint32Array(this._binaryTokens.length);for(let c=0,u=this._binaryTokens.length;c<u;c++)f[c]=this._binaryTokens[c];return f}};let SyncRegistry=class SyncRegistry{_onigLibPromise;_grammars=new Map;_rawGrammars=new Map;_injectionGrammars=new Map;_theme;constructor(c,u){this._onigLibPromise=u,this._theme=c}dispose(){for(let c of this._grammars.values())c.dispose()}setTheme(c){this._theme=c}getColorMap(){return this._theme.getColorMap()}addGrammar(c,u){this._rawGrammars.set(c.scopeName,c),u&&this._injectionGrammars.set(c.scopeName,u)}lookup(c){return this._rawGrammars.get(c)}injections(c){return this._injectionGrammars.get(c)}getDefaults(){return this._theme.getDefaults()}themeMatch(c){return this._theme.match(c)}async grammarForScopeName(c,u,f,g,b){if(!this._grammars.has(c)){let v=this._rawGrammars.get(c);if(!v)return null;this._grammars.set(c,createGrammar(c,v,u,f,g,b,this,await this._onigLibPromise))}return this._grammars.get(c)}};let B=class{_options;_syncRegistry;_ensureGrammarCache;constructor(c){this._options=c,this._syncRegistry=new SyncRegistry(Theme.createFromRawTheme(c.theme,c.colorMap),c.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(c,u){this._syncRegistry.setTheme(Theme.createFromRawTheme(c,u))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(c,u,f){return this.loadGrammarWithConfiguration(c,u,{embeddedLanguages:f})}loadGrammarWithConfiguration(c,u,f){return this._loadGrammar(c,u,f.embeddedLanguages,f.tokenTypes,new BalancedBracketSelectors(f.balancedBracketSelectors||[],f.unbalancedBracketSelectors||[]))}loadGrammar(c){return this._loadGrammar(c,0,null,null,null)}async _loadGrammar(c,u,f,g,b){let v=new ScopeDependencyProcessor(this._syncRegistry,c);for(;v.Q.length>0;)await Promise.all(v.Q.map(c=>this._loadSingleGrammar(c.scopeName))),v.processQueue();return this._grammarForScopeName(c,u,f,g,b)}async _loadSingleGrammar(c){return this._ensureGrammarCache.has(c)||this._ensureGrammarCache.set(c,this._doLoadSingleGrammar(c)),this._ensureGrammarCache.get(c)}async _doLoadSingleGrammar(c){let u=await this._options.loadGrammar(c);if(u){let f="function"==typeof this._options.getInjections?this._options.getInjections(c):void 0;this._syncRegistry.addGrammar(u,f)}}async addGrammar(c,u=[],f=0,g=null){return this._syncRegistry.addGrammar(c,u),await this._grammarForScopeName(c.scopeName,f,g)}_grammarForScopeName(c,u=0,f=null,g=null,b=null){return this._syncRegistry.grammarForScopeName(c,u,f,g,b)}},G=StateStackImpl.NULL,U={LANGUAGEID_MASK:255,TOKEN_TYPE_MASK:768,BALANCED_BRACKETS_MASK:1024,FONT_STYLE_MASK:14336,FOREGROUND_MASK:8372224,BACKGROUND_MASK:4286578688,LANGUAGEID_OFFSET:0,TOKEN_TYPE_OFFSET:8,BALANCED_BRACKETS_OFFSET:10,FONT_STYLE_OFFSET:11,FOREGROUND_OFFSET:15,BACKGROUND_OFFSET:24};let StackElementMetadata=class StackElementMetadata{static toBinaryStr(c){let u=c.toString(2);for(;u.length<32;)u=`0${u}`;return u}static getLanguageId(c){return(c&U.LANGUAGEID_MASK)>>>U.LANGUAGEID_OFFSET}static getTokenType(c){return(c&U.TOKEN_TYPE_MASK)>>>U.TOKEN_TYPE_OFFSET}static getFontStyle(c){return(c&U.FONT_STYLE_MASK)>>>U.FONT_STYLE_OFFSET}static getForeground(c){return(c&U.FOREGROUND_MASK)>>>U.FOREGROUND_OFFSET}static getBackground(c){return(c&U.BACKGROUND_MASK)>>>U.BACKGROUND_OFFSET}static containsBalancedBrackets(c){return(c&U.BALANCED_BRACKETS_MASK)!=0}static set(c,u,f,g,b,v){let x=StackElementMetadata.getLanguageId(c),w=StackElementMetadata.getTokenType(c),_=StackElementMetadata.getFontStyle(c),k=StackElementMetadata.getForeground(c),E=StackElementMetadata.getBackground(c),T=StackElementMetadata.containsBalancedBrackets(c)?1:0;return 0!==u&&(x=u),0!==f&&(w=8===f?0:f),g!==I.NotSet&&(_=g),0!==b&&(k=b),0!==v&&(E=v),(x<<U.LANGUAGEID_OFFSET|w<<U.TOKEN_TYPE_OFFSET|_<<U.FONT_STYLE_OFFSET|T<<U.BALANCED_BRACKETS_OFFSET|k<<U.FOREGROUND_OFFSET|E<<U.BACKGROUND_OFFSET)>>>0}};var V=f(40263).Buffer;function toArray(c){return Array.isArray(c)?c:[c]}function splitLines(c,u=!1){let f=c.split(/(\r?\n)/g),g=0,b=[];for(let c=0;c<f.length;c+=2){let v=u?f[c]+(f[c+1]||""):f[c];b.push([v,g]),g+=f[c].length+(f[c+1]?.length||0)}return b}function isPlainLang(c){return!c||["plaintext","txt","text","plain"].includes(c)}function isSpecialLang(c){return"ansi"===c||isPlainLang(c)}function addClassToHast(c,u){if(!u)return c;c.properties||={},c.properties.class||=[],"string"==typeof c.properties.class&&(c.properties.class=c.properties.class.split(/\s+/g)),Array.isArray(c.properties.class)||(c.properties.class=[]);let f=Array.isArray(u)?u:u.split(/\s+/g);for(let u of f)u&&!c.properties.class.includes(u)&&c.properties.class.push(u);return c}function splitToken(c,u){let f=0,g=[];for(let b of u)b>f&&g.push({...c,content:c.content.slice(f,b),offset:c.offset+f}),f=b;return f<c.content.length&&g.push({...c,content:c.content.slice(f),offset:c.offset+f}),g}function splitTokens(c,u){let f=Array.from(u instanceof Set?u:new Set(u)).sort((c,u)=>c-u);return f.length?c.map(c=>c.flatMap(c=>{let u=f.filter(u=>c.offset<u&&u<c.offset+c.content.length).map(u=>u-c.offset).sort((c,u)=>c-u);return u.length?splitToken(c,u):c})):c}function applyColorReplacements(c,u){return u?.[c?.toLowerCase()]||c}function getTokenStyleObject(c){let u={};return c.color&&(u.color=c.color),c.bgColor&&(u["background-color"]=c.bgColor),c.fontStyle&&(c.fontStyle&I.Italic&&(u["font-style"]="italic"),c.fontStyle&I.Bold&&(u["font-weight"]="bold"),c.fontStyle&I.Underline&&(u["text-decoration"]="underline")),u}function stringifyTokenStyle(c){return Object.entries(c).map(([c,u])=>`${c}:${u}`).join(";")}function createPositionConverter(c){let u=splitLines(c,!0).map(([c])=>c);function indexToPos(c){let f=c,g=0;for(let c of u){if(f<c.length)break;f-=c.length,g++}return{line:g,character:f}}function posToIndex(c,f){let g=0;for(let f=0;f<c;f++)g+=u[f].length;return g+f}return{lines:u,indexToPos,posToIndex}}var K=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],Z={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function findSequence(c,u){let f=c.indexOf("\x1b[",u);if(-1!==f){let u=c.indexOf("m",f);return{sequence:c.substring(f+2,u).split(";"),startPosition:f,position:u+1}}return{position:c.length}}function parseColor(c,u){let f,g=1,b=c[u+g++];if("2"===b){let b=[c[u+g++],c[u+g++],c[u+g]].map(c=>Number.parseInt(c));3!==b.length||b.some(c=>Number.isNaN(c))||(f={type:"rgb",rgb:b})}else if("5"===b){let b=Number.parseInt(c[u+g]);Number.isNaN(b)||(f={type:"table",index:Number(b)})}return[g,f]}function parseSequence(c){let u=[];for(let f=0;f<c.length;f++){let g=c[f],b=Number.parseInt(g);if(!Number.isNaN(b)){if(0===b)u.push({type:"resetAll"});else if(b<=9){let c=Z[b];c&&u.push({type:"setDecoration",value:Z[b]})}else if(b<=29){let c=Z[b-20];c&&u.push({type:"resetDecoration",value:c})}else if(b<=37)u.push({type:"setForegroundColor",value:{type:"named",name:K[b-30]}});else if(38===b){let[g,b]=parseColor(c,f);b&&u.push({type:"setForegroundColor",value:b}),f+=g}else if(39===b)u.push({type:"resetForegroundColor"});else if(b<=47)u.push({type:"setBackgroundColor",value:{type:"named",name:K[b-40]}});else if(48===b){let[g,b]=parseColor(c,f);b&&u.push({type:"setBackgroundColor",value:b}),f+=g}else 49===b?u.push({type:"resetBackgroundColor"}):b>=90&&b<=97?u.push({type:"setForegroundColor",value:{type:"named",name:K[b-90+8]}}):b>=100&&b<=107&&u.push({type:"setBackgroundColor",value:{type:"named",name:K[b-100+8]}})}}return u}function createAnsiSequenceParser(){let c=null,u=null,f=new Set;return{parse(g){let b=[],v=0;do{let x=findSequence(g,v),w=x.sequence?g.substring(v,x.startPosition):g.substring(v);if(w.length>0&&b.push({value:w,foreground:c,background:u,decorations:new Set(f)}),x.sequence){let g=parseSequence(x.sequence);for(let b of g)"resetAll"===b.type?(c=null,u=null,f.clear()):"resetForegroundColor"===b.type?c=null:"resetBackgroundColor"===b.type?u=null:"resetDecoration"===b.type&&f.delete(b.value);for(let b of g)"setForegroundColor"===b.type?c=b.value:"setBackgroundColor"===b.type?u=b.value:"setDecoration"===b.type&&f.add(b.value)}v=x.position}while(v<g.length);return b}}}var Y={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function createColorPalette(c=Y){let u;function rgbColor(c){return`#${c.map(c=>Math.max(0,Math.min(c,255)).toString(16).padStart(2,"0")).join("")}`}function getColorTable(){if(u)return u;u=[];for(let f=0;f<K.length;f++)u.push(c[K[f]]);let f=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let g=0;g<6;g++)for(let b=0;b<6;b++)u.push(rgbColor([f[c],f[g],f[b]]));let g=8;for(let c=0;c<24;c++,g+=10)u.push(rgbColor([g,g,g]));return u}function tableColor(c){return getColorTable()[c]}return{value:function(u){switch(u.type){case"named":return c[u.name];case"rgb":return rgbColor(u.rgb);case"table":return tableColor(u.index)}}}}function tokenizeAnsiWithTheme(c,u,f){let g={...c.colorReplacements,...f?.colorReplacements},b=splitLines(u),v=createColorPalette(Object.fromEntries(K.map(u=>[u,c.colors?.[`terminal.ansi${u[0].toUpperCase()}${u.substring(1)}`]]))),x=createAnsiSequenceParser();return b.map(u=>x.parse(u[0]).map(f=>{let b,x;f.decorations.has("reverse")?(b=f.background?v.value(f.background):c.bg,x=f.foreground?v.value(f.foreground):c.fg):(b=f.foreground?v.value(f.foreground):c.fg,x=f.background?v.value(f.background):void 0),b=applyColorReplacements(b,g),f.decorations.has("dim")&&(b=dimColor(b));let w=I.None;return f.decorations.has("bold")&&(w|=I.Bold),f.decorations.has("italic")&&(w|=I.Italic),f.decorations.has("underline")&&(w|=I.Underline),{content:f.value,offset:u[1],color:b,bgColor:x,fontStyle:w}}))}function dimColor(c){let u=c.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(u){if(u[3]){let c=Math.round(Number.parseInt(u[3],16)/2).toString(16).padStart(2,"0");return`#${u[1]}${u[2]}${c}`}return u[2]?`#${u[1]}${u[2]}80`:`#${Array.from(u[1]).map(c=>`${c}${c}`).join("")}80`}let f=c.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return f?`var(${f[1]}-dim)`:c}function codeToTokensBase(c,u,f={}){let{lang:g="text",theme:b=c.getLoadedThemes()[0]}=f;if(isPlainLang(g)||"none"===b)return splitLines(u).map(c=>[{content:c[0],offset:c[1]}]);let{theme:v,colorMap:x}=c.setTheme(b);if("ansi"===g)return tokenizeAnsiWithTheme(v,u,f);let w=c.getLanguage(g);return tokenizeWithTheme(u,w,v,x,f)}function tokenizeWithTheme(c,u,f,g,b){let v={...f.colorReplacements,...b?.colorReplacements},{tokenizeMaxLineLength:x=0,tokenizeTimeLimit:w=500}=b,_=splitLines(c),k=G,E=[],T=[];for(let c=0,$=_.length;c<$;c++){let $,I;let[M,j]=_[c];if(""===M){E=[],T.push([]);continue}if(x>0&&M.length>=x){E=[],T.push([{content:M,offset:j,color:"",fontStyle:0}]);continue}b.includeExplanation&&($=u.tokenizeLine(M,k).tokens,I=0);let D=u.tokenizeLine2(M,k,w),L=D.tokens.length/2;for(let c=0;c<L;c++){let u=D.tokens[2*c],x=c+1<L?D.tokens[2*c+2]:M.length;if(u===x)continue;let w=D.tokens[2*c+1],_=StackElementMetadata.getForeground(w),k=applyColorReplacements(g[_],v),T=StackElementMetadata.getFontStyle(w),F={content:M.substring(u,x),offset:j+u,color:k,fontStyle:T};if(b.includeExplanation){F.explanation=[];let c=0;for(;u+c<x;){let u=$[I],g=M.substring(u.startIndex,u.endIndex);c+=g.length,F.explanation.push({content:g,scopes:explainThemeScopes(f,u.scopes)}),I+=1}}E.push(F)}T.push(E),E=[],k=D.ruleStack}return T}function explainThemeScopes(c,u){let f=[];for(let g=0,b=u.length;g<b;g++){let b=u.slice(0,g),v=u[g];f[g]={scopeName:v,themeMatches:explainThemeScope(c,v,b)}}return f}function matchesOne(c,u){let f=`${c}.`;return c===u||u.substring(0,f.length)===f}function matches(c,u,f,g){if(!matchesOne(c,f))return!1;let b=u.length-1,v=g.length-1;for(;b>=0&&v>=0;)matchesOne(u[b],g[v])&&(b-=1),v-=1;return -1===b}function explainThemeScope(c,u,f){let g=[],b=0;for(let v=0,x=c.settings.length;v<x;v++){let x;let w=c.settings[v];if("string"==typeof w.scope)x=w.scope.split(/,/).map(c=>c.trim());else{if(!Array.isArray(w.scope))continue;x=w.scope}for(let c=0,v=x.length;c<v;c++){let _=x[c],k=_.split(/ /),E=k[k.length-1],T=k.slice(0,k.length-1);matches(E,T,u,f)&&(g[b++]=w,c=v)}}return g}function codeToTokensWithThemes(c,u,f){let g=Object.entries(f.themes).filter(c=>c[1]).map(c=>({color:c[0],theme:c[1]})),b=syncThemesTokenization(...g.map(g=>codeToTokensBase(c,u,{...f,theme:g.theme}))),v=b[0].map((c,u)=>c.map((c,f)=>{let v={content:c.content,variants:{},offset:c.offset};return b.forEach((c,b)=>{let{content:x,explanation:w,offset:_,...k}=c[u][f];v.variants[g[b].color]=k}),v}));return v}function syncThemesTokenization(...c){let u=c.map(()=>[]),f=c.length;for(let g=0;g<c[0].length;g++){let b=c.map(c=>c[g]),v=u.map(()=>[]);u.forEach((c,u)=>c.push(v[u]));let x=b.map(()=>0),w=b.map(c=>c[0]);for(;w.every(c=>c);){let c=Math.min(...w.map(c=>c.content.length));for(let u=0;u<f;u++){let f=w[u];f.content.length===c?(v[u].push(f),x[u]+=1,w[u]=b[u][x[u]]):(v[u].push({...f,content:f.content.slice(0,c)}),w[u]={...f,content:f.content.slice(c),offset:f.offset+c})}}}return u}let ShikiError=class ShikiError extends Error{constructor(c){super(c),this.name="ShikiError"}};function codeToTokens(c,u,f){let g,b,v,x,w;if("themes"in f){let{defaultColor:_="light",cssVariablePrefix:k="--shiki-"}=f,E=Object.entries(f.themes).filter(c=>c[1]).map(c=>({color:c[0],theme:c[1]})).sort((c,u)=>c.color===_?-1:u.color===_?1:0);if(0===E.length)throw new ShikiError("`themes` option must not be empty");let T=codeToTokensWithThemes(c,u,f);if(_&&!E.find(c=>c.color===_))throw new ShikiError(`\`themes\` option must contain the defaultColor key \`${_}\``);let $=E.map(u=>c.getTheme(u.theme)),I=E.map(c=>c.color);v=T.map(c=>c.map(c=>mergeToken(c,I,k,_))),b=E.map((c,u)=>(0===u&&_?"":`${k+c.color}:`)+($[u].fg||"inherit")).join(";"),g=E.map((c,u)=>(0===u&&_?"":`${k+c.color}-bg:`)+($[u].bg||"inherit")).join(";"),x=`shiki-themes ${$.map(c=>c.name).join(" ")}`,w=_?void 0:[b,g].join(";")}else if("theme"in f){v=codeToTokensBase(c,u,f);let w=c.getTheme(f.theme);g=w.bg,b=w.fg,x=w.name}else throw new ShikiError("Invalid options, either `theme` or `themes` must be provided");return{tokens:v,fg:b,bg:g,themeName:x,rootStyle:w}}function mergeToken(c,u,f,g){let b={content:c.content,explanation:c.explanation,offset:c.offset},v=u.map(u=>getTokenStyleObject(c.variants[u])),x=new Set(v.flatMap(c=>Object.keys(c))),w=v.reduce((c,b,v)=>{for(let w of x){let x=b[w]||"inherit";if(0===v&&g)c[w]=x;else{let g="color"===w?"":"background-color"===w?"-bg":`-${w}`,b=f+u[v]+("color"===w?"":g);c[w]?c[w]+=`;${b}:${x}`:c[w]=`${b}:${x}`}}return c},{});return b.htmlStyle=g?stringifyTokenStyle(w):Object.values(w).join(";"),b}function transformerDecorations(){let c=new WeakMap;function getContext(u){if(!c.has(u.meta)){let f=createPositionConverter(u.source);function normalizePosition(c){return"number"==typeof c?{...f.indexToPos(c),offset:c}:{...c,offset:f.posToIndex(c.line,c.character)}}let g=(u.options.decorations||[]).map(c=>({...c,start:normalizePosition(c.start),end:normalizePosition(c.end)}));verifyIntersections(g),c.set(u.meta,{decorations:g,converter:f,source:u.source})}return c.get(u.meta)}function verifyIntersections(c){for(let u=0;u<c.length;u++){let f=c[u];if(f.start.offset>f.end.offset)throw new ShikiError(`Invalid decoration range: ${JSON.stringify(f.start)} - ${JSON.stringify(f.end)}`);for(let g=u+1;g<c.length;g++){let u=c[g],b=f.start.offset<u.start.offset&&u.start.offset<f.end.offset,v=f.start.offset<u.end.offset&&u.end.offset<f.end.offset,x=u.start.offset<f.start.offset&&f.start.offset<u.end.offset,w=u.start.offset<f.end.offset&&f.end.offset<u.end.offset;if(b||v||x||w){if(v&&v||x&&w)continue;throw new ShikiError(`Decorations ${JSON.stringify(f.start)} and ${JSON.stringify(u.start)} intersect.`)}}}}return{name:"shiki:decorations",tokens(c){if(!this.options.decorations?.length)return;let u=getContext(this),f=u.decorations.flatMap(c=>[c.start.offset,c.end.offset]),g=splitTokens(c,f);return g},code(c){if(!this.options.decorations?.length)return;let u=getContext(this),f=Array.from(c.children).filter(c=>"element"===c.type&&"span"===c.tagName);if(f.length!==u.converter.lines.length)throw new ShikiError(`Number of lines in code element (${f.length}) does not match the number of lines in the source (${u.converter.lines.length}). Failed to apply decorations.`);function applyLineSection(c,u,g,b){let v=f[c],x="",w=-1,_=-1;function stringify(c){return"text"===c.type?c.value:"element"===c.type?c.children.map(stringify).join(""):""}if(0===u&&(w=0),0===g&&(_=0),g===Number.POSITIVE_INFINITY&&(_=v.children.length),-1===w||-1===_)for(let c=0;c<v.children.length;c++)x+=stringify(v.children[c]),-1===w&&x.length===u&&(w=c+1),-1===_&&x.length===g&&(_=c+1);if(-1===w)throw new ShikiError(`Failed to find start index for decoration ${JSON.stringify(b.start)}`);if(-1===_)throw new ShikiError(`Failed to find end index for decoration ${JSON.stringify(b.end)}`);let k=v.children.slice(w,_);if(b.alwaysWrap||k.length!==v.children.length){if(b.alwaysWrap||1!==k.length||"element"!==k[0].type){let c={type:"element",tagName:"span",properties:{},children:k};applyDecoration(c,b,"wrapper"),v.children.splice(w,k.length,c)}else applyDecoration(k[0],b,"token")}else applyDecoration(v,b,"line")}function applyLine(c,u){f[c]=applyDecoration(f[c],u,"line")}function applyDecoration(c,u,f){let g=u.properties||{},b=u.transform||(c=>c);return c.tagName=u.tagName||"span",c.properties={...c.properties,...g,class:c.properties.class},u.properties?.class&&addClassToHast(c,u.properties.class),c=b(c,f)||c}let g=[],b=u.decorations.sort((c,u)=>u.start.offset-c.start.offset);for(let c of b){let{start:u,end:f}=c;if(u.line===f.line)applyLineSection(u.line,u.character,f.character,c);else if(u.line<f.line){applyLineSection(u.line,u.character,Number.POSITIVE_INFINITY,c);for(let b=u.line+1;b<f.line;b++)g.unshift(()=>applyLine(b,c));applyLineSection(f.line,0,f.character,c)}}g.forEach(c=>c())}}}let X=[transformerDecorations()];function getTransformers(c){return[...c.transformers||[],...X]}function codeToHast(c,u,f,g={meta:{},options:f,codeToHast:(u,f)=>codeToHast(c,u,f),codeToTokens:(u,f)=>codeToTokens(c,u,f)}){let b=u;for(let c of getTransformers(f))b=c.preprocess?.call(g,b,f)||b;let{tokens:v,fg:x,bg:w,themeName:_,rootStyle:k}=codeToTokens(c,b,f),{mergeWhitespaces:E=!0}=f;!0===E?v=mergeWhitespaceTokens(v):"never"===E&&(v=splitWhitespaceTokens(v));let T={...g,get source(){return b}};for(let c of getTransformers(f))v=c.tokens?.call(T,v)||v;return tokensToHast(v,{...f,fg:x,bg:w,themeName:_,rootStyle:k},T)}function tokensToHast(c,u,f){let g=getTransformers(u),b=[],v={type:"root",children:[]},x={type:"element",tagName:"pre",properties:{class:`shiki ${u.themeName||""}`,style:u.rootStyle||`background-color:${u.bg};color:${u.fg}`,tabindex:"0",...Object.fromEntries(Array.from(Object.entries(u.meta||{})).filter(([c])=>!c.startsWith("_")))},children:[]},w={type:"element",tagName:"code",properties:{},children:b},_=[],k={...f,addClassToHast,get source(){return f.source},get tokens(){return c},get options(){return u},get root(){return v},get pre(){return x},get code(){return w},get lines(){return _}};for(let u of(c.forEach((c,u)=>{u&&b.push({type:"text",value:"\n"});let f={type:"element",tagName:"span",properties:{class:"line"},children:[]},v=0;for(let b of c){let c={type:"element",tagName:"span",properties:{},children:[{type:"text",value:b.content}]},x=b.htmlStyle||stringifyTokenStyle(getTokenStyleObject(b));for(let b of(x&&(c.properties.style=x),g))c=b?.span?.call(k,c,u+1,v,f)||c;f.children.push(c),v+=b.content.length}for(let c of g)f=c?.line?.call(k,f,u+1)||f;_.push(f),b.push(f)}),g))w=u?.code?.call(k,w)||w;for(let c of(x.children.push(w),g))x=c?.pre?.call(k,x)||x;v.children.push(x);let E=v;for(let c of g)E=c?.root?.call(k,E)||E;return E}function mergeWhitespaceTokens(c){return c.map(c=>{let u=[],f="",g=0;return c.forEach((b,v)=>{let x=b.fontStyle&&b.fontStyle&I.Underline,w=!x;w&&b.content.match(/^\s+$/)&&c[v+1]?(g||(g=b.offset),f+=b.content):f?(w?u.push({...b,offset:g,content:f+b.content}):u.push({content:f,offset:g},b),g=0,f=""):u.push(b)}),u})}function splitWhitespaceTokens(c){return c.map(c=>c.flatMap(c=>{if(c.content.match(/^\s+$/))return c;let u=c.content.match(/^(\s*)(.*?)(\s*)$/);if(!u)return c;let[,f,g,b]=u;if(!f&&!b)return c;let v=[{...c,offset:c.offset+f.length,content:g}];return f&&v.unshift({content:f,offset:c.offset}),b&&v.push({content:b,offset:c.offset+f.length+g.length}),v}))}let J=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];let Schema=class Schema{constructor(c,u,f){this.property=c,this.normal=u,f&&(this.space=f)}};function merge(c,u){let f={},g={},b=-1;for(;++b<c.length;)Object.assign(f,c[b].property),Object.assign(g,c[b].normal);return new Schema(f,g,u)}function normalize(c){return c.toLowerCase()}Schema.prototype.property={},Schema.prototype.normal={},Schema.prototype.space=null;let Info=class Info{constructor(c,u){this.property=c,this.attribute=u}};Info.prototype.space=null,Info.prototype.boolean=!1,Info.prototype.booleanish=!1,Info.prototype.overloadedBoolean=!1,Info.prototype.number=!1,Info.prototype.commaSeparated=!1,Info.prototype.spaceSeparated=!1,Info.prototype.commaOrSpaceSeparated=!1,Info.prototype.mustUseProperty=!1,Info.prototype.defined=!1;let Q=0,ee=increment(),et=increment(),en=increment(),er=increment(),ei=increment(),eo=increment(),ea=increment();function increment(){return 2**++Q}var es=Object.freeze({__proto__:null,boolean:ee,booleanish:et,commaOrSpaceSeparated:ea,commaSeparated:eo,number:er,overloadedBoolean:en,spaceSeparated:ei});let el=Object.keys(es);let DefinedInfo=class DefinedInfo extends Info{constructor(c,u,f,g){var b,v;let x=-1;if(super(c,u),g&&(this.space=g),"number"==typeof f)for(;++x<el.length;){let c=el[x];b=el[x],(v=(f&es[c])===es[c])&&(this[b]=v)}}};DefinedInfo.prototype.defined=!0;let ec={}.hasOwnProperty;function create(c){let u;let f={},g={};for(u in c.properties)if(ec.call(c.properties,u)){let b=c.properties[u],v=new DefinedInfo(u,c.transform(c.attributes||{},u),b,c.space);c.mustUseProperty&&c.mustUseProperty.includes(u)&&(v.mustUseProperty=!0),f[u]=v,g[normalize(u)]=u,g[normalize(v.attribute)]=u}return new Schema(f,g,c.space)}let eu=create({space:"xlink",transform:(c,u)=>"xlink:"+u.slice(5).toLowerCase(),properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),ed=create({space:"xml",transform:(c,u)=>"xml:"+u.slice(3).toLowerCase(),properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function caseSensitiveTransform(c,u){return u in c?c[u]:u}function caseInsensitiveTransform(c,u){return caseSensitiveTransform(c,u.toLowerCase())}let eh=create({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:caseInsensitiveTransform,properties:{xmlns:null,xmlnsXLink:null}}),ep=create({transform:(c,u)=>"role"===u?u:"aria-"+u.slice(4).toLowerCase(),properties:{ariaActiveDescendant:null,ariaAtomic:et,ariaAutoComplete:null,ariaBusy:et,ariaChecked:et,ariaColCount:er,ariaColIndex:er,ariaColSpan:er,ariaControls:ei,ariaCurrent:null,ariaDescribedBy:ei,ariaDetails:null,ariaDisabled:et,ariaDropEffect:ei,ariaErrorMessage:null,ariaExpanded:et,ariaFlowTo:ei,ariaGrabbed:et,ariaHasPopup:null,ariaHidden:et,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ei,ariaLevel:er,ariaLive:null,ariaModal:et,ariaMultiLine:et,ariaMultiSelectable:et,ariaOrientation:null,ariaOwns:ei,ariaPlaceholder:null,ariaPosInSet:er,ariaPressed:et,ariaReadOnly:et,ariaRelevant:null,ariaRequired:et,ariaRoleDescription:ei,ariaRowCount:er,ariaRowIndex:er,ariaRowSpan:er,ariaSelected:et,ariaSetSize:er,ariaSort:null,ariaValueMax:er,ariaValueMin:er,ariaValueNow:er,ariaValueText:null,role:null}}),ef=create({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:caseInsensitiveTransform,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:eo,acceptCharset:ei,accessKey:ei,action:null,allow:null,allowFullScreen:ee,allowPaymentRequest:ee,allowUserMedia:ee,alt:null,as:null,async:ee,autoCapitalize:null,autoComplete:ei,autoFocus:ee,autoPlay:ee,blocking:ei,capture:null,charSet:null,checked:ee,cite:null,className:ei,cols:er,colSpan:null,content:null,contentEditable:et,controls:ee,controlsList:ei,coords:er|eo,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ee,defer:ee,dir:null,dirName:null,disabled:ee,download:en,draggable:et,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ee,formTarget:null,headers:ei,height:er,hidden:ee,high:er,href:null,hrefLang:null,htmlFor:ei,httpEquiv:ei,id:null,imageSizes:null,imageSrcSet:null,inert:ee,inputMode:null,integrity:null,is:null,isMap:ee,itemId:null,itemProp:ei,itemRef:ei,itemScope:ee,itemType:ei,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ee,low:er,manifest:null,max:null,maxLength:er,media:null,method:null,min:null,minLength:er,multiple:ee,muted:ee,name:null,nonce:null,noModule:ee,noValidate:ee,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ee,optimum:er,pattern:null,ping:ei,placeholder:null,playsInline:ee,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ee,referrerPolicy:null,rel:ei,required:ee,reversed:ee,rows:er,rowSpan:er,sandbox:ei,scope:null,scoped:ee,seamless:ee,selected:ee,shadowRootDelegatesFocus:ee,shadowRootMode:null,shape:null,size:er,sizes:null,slot:null,span:er,spellCheck:et,src:null,srcDoc:null,srcLang:null,srcSet:null,start:er,step:null,style:null,tabIndex:er,target:null,title:null,translate:null,type:null,typeMustMatch:ee,useMap:null,value:et,width:er,wrap:null,align:null,aLink:null,archive:ei,axis:null,background:null,bgColor:null,border:er,borderColor:null,bottomMargin:er,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ee,declare:ee,event:null,face:null,frame:null,frameBorder:null,hSpace:er,leftMargin:er,link:null,longDesc:null,lowSrc:null,marginHeight:er,marginWidth:er,noResize:ee,noHref:ee,noShade:ee,noWrap:ee,object:null,profile:null,prompt:null,rev:null,rightMargin:er,rules:null,scheme:null,scrolling:et,standby:null,summary:null,text:null,topMargin:er,valueType:null,version:null,vAlign:null,vLink:null,vSpace:er,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ee,disableRemotePlayback:ee,prefix:null,property:null,results:er,security:null,unselectable:null}}),eg=create({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:caseSensitiveTransform,properties:{about:ea,accentHeight:er,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:er,amplitude:er,arabicForm:null,ascent:er,attributeName:null,attributeType:null,azimuth:er,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:er,by:null,calcMode:null,capHeight:er,className:ei,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:er,diffuseConstant:er,direction:null,display:null,dur:null,divisor:er,dominantBaseline:null,download:ee,dx:null,dy:null,edgeMode:null,editable:null,elevation:er,enableBackground:null,end:null,event:null,exponent:er,externalResourcesRequired:null,fill:null,fillOpacity:er,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:eo,g2:eo,glyphName:eo,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:er,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:er,horizOriginX:er,horizOriginY:er,id:null,ideographic:er,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:er,k:er,k1:er,k2:er,k3:er,k4:er,kernelMatrix:ea,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:er,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:er,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:er,overlineThickness:er,paintOrder:null,panose1:null,path:null,pathLength:er,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ei,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:er,pointsAtY:er,pointsAtZ:er,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:ea,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:ea,rev:ea,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:ea,requiredFeatures:ea,requiredFonts:ea,requiredFormats:ea,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:er,specularExponent:er,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:er,strikethroughThickness:er,string:null,stroke:null,strokeDashArray:ea,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:er,strokeOpacity:er,strokeWidth:null,style:null,surfaceScale:er,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:ea,tabIndex:er,tableValues:null,target:null,targetX:er,targetY:er,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:ea,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:er,underlineThickness:er,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:er,values:null,vAlphabetic:er,vMathematical:er,vectorEffect:null,vHanging:er,vIdeographic:er,version:null,vertAdvY:er,vertOriginX:er,vertOriginY:er,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:er,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),em=/^data[-\w.:]+$/i,ey=/-[a-z]/g,eb=/[A-Z]/g;function find(c,u){let f=normalize(u),g=u,b=Info;if(f in c.normal)return c.property[c.normal[f]];if(f.length>4&&"data"===f.slice(0,4)&&em.test(u)){if("-"===u.charAt(4)){let c=u.slice(5).replace(ey,camelcase);g="data"+c.charAt(0).toUpperCase()+c.slice(1)}else{let c=u.slice(4);if(!ey.test(c)){let f=c.replace(eb,kebab);"-"!==f.charAt(0)&&(f="-"+f),u="data"+f}}b=DefinedInfo}return new b(g,u)}function kebab(c){return"-"+c.toLowerCase()}function camelcase(c){return c.charAt(1).toUpperCase()}let ev=merge([ed,eu,eh,ep,ef],"html"),eS=merge([ed,eu,eh,ep,eg],"svg"),ex={}.hasOwnProperty;function zwitch(c,u){let f=u||{};function one(u,...f){let g=one.invalid,b=one.handlers;if(u&&ex.call(u,c)){let f=String(u[c]);g=ex.call(b,f)?b[f]:one.unknown}if(g)return g.call(this,u,...f)}return one.handlers=f.handlers||{},one.invalid=f.invalid,one.unknown=f.unknown,one}function core(c,u){if(c=c.replace(u.subset?charactersToExpression(u.subset):/["&'<>`]/g,basic),u.subset||u.escapeOnly)return c;return c.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,surrogate).replace(/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,basic);function surrogate(c,f,g){return u.format((c.charCodeAt(0)-55296)*1024+c.charCodeAt(1)-56320+65536,g.charCodeAt(f+2),u)}function basic(c,f,g){return u.format(c.charCodeAt(0),g.charCodeAt(f+1),u)}}function charactersToExpression(c){let u=[],f=-1;for(;++f<c.length;)u.push(c[f].replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"));return RegExp("(?:"+u.join("|")+")","g")}function toHexadecimal(c,u,f){let g="&#x"+c.toString(16).toUpperCase();return f&&u&&!/[\dA-Fa-f]/.test(String.fromCharCode(u))?g:g+";"}function toDecimal(c,u,f){let g="&#"+String(c);return f&&u&&!/\d/.test(String.fromCharCode(u))?g:g+";"}let ew=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],e_={nbsp:"\xa0",iexcl:"\xa1",cent:"\xa2",pound:"\xa3",curren:"\xa4",yen:"\xa5",brvbar:"\xa6",sect:"\xa7",uml:"\xa8",copy:"\xa9",ordf:"\xaa",laquo:"\xab",not:"\xac",shy:"\xad",reg:"\xae",macr:"\xaf",deg:"\xb0",plusmn:"\xb1",sup2:"\xb2",sup3:"\xb3",acute:"\xb4",micro:"\xb5",para:"\xb6",middot:"\xb7",cedil:"\xb8",sup1:"\xb9",ordm:"\xba",raquo:"\xbb",frac14:"\xbc",frac12:"\xbd",frac34:"\xbe",iquest:"\xbf",Agrave:"\xc0",Aacute:"\xc1",Acirc:"\xc2",Atilde:"\xc3",Auml:"\xc4",Aring:"\xc5",AElig:"\xc6",Ccedil:"\xc7",Egrave:"\xc8",Eacute:"\xc9",Ecirc:"\xca",Euml:"\xcb",Igrave:"\xcc",Iacute:"\xcd",Icirc:"\xce",Iuml:"\xcf",ETH:"\xd0",Ntilde:"\xd1",Ograve:"\xd2",Oacute:"\xd3",Ocirc:"\xd4",Otilde:"\xd5",Ouml:"\xd6",times:"\xd7",Oslash:"\xd8",Ugrave:"\xd9",Uacute:"\xda",Ucirc:"\xdb",Uuml:"\xdc",Yacute:"\xdd",THORN:"\xde",szlig:"\xdf",agrave:"\xe0",aacute:"\xe1",acirc:"\xe2",atilde:"\xe3",auml:"\xe4",aring:"\xe5",aelig:"\xe6",ccedil:"\xe7",egrave:"\xe8",eacute:"\xe9",ecirc:"\xea",euml:"\xeb",igrave:"\xec",iacute:"\xed",icirc:"\xee",iuml:"\xef",eth:"\xf0",ntilde:"\xf1",ograve:"\xf2",oacute:"\xf3",ocirc:"\xf4",otilde:"\xf5",ouml:"\xf6",divide:"\xf7",oslash:"\xf8",ugrave:"\xf9",uacute:"\xfa",ucirc:"\xfb",uuml:"\xfc",yacute:"\xfd",thorn:"\xfe",yuml:"\xff",fnof:"ƒ",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",bull:"•",hellip:"…",prime:"′",Prime:"″",oline:"‾",frasl:"⁄",weierp:"℘",image:"ℑ",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",quot:'"',amp:"&",lt:"<",gt:">",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",permil:"‰",lsaquo:"‹",rsaquo:"›",euro:"€"},ek=["cent","copy","divide","gt","lt","not","para","times"],eC={}.hasOwnProperty,eE={};for(g in e_)eC.call(e_,g)&&(eE[e_[g]]=g);function toNamed(c,u,f,g){let b=String.fromCharCode(c);if(eC.call(eE,b)){let c=eE[b],v="&"+c;return f&&ew.includes(c)&&!ek.includes(c)&&(!g||u&&61!==u&&/[^\da-z]/i.test(String.fromCharCode(u)))?v:v+";"}return""}function formatSmart(c,u,f){let g,b=toHexadecimal(c,u,f.omitOptionalSemicolons);if((f.useNamedReferences||f.useShortestReferences)&&(g=toNamed(c,u,f.omitOptionalSemicolons,f.attribute)),(f.useShortestReferences||!g)&&f.useShortestReferences){let g=toDecimal(c,u,f.omitOptionalSemicolons);g.length<b.length&&(b=g)}return g&&(!f.useShortestReferences||g.length<b.length)?g:b}function stringifyEntities(c,u){return core(c,Object.assign({format:formatSmart},u))}function comment(c,u,f,g){return g.settings.bogusComments?"<?"+stringifyEntities(c.value,Object.assign({},g.settings.characterReferences,{subset:[">"]}))+">":"<!--"+c.value.replace(/^>|^->|<!--|-->|--!>|<!-$/g,encode)+"-->";function encode(c){return stringifyEntities(c,Object.assign({},g.settings.characterReferences,{subset:["<",">"]}))}}function doctype(c,u,f,g){return"<!"+(g.settings.upperDoctype?"DOCTYPE":"doctype")+(g.settings.tightDoctype?"":" ")+"html>"}function ccount(c,u){let f=String(c);if("string"!=typeof u)throw TypeError("Expected character");let g=0,b=f.indexOf(u);for(;-1!==b;)g++,b=f.indexOf(u,b+u.length);return g}function stringify$1(c,u){let f=u||{},g=""===c[c.length-1]?[...c,""]:c;return g.join((f.padRight?" ":"")+","+(!1===f.padLeft?"":" ")).trim()}function stringify(c){return c.join(" ").trim()}let eP=/[ \t\n\f\r]/g;function whitespace(c){return"object"==typeof c?"text"===c.type&&empty(c.value):empty(c)}function empty(c){return""===c.replace(eP,"")}let eT=siblings(1),e$=siblings(-1),eI=[];function siblings(c){return sibling;function sibling(u,f,g){let b=u?u.children:eI,v=(f||0)+c,x=b[v];if(!g)for(;x&&whitespace(x);)v+=c,x=b[v];return x}}let eA={}.hasOwnProperty;function omission(c){return omit;function omit(u,f,g){return eA.call(c,u.tagName)&&c[u.tagName](u,f,g)}}let eM=omission({body:body$1,caption:headOrColgroupOrCaption,colgroup:headOrColgroupOrCaption,dd,dt,head:headOrColgroupOrCaption,html:html$1,li,optgroup,option:dist_option,p,rp:rubyElement,rt:rubyElement,tbody:tbody$1,td:cells,tfoot,th:cells,thead,tr});function headOrColgroupOrCaption(c,u,f){let g=eT(f,u,!0);return!g||"comment"!==g.type&&!("text"===g.type&&whitespace(g.value.charAt(0)))}function html$1(c,u,f){let g=eT(f,u);return!g||"comment"!==g.type}function body$1(c,u,f){let g=eT(f,u);return!g||"comment"!==g.type}function p(c,u,f){let g=eT(f,u);return g?"element"===g.type&&("address"===g.tagName||"article"===g.tagName||"aside"===g.tagName||"blockquote"===g.tagName||"details"===g.tagName||"div"===g.tagName||"dl"===g.tagName||"fieldset"===g.tagName||"figcaption"===g.tagName||"figure"===g.tagName||"footer"===g.tagName||"form"===g.tagName||"h1"===g.tagName||"h2"===g.tagName||"h3"===g.tagName||"h4"===g.tagName||"h5"===g.tagName||"h6"===g.tagName||"header"===g.tagName||"hgroup"===g.tagName||"hr"===g.tagName||"main"===g.tagName||"menu"===g.tagName||"nav"===g.tagName||"ol"===g.tagName||"p"===g.tagName||"pre"===g.tagName||"section"===g.tagName||"table"===g.tagName||"ul"===g.tagName):!f||!("element"===f.type&&("a"===f.tagName||"audio"===f.tagName||"del"===f.tagName||"ins"===f.tagName||"map"===f.tagName||"noscript"===f.tagName||"video"===f.tagName))}function li(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&"li"===g.tagName}function dt(c,u,f){let g=eT(f,u);return!!(g&&"element"===g.type&&("dt"===g.tagName||"dd"===g.tagName))}function dd(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&("dt"===g.tagName||"dd"===g.tagName)}function rubyElement(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&("rp"===g.tagName||"rt"===g.tagName)}function optgroup(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&"optgroup"===g.tagName}function dist_option(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&("option"===g.tagName||"optgroup"===g.tagName)}function thead(c,u,f){let g=eT(f,u);return!!(g&&"element"===g.type&&("tbody"===g.tagName||"tfoot"===g.tagName))}function tbody$1(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&("tbody"===g.tagName||"tfoot"===g.tagName)}function tfoot(c,u,f){return!eT(f,u)}function tr(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&"tr"===g.tagName}function cells(c,u,f){let g=eT(f,u);return!g||"element"===g.type&&("td"===g.tagName||"th"===g.tagName)}let ej=omission({body,colgroup,head,html,tbody});function html(c){let u=eT(c,-1);return!u||"comment"!==u.type}function head(c){let u=c.children,f=[],g=-1;for(;++g<u.length;){let c=u[g];if("element"===c.type&&("title"===c.tagName||"base"===c.tagName)){if(f.includes(c.tagName))return!1;f.push(c.tagName)}}return u.length>0}function body(c){let u=eT(c,-1,!0);return!u||"comment"!==u.type&&!("text"===u.type&&whitespace(u.value.charAt(0)))&&!("element"===u.type&&("meta"===u.tagName||"link"===u.tagName||"script"===u.tagName||"style"===u.tagName||"template"===u.tagName))}function colgroup(c,u,f){let g=e$(f,u),b=eT(c,-1,!0);return!(f&&g&&"element"===g.type&&"colgroup"===g.tagName&&eM(g,f.children.indexOf(g),f))&&!!(b&&"element"===b.type&&"col"===b.tagName)}function tbody(c,u,f){let g=e$(f,u),b=eT(c,-1);return!(f&&g&&"element"===g.type&&("thead"===g.tagName||"tbody"===g.tagName)&&eM(g,f.children.indexOf(g),f))&&!!(b&&"element"===b.type&&"tr"===b.tagName)}let eO={name:[["	\n\f\r &/=>".split(""),"	\n\f\r \"&'/=>`".split("")],["\x00	\n\f\r \"&'/<=>".split(""),"\x00	\n\f\r \"&'/<=>`".split("")]],unquoted:[["	\n\f\r &>".split(""),"\x00	\n\f\r \"&'<=>`".split("")],["\x00	\n\f\r \"&'<=>`".split(""),"\x00	\n\f\r \"&'<=>`".split("")]],single:[["&'".split(""),"\"&'`".split("")],["\x00&'".split(""),"\x00\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\x00"&'.split(""),"\x00\"&'`".split("")]]};function dist_element(c,u,f,g){let b;let v=g.schema,x="svg"!==v.space&&g.settings.omitOptionalTags,w="svg"===v.space?g.settings.closeEmptyElements:g.settings.voids.includes(c.tagName.toLowerCase()),_=[];"html"===v.space&&"svg"===c.tagName&&(g.schema=eS);let k=serializeAttributes(g,c.properties),E=g.all("html"===v.space&&"template"===c.tagName?c.content:c);return g.schema=v,E&&(w=!1),!k&&x&&ej(c,u,f)||(_.push("<",c.tagName,k?" "+k:""),w&&("svg"===v.space||g.settings.closeSelfClosing)&&(b=k.charAt(k.length-1),(!g.settings.tightSelfClosing||"/"===b||b&&'"'!==b&&"'"!==b)&&_.push(" "),_.push("/")),_.push(">")),_.push(E),w||x&&eM(c,u,f)||_.push("</"+c.tagName+">"),_.join("")}function serializeAttributes(c,u){let f;let g=[],b=-1;if(u){for(f in u)if(null!==u[f]&&void 0!==u[f]){let b=serializeAttribute(c,f,u[f]);b&&g.push(b)}}for(;++b<g.length;){let u=c.settings.tightAttributes?g[b].charAt(g[b].length-1):void 0;b!==g.length-1&&'"'!==u&&"'"!==u&&(g[b]+=" ")}return g.join("")}function serializeAttribute(c,u,f){let g;let b=find(c.schema,u),v=c.settings.allowParseErrors&&"html"===c.schema.space?0:1,x=c.settings.allowDangerousCharacters?0:1,w=c.quote;if(b.overloadedBoolean&&(f===b.attribute||""===f)?f=!0:(b.boolean||b.overloadedBoolean&&"string"!=typeof f)&&(f=!!f),null==f||!1===f||"number"==typeof f&&Number.isNaN(f))return"";let _=stringifyEntities(b.attribute,Object.assign({},c.settings.characterReferences,{subset:eO.name[v][x]}));return!0===f?_:(f=Array.isArray(f)?(b.commaSeparated?stringify$1:stringify)(f,{padLeft:!c.settings.tightCommaSeparatedLists}):String(f),c.settings.collapseEmptyAttributes&&!f)?_:(c.settings.preferUnquoted&&(g=stringifyEntities(f,Object.assign({},c.settings.characterReferences,{attribute:!0,subset:eO.unquoted[v][x]}))),g!==f&&(c.settings.quoteSmart&&ccount(f,w)>ccount(f,c.alternative)&&(w=c.alternative),g=w+stringifyEntities(f,Object.assign({},c.settings.characterReferences,{subset:("'"===w?eO.single:eO.double)[v][x],attribute:!0}))+w),_+(g?"="+g:g))}function dist_text(c,u,f,g){return f&&"element"===f.type&&("script"===f.tagName||"style"===f.tagName)?c.value:stringifyEntities(c.value,Object.assign({},g.settings.characterReferences,{subset:["<","&"]}))}function raw(c,u,f,g){return g.settings.allowDangerousHtml?c.value:dist_text(c,u,f,g)}function root(c,u,f,g){return g.all(c)}let eR=zwitch("type",{invalid,unknown,handlers:{comment,doctype,element:dist_element,raw,root,text:dist_text}});function invalid(c){throw Error("Expected node, not `"+c+"`")}function unknown(c){throw Error("Cannot compile unknown node `"+c.type+"`")}let eD={},eL={},eN=[];function toHtml(c,u){let f=u||eD,g=f.quote||'"';if('"'!==g&&"'"!==g)throw Error("Invalid quote `"+g+"`, expected `'` or `\"`");let b={one,all:dist_all,settings:{omitOptionalTags:f.omitOptionalTags||!1,allowParseErrors:f.allowParseErrors||!1,allowDangerousCharacters:f.allowDangerousCharacters||!1,quoteSmart:f.quoteSmart||!1,preferUnquoted:f.preferUnquoted||!1,tightAttributes:f.tightAttributes||!1,upperDoctype:f.upperDoctype||!1,tightDoctype:f.tightDoctype||!1,bogusComments:f.bogusComments||!1,tightCommaSeparatedLists:f.tightCommaSeparatedLists||!1,tightSelfClosing:f.tightSelfClosing||!1,collapseEmptyAttributes:f.collapseEmptyAttributes||!1,allowDangerousHtml:f.allowDangerousHtml||!1,voids:f.voids||J,characterReferences:f.characterReferences||eL,closeSelfClosing:f.closeSelfClosing||!1,closeEmptyElements:f.closeEmptyElements||!1},schema:"svg"===f.space?eS:ev,quote:g,alternative:'"'===g?"'":'"'};return b.one(Array.isArray(c)?{type:"root",children:c}:c,void 0,void 0)}function one(c,u,f){return eR(c,u,f,this)}function dist_all(c){let u=[],f=c&&c.children||eN,g=-1;for(;++g<f.length;)u[g]=this.one(f[g],g,c);return u.join("")}function codeToHtml(c,u,f){let g={meta:{},options:f,codeToHast:(u,f)=>codeToHast(c,u,f),codeToTokens:(u,f)=>codeToTokens(c,u,f)},b=toHtml(codeToHast(c,u,f,g));for(let c of getTransformers(f))b=c.postprocess?.call(g,b,f)||b;return b}async function main(c){let u,f;let g={};function updateGlobalBufferAndViews(c){f=c,g.HEAPU8=new Uint8Array(c),g.HEAPU32=new Uint32Array(c)}function _emscripten_get_now(){return"undefined"!=typeof performance?performance.now():Date.now()}function _emscripten_memcpy_big(c,u,f){g.HEAPU8.copyWithin(c,u,u+f)}function getHeapMax(){return 2147483648}function emscripten_realloc_buffer(c){try{return u.grow(c-f.byteLength+65535>>>16),updateGlobalBufferAndViews(u.buffer),1}catch(c){}}function _emscripten_resize_heap(c){let u=g.HEAPU8.length;c>>>=0;let f=getHeapMax();if(c>f)return!1;let alignUp=(c,u)=>c+(u-c%u)%u;for(let g=1;g<=4;g*=2){let b=u*(1+.2/g);b=Math.min(b,c+100663296);let v=Math.min(f,alignUp(Math.max(c,b),65536)),x=emscripten_realloc_buffer(v);if(x)return!0}return!1}let b={emscripten_get_now:_emscripten_get_now,emscripten_memcpy_big:_emscripten_memcpy_big,emscripten_resize_heap:_emscripten_resize_heap,fd_write:()=>0};async function createWasm(){let f=await c({env:b,wasi_snapshot_preview1:b});updateGlobalBufferAndViews((u=f.memory).buffer),Object.assign(g,f)}return await createWasm(),g}let eF=null;function throwLastOnigError(c){throw new ShikiError(c.UTF8ToString(c.getLastOnigError()))}let UtfString=class UtfString{static _utf8ByteLength(c){let u=0;for(let f=0,g=c.length;f<g;f++){let b=c.charCodeAt(f),v=b,x=!1;if(b>=55296&&b<=56319&&f+1<g){let u=c.charCodeAt(f+1);u>=56320&&u<=57343&&(v=(b-55296<<10)+65536|u-56320,x=!0)}v<=127?u+=1:v<=2047?u+=2:v<=65535?u+=3:u+=4,x&&f++}return u}utf16Length;utf8Length;utf16Value;utf8Value;utf16OffsetToUtf8;utf8OffsetToUtf16;constructor(c){let u=c.length,f=UtfString._utf8ByteLength(c),g=f!==u,b=g?new Uint32Array(u+1):null;g&&(b[u]=f);let v=g?new Uint32Array(f+1):null;g&&(v[f]=u);let x=new Uint8Array(f),w=0;for(let f=0;f<u;f++){let _=c.charCodeAt(f),k=_,E=!1;if(_>=55296&&_<=56319&&f+1<u){let u=c.charCodeAt(f+1);u>=56320&&u<=57343&&(k=(_-55296<<10)+65536|u-56320,E=!0)}g&&(b[f]=w,E&&(b[f+1]=w),k<=127?v[w+0]=f:k<=2047?(v[w+0]=f,v[w+1]=f):k<=65535?(v[w+0]=f,v[w+1]=f,v[w+2]=f):(v[w+0]=f,v[w+1]=f,v[w+2]=f,v[w+3]=f)),k<=127?x[w++]=k:(k<=2047?x[w++]=192|(1984&k)>>>6:(k<=65535?x[w++]=224|(61440&k)>>>12:(x[w++]=240|(1835008&k)>>>18,x[w++]=128|(258048&k)>>>12),x[w++]=128|(4032&k)>>>6),x[w++]=128|(63&k)>>>0),E&&f++}this.utf16Length=u,this.utf8Length=f,this.utf16Value=c,this.utf8Value=x,this.utf16OffsetToUtf8=b,this.utf8OffsetToUtf16=v}createString(c){let u=c.omalloc(this.utf8Length);return c.HEAPU8.set(this.utf8Value,u),u}};let OnigString=class OnigString{static LAST_ID=0;static _sharedPtr=0;static _sharedPtrInUse=!1;id=++OnigString.LAST_ID;_onigBinding;content;utf16Length;utf8Length;utf16OffsetToUtf8;utf8OffsetToUtf16;ptr;constructor(c){if(!eF)throw new ShikiError("Must invoke loadWasm first.");this._onigBinding=eF,this.content=c;let u=new UtfString(c);this.utf16Length=u.utf16Length,this.utf8Length=u.utf8Length,this.utf16OffsetToUtf8=u.utf16OffsetToUtf8,this.utf8OffsetToUtf16=u.utf8OffsetToUtf16,this.utf8Length<1e4&&!OnigString._sharedPtrInUse?(OnigString._sharedPtr||(OnigString._sharedPtr=eF.omalloc(1e4)),OnigString._sharedPtrInUse=!0,eF.HEAPU8.set(u.utf8Value,OnigString._sharedPtr),this.ptr=OnigString._sharedPtr):this.ptr=u.createString(eF)}convertUtf8OffsetToUtf16(c){return this.utf8OffsetToUtf16?c<0?0:c>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[c]:c}convertUtf16OffsetToUtf8(c){return this.utf16OffsetToUtf8?c<0?0:c>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[c]:c}dispose(){this.ptr===OnigString._sharedPtr?OnigString._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}};let OnigScanner=class OnigScanner{_onigBinding;_ptr;constructor(c){if(!eF)throw new ShikiError("Must invoke loadWasm first.");let u=[],f=[];for(let g=0,b=c.length;g<b;g++){let b=new UtfString(c[g]);u[g]=b.createString(eF),f[g]=b.utf8Length}let g=eF.omalloc(4*c.length);eF.HEAPU32.set(u,g/4);let b=eF.omalloc(4*c.length);eF.HEAPU32.set(f,b/4);let v=eF.createOnigScanner(g,b,c.length);for(let f=0,g=c.length;f<g;f++)eF.ofree(u[f]);eF.ofree(b),eF.ofree(g),0===v&&throwLastOnigError(eF),this._onigBinding=eF,this._ptr=v}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(c,u,f){let g=!1,b=0;if("number"==typeof f?(8&f&&(g=!0),b=f):"boolean"==typeof f&&(g=f),"string"==typeof c){c=new OnigString(c);let f=this._findNextMatchSync(c,u,g,b);return c.dispose(),f}return this._findNextMatchSync(c,u,g,b)}_findNextMatchSync(c,u,f,g){let b;let v=this._onigBinding;if(0===(b=f?v.findNextOnigScannerMatchDbg(this._ptr,c.id,c.ptr,c.utf8Length,c.convertUtf16OffsetToUtf8(u),g):v.findNextOnigScannerMatch(this._ptr,c.id,c.ptr,c.utf8Length,c.convertUtf16OffsetToUtf8(u),g)))return null;let x=v.HEAPU32,w=b/4,_=x[w++],k=x[w++],E=[];for(let u=0;u<k;u++){let f=c.convertUtf8OffsetToUtf16(x[w++]),g=c.convertUtf8OffsetToUtf16(x[w++]);E[u]={start:f,end:g,length:g-f}}return{index:_,captureIndices:E}}};function isInstantiatorOptionsObject(c){return"function"==typeof c.instantiator}function isInstantiatorModule(c){return"function"==typeof c.default}function isDataOptionsObject(c){return void 0!==c.data}function isResponse(c){return"undefined"!=typeof Response&&c instanceof Response}function isArrayBuffer(c){return"undefined"!=typeof ArrayBuffer&&(c instanceof ArrayBuffer||ArrayBuffer.isView(c))||void 0!==V&&V.isBuffer(c)||"undefined"!=typeof SharedArrayBuffer&&c instanceof SharedArrayBuffer||"undefined"!=typeof Uint32Array&&c instanceof Uint32Array}function loadWasm(c){return b||(b=async function(){eF=await main(async u=>{let f=c;return"function"==typeof(f=await f)&&(f=await f(u)),"function"==typeof f&&(f=await f(u)),isInstantiatorOptionsObject(f)?f=await f.instantiator(u):isInstantiatorModule(f)?f=await f.default(u):(isDataOptionsObject(f)&&(f=f.data),isResponse(f)?f="function"==typeof WebAssembly.instantiateStreaming?await _makeResponseStreamingLoader(f)(u):await _makeResponseNonStreamingLoader(f)(u):isArrayBuffer(f)&&(f=await _makeArrayBufferLoader(f)(u))),"instance"in f&&(f=f.instance),"exports"in f&&(f=f.exports),f})}())}function _makeArrayBufferLoader(c){return u=>WebAssembly.instantiate(c,u)}function _makeResponseStreamingLoader(c){return u=>WebAssembly.instantiateStreaming(c,u)}function _makeResponseNonStreamingLoader(c){return async u=>{let f=await c.arrayBuffer();return WebAssembly.instantiate(f,u)}}function createOnigString(c){return new OnigString(c)}function createOnigScanner(c){return new OnigScanner(c)}let eB={light:"#333333",dark:"#bbbbbb"},ez={light:"#fffffe",dark:"#1e1e1e"},eG="__shiki_resolved";function normalizeTheme(c){if(c?.[eG])return c;let u={...c};u.tokenColors&&!u.settings&&(u.settings=u.tokenColors,delete u.tokenColors),u.type||="dark",u.colorReplacements={...u.colorReplacements},u.settings||=[];let{bg:f,fg:g}=u;if(!f||!g){let c=u.settings?u.settings.find(c=>!c.name&&!c.scope):void 0;c?.settings?.foreground&&(g=c.settings.foreground),c?.settings?.background&&(f=c.settings.background),!g&&u?.colors?.["editor.foreground"]&&(g=u.colors["editor.foreground"]),!f&&u?.colors?.["editor.background"]&&(f=u.colors["editor.background"]),g||(g="light"===u.type?eB.light:eB.dark),f||(f="light"===u.type?ez.light:ez.dark),u.fg=g,u.bg=f}u.settings[0]&&u.settings[0].settings&&!u.settings[0].scope||u.settings.unshift({settings:{foreground:u.fg,background:u.bg}});let b=0,v=new Map;function getReplacementColor(c){if(v.has(c))return v.get(c);b+=1;let f=`#${b.toString(16).padStart(8,"0").toLowerCase()}`;return u.colorReplacements?.[`#${f}`]?getReplacementColor(c):(v.set(c,f),f)}for(let c of(u.settings=u.settings.map(c=>{let f=c.settings?.foreground&&!c.settings.foreground.startsWith("#"),g=c.settings?.background&&!c.settings.background.startsWith("#");if(!f&&!g)return c;let b={...c,settings:{...c.settings}};if(f){let f=getReplacementColor(c.settings.foreground);u.colorReplacements[f]=c.settings.foreground,b.settings.foreground=f}if(g){let f=getReplacementColor(c.settings.background);u.colorReplacements[f]=c.settings.background,b.settings.background=f}return b}),Object.keys(u.colors||{})))if(("editor.foreground"===c||"editor.background"===c||c.startsWith("terminal.ansi"))&&!u.colors[c]?.startsWith("#")){let f=getReplacementColor(u.colors[c]);u.colorReplacements[f]=u.colors[c],u.colors[c]=f}return Object.defineProperty(u,eG,{enumerable:!1,writable:!1,value:!0}),u}let Registry=class Registry extends B{_resolver;_themes;_langs;_resolvedThemes={};_resolvedGrammars={};_langMap={};_langGraph=new Map;alias={};constructor(c,u,f){super(c),this._resolver=c,this._themes=u,this._langs=f,u.forEach(c=>this.loadTheme(c)),f.forEach(c=>this.loadLanguage(c))}getTheme(c){return"string"==typeof c?this._resolvedThemes[c]:this.loadTheme(c)}loadTheme(c){let u=normalizeTheme(c);return u.name&&(this._resolvedThemes[u.name]=u),u}getLoadedThemes(){return Object.keys(this._resolvedThemes)}getGrammar(c){if(this.alias[c]){let u=new Set([c]);for(;this.alias[c];){if(c=this.alias[c],u.has(c))throw new ShikiError(`Circular alias \`${Array.from(u).join(" -> ")} -> ${c}\``);u.add(c)}}return this._resolvedGrammars[c]}async loadLanguage(c){if(this.getGrammar(c.name))return;let u=new Set(Object.values(this._langMap).filter(u=>u.embeddedLangsLazy?.includes(c.name)));this._resolver.addLanguage(c);let f={balancedBracketSelectors:c.balancedBracketSelectors||["*"],unbalancedBracketSelectors:c.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(c.scopeName,c);let g=await this.loadGrammarWithConfiguration(c.scopeName,1,f);if(this._resolvedGrammars[c.name]=g,c.aliases&&c.aliases.forEach(u=>{this.alias[u]=c.name}),u.size)for(let c of u)delete this._resolvedGrammars[c.name],this._syncRegistry?._injectionGrammars?.delete(c.scopeName),this._syncRegistry?._grammars?.delete(c.scopeName),await this.loadLanguage(this._langMap[c.name])}async init(){this._themes.map(c=>this.loadTheme(c)),await this.loadLanguages(this._langs)}async loadLanguages(c){for(let u of c)this.resolveEmbeddedLanguages(u);let u=Array.from(this._langGraph.entries()),f=u.filter(([c,u])=>!u);if(f.length){let c=u.filter(([c,u])=>u&&u.embeddedLangs?.some(c=>f.map(([c])=>c).includes(c))).filter(c=>!f.includes(c));throw new ShikiError(`Missing languages ${f.map(([c])=>`\`${c}\``).join(", ")}, required by ${c.map(([c])=>`\`${c}\``).join(", ")}`)}for(let[c,f]of u)this._resolver.addLanguage(f);for(let[c,f]of u)await this.loadLanguage(f)}getLoadedLanguages(){return Object.keys({...this._resolvedGrammars,...this.alias})}resolveEmbeddedLanguages(c){if(this._langMap[c.name]=c,this._langGraph.set(c.name,c),c.embeddedLangs)for(let u of c.embeddedLangs)this._langGraph.set(u,this._langMap[u])}};let Resolver=class Resolver{_langs=new Map;_scopeToLang=new Map;_injections=new Map;_onigLibPromise;constructor(c,u){this._onigLibPromise=c,u.forEach(c=>this.addLanguage(c))}get onigLib(){return this._onigLibPromise}getLangRegistration(c){return this._langs.get(c)}async loadGrammar(c){return this._scopeToLang.get(c)}addLanguage(c){this._langs.set(c.name,c),c.aliases&&c.aliases.forEach(u=>{this._langs.set(u,c)}),this._scopeToLang.set(c.scopeName,c),c.injectTo&&c.injectTo.forEach(u=>{this._injections.get(u)||this._injections.set(u,[]),this._injections.get(u).push(c.scopeName)})}getInjections(c){let u=c.split("."),f=[];for(let c=1;c<=u.length;c++){let g=u.slice(0,c).join(".");f=[...f,...this._injections.get(g)||[]]}return f}};async function getShikiInternal(c={}){let u;async function normalizeGetter(c){return Promise.resolve("function"==typeof c?c():c).then(c=>c.default||c)}async function resolveLangs(c){return Array.from(new Set((await Promise.all(c.filter(c=>!isSpecialLang(c)).map(async c=>await normalizeGetter(c).then(c=>Array.isArray(c)?c:[c])))).flat()))}let f=c.loadWasm||v,[g,b]=await Promise.all([Promise.all((c.themes||[]).map(normalizeGetter)).then(c=>c.map(normalizeTheme)),resolveLangs(c.langs||[]),f?loadWasm(f):void 0]),x=new Resolver(Promise.resolve({createOnigScanner:c=>createOnigScanner(c),createOnigString:c=>createOnigString(c)}),b),w=new Registry(x,g,b);function getTheme(c){if("none"===c)return{bg:"",fg:"",name:"none",settings:[],type:"dark"};let u=w.getTheme(c);if(!u)throw new ShikiError(`Theme \`${c}\` not found, you may need to load it first`);return u}return Object.assign(w.alias,c.langAlias),await w.init(),{setTheme:function(c){let f=getTheme(c);u!==c&&(w.setTheme(f),u=c);let g=w.getColorMap();return{theme:f,colorMap:g}},getTheme,getLanguage:function(c){let u=w.getGrammar("string"==typeof c?c:c.name);if(!u)throw new ShikiError(`Language \`${c}\` not found, you may need to load it first`);return u},getLoadedThemes:function(){return w.getLoadedThemes()},getLoadedLanguages:function(){return w.getLoadedLanguages()},loadLanguage:async function(...c){await w.loadLanguages(await resolveLangs(c))},loadTheme:async function(...c){await Promise.all(c.map(async c=>"none"===c?null:w.loadTheme(await normalizeGetter(c))))}}}async function getHighlighterCore(c={}){let u=await getShikiInternal(c);return{codeToTokensBase:(c,f)=>codeToTokensBase(u,c,f),codeToTokensWithThemes:(c,f)=>codeToTokensWithThemes(u,c,f),codeToTokens:(c,f)=>codeToTokens(u,c,f),codeToHast:(c,f)=>codeToHast(u,c,f),codeToHtml:(c,f)=>codeToHtml(u,c,f),...u,getInternalContext:()=>u}}function createdBundledHighlighter(c,u,f){return async function(g){function resolveLang(u){if("string"==typeof u){if(isSpecialLang(u))return[];let f=c[u];if(!f)throw new ShikiError(`Language \`${u}\` is not included in this bundle. You may want to load it from external source.`);return f}return u}function resolveTheme(c){if("none"===c)return"none";if("string"==typeof c){let f=u[c];if(!f)throw new ShikiError(`Theme \`${c}\` is not included in this bundle. You may want to load it from external source.`);return f}return c}let b=(g.themes??[]).map(c=>resolveTheme(c)),v=(g.langs??[]).map(c=>resolveLang(c)),x=await getHighlighterCore({...g,themes:b,langs:v,loadWasm:f});return{...x,loadLanguage:(...c)=>x.loadLanguage(...c.map(resolveLang)),loadTheme:(...c)=>x.loadTheme(...c.map(resolveTheme))}}}function createSingletonShorthands(c){let u;async function _getHighlighter(f={}){if(!u)return u=c({themes:toArray(f.theme||[]),langs:toArray(f.lang||[])});{let c=await u;return await Promise.all([c.loadTheme(...toArray(f.theme||[])),c.loadLanguage(...toArray(f.lang||[]))]),c}}return{getSingletonHighlighter:()=>_getHighlighter(),async codeToHtml(c,u){let f=await _getHighlighter({lang:u.lang,theme:"theme"in u?[u.theme]:Object.values(u.themes)});return f.codeToHtml(c,u)},async codeToHast(c,u){let f=await _getHighlighter({lang:u.lang,theme:"theme"in u?[u.theme]:Object.values(u.themes)});return f.codeToHast(c,u)},async codeToTokens(c,u){let f=await _getHighlighter({lang:u.lang,theme:"theme"in u?[u.theme]:Object.values(u.themes)});return f.codeToTokens(c,u)},async codeToTokensBase(c,u){let f=await _getHighlighter(u);return f.codeToTokensBase(c,u)},async codeToTokensWithThemes(c,u){let f=await _getHighlighter({lang:u.lang,theme:Object.values(u.themes).filter(Boolean)});return f.codeToTokensWithThemes(c,u)}}}let eU=createdBundledHighlighter(k,T,getWasmInlined),{codeToHtml:eH,codeToHast:eV,codeToTokens:eW,codeToTokensBase:eK,codeToTokensWithThemes:eZ,getSingletonHighlighter:eY}=createSingletonShorthands(eU)},94660:function(c,u,f){"use strict";f.d(u,{ZP:function(){return esm_react}});let createStoreImpl=c=>{let u;let f=new Set,setState=(c,g)=>{let b="function"==typeof c?c(u):c;if(!Object.is(b,u)){let c=u;u=(null!=g?g:"object"!=typeof b||null===b)?b:Object.assign({},u,b),f.forEach(f=>f(u,c))}},getState=()=>u,g={setState,getState,getInitialState:()=>b,subscribe:c=>(f.add(c),()=>f.delete(c)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),f.clear()}},b=u=c(setState,getState,g);return g},createStore=c=>c?createStoreImpl(c):createStoreImpl;var g=f(2265),b=f(65401);let{useDebugValue:v}=g,{useSyncExternalStoreWithSelector:x}=b,w=!1,identity=c=>c;function useStore(c,u=identity,f){f&&!w&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),w=!0);let g=x(c.subscribe,c.getState,c.getServerState||c.getInitialState,u,f);return v(g),g}let createImpl=c=>{"function"!=typeof c&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let u="function"==typeof c?createStore(c):c,useBoundStore=(c,f)=>useStore(u,c,f);return Object.assign(useBoundStore,u),useBoundStore},create=c=>c?createImpl(c):createImpl;var esm_react=c=>(console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),create(c))},74810:function(c,u,f){"use strict";f.d(u,{mW:function(){return devtools}});let g=new Map,getTrackedConnectionState=c=>{let u=g.get(c);return u?Object.fromEntries(Object.entries(u.stores).map(([c,u])=>[c,u.getState()])):{}},extractConnectionInformation=(c,u,f)=>{if(void 0===c)return{type:"untracked",connection:u.connect(f)};let b=g.get(f.name);if(b)return{type:"tracked",store:c,...b};let v={connection:u.connect(f),stores:{}};return g.set(f.name,v),{type:"tracked",store:c,...v}},devtools=(c,u={})=>(f,g,b)=>{let v;let{enabled:x,anonymousActionType:w,store:_,...k}=u;try{v=(null==x||x)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(c){}if(!v)return x&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),c(f,g,b);let{connection:E,...T}=extractConnectionInformation(_,v,k),$=!0;b.setState=(c,u,v)=>{let x=f(c,u);if(!$)return x;let T=void 0===v?{type:w||"anonymous"}:"string"==typeof v?{type:v}:v;return void 0===_?null==E||E.send(T,g()):null==E||E.send({...T,type:`${_}/${T.type}`},{...getTrackedConnectionState(k.name),[_]:b.getState()}),x};let setStateFromDevtools=(...c)=>{let u=$;$=!1,f(...c),$=u},I=c(b.setState,g,b);if("untracked"===T.type?null==E||E.init(I):(T.stores[T.store]=b,null==E||E.init(Object.fromEntries(Object.entries(T.stores).map(([c,u])=>[c,c===T.store?I:u.getState()])))),b.dispatchFromDevtools&&"function"==typeof b.dispatch){let c=!1,u=b.dispatch;b.dispatch=(...f)=>{"__setState"!==f[0].type||c||(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),c=!0),u(...f)}}return E.subscribe(c=>{var u;switch(c.type){case"ACTION":if("string"!=typeof c.payload){console.error("[zustand devtools middleware] Unsupported action format");return}return parseJsonThen(c.payload,c=>{if("__setState"===c.type){if(void 0===_){setStateFromDevtools(c.state);return}1!==Object.keys(c.state).length&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let u=c.state[_];if(null==u)return;JSON.stringify(b.getState())!==JSON.stringify(u)&&setStateFromDevtools(u);return}b.dispatchFromDevtools&&"function"==typeof b.dispatch&&b.dispatch(c)});case"DISPATCH":switch(c.payload.type){case"RESET":if(setStateFromDevtools(I),void 0===_)return null==E?void 0:E.init(b.getState());return null==E?void 0:E.init(getTrackedConnectionState(k.name));case"COMMIT":if(void 0===_){null==E||E.init(b.getState());break}return null==E?void 0:E.init(getTrackedConnectionState(k.name));case"ROLLBACK":return parseJsonThen(c.state,c=>{if(void 0===_){setStateFromDevtools(c),null==E||E.init(b.getState());return}setStateFromDevtools(c[_]),null==E||E.init(getTrackedConnectionState(k.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return parseJsonThen(c.state,c=>{if(void 0===_){setStateFromDevtools(c);return}JSON.stringify(b.getState())!==JSON.stringify(c[_])&&setStateFromDevtools(c[_])});case"IMPORT_STATE":{let{nextLiftedState:f}=c.payload,g=null==(u=f.computedStates.slice(-1)[0])?void 0:u.state;if(!g)return;void 0===_?setStateFromDevtools(g):setStateFromDevtools(g[_]),null==E||E.send(null,f);break}case"PAUSE_RECORDING":return $=!$}return}}),I},parseJsonThen=(c,u)=>{let f;try{f=JSON.parse(c)}catch(c){console.error("[zustand devtools middleware] Could not parse the received json",c)}void 0!==f&&u(f)}}}]);